(function(){var d=window.jQuery,p=d(window),j=d(document),t;var f="http://www.w3.org/2000/svg",s="SVGAngle" in window&&(function(){var y,z=document.createElement("div");z.innerHTML="<svg/>";y=(z.firstChild&&z.firstChild.namespaceURI)==f;z.innerHTML="";return y})();var n=(function(){var y=document.createElement("div").style;return"transition" in y||"WebkitTransition" in y||"MozTransition" in y||"msTransition" in y||"OTransition" in y})();var h="ontouchstart" in window,q="mousedown"+(h?" touchstart":""),i="mousemove.clockpicker"+(h?" touchmove.clockpicker":""),e="mouseup.clockpicker"+(h?" touchend.clockpicker":"");var c=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null;function w(y){return document.createElementNS(f,y)}function r(y){return(y<10?"0":"")+y}var k=0;function m(y){var z=++k+"";return y?y+z:z}var o=100,v=80,g=54,b=13,l=o*2,a=n?350:1;var x=['<div class="popover clockpicker-popover">','<div class="arrow"></div>','<div class="popover-title">','<span class="clockpicker-span-hours text-primary"></span>'," : ",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="popover-content">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>","</div>","</div>"].join("");function u(y,B){var F=d(x),C=F.find(".clockpicker-plate"),Q=F.find(".clockpicker-hours"),G=F.find(".clockpicker-minutes"),R=y.prop("tagName")==="INPUT",K=R?y:y.find("input"),L=y.find(".input-group-addon"),P=this,J;this.id=m("cp");this.element=y;this.options=B;this.isAppended=false;this.isShown=false;this.currentView="hours";this.isInput=R;this.input=K;this.addon=L;this.popover=F;this.plate=C;this.hoursView=Q;this.minutesView=G;this.spanHours=F.find(".clockpicker-span-hours");this.spanMinutes=F.find(".clockpicker-span-minutes");if(!B.autoclose){d('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+B.donetext+"</button>").click(d.proxy(this.done,this)).appendTo(F)}if((B.placement==="top"||B.placement==="bottom")&&(B.align==="top"||B.align==="bottom")){B.align="left"}if((B.placement==="left"||B.placement==="right")&&(B.align==="left"||B.align==="right")){B.align="top"}F.addClass(B.placement);F.addClass("clockpicker-align-"+B.align);this.spanHours.click(d.proxy(this.toggleView,this,"hours"));this.spanMinutes.click(d.proxy(this.toggleView,this,"minutes"));K.on("focus.clockpicker click.clockpicker",d.proxy(this.show,this));L.on("click.clockpicker",d.proxy(this.toggle,this));var S=d('<div class="clockpicker-tick"></div>'),U,V,M;for(U=0;U<24;U+=1){V=S.clone();M=U/6*Math.PI;var X=U>0&&U<13,E=X?g:v;V.css({left:o+Math.sin(M)*E-b,top:o-Math.cos(M)*E-b});if(X){V.css("font-size","120%")}V.html(U===0?"00":U);Q.append(V);V.on(q,T)}var H=5;if(B.stepping){H=B.stepping}for(U=0;U<60;U+=H){V=S.clone();M=U/30*Math.PI;V.css({left:o+Math.sin(M)*v-b,top:o-Math.cos(M)*v-b});V.css("font-size","120%");V.html(r(U));G.append(V);V.on(q,T)}C.on(q,function(Y){if(d(Y.target).closest(".clockpicker-tick").length===0){T(Y,true)}});function T(ad,Y){var ab=C.offset(),aa=/^touch/.test(ad.type),Z=ab.left+o,ag=ab.top+o,ai=(aa?ad.originalEvent.touches[0]:ad).pageX-Z,ah=(aa?ad.originalEvent.touches[0]:ad).pageY-ag,ae=Math.sqrt(ai*ai+ah*ah),af=false;if(Y&&(ae<v-b||ae>v+b)){return}ad.preventDefault();var ac=setTimeout(function(){t.addClass("clockpicker-moving")},200);if(s){C.append(P.canvas)}P.setHand(ai,ah,!Y,true);j.off(i).on(i,function(al){al.preventDefault();var ak=/^touch/.test(al.type),aj=(ak?al.originalEvent.touches[0]:al).pageX-Z,am=(ak?al.originalEvent.touches[0]:al).pageY-ag;if(!af&&aj===ai&&am===ah){return}af=true;P.setHand(aj,am,false,true)});j.off(e).one(e,function(al){al.preventDefault();var ak=/^touch/.test(al.type),aj=(ak?al.originalEvent.changedTouches[0]:al).pageX-Z,am=(ak?al.originalEvent.changedTouches[0]:al).pageY-ag;if((Y||af)&&aj===ai&&am===ah){P.setHand(aj,am)}if(P.currentView==="hours"){P.toggleView("minutes",a/2)}else{if(B.autoclose){P.minutesView.addClass("clockpicker-dial-out");setTimeout(function(){P.done()},a/2)}}C.prepend(A);clearTimeout(ac);t.removeClass("clockpicker-moving");j.off(i)})}if(s){var A=F.find(".clockpicker-canvas"),O=w("svg");O.setAttribute("class","clockpicker-svg");O.setAttribute("width",l);O.setAttribute("height",l);var W=w("g");W.setAttribute("transform","translate("+o+","+o+")");var D=w("circle");D.setAttribute("class","clockpicker-canvas-bearing");D.setAttribute("cx",0);D.setAttribute("cy",0);D.setAttribute("r",2);var I=w("line");I.setAttribute("x1",0);I.setAttribute("y1",0);var z=w("circle");z.setAttribute("class","clockpicker-canvas-bg");z.setAttribute("r",b);var N=w("circle");N.setAttribute("class","clockpicker-canvas-fg");N.setAttribute("r",3.5);W.appendChild(I);W.appendChild(z);W.appendChild(N);W.appendChild(D);O.appendChild(W);A.append(O);this.hand=I;this.bg=z;this.fg=N;this.bearing=D;this.g=W;this.canvas=A}}u.DEFAULTS={"default":"",fromnow:0,placement:"bottom",align:"left",donetext:"完成",autoclose:false,vibrate:true};u.prototype.toggle=function(){this[this.isShown?"hide":"show"]()};u.prototype.locate=function(){var B=this.element,D=this.popover,z=B.offset(),y=B.outerWidth(),E=B.outerHeight(),A=this.options.placement,C=this.options.align,G={},F=this;D.show();switch(A){case"bottom":G.top=z.top+E;break;case"right":G.left=z.left+y;break;case"top":G.top=z.top-D.outerHeight();break;case"left":G.left=z.left-D.outerWidth();break}switch(C){case"left":G.left=z.left;break;case"right":G.left=z.left+y-D.outerWidth();break;case"top":G.top=z.top;break;case"bottom":G.top=z.top+E-D.outerHeight();break}D.css(G)};u.prototype.show=function(B){if(this.isShown){return}var y=this;if(!this.isAppended){t=d(document.body).append(this.popover);p.on("resize.clockpicker"+this.id,function(){if(y.isShown){y.locate()}});this.isAppended=true}var A=((this.input.prop("value")||this.options["default"]||"")+"").split(":");if(A[0]==="now"){var z=new Date(+new Date()+this.options.fromnow);A=[z.getHours(),z.getMinutes()]}this.hours=+A[0]||0;this.minutes=+A[1]||0;this.spanHours.html(r(this.hours));this.spanMinutes.html(r(this.minutes));this.toggleView("hours");this.locate();this.isShown=true;j.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(D){var C=d(D.target);if(C.closest(y.popover).length===0&&C.closest(y.addon).length===0&&C.closest(y.input).length===0){y.hide()}});j.on("keyup.clockpicker."+this.id,function(C){if(C.keyCode===27){y.hide()}})};u.prototype.hide=function(){this.isShown=false;j.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id);j.off("keyup.clockpicker."+this.id);this.popover.hide()};u.prototype.toggleView=function(y,A){var z=y==="hours",C=z?this.hoursView:this.minutesView,B=z?this.minutesView:this.hoursView;this.currentView=y;this.spanHours.toggleClass("text-primary",z);this.spanMinutes.toggleClass("text-primary",!z);B.addClass("clockpicker-dial-out");C.css("visibility","visible").removeClass("clockpicker-dial-out");this.resetClock(A);clearTimeout(this.toggleViewTimer);this.toggleViewTimer=setTimeout(function(){B.css("visibility","hidden")},a)};u.prototype.resetClock=function(z){var E=this.currentView,G=this[E],B=E==="hours",H=Math.PI/(B?6:30),D=G*H,A=B&&G>0&&G<13?g:v,F=Math.sin(D)*A,C=-Math.cos(D)*A,I=this;if(s&&z){I.canvas.addClass("clockpicker-canvas-out");setTimeout(function(){I.canvas.removeClass("clockpicker-canvas-out");I.setHand(F,C)},z)}else{this.setHand(F,C)}};u.prototype.setHand=function(H,F,J,L){var G=Math.atan2(H,-F),E=this.currentView==="hours",K=Math.PI/(E||J?6:30),D=Math.sqrt(H*H+F*F),N=this.options,M=E&&D<(v+g)/2,C=M?g:v,I;if(G<0){G=Math.PI*2+G}I=Math.round(G/K);G=I*K;if(E){if(I===12){I=0}I=M?(I===0?12:I):I===0?0:I+12}else{if(J){I*=5}if(I===60){I=0}}if(this[this.currentView]!==I){if(c&&this.options.vibrate){if(!this.vibrateTimer){navigator[c](10);this.vibrateTimer=setTimeout(d.proxy(function(){this.vibrateTimer=null},this),100)}}}this[this.currentView]=I;this[E?"spanHours":"spanMinutes"].html(r(I));if(!s){this[E?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var y=d(this);y.toggleClass("active",I===+y.html())});return}if(L||(!E&&I%5)){this.g.insertBefore(this.hand,this.bearing);this.g.insertBefore(this.bg,this.fg);this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")}else{this.g.insertBefore(this.hand,this.bg);this.g.insertBefore(this.fg,this.bg);this.bg.setAttribute("class","clockpicker-canvas-bg")}var B=Math.sin(G)*C,A=-Math.cos(G)*C;this.hand.setAttribute("x2",B);this.hand.setAttribute("y2",A);this.bg.setAttribute("cx",B);this.bg.setAttribute("cy",A);this.fg.setAttribute("cx",B);this.fg.setAttribute("cy",A)};u.prototype.done=function(){this.hide();var y=this.input.prop("value"),z=r(this.hours)+":"+r(this.minutes);this.input.prop("value",z);if(z!==y){this.input.triggerHandler("change");if(!this.isInput){this.element.trigger("change")}}};u.prototype.remove=function(){this.element.removeData("clockpicker");this.input.off("focus.clockpicker click.clockpicker");this.addon.off("click.clockpicker");if(this.isShown){this.hide()}if(this.isAppended){p.off("resize.clockpicker"+this.id);this.popover.remove()}};d.fn.clockpicker=function(z){var y=Array.prototype.slice.call(arguments,1);return this.each(function(){var C=d(this),B=C.data("clockpicker");if(!B){var A=d.extend({},u.DEFAULTS,C.data(),typeof z=="object"&&z);C.data("clockpicker",new u(C,A))}else{if(typeof B[z]==="function"){B[z].apply(B,y)}}})}}());