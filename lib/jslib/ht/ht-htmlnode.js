!function(P){"use strict";var B="ht",A=P[B],t=function(){return document},v=function(){return t().body},o=function(G,K,s){G.style.setProperty(K,s,null)},Q=function(I){return t().createElement(I)},R=function(){return Q("div")},i=function(){var r=Q("canvas");return r},f=function(l,U){o(l,"-webkit-transform",U),o(l,"-ms-transform",U),o(l,"transform",U)},u=function(t,i){o(t,"-webkit-transform-origin",i),o(t,"-ms-transform-origin",i),o(t,"transform-origin",i)},K=function(r,H){r.appendChild(H)},C=function(H,O){H.removeChild(O)},M=P.parseInt,O=A.Default,c=O.getInternal(),y=Math.PI,I="white-space",S="visibility",e="left",Z="top",m="width",h="height",z="position",k="display",F="z-index",x="px",j="0 0",w="absolute",d="visible",q="hidden",Y="none",H="block",g="nowrap",p="rgba(0, 0, 0, 0.005)";O.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var G=A.graph.GraphView.prototype,V=G._42;G.adjustHtmlNodeIndex=!0,G._42=function(T,f){if(V.call(this,T,f),this.adjustHtmlNodeIndex)for(var p=this.getDataModel()._datas._as,u=p.length,h=1,m=0;u>m;m++){var S=p[m];if(S instanceof $){var d=this.getDataUI(S);o(d.$2f,F,h+""),o(d.$3f,F,h+1+""),h+=2}}};var X=A.HtmlNodeUI=function(c,e){var _=this;X.superClass.constructor.call(_,c,e);var v=_.$2f=R(),P=_.$3f=i();o(v,z,w),o(v,S,q),o(v,I,g),P.draggable=!1,o(P,z,w),o(P,k,Y),u(P,j),v.addEventListener("change",function(D){var O=D.target,A=O.bind||O.getAttribute("bind"),F=O.type&&"checkbox"===O.type?O.checked:O.value,Z=e.getContext();A&&Z&&(Z[A]=F,_.$4f=JSON.stringify(Z))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(y){v.addEventListener(y,this.$9f.bind(this))},_)};O.def(X,c.ui().NodeUI,{_visible:!0,$11f:function(){var C=this,M=C.$3f,x=C._data,J=x.getDraggerImageWidth(),y=x.getDraggerImageHeight(),K=x.getDraggerImage(),Y=c.initContext(M);Y.beginPath(),c.setCanvas(M,J,y),c.translateAndScale(Y,0,0,1),Y.clearRect(0,0,J,y),O.drawImage(Y,O.getImage(K),0,0,J,y),Y.restore()},_80o:function(D){X.superClass._80o.call(this,D);var g=this,n=g._data,A=n._padding,r=2*A,s=g.$2f,I=g.$3f,N=g.gv,O=N.getZoom(),$=N.getTranslateX(),B=N.getTranslateY(),j=N.getView(),i=g._83o,C=n._width,T=n._height,v=i.position,Q=i.rotation,_=(C-r)/n.$5f*O,V=(T-r)/n.$6f*O,L=g._html,c=n._html,U=n.getHtmlType();if("html"===U){var J=n.getContext()||{},t=g.$4f,G=n.$10f,u=JSON.stringify(J);L&&t&&L===c&&t===u||(g.$4f=u,g._html=c,s.innerHTML=G?G(J):c)}else if(null!=U){var W=n.getHtml();"ht"===U&&(W=W.getView()),L&&L===W||(g._html=W,s.innerHTML="",K(s,W))}if(!s.parentNode){var E=N.$1f;if(!E){var b=R();o(b,z,w),o(b,F,"0"),E=N.$1f=b;var a=N._canvas.nextSibling;a?j.insertBefore(b,a):K(j,b)}K(E,s),K(E,I)}if(n._scalable){var P=n.$5f,l=n.$6f;f(s,"rotate("+180*(Q/y)+"deg) scale("+_+","+V+")"),o(s,e,(v.x-P/O/2)*O+$+x),o(s,Z,(v.y-l/O/2)*O+B+x)}else{var nk=M(s.style.width),pi=M(s.style.height),Bo=M((C-r)*O),tc=M((T-r)*O),El="100%",nm=s.children[0];o(nm,m,El),o(nm,h,El),(nk!==Bo||pi!==tc)&&(o(s,m,Bo+x),o(s,h,tc+x),"ht"===U&&c.invalidate()),f(s,"rotate("+180*(Q/y)+"deg)"),o(s,e,(v.x-Bo/O/2)*O+$+x),o(s,Z,(v.y-tc/O/2)*O+B+x)}var sb=g.dragRect;N.isMovable(n)&&N.isSelected(n)&&sb?(D.save(),D.fillStyle=p,D.fillRect(sb.x,sb.y,sb.width,sb.height),D.restore(),o(I,e,sb.x*O+$+x),o(I,Z,sb.y*O+B+x),f(I,"scale("+O+","+O+")"),o(I,k,H),g.$11f()):o(I,k,Y),o(s,S,this._visible?d:q)},dispose:function(){var S=this.gv.$1f;S.removeChild(this.$2f),S.removeChild(this.$3f)},_84o:function(u){this._visible=u,o(this.$2f,S,u?d:q),o(this.$3f,k,u?H:Y)},_3O:function(){var I=this,P=I._data;X.superClass._3O.call(I);var U=P.getRect();I.dragRect={x:U.x+U.width+P._padding,y:U.y+10,width:P.getDraggerImageWidth(),height:P.getDraggerImageHeight()},I._68o(I.dragRect)},rectIntersects:function(d){var n=this._79o();return A.Default.intersection(n,d)?!0:void 0},$9f:function(Q){var k=this.gv,v=this._data;k.sm().contains(v)&&Q.stopPropagation()}});var $=A.HtmlNode=function(){$.superClass.constructor.call(this)};A.Default.def($,A.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:A.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(J){var v=this,C=v._html;v._html=J,"html"===v.getHtmlType()&&"Handlebars"in P&&(v.$10f=Handlebars.compile(J)),v.$13f(),v.fp("html",C,J)},setContext:function(K){var _=this,I=_._context;_._context=K,_.fp("context",I,K),_.$13f()},setScalable:function($){var N=this,I=N._scalable;N._scalable=$,N.fp("scalable",I,$),N.$13f()},getHtmlType:function(){var Z=this._html;return Z?"string"==typeof Z?"html":Z.getView?"ht":"dom":null},$13f:function(){var U=this,O=U._html,i=U.$10f;if(O){var y=R(),m=!1,d=U.getHtmlType();if(o(y,z,w),o(y,I,g),o(y,S,q),"html"===d?(y.innerHTML=i?i(U.getContext()||{}):O,m=!0):"ht"===d?(K(y,O.getView()),m=!0):"dom"===d&&(K(y,O),m=!0),m){var G=2*U._padding;K(v(),y),U.$5f=y.scrollWidth,U.$6f=y.scrollHeight,U._width=U.$5f+G,U._height=U.$6f+G,U._originWidth=U._width,U._originHeight=U._height,C(v(),y)}}},getUIClass:function(){return A.HtmlNodeUI}})}(this,Object);