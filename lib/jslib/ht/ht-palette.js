!function(S,t,z){"use strict";var W="px",C="0",_="innerHTML",V="className",l=ht.Default,E=ht.Color,q=ht.Node,J="position",Z="top",r="left",H=l.animate,Y=l.getInternal(),n="width",C="0",i="none",x="max-height",f="font",c="background",I="border-box",u="user-select",w="box-sizing",A="overflow",h=l.isTouchable,Y=l.getInternal(),d=E.titleIconBackground,T=l.scrollBarInteractiveSize,N=/msie 9/.test(S.navigator?S.navigator.userAgent.toLowerCase():""),U=null,R=function(){return document},e=function(C){return R().createElement(C)},m=function(){return e("div")},L=function(){var Y=m(),I=Y.style;return I.msTouchAction=i,I.cursor="default",h&&I.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",U),I.position="absolute",I.left=C,I.top=C,Y},O=function(){return e("canvas")},D=function(){return document.body},M=function(T,Q,l){T.style.setProperty(Q,l,U)},Q=function(C,z){C.style.removeProperty(z)},j=function(F,B,Y){l.def(ht.widget[F],B,Y)},v=function(z,W){z.appendChild(W)},K=function(A,h){A.removeChild(h)},b=function(a,T,c,i){a.addEventListener(T,c,!!i)};Y.addMethod(l,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:d,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:d}]},paletteTitleLabelColor:l.labelSelectColor,paletteTitleLabelFont:l.labelFont,paletteContentLabelFont:l.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:l.widgetTitleHeight,paletteTitleBackground:E.titleBackground,paletteTitleHoverBackground:E.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:z,paletteItemHoverBorderColor:E.highlight,paletteItemSelectBackground:E.highlight},!0);var g=".palette-item:hover{border: 1px solid "+l.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+l.paletteTitleHoverBackground+" !important}",P=document.createElement("style");h||(P.styleSheet?P.styleSheet.cssText=g:P.appendChild(R().createTextNode(g))),R().getElementsByTagName("head")[0].appendChild(P);var F=function(K){var i=this;i.$22h=K,i.addListeners()};l.def(F,t,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var t=this;t.$36h&&D().removeChild(t.$36h),t.$23h=t.$24h=t.$25h=t.$35h=t.$36h=U},handle_touchstart:function(R){for(var x,S=this,_=S.$22h,M=R.target,B=_.sm(),a=_.dm(),f="palette-header",e="palette-header-tool",E="palette-item",L=!1,n=!1,m=!1;M&&(M[V]||"").indexOf(f)<0&&(M[V]||"").indexOf(E)<0;)M=M.parentNode;if(M&&M[V].indexOf(e)>=0?L=!0:M&&M[V].indexOf(f)>=0?m=!0:M&&M[V].indexOf(E)>=0&&(n=!0),l.isLeftButton(R))if(S.$27h(R))S.$24h=l.getClientPoint(R),S.$25h=_.ty();else if(L){l.preventDefault(R),x=M.parentNode.$11h;var U=a.getDataById(x),d=U.s("tools")[M.toolIndex];d.action&&d.action.call(_)}else if(m){l.preventDefault(R),x=M.$11h;var U=a.getDataById(x);U.isExpanded()?U.setExpanded(!1):U.setExpanded(!0)}else if(n){x=M.$11h;var O=a.getDataById(x);B.ss(O),_.handleDragAndDrop&&(l.preventDefault(R),O.s("draggable")&&(_.handleDragAndDrop(R,"prepare"),S.$35h=0))}else l.preventDefault(R),S.$24h=l.getClientPoint(R),S.$25h=_.ty();else S.$26h(R)},handle_mousedown:function(O){this.handle_touchstart(O)},handle_mousewheel:function(P){this.handleScroll(P,P.wheelDelta/40,P.wheelDelta!==P.wheelDeltaX)},handle_DOMMouseScroll:function(U){this.handleScroll(U,-U.detail,1)},handleScroll:function(q,N,F){var D=this.$22h;l.preventDefault(q),F&&D._41o()&&D.ty(D.ty()+20*N)},handle_mouseup:function(M){this.handle_touchend(M)},handle_touchend:function(h){var u=this;u.$37h(h),u.$26h(h)},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(y){var E=this;E.$37h(y),E.$26h(y)},$37h:function(i){var q=this,u=q.$22h;2===q.$35h&&(q.$35h=3,u.handleDragAndDrop(i,"end"))},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(R){var b=this,_=b.$22h,y=b.$23h,d=b.$24h,p=b.$25h,m=l.getClientPoint(R),B=_._29I,L=b.$36h;if(1===b.$35h||2===b.$35h){if(b.$35h=2,_.handleDragAndDrop(R,"between"),h){var f=R.touches[0];R=f?f:R.changedTouches[0]}L.style.left=R.pageX-parseInt(L.width)/2+W,L.style.top=R.pageY-parseInt(L.height)/2+W}else"p"===y?_.ty(p+m.y-d.y):"v"===y&&_.ty(p+(d.y-m.y)/B.height*_._59I)},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(B){if(!l.isDragging()&&l.isLeftButton(B)){var R=this,K=R.$22h,E=R.$27h(B);if(R.$24h){if(!R.$23h){if(l.getDistance(l.getClientPoint(B),R.$24h)<2)return;R.$23h=E?"v":"p",l.startDragging(R)}}else if(E)K._43o();else if(0===R.$35h){if(R.$35h=1,K.handleDragAndDrop(B,"begin"),h){var M=B.touches[0];B=M?M:B.changedTouches[0]}var b=R.$36h=new Image,m=K.$10h[K.sm().ld().getId()].querySelector(".image-box"),w=parseInt(m.style.width),H=parseInt(m.style.height);b.draggable=!1,b.src=m.toDataURL(),b.width=w,b.height=H,b.style.position="absolute",b.style.left=B.pageX-w/2+W,b.style.top=B.pageY-H/2+W,D().appendChild(b),l.startDragging(R)}}},$27h:function(A){var I=this.$22h,f=I.getView(),S=f.getBoundingClientRect(),N=I._29I,m=A.clientX-S.left+f.scrollLeft;return I._41o()&&N.x+N.width-m<T}}),ht.widget.Palette=function(Z){var H=this,S=H._view=m();H.$9h={},H.$10h={},H.$4h={},H._29I={x:0,y:0,width:0,height:0},H._59I=0,H.dm(Z?Z:new ht.DataModel),S[V]="ht-widget-palette",H.$29h=new F(H),M(S,c,l.paletteContentBackground),M(S,A,"auto"),M(S,w,I),M(S,"-moz-"+w,I),M(S,"-webkit-"+u,i),M(S,"-moz-"+u,i),M(S,"-ms-"+u,i),M(S,u,i),M(S,"position","absolute"),M(S,"overflow","hidden"),v(S,H._79O=L()),b(S,"dragstart",function(Y){Y.dataTransfer.setData("Text","nodeid:"+Y.target.$11h),Y.dataTransfer.effectAllowed="all",H.$29h.$26h()})},j("Palette",t,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:l.autoHideScrollBar,_scrollBarSize:l.scrollBarSize,_scrollBarColor:l.scrollBarColor,getViewRect:function(){return this._29I},ty:function(v){return v?(this.setTranslateY(v),void 0):this.getTranslateY()},setTranslateY:function(v){if(this.$32h==U){var M=this,E=M.$33h(v),G=M.$30h;M.$30h=E,M.fp("translateY",G,E)}},getTranslateY:function(){return this.$30h},setLayout:function(F){var I,r,H=this,Z=H._layout;H._layout=F,"smallicons"===F?I=r=20:"iconsonly"===F?I=r=50:(I=70,r=50),H.setItemImageWidth(I),H.setItemImageHeight(r),H.setItemImagePadding(4),H.fp("layout",Z,F)},getDataAt:function(y){for(var q=y.target;q&&q.$11h==U;)q=q.parentNode;return q&&q.$11h!=U?this.getDataModel().getDataById(q.$11h):void 0},$20h:function(){var e=16;return h&&(e*=1.2),e},$19h:function(){return l.paletteTitleHeight},$18h:function(){var N=l.paletteSeparatorWidth,z=l.paletteTitleBackground,A=l.paletteSeparatorColor||l.brighter(z);return N+W+" solid "+A},$17h:function(L){M(L,"cursor","pointer"),M(L,"display","inline-block"),M(L,"margin-right",(h?8:4)+W),M(L,"vertical-align",Z)},$1h:function(z){var F=this,B=m(),j=m(),Q=e("span");B[V]="palette-header",M(B,J,"relative"),M(B,c,l.paletteTitleBackground),M(B,"color",l.paletteTitleLabelColor),M(B,Z,C),M(B,w,I),M(B,"-moz-"+w,I),M(B,"padding","0 5px 0 0"),M(B,"border-top",F.$18h()),M(B,n,"100%"),M(B,"cursor","pointer"),M(B,"white-space","nowrap"),M(B,A,"hidden"),M(B,f,l.paletteTitleLabelFont),M(B,"line-height",F.$19h()+W),B.$11h=z.getId();var U=O(),d=F.$19h(),P=F.$20h();F.$17h(U),Y.setCanvas(U,P,d),v(B,U);var p=z.s("tools");if(p)for(var y=0;y<p.length;y++){var s=O();F.$17h(s),Y.setCanvas(s,P,d),s[V]="palette-header-tool palette-header-tool"+z.getId()+"-"+y,s.style.position="absolute",s.style.right=(P+10)*y+"px",s.toolIndex=y,v(B,s)}return U[V]="palette-toggle-icon-"+z.getId(),j[V]="palette-content",M(j,"max-height",0+W),M(j,f,l.paletteContentLabelFont),M(j,A,"hidden"),j.$11h=z.getId(),F.$9h[z.getId()]=j,Q[_]=z.getName(),M(Q,f,l.paletteTitleLabelFont),v(B,U),v(B,Q),[B,j]},$2h:function(G){var K=this,o=K._layout,s=N&&G.s("draggable")?e("a"):m(),S=O(),b=m(),I=G.getName()||"",A=G.s("title")||G.getToolTip()||I,Q=K._itemMargin;S[V]="image-box";var w=K.getItemImageWidth(),$=K.getItemImageHeight();return Y.setCanvas(S,w,$),v(s,S),b[_]=I,b[V]="label-box","iconsonly"!==o&&v(s,b),s[V]="palette-item",M(s,"vertical-align",Z),M(s,"cursor","pointer"),M(s,"border-radius",5+W),M(s,"border","1px solid transparent"),M(s,"text-align","center"),M(s,"display","inline-block"),M(s,"margin-left",Q+W),M(s,"margin-top",Q+W),M(s,"color",l.paletteContentLabelColor),"smallicons"===o?(M(S,"vertical-align","middle"),M(s,"margin-left",2+W),M(s,"margin-top",2+W),M(s,"padding",2+W),M(s,"text-align",r),M(b,"display","inline-block"),M(b,"min-width",K.$21h+K._itemMargin+W)):"largeicons"===o&&(M(b,"max-width",w+W),M(b,"overflow","hidden")),s.$11h=G.getId(),A&&(s.title=A),G.s("draggable")&&!K.handleDragAndDrop&&(N?(s.href="#",M(s,"text-decoration",i)):s.draggable="true"),s},$16h:function(N,R,p,b){var H=Y.initContext(N);Y.translateAndScale(H,0,0,1),H.clearRect(0,0,p,p);var k=(p-b)/2;l.drawStretchImage(H,l.getImage(R),"fill",0,k,b,b),H.restore()},$15h:function(U){var u=this,J=U.getId(),f=u._view.querySelector(".palette-toggle-icon-"+J),k=U.isExpanded()?l.paletteCollapseIcon:l.paletteExpandIcon;if(f&&k){var r=u.$19h(),i=u.$20h();u.$16h(f,k,r,i)}},_drawToolsIcon:function(I){var f=this,z=I.s("tools");if(z)for(var N=0;N<z.length;N++){var R=f._view.querySelector(".palette-header-tool"+I.getId()+"-"+N),$=z[N].icon,T=f.$19h(),Y=f.$20h();f.$16h(R,$,T,Y)}},$14h:function(D){var M=this,o=D.getId(),I=M.$10h[o].querySelector(".image-box"),S=D.getImage(),P=D.s("image.stretch");if(I&&S){var E=Y.initContext(I),x=M.getItemImagePadding();x="smallicons"===M._layout?x/2:x;var G=M.getItemImageWidth()-2*x,N=M.getItemImageHeight()-2*x;Y.translateAndScale(E,0,0,1),E.clearRect(0,0,G,N),l.drawStretchImage(E,l.getImage(S),P,x,x,G,N),E.restore()}},validateImpl:function(){var y,G,a,D=this,u=D.$9h,I=D._layout,c=D.$10h,$=D.$4h,f=D._view,T=D.dm();if(D.$13h&&(delete D.$13h,$={},T.each(function(Y){$[Y.getId()]=Y})),"smallicons"===I)for(var J in $){var N=$[J];if(N instanceof q){var n=N.getName()||"",g=l.getTextSize(l.paletteContentLabelFont,n).width;D.$21h!=U&&D.$21h>g||(D.$21h=g)}}for(var J in $){a=$[J];var A,P;if(T.contains(a)){if(a instanceof ht.Group){var z,O=D.$1h(a),d=c[a.getId()];d&&(z=d.nextSibling,K(f,z),K(f,d)),G=T.getSiblings(a).indexOf(a);var F=f.children[2*G]||D._79O;f.insertBefore(O[0],F),f.insertBefore(z||O[1],F),c[a.getId()]=O[0],y=u[a.getId()]=z||O[1],P=a.$12h;var k=a.s("promptText");P||(a.$12h=e("div"),a.$12h[_]=k||"",P=a.$12h),0===a.getChildren().size()?y.contains(P)||v(y,P):y.contains(P)&&K(y,P)}else if(A=a.getParent()){var Q=D.$2h(a),R=c[a.getId()];y=u[A.getId()],R&&K(R.parentNode,R),G=T.getSiblings(a).indexOf(a);var Z=y.children[G];Z?y.insertBefore(Q,Z):v(y,Q),c[a.getId()]=Q,D.$14h(a)}}else{var s=c[a.getId()],M=s.parentNode;if(a instanceof ht.Group){var t=s.nextSibling;K(f,s),K(f,t),delete u[a.getId()]}else K(M,s),0===M.children.length&&(A=T.getDataById(M.$11h),P=A.$12h,P&&!M.contains(P)&&v(M,P));delete c[a.getId()]}}D.$4h={};var i=function(){var z=D._59I,G=0;D.$32h!=U&&(clearInterval(D.$32h),G=0,delete D.$32h),D.$32h=setInterval(function(){D.$31h(),z===D._59I?(G++,G>=2&&(clearInterval(D.$32h),delete D.$32h)):(G=0,z=D._59I)},30)};for(var X in u)if(y=u[X],a=T.getDataById(u[X].$11h),D.$15h(a),D._drawToolsIcon(a),a.isExpanded()){if(y.style.maxHeight===0+W){var B=y.scrollHeight+D._itemMargin+W;H(y).duration(200).set(x,B).set("padding-bottom",D._itemMargin+W).end(function(){return function(){i()}}(B))}else y.style.maxHeight=y.scrollHeight+W;y.style.paddingBottom=D._itemMargin+W}else y.style.maxHeight!==0+W&&H(y).duration(200).set(x,C).set("padding-bottom",C).end(function(){return function(){i()}}(y));D.$28h(),D.$31h()},$31h:function(){for(var T=this,H=T._view,v=0,l=H.children,J=0;J<l.length;J++){var i=l[J];i.className&&i.className.indexOf("palette-")>=0&&(v+=i.offsetHeight)}T._59I=v,T.$30h=T.$33h(T.ty());var r=T.ty();H.scrollTop=-r,T._29I={x:0,y:-r,width:H.clientWidth,height:H.clientHeight},M(T._79O,Z,-r+W),T._93I()},$33h:function(p){var J=this,o=J._29I.height-J._59I;return o>p&&(p=o),p>0?0:Math.round(p)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function($){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf($.property)<0&&this.redraw(),"translateY"===$.property&&(this.iv(),this._43o())},findDataByName:function(J){for(var e=this.dm().getDatas(),g=0;g<e.size();g++){var v=e.get(g);if(v.getName()===J)return v}},setDataModel:function(U){var T=this,t=T._dataModel,l=T._3o;t!==U&&(t&&(t.umm(T.$6h,T),t.umd(T.$8h,T),t.umh(T.$7h,T),l||t.sm().ums(T.$28h,T)),T._dataModel=U,U.mm(T.$6h,T),U.md(T.$8h,T),U.mh(T.$7h,T),l?l._21I(U):U.sm().ms(T.$28h,T),T.sm().setSelectionMode("single"),T.fp("dataModel",t,U))},$6h:function(T){var l=this,x=l._view,H=T.data,W=l.$4h;"add"===T.kind?W[H.getId()]=H:"remove"===T.kind?W[H.getId()]=H:"clear"===T.kind&&(l.$10h={},l.$9h={},l.$4h={},x[_]=""),l.iv()},$7h:function(d){var o=this,t=d.data;o.$4h[t.getId()]=t,o.iv()},$8h:function(Q){var i=this,h=Q.data,s=Q.property;"expanded"===s?i.iv():(i.$4h[h.getId()]=h,i.iv())},$28h:function(){var E,p=this,H=p.sm(),k="palette-item",K=H.ld();this.dm().each(function(e){E=p.$10h[e.getId()],E&&E[V].indexOf(k)>=0&&(e===K?M(E,c,l.paletteItemSelectBackground):Q(E,c))})}})}(this,Object);