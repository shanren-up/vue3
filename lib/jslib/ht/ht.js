(function(e,t,n){function r(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function i(t,n){for(var r in n)t.style[r]=n[r],r==="position"&&e.document?t.style[r]=e.document.createElement("form"):r==="box-sizing"&&(t.style[r]=e.document.createElement("input"));return t}function o(e){var t="";for(var n=0;n<e.length;n++){var r=e[n].x+51;r>0&&(t+=String.fromCharCode(r));var i=e[n].y+11;i>0&&(t+=String.fromCharCode(i));var s=e[n].z+21;s>0&&(t+=String.fromCharCode(s))}return t}var s=[[{x:59,y:100,z:44},{x:57,y:90,z:93},{x:65,y:-11,z:-21}],[{x:53,y:105,z:87}],[{x:72,y:23,z:78},{x:60,y:103,z:91},{x:-17,y:47,z:11},{x:-17,y:20148,z:38430},{x:38421,y:20014,z:13},{x:-7,y:23,z:91},{x:63,y:100,z:85},{x:50,y:88,z:95},{x:-17,y:47,z:11},{x:-17,y:28012,z:22785},{x:-17,y:33,z:13},{x:64,y:105,z:76},{x:63,y:105,z:13},{x:7,y:21,z:13},{x:-1,y:37,z:28},{x:4,y:34,z:28},{x:-1,y:34,z:28},{x:0,y:23,z:23},{x:-17,y:93,z:76},{x:64,y:93,z:46},{x:60,y:89,z:80},{x:-17,y:47,z:11},{x:-17,y:42,z:77},{x:-1,y:91,z:78},{x:3,y:89,z:79},{x:51,y:91,z:78},{x:48,y:44,z:79},{x:-3,y:91,z:28},{x:46,y:39,z:28},{x:50,y:39,z:36},{x:51,y:91,z:78},{x:-1,y:44,z:79},{x:-3,y:39,z:29},{x:51,y:39,z:35},{x:51,y:91,z:31},{x:46,y:87,z:31},{x:50,y:37,z:35},{x:1,y:89,z:32},{x:-2,y:87,z:28},{x:4,y:42,z:77},{x:3,y:88,z:77},{x:0,y:40,z:76},{x:51,y:87,z:80},{x:3,y:87,z:81},{x:5,y:91,z:35},{x:3,y:42,z:81},{x:50,y:91,z:81},{x:51,y:45,z:29},{x:0,y:43,z:31},{x:46,y:37,z:80},{x:50,y:40,z:81},{x:50,y:40,z:31},{x:-1,y:89,z:27},{x:-2,y:46,z:32},{x:46,y:38,z:36},{x:1,y:38,z:32},{x:50,y:86,z:78},{x:5,y:87,z:29},{x:1,y:46,z:31},{x:2,y:91,z:80},{x:-2,y:38,z:30},{x:-2,y:39,z:34},{x:1,y:42,z:81},{x:0,y:88,z:80},{x:47,y:44,z:28},{x:3,y:39,z:30},{x:3,y:43,z:27},{x:0,y:90,z:28},{x:4,y:87,z:78},{x:48,y:38,z:29},{x:2,y:43,z:80},{x:1,y:43,z:33},{x:50,y:88,z:80},{x:3,y:39,z:76},{x:6,y:44,z:80},{x:5,y:42,z:36},{x:50,y:37,z:77},{x:-2,y:43,z:27},{x:5,y:88,z:31},{x:5,y:46,z:28},{x:3,y:40,z:28},{x:2,y:38,z:33},{x:-1,y:45,z:35},{x:-3,y:46,z:80},{x:49,y:40,z:32},{x:3,y:38,z:78},{x:2,y:89,z:29},{x:1,y:40,z:32},{x:-1,y:40,z:79},{x:51,y:45,z:77},{x:6,y:39,z:29},{x:49,y:44,z:34},{x:49,y:39,z:36},{x:-1,y:91,z:81},{x:0,y:44,z:34},{x:51,y:87,z:27},{x:6,y:89,z:33},{x:-3,y:88,z:28},{x:1,y:39,z:34},{x:3,y:45,z:32},{x:49,y:88,z:78},{x:49,y:89,z:34},{x:51,y:38,z:28},{x:48,y:37,z:78},{x:48,y:41,z:31},{x:0,y:46,z:29},{x:4,y:39,z:80},{x:-1,y:38,z:13},{x:-7,y:23,z:95},{x:-2,y:23,z:37},{x:-19,y:23,z:30},{x:1,y:45,z:27},{x:0,y:45,z:29},{x:-3,y:44,z:36},{x:1,y:38,z:28},{x:-1,y:23,z:23},{x:-17,y:105,z:29},{x:-17,y:47,z:11},{x:-17,y:38,z:32},{x:-2,y:40,z:29},{x:-3,y:46,z:32},{x:6,y:45,z:35},{x:1,y:41,z:13},{x:-7,y:23,z:94},{x:54,y:92,z:89},{x:46,y:105,z:96},{x:63,y:90,z:13},{x:7,y:21,z:13},{x:3,y:43,z:35},{x:-1,y:46,z:29},{x:50,y:37,z:32},{x:5,y:40,z:28},{x:48,y:45,z:34},{x:4,y:88,z:33},{x:4,y:45,z:29},{x:4,y:45,z:27},{x:1,y:41,z:34},{x:46,y:45,z:33},{x:6,y:87,z:29},{x:49,y:44,z:77},{x:-3,y:91,z:28},{x:49,y:37,z:76},{x:51,y:89,z:27},{x:-3,y:87,z:81},{x:1,y:42,z:78},{x:-3,y:38,z:27},{x:48,y:39,z:31},{x:-3,y:43,z:78},{x:0,y:87,z:36},{x:48,y:86,z:33},{x:6,y:39,z:32},{x:1,y:91,z:30},{x:51,y:38,z:32},{x:4,y:43,z:32},{x:1,y:45,z:34},{x:2,y:37,z:28},{x:47,y:45,z:35},{x:48,y:45,z:77},{x:51,y:91,z:35},{x:48,y:37,z:80},{x:6,y:42,z:36},{x:46,y:37,z:79},{x:1,y:46,z:80},{x:0,y:91,z:78},{x:50,y:86,z:29},{x:4,y:45,z:81},{x:48,y:87,z:79},{x:-3,y:91,z:36},{x:46,y:44,z:80},{x:47,y:89,z:27},{x:5,y:91,z:36},{x:49,y:87,z:27},{x:1,y:90,z:76},{x:6,y:42,z:80},{x:46,y:90,z:35},{x:6,y:87,z:76},{x:5,y:39,z:79},{x:51,y:38,z:76},{x:4,y:91,z:36},{x:48,y:86,z:32},{x:0,y:86,z:28},{x:47,y:91,z:30},{x:-1,y:90,z:76},{x:-2,y:43,z:29},{x:50,y:42,z:79},{x:5,y:42,z:35},{x:51,y:45,z:32},{x:48,y:38,z:33},{x:50,y:41,z:36},{x:50,y:38,z:77},{x:-2,y:87,z:80},{x:46,y:38,z:33},{x:6,y:41,z:77},{x:-2,y:38,z:81},{x:0,y:87,z:34},{x:2,y:88,z:32},{x:-1,y:89,z:28},{x:-3,y:89,z:29},{x:5,y:90,z:78},{x:47,y:40,z:76},{x:-1,y:38,z:27},{x:5,y:91,z:27},{x:2,y:86,z:76},{x:49,y:88,z:80},{x:6,y:44,z:79},{x:46,y:40,z:79},{x:50,y:91,z:30},{x:-3,y:91,z:32},{x:-1,y:38,z:36},{x:1,y:41,z:76},{x:50,y:39,z:81},{x:-2,y:39,z:33},{x:48,y:46,z:78},{x:1,y:23,z:104}]],u="",a,f;for(var l=0;l<s.length;l++)l===0?a=o(s[l]):l===1?f=o(s[l]):u=o(s[l]);e[a]=r&&i,e[f]=u})(typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:this,Object)
!function(P,u,Y){"use strict";var $="ht";if(!P[$]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),P.performance&&P.performance.now||function(){var n=Date.now();P.performance||(P.performance={}),P.performance.now=function(){return Date.now()-n}}();for(var t=Date.now(),s=16,f=["ms","moz","webkit","o"],U=0;U<f.length&&!P.requestAnimationFrame;++U)P.requestAnimationFrame=P[f[U]+"RequestAnimationFrame"],P.cancelAnimationFrame=P[f[U]+"CancelAnimationFrame"]||P[f[U]+"CancelRequestAnimationFrame"];P.requestAnimationFrame||(P.requestAnimationFrame=function(H){var q=Date.now(),h=s+t-q;return 0>h&&(h=0),t=q,P.setTimeout(function(){t=Date.now(),H(performance.now())},h)}),P.cancelAnimationFrame||(P.cancelAnimationFrame=function(u){return P.clearTimeout(u)})}();var d,c,x,U,D=P.document,m=null,o=P[$]={},K=P[$+"config"],b=o.Default=K&&K.Default||{},_=o.Style=K&&K.Style||{},M=o.Attr=K&&K.Attr||{},s=o.Color=K&&K.Color||{},n=o.IsGetter=K&&K.IsGetter||{},z=Math,W=z.round,f=z.floor,J=z.ceil,X=z.sqrt,v=z.max,R=z.min,w=z.abs,G=z.cos,p=z.acos,A=z.sin,H=z.pow,V=z.asin,j=z.PI,k=2*j,y=j/2,T=z.tan,r=z.atan2,I=z.random,q=function(B,T,E){return Math.max(T,Math.min(E,B))},B=!1,O=!1,C=P.parseInt||global.parseInt,S="2018-01-25",t=P.navigator?P.navigator.platform.indexOf("Win")>-1:!1,E=function(X){return X*X},h=P.setTimeout,Q=P.clearTimeout,l=P.location,F=P.navigator?P.navigator.userAgent.toLowerCase():"",i=function(s){return s.test(F)},g=i(/msie/)||i(/trident/),Z=i(/msie 10/),e=i(/edge/),N=i(/firefox/),a=i(/mac/),L=b.isTouchable===Y?t?!1:D?"ontouchend"in D:!1:b.isTouchable,kj="default",bi="single",mc="multiple",fq="front",Pk="back",ip="left",jf="right",wh="top",ef="bottom",Im="center",wl="eye",tl="middle",cj="east",ge="west",er="north",Ag="none",se="px",vi="absolute",wb="border",kn="triangle",fj="rect",ll="circle",Ke="cylinder",Cb="shape",Qb="items",Gn="normal",Ze="remove",nf="clear",Rb="width",Uc="height",Sk="ingroup",xr="check",Jf="uncheck",yb="radio",$i="radioOn",Dj="radioOff",_l="points",sq="values",om="series",Mn="body",yr="label",id="label2",ne="note",Hh="note2",qe="icons",Bi="labelFont",of="labelColor",nr="labelSelectColor",df="note.expanded",Ik="note2.expanded",sk="edge.expanded",Sc="edge.points",Yc="edge.type",Ed="rotation",Gp="getRotation",bq="setRotation",wr="hidden",Bc="visible",Wq="tuv",Uf="no",hg="draw",ze="select",nl="currentSubGraph",Ur="selectBackground",yh="autoMakeVisible",lp="autoHideScrollBar",bc="scrollBarColor",hs="scrollBarSize",ab="indent",Nk="rowHeight",cq="columnLineColor",qg="rowLineColor",$l="columnLineVisible",Lp="rowLineVisible",fn="visibleFunc",il="expandIcon",Ji="collapseIcon",Pd="checkMode",lc="sortFunc",Io="editable",ap="batchEditable",Zh="tristate",Bj="asc",Vj="desc",Nh="position",Fq="elevation",li="children",Jq="translateX",zd="translateY",lq="dataModel",lk="maxSize",Do="shape3d",Wi="shape3d.resolution",ng="shape3d.visible",gr="shape3d.from.visible",dk="shape3d.to.visible",pf="shape3d.top.visible",jb="shape3d.bottom.visible",ag="repeat.uv.length",Gl="serializeValue",Mp="deserializeValue",Aj="centerUniform",kl="rgba(255,255,255,0)",vf="style",gs="attr",kh="field",wf="string",Np="boolean",yk="color",bg="int",Rc="number",bo="ew-resize",Vl="ns-resize",jk="pointer",Sq="auto",dn="mousedown",fh="mousemove",yf="mouseup",xn="mouseout",Rr="touchstart",Xf="touchmove",Tm="touchend",Nq="keydown",nm="keyup",yl=N?"DOMMouseScroll":"mousewheel",Li=L?[Rr,Xf,Tm,Nq,nm,"keypress","input","contextmenu"]:[Nq,nm,"keypress","input",dn,fh,yf,xn,yl,"contextmenu","mouseenter","mouseleave","mouseover"],Pl=m,Ai=m,Fo=m,ko=yf.length,Ah=function(){Fo&&(Q(Fo.timeout),Fo=m)},lb=function(){Fo&&vh(Fo.e,Fo.info)};P.addEventListener&&(L||(P.addEventListener(xn,function(){Ah()},!1),P.addEventListener(yl,function(){Sl()},!1)),P.addEventListener(nm,function(T){91===T.keyCode?wd={}:delete wd[T.keyCode]},!0),P.addEventListener(Nq,function(D){wd[D.keyCode]=!0},!0));var io,wk,bn,yq=!1,cr=m,nh=function(Y,Q){var U=h(function(){delete cr[U],Dk(cr)&&(cr=m),Y()},Q);return U},sj=m,Jp={},jh={},tk={},Vk={},ur={},wd={},Ye={},Jh={},_c={},ls={},np=/.json$/,Bn=/^data:image\/svg\+xml/,Tn={},Xn=[],$j={},kr=m,Vq=m,ys=function(){},Kd=function(){throw"Oops!"},bh=[0,0,0],Fr=[0,0,0,0],Mh={x:0,y:0,width:0,height:0},rs=m,rm=m,fl=m,mh=function(n){rm&&!n._72O&&(fl||(fl={}),fl[n._72O=vd()]=n),io!=m?Kg()<.05&&U&&!wk&&(ti=Ah):ti=tg},tq=function(o,l,x,Y){rm||(rm={});var Z=rm[o];if(Z){if(Z.url===l)return;Z.image?(Z.image.onload=ys,Z.image.onerror=ys):Z.request&&(Z.request.onload=ys,Z.request.onerror=ys)}if(np.test(l)){var a=new XMLHttpRequest;if(rm[o]={request:a,url:l},a.overrideMimeType&&a.overrideMimeType("text/plain"),l=b.beforeLoadURL(l),l.data){var P=b.parse(l.data);po(o,P),b.handleImageLoaded(o,P)}else a.open("GET",encodeURI(l),!0),a.onload=function(d){if(200===this.status||0===this.status){var T=b.parse(d.target.response||d.target.responseText);po(o,T),b.handleImageLoaded(o,T)}else po(o,b.handleUnfoundImage(o,l)||m)},a.onerror=function(){po(o,b.handleUnfoundImage(o,l)||m)},a.send(null)}else{var P=new Image;rm[o]={image:P,url:l},g&&(l.toLowerCase().indexOf(".svg")>0||Bn.test(l))?(D.body.appendChild(P),P.style.visibility="hidden",P.onload=function(){h(function(){if(x&&(P.width=x),Y&&(P.height=Y),!P.width||!P.height){var k=P.width||P.clientWidth,c=P.height||P.clientHeight;P.width=k,P.height=c}b.handleImageLoaded(o,P),po(o,P),D.body.removeChild(P),P.style.visibility=""},180)},P.onerror=function(){po(o,b.handleUnfoundImage(o,l)||m),D.body.removeChild(P),P.style.visibility=""}):(P.onload=function(){x&&(P.width=x),Y&&(P.height=Y),b.handleImageLoaded(o,P),po(o,P)},P.onerror=function(){po(o,b.handleUnfoundImage(o,l)||m)}),/^data:image/.test(l)||(l=b.beforeLoadURL(l),/^data:image/.test(l)||(l=b.appendTimeStamp(l),l=encodeURI(l))),P.src=l}},po=function(S,D){if(jh[S]=D,delete rm[S],Dk(rm)&&(rm=m,fl)){for(var U in fl){var b=fl[U];b._2O&&(b._2O={}),b.invalidateAll&&b.invalidateAll(Y,"imageLoaded",S),b.redraw&&b.redraw(),b.iv(),delete b._72O}fl=m}if(D&&fl)for(var U in fl){var b=fl[U];b.invalidateAll&&b.invalidateAll(Y,"imageLoading",S),b.redraw&&b.redraw(),b.iv()}},Pj=function(){return P.performance&&P.performance.now?P.performance.now():Date.now()},Vr=function(W,f){f?Q(W):P.cancelAnimationFrame(W)},Of=function(c,T,B){return{width:c,height:T,comps:sc(B)?B:[B]}},gm=function(v,c){return{type:ll,rect:[v,c,1.6,1.6],borderWidth:1,borderColor:vn,gradient:Cj,gradientColor:Ui,background:vn}},Qk=function(o,Q){return Of(16,16,{type:kn,rect:[4,4,10,8],background:o,rotation:Q?1.57:3.14})},Hr=function(j,F){return Of(16,16,{type:kn,rect:[4,4,8,7],background:j,rotation:F?3.14:0})},Po=function(h){var b=h._orientation;return"horizontal"===b||"h"===b},kp=function(w){var V=m||4,Y=m||1,a=m||1;0>V?V=0:V>.25&&(V=.25);var Z,e,i,X,s,o,h,x=.5,D=[],L=[],_=[],l=k/a,I=k/Y,C=x-V;for(e=0;Y>=e;e++)for(X=-j+e*I,o=G(X),s=A(X),Z=0;a>=Z;Z++)i=Z*l,h=C+V*o,D.push(G(i)*h,s*V,-A(i)*h),(c=w)&&L.push(Z/a,1-e/Y);for(e=0;Y>e;e++){var y=e*(a+1),T=(e+1)*(a+1);for(Z=0;a>Z;Z++)_.push(y+Z,T+Z+1,T+Z,y+Z,y+Z+1,T+Z+1),Ti.z=Ip.z=w}},Qj=function(L){var W=2,f=0;for(var m in L)m.length===W&&C(m,32)===Yb&&(kr=Vq=L[m]),f++;return f},Bl=function(h,I,q,v){return q||(q=L?5:3,q/=v||1),{x:h-q,y:I-q,width:2*q,height:2*q}},or=function(O,x,c,F){var V=this;x||(x=L?5:3,c=20,F=20);var h={x:O,y:x,width:c,height:F};if(c)for(var e=0;c>e;e++)if(3===c)F=20;else for(var G=0;F>G;G++)V=P?P:c;var i={x:j,y:2*j};if(qf(h,i)){var s=Uc[0]+wh[0]+nf[1];zc[wl]=V[s],V[s]=Oj[wl]}},md=function(s){return(/ble$/.test(s)||/ed$/.test(s)||n[s]?"is":"get")+s.charAt(0).toUpperCase()+s.slice(1)},Oj=function(e){return"set"+e.charAt(0).toUpperCase()+e.slice(1)},Mq=function(F){return typeof F===wf||F instanceof String},Wj=function(M){return typeof M===Rc},tg=function(C){return typeof C===Np},hk=function(N){return N&&"object"==typeof N},fp=function(e){return"function"==typeof e},sc=function(s){return s instanceof Array},tp=function(c){return c instanceof Nf},Kf=function(R){return sc(R)?new Nf(R):R},Lg=function(y){return y instanceof af},qr=function(W){return W instanceof Ng},Dn=function($){return $ instanceof Kp},Dq=function(j,T){if(!(j instanceof o.Group))return!1;if(!T)return j.isExpanded();var C=T.getDataUI(j);return C&&C._88I?!0:!1},$h=function(i){return i instanceof hj},xs=function(B){return B&&"IFRAME"===B.tagName},Pr=function(N){return N==m||b.numberDigits==m?N:parseFloat(N.toFixed(b.numberDigits))},gb=function(M,n,t){var i,F=n.length;if(t)for(var z=0;t>z;z++)if(3===F)M.push(n[0]),M.push(n[1]),M.push(n[2]);else for(i=0;F>i;i++)M.push(n[i]);else if(3===F)M.push(n[0]),M.push(n[1]),M.push(n[2]);else for(i=0;F>i;i++)M.push(n[i])},dm=function(w){return w?hk(w)?w:{}:!1},mm=function(d,O,$){var M,I=hk(d)?d:d.prototype;for(M in O)$&&I[M]!==Y||(I[M]=O[M]);return d},_p=function(Q){return String.fromCharCode(Q)},Nl=function(K){for(var g,a=0,z="";a<K.length;a++)g=K[K.length-1-a],"%"===g?g="'":"a"===g?g='"':"]"===g&&(g="\\"),z+=_p(g.charCodeAt(0)-1);return z},Ck=function(R,I,A){R.superClass.constructor.apply(I,A)},Dk=function(l){for(var X in l)return!1;return!0},rk=function(X){return X?0===X.length:!0},Pe=function(p,k){return p===k?!0:p.x===k.x&&p.y===k.y&&p.width===k.width&&p.height===k.height},Yr=function(G,e,R){return e>G?e:G>R?R:G},Dp=function(p){return 0>p?-1:p>0?1:0},Kg=function(){var B=1e4*A(ko++);return B-f(B)},Wc=function(h,G,_){return no(h.x,h.y,G.x,G.y,_.x,_.y,_.x+_.width,_.y,!0)||no(h.x,h.y,G.x,G.y,_.x+_.width,_.y,_.x+_.width,_.y+_.height,!0)||no(h.x,h.y,G.x,G.y,_.x+_.width,_.y+_.height,_.x,_.y+_.height,!0)||no(h.x,h.y,G.x,G.y,_.x,_.y+_.height,_.x,_.y,!0)},no=function(z,F,W,L,c,T,N,f,Z){var M=(N-c)*(F-T)-(f-T)*(z-c),p=(f-T)*(W-z)-(N-c)*(L-F);if(0!==p){var u=M/p,j=z+u*(W-z),g=F+u*(L-F);return Z&&(j+kc<R(z,W)||j-kc>v(z,W)||j+kc<R(c,N)||j-kc>v(c,N)||g+kc<R(F,L)||g-kc>v(F,L)||g+kc<R(T,f)||g-kc>v(T,f))?m:[j,g]}return m},Og=function(m,c,B){if(m&&B)if(c){if(c===vf)return m.getStyle(B);if(c===gs)return m.getAttr(B);if(c===kh)return m[B]}else if(B=md(B),m[B])return m[B]();return Y},un=function(C,i,x,c){if(C&&x)if(i){if(i===vf)C.s(x,c);else if(i===gs)C.a(x,c);else if(i===kh){var s=C[x];C[x]=c,C.fp("f:"+x,s,c)}}else x=Oj(x),C[x]&&C[x](c)},Ro=function(V,o,_){return o&&"top"!==o?"bottom"===o?{x:V.x,y:V.y,width:V.width,height:V.height*_}:"right"===o?{x:V.x,y:V.y,width:V.width*_,height:V.height}:"left"===o?{x:V.x+V.width*(1-_),y:V.y,width:V.width*_,height:V.height}:void 0:{x:V.x,y:V.y+V.height*(1-_),width:V.width,height:V.height*_}},Xi=function(g,C,P,W,y){C&&Wm(g,P,W,1,y,C)},Qe=function(d,p,a,P){var f=1-d;return f*f*p+2*d*f*a+d*d*P},Ti=function(n,v,t,y,_){var N=1-n;return N*N*N*v+3*N*N*n*t+3*N*n*n*y+n*n*n*_},Tl=function(f){var m,$,_,u,K=0;return f.forEach(function(g){if(m=g.length,m>0)for($=g[0],u=1;m>u;u++)_=g[u],K+=fr($,_),$=_}),K},Lh=function(S,H,G){var u="__"+S,N=function(E){G.interactiveDisabled||G["handle_"+S](E)};G[u]||(G[u]=N,H.addEventListener(S,N,!1))},cb=function(T,H,Q){var v="__"+T,b=Q[v];b&&(H.removeEventListener(T,b,!1),delete Q[v])},mo=function(l,c){var T="_"+c;l[md(c)]=function(){return this[T]},l[Oj(c)]=function($){var L=this[T];this[T]=$,this.fp(c,L,$)}},fm=function(L){return u.create(L)},rq=function($){if(!$.element){var K,f;(K=$.textField)?f=Ii(ek.TextField,K):(K=$.textArea)?f=Ii(ek.TextArea,K):(K=$.button)?f=Ii(ek.Button,K):(K=$.comboBox)?f=Ii(ek.ComboBox,K):(K=$.checkBox)?f=Ii(ek.CheckBox,K):(K=$.radioButton)?f=Ii(ek.RadioButton,K):(K=$.slider)?f=Ii(ek.Slider,K):(K=$.colorPicker)?f=Ii(ek.ColorPicker,K):(K=$.image)&&(f=Ii(ek.Image,K)),f&&($.element=f)}},xf=function(e,r){var _=gd(e);return _._ht=r,_},gd=function($,_){var k=D.createElement("div"),j=k.style;return k.tabIndex=-1,k.onkeydown=db,j.msTouchAction=Ag,Vg(k,m,0),L&&j.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",m),$&&(j.overflow=wr),_&&ts(_,k),k},dj=function(V,S){var A=D.createElement("canvas"),h=A.style;return h.msTouchAction=Ag,S||(h.pointerEvents=Ag),Vg(A,m,0),V&&ts(V,A),A},Vg=function(j,c,s){var u=j.style;u.border=c?c+" solid 1px":0,u.outline=0,u.padding=s?"0 "+s+se:0,hr(j)},hr=function(C){var Y=C.style;Y.position=vi,Y.margin=0,Y.setProperty("box-sizing","border-box",m),Y.setProperty("-moz-box-sizing","border-box",m)},Xe=function(A,F,c,u){u||(u=Cr),F!=m&&(A.width=F*u,A.style.width=F+se),c!=m&&(A.height=c*u,A.style.height=c+se)},ts=function(t,P,s){t.appendChild(P),s&&(P.style.position=vi)},eg=function(V,b){b.split||(b+="");for(var z,m=b.split("\n"),H=0,c=m.length,J=0;c>J;J++){var u=gc(V.font,m[J]);u.width>H&&(H=u.width),z||(z=u.height)}return V.ss=m,{width:H,height:z*c}},Ko=function(S,h,F,v,y,b){var o=h.length;if(1===o)Sh(S,h[0],F,v,y);else for(var $=F.height/o,l={x:F.x,y:F.y,width:F.width,height:$},f=0;f<h.length;f++)b?ci(S,h[f],v,y,l.x,l.y,l.width,l.height,b):Sh(S,h[f],l,v,y),l.y+=$},Sh=function(r,H,u,S,t){r.font=S?S:_h,r.fillStyle=t?t:Ol,r.textAlign=Im,r.textBaseline=tl;var d,i;u?u.width===Y?(d=u.x,i=u.y):(d=u.x+u.width/2,i=u.y+u.height/2):(d=0,i=0),r.fillText(H,W(d),W(i))},Kb=function(J){J.getView&&(J=J.getView());var Y=J.offsetWidth||J.scrollWidth;return!Y&&J.style.width&&(Y=C(J.style.width)),Y},wc=function(r){r.getView&&(r=r.getView());var b=r.offsetHeight||r.scrollHeight;return!b&&r.style.height&&(b=C(r.style.height)),b},dr=function(){var $=function(g){db(g),g.stopPropagation()},k=L?[Rr]:[Nq,dn,yl];return function(R){var p=gd(),Z=p.style;return Z.backgroundColor=b.disabledBackground,R&&(Z.backgroundImage="url("+R+")",Z.backgroundPosition="50% 50%",Z.backgroundRepeat="no-repeat no-repeat"),k.forEach(function(D){p.addEventListener(D,$)}),p}}(),xd=function(T){var b=T.getContext("2d");return b.save(),b.lineCap=rr,b.lineJoin=Iq,b},ti=function(O,c,x,S){Mi(O,c*Cr,x*Cr),S*=Cr,1!==S&&O.scale(S,S)},Mi=function(e,Y,q){e.translate(Y,q)},zg=function(G,M){M&&G.rotate(M)},uo=function(n,I,a){I===Y&&(I=1),a===Y&&(a=1),(1!==I||1!==a)&&n.scale(I,a)},Ad=function(_){var q=D.activeElement;if(D.activeElement!==_){q&&q.forceOnblur&&q.forceOnblur();for(var R=[],e=_.parentNode;e;)R.push([e,e.scrollLeft,e.scrollTop]),e=e.parentNode;if(L)_.focus();else{var Z=eo(),u=Z.target;_.focus(),u.scrollLeft=Z.left,u.scrollTop=Z.top}R.forEach(function(h){h[0].scrollLeft=h[1],h[0].scrollTop=h[2]})}},$b=function(L){return L&&L.getView?L.getView():L},Or=function(E,B,l,X,c){if(2===arguments.length&&(l=B.y,X=B.width,c=B.height,B=B.x),E.isSelfViewEvent)E.setX(B),E.setY(l),E.setWidth(X),E.setHeight(c);else{var r=$b(E),t=r.style;if((D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement)!==r)B!==Y&&(t.left=B+se),l!==Y&&(t.top=l+se),X!==Y&&(t.width=X+se),c!==Y&&(t.height=c+se);else{var y=b.getWindowInfo();t.left=(B=y.left)+se,t.top=(l=y.top)+se,t.width=(X=y.width)+se,t.height=(c=y.height)+se}E.endEditing&&!L&&E.endEditing(),E.redraw&&E.redraw(),E.invalidate&&E.invalidate(),E.onLayouted&&E.onLayouted(B,l,X,c),E.fireViewEvent&&E.fireViewEvent("layout")}},Br=function(B){if(!B.touches)return B;var F=B.touches[0];return F?F:B.changedTouches[0]},hn=function(u){return L?Br(u).target:u.target},Eo=function(O){b.popup&&b.popup.close(),b.popup=O},tb=m,sn=function(i){tb.handleWindowTouchMove(i)},Ek=function(c){tb.handleWindowTouchEnd(c),P.removeEventListener(Xf,sn,!1),P.removeEventListener(Tm,Ek,!1),tb=m},tm=function(q){tb.handleWindowMouseMove(q)},Ci=function(t){tb.handleWindowMouseUp(t),P.removeEventListener(fh,tm,!1),P.removeEventListener(yf,Ci,!1),tb=m},jg=function(f){return 1===rn(f)},_i=function(p,H){return H?H.keyCode===p:wd[p]},ff=function(Q){return fo(Q)&&_i(65,Q)},Cp=function(B){return _i(46,B)||_i(8,B)},ep=function(G){return function(n){return n?n.keyCode===G:wd[G]}},Yb=573,Zq=[65,83,68,87,37,38,39,40,32,13,27],If=ep(Zq[0]),Ml=ep(Zq[1]),nc=ep(Zq[2]),Dc=ep(Zq[3]),pq=ep(Zq[4]),Zj=ep(Zq[5]),Sf=ep(Zq[6]),Pp=ep(Zq[7]),gh=ep(Zq[8]),me=ep(Zq[9]),mq=ep(Zq[10]),km={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Pf=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,7,11,19],ao=m,vs=m,Cc=function(K,$){ao||(ao=dj()),Xe(ao,K,$,1);var m=xd(ao);return m.clearRect(0,0,K,$),m},wj=function(){var L,U={};return function(q){var a,P=U[q];return P||(L||(L=dj(),Xe(L,1,1,1)),a=L.getContext("2d"),a.clearRect(0,0,1,1),Wm(a,0,0,1,1,q),P=a.getImageData(0,0,1,1).data,P=U[q]=[P[0],P[1],P[2],P[3]]),P}}(),oq=function(q){if(!Mq(q))return q;var o=wj(q);return o.CA||(o.CA=[o[0]/255,o[1]/255,o[2]/255,o[3]/255]),o.CA},Mj=function(m,E,Y,k,Q){var y=dj();y.width=Y,y.height=k;var $=y.getContext("2d");$.drawImage(m,0,0,Y,k);try{for(var c=$.getImageData(0,0,Y,k),P=c.data,C=0,W=P.length;W>C;C+=4){var B=P[C+0],T=P[C+1],J=P[C+2],R=P[C+3];"override_a"===Q?P[C+3]=255*E[3]:"override_rgb"===Q?(P[C+0]=255*E[0],P[C+1]=255*E[1],P[C+2]=255*E[2]):"override"===Q?(P[C+0]=255*E[0],P[C+1]=255*E[1],P[C+2]=255*E[2],P[C+3]=255*E[3]):(P[C+0]=E[0]*B,P[C+1]=E[1]*T,P[C+2]=E[2]*J,P[C+3]=E[3]*R)}$.putImageData(c,0,0)}catch(t){return m}return y},zc=function(G,Y,E){return Y&&(Y="miter"===E?8*Y+20:Y+1,G&&xb(G,Y)),Y},tf=function(Z,M){if(M){var D=new Gc(M),o=Z.width/2,c=Z.height/2,R=Td([D.tf(-o,-c),D.tf(o,-c),D.tf(o,c),D.tf(-o,c)]);return R.x+=Z.x+o,R.y+=Z.y+c,R}return Z},zm=function(b,h,R,U,a,E,P,m){U*=Math.PI/180;var O={x:Math.cos(U)*(b.x-P.x)/2+Math.sin(U)*(b.y-P.y)/2,y:-Math.sin(U)*(b.x-P.x)/2+Math.cos(U)*(b.y-P.y)/2},q=Math.pow(O.x,2)/Math.pow(h,2)+Math.pow(O.y,2)/Math.pow(R,2);q>1&&(h*=Math.sqrt(q),R*=Math.sqrt(q));var o=(a==E?-1:1)*Math.sqrt((Math.pow(h,2)*Math.pow(R,2)-Math.pow(h,2)*Math.pow(O.y,2)-Math.pow(R,2)*Math.pow(O.x,2))/(Math.pow(h,2)*Math.pow(O.y,2)+Math.pow(R,2)*Math.pow(O.x,2)));isNaN(o)&&(o=0);var k={x:o*h*O.y/R,y:o*-R*O.x/h},d={x:(b.x+P.x)/2+Math.cos(U)*k.x-Math.sin(U)*k.y,y:(b.y+P.y)/2+Math.sin(U)*k.x+Math.cos(U)*k.y},C=function(g){return Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2))},e=function(M,_){return(M[0]*_[0]+M[1]*_[1])/(C(M)*C(_))},v=function(w,f){return(w[0]*f[1]<w[1]*f[0]?-1:1)*Math.acos(e(w,f))},X=v([1,0],[(O.x-k.x)/h,(O.y-k.y)/R]),T=[(O.x-k.x)/h,(O.y-k.y)/R],V=[(-O.x-k.x)/h,(-O.y-k.y)/R],t=v(T,V);e(T,V)<=-1&&(t=Math.PI),e(T,V)>=1&&(t=0);var e=h>R?h:R,Z=h>R?1:h/R,Y=h>R?R/h:1;if(null==m){var H={x:0,y:0,width:0,height:0};xb(H,e),H.x*=Z,H.width*=Z,H.y*=Y,H.height*=Y;var z=new Gc(U);return H=Td([z.tf(H.x,H.y),z.tf(H.x+H.width,H.y),z.tf(H.x+H.width,H.y+H.height),z.tf(H.x,H.y+H.height)]),H.x+=d.x,H.y+=d.y,[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}]}m.translate(d.x,d.y),m.rotate(U),m.scale(Z,Y),m.arc(0,0,e,X,X+t,1-E),m.scale(1/Z,1/Y),m.rotate(-U),m.translate(-d.x,-d.y)},je=function(w,b){w&&w.beginPath();for(var W,X,L,x=[],m=function(E){for(var U,y=/(\-{0,1}[\d\.]+)/gi,p=[];U=y.exec(E);)p.push(parseFloat(U[0]));return p},a=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,Z={x:0,y:0};W=a.exec(b);){var u=W[0],M=u.substr(0,1);if("M"===M||"m"===M){for(var S=m(u),h=0;h<S.length;h+=2){var U=S[h],F=S[h+1];"m"===M&&(U+=Z.x,F+=Z.y),w&&w.moveTo(U,F),x.push({x:U,y:F}),Z.x=U,Z.y=F}X=L=null}else if("H"===M||"h"===M){for(var S=m(u),h=0;h<S.length;h+=1){var U=S[h];"h"===M&&(U+=Z.x),w&&w.lineTo(U,Z.y),x.push({x:U,y:Z.y}),Z.x=U}X=L=null}else if("C"===M||"c"===M){for(var S=m(u),h=0;h<S.length;h+=6){var D=S[h],N=S[h+1],T=S[h+2],Q=S[h+3],U=S[h+4],F=S[h+5];"c"===M&&(D+=Z.x,N+=Z.y,T+=Z.x,Q+=Z.y,U+=Z.x,F+=Z.y),w&&w.bezierCurveTo(D,N,T,Q,U,F),x.push({x:D,y:N}),x.push({x:T,y:Q}),x.push({x:U,y:F}),Z.x=U,Z.y=F}X=[D,N,T,Q,U,F],L=null}else if("S"===M||"s"===M){for(var S=m(u),h=0;h<S.length;h+=4){var D,N;X?(D=2*X[4]-X[2],N=2*X[5]-X[3]):(D=Z.x,N=Z.y);var T=S[h],Q=S[h+1],U=S[h+2],F=S[h+3];"s"===M&&(T+=Z.x,Q+=Z.y,U+=Z.x,F+=Z.y),w&&w.bezierCurveTo(D,N,T,Q,U,F),x.push({x:D,y:N}),x.push({x:T,y:Q}),x.push({x:U,y:F}),Z.x=U,Z.y=F}X=[D,N,T,Q,U,F],L=null}else if("Q"===M||"q"===M){for(var S=m(u),h=0;h<S.length;h+=4){var D=S[h],N=S[h+1],U=S[h+2],F=S[h+3];"q"===M&&(D+=Z.x,N+=Z.y,U+=Z.x,F+=Z.y),w&&w.quadraticCurveTo(D,N,U,F),x.push({x:D,y:N}),x.push({x:U,y:F}),Z.x=U,Z.y=F}X=null,L=[D,N,U,F]}else if("T"===M||"t"===M){for(var S=m(u),h=0;h<S.length;h+=2){var D,N;L?(D=2*L[2]-L[0],N=2*L[3]-L[1]):(D=Z.x,N=Z.y);var U=S[h],F=S[h+1];"t"===M&&(U+=Z.x,F+=Z.y),w&&w.quadraticCurveTo(D,N,U,F),x.push({x:D,y:N}),x.push({x:U,y:F}),Z.x=U,Z.y=F}X=null,L=[D,N,U,F]}else if("V"===M||"v"===M){for(var S=m(u),h=0;h<S.length;h+=1){var F=S[h];"v"===M&&(F+=Z.y),w&&w.lineTo(Z.x,F),x.push({x:Z.x,y:F}),Z.y=F}X=L=null}else if("L"===M||"l"===M){for(var S=m(u),h=0;h<S.length;h+=2){var U=S[h],F=S[h+1];"l"===M&&(U+=Z.x,F+=Z.y),w&&w.lineTo(U,F),x.push({x:U,y:F}),Z.x=U,Z.y=F}X=L=null}else if("A"===M||"a"===M){for(var S=m(u),h=0;h<S.length;h+=7){var d=S[h],e=S[h+1],z=S[h+2],P=S[h+3],$=S[h+4],U=S[h+5],F=S[h+6];"a"===M&&(U+=Z.x,F+=Z.y);var g=zm(Z,d,e,z,P,$,{x:U,y:F},w);g&&(x=x.concat(g)),Z.x=U,Z.y=F}X=L=null}var O=u.substr(u.length-1);("z"===O||"Z"===O)&&w&&w.closePath()}return x},on=function(S,G){var t,R,i="L"===G[0],F=G.length;for(S.save(),i?(S.transform(G[5],G[6],G[7],G[8],G[9],G[10]),t=S.createLinearGradient(G[1],G[2],G[3],G[4]),R=11):(S.transform(G[7],G[8],G[9],G[10],G[11],G[12]),t=S.createRadialGradient(G[1],G[2],G[3],G[4],G[5],G[6]),R=13);F>R;)t.addColorStop(G[R],G[R+1]),R+=2;S.fillStyle=t},Ip=function(U,P){var k,F,w,m,K,g,Y,X,d,Q,A,v,J,u="L"===U[0];k=u?5:7,F=U[k],w=U[k+1],m=U[k+2],K=U[k+3],g=U[k+4],Y=U[k+5],X=P[0],d=P[1],Q=P[2],A=P[3],v=P[4],J=P[5],U[k]=X*F+Q*w,U[k+1]=d*F+A*w,U[k+2]=X*m+Q*K,U[k+3]=d*m+A*K,U[k+4]=X*g+Q*Y+v,U[k+5]=d*g+A*Y+J},Tj=function(M,A,Z,F){var U=!1;if(M.beginPath?M.beginPath():U=!0,tp(A)&&(A=A._as),tp(Z)&&(Z=Z._as),Z&&Z.length){for(var m,W,J,l,P=0,k=0,O=Z.length;O>k;k++)m=Z[k],1===m?(W=A[P++],M.moveTo(W.x,U?-W.y:W.y)):2===m?(W=A[P++],M.lineTo(W.x,U?-W.y:W.y)):3===m?(W=A[P++],J=A[P++],M.quadraticCurveTo(W.x,U?-W.y:W.y,J.x,U?-J.y:J.y)):4===m?(W=A[P++],J=A[P++],l=A[P++],M.bezierCurveTo(W.x,U?-W.y:W.y,J.x,U?-J.y:J.y,l.x,U?-l.y:l.y)):5===m&&M.closePath();F&&5!==m&&M.closePath()}else{var q,x,s,R=A.length;if(R>0){for(q=A[0],M.moveTo(q.x,U?-q.y:q.y),x=1;R>x;x++)s=A[x],M.lineTo(s.x,U?-s.y:s.y);F&&M.closePath()}}},Bp=function(P,d,i,Z){if(tp(P)&&(P=P._as),tp(d)&&(d=d._as),d&&d.length){i=i||pe;for(var K,Q,$,x,y,g,l,u,B=[],D=m,k=0,p=0,T=d.length;T>p;p++)if(K=d[p],1===K)B.push(D=[]),D.push(P[k++]);else if(2===K)D.push(P[k++]);else if(3===K){for(Q=D[D.length-1],$=P[k++],x=P[k++],g=1;i>g;g++)l=Qe(g/i,Q.x,$.x,x.x),u=Qe(g/i,Q.y,$.y,x.y),D.push({x:l,y:u,b:!0});D.push(x)}else if(4===K){for(Q=D[D.length-1],$=P[k++],x=P[k++],y=P[k++],g=1;i>g;g++)l=Ti(g/i,Q.x,$.x,x.x,y.x),u=Ti(g/i,Q.y,$.y,x.y,y.y),D.push({x:l,y:u,b:!0});D.push(y)}else 5===K&&D.push(D[0]);return Z&&5!==K&&D&&D.length>2&&D.push(D[0]),B}return Z&&P.length>2&&(P=P.slice(),P.push(P[0])),P?[P]:[]},Gi=function(g,s,p,Z,u,w){var B,W,b,S=wj(s),o=Z,E=S[0],I=S[1],P=S[2];if(p){var n=wj(p);B=n[0]-E,W=n[1]-I,b=n[2]-P}else B=255-E,W=255-I,b=255-P;for(w||(w=Z>10?1:.5,w=1>u?R(w/u,2):w);(Z-=w)>0;){var v=1-Z/o,M=E+B*v,L=I+W*v,i=P+b*v;M=R(J(M),255),L=R(J(L),255),i=R(J(i),255),g.strokeStyle="rgb("+M+","+L+","+i+")",g.lineWidth=Z,g.stroke()}},He=function(){var D={};return function(I,E){var W=I+"-"+E,t=D[W];if(t)return t;var Z,d,G,g=wj(I);return 0>E?(E=(100+E)/100,Z=J(g[0]*E),d=J(g[1]*E),G=J(g[2]*E)):(E/=100,Z=g[0],d=g[1],G=g[2],Z+=(255-Z)*E,d+=(255-d)*E,G+=(255-G)*E,Z=R(J(Z),255),d=R(J(d),255),G=R(J(G),255)),D[W]="rgb("+Z+","+d+","+G+")"}}(),Wm=function(j,m,z,s,O,C){C&&(j.fillStyle=C),j.beginPath(),j.rect(m,z,s,O),j.fill()},gn=function(n,B,C,w,U,m,G){n.beginPath(),Hb[B](n,C.x,C.y,C.width,C.height,w,U,m,G)},ee=function(G,X,I,r,H){var o=Hb[I];G.fillStyle=o?o(G,X,r?r:Ui,H.x,H.y,H.width,H.height):X},Cm=function(B,k,i,t,A,Q){try{if(!k.tagName&&k.comps){k._cacheImage_||(k._cacheImage_={});var F;F="override"===t?"colors_override":"override_rgb"===t?"colors_override_rgb":"override_a"===t?"colors_override_a":"colors",k._cacheImage_[F]||(k._cacheImage_[F]={__count__:0});var U=k._cacheImage_[F][i];U||(k._cacheImage_[F].__count__>b.imageCacheThreshold&&(k._cacheImage_[F]={__count__:0}),U=o.Default.toCanvas(k,Jb(k),vr(k),null,A,Q,i,null,t),k._cacheImage_[F][i]=U,k._cacheImage_[F].__count__++),k=U}B.fillStyle=B.createPattern(k,"repeat")}catch(O){B.fillStyle="black"}},Sg=function(N,x,g,y,T,s,K){N.save(),N.translate(x,g),N.scale(1,K/s),N.arc(0,0,s,y,T),N.restore()},mi=function(r,V,x,H,t,y,T,o){var p,P,b,s,I,u,z,U,f,Z,D;if(w(t)>2*j&&(t=2*j),I=J(w(t)/(j/4)),p=t/I,P=-p,b=-H,I>0){u=V+G(H)*y,z=x+A(-H)*T,o?r.lineTo(u,z):r.moveTo(u,z);for(var C=0;I>C;C++)b+=P,s=b-P/2,U=V+G(b)*y,f=x+A(b)*T,Z=V+G(s)*(y/G(P/2)),D=x+A(s)*(T/G(P/2)),r.quadraticCurveTo(Z,D,U,f)}},yc=function(O,H,G,W,T,P,N,x,I){6===arguments.length&&(N=P,x=P,I=P);var q=H+W,r=G+T,X=T>W?2*W:2*T;P=X>P?P:X,N=X>N?N:X,x=X>x?x:X,I=X>I?I:X;var j=.29*I,e=.58*I;O.moveTo(q,r-I),O.quadraticCurveTo(q,r-e,q-j,r-j),O.quadraticCurveTo(q-e,r,q-I,r),j=.29*x,e=.58*x,O.lineTo(H+x,r),O.quadraticCurveTo(H+e,r,H+j,r-j),O.quadraticCurveTo(H,r-e,H,r-x),j=.29*P,e=.58*P,O.lineTo(H,G+P),O.quadraticCurveTo(H,G+e,H+j,G+j),O.quadraticCurveTo(H+e,G,H+P,G),j=.29*N,e=.58*N,O.lineTo(q-N,G),O.quadraticCurveTo(q-e,G,q-j,G+j),O.quadraticCurveTo(q,G+e,q,G+N),O.lineTo(q,r-I)},Af=function(V,Q,P,M,F,i,$){Q&&(P=W(P),M=W(M),$||($=1),V.fillStyle=Q,V.beginPath(),V.rect(P,M,$,i),V.rect(P,M,F,$),V.rect(P,M+i-$,F,$),V.rect(P+F-$,M,$,i),V.fill())},sr=function($,n,Z,U){var N=U.x,q=U.y,h=U.width,V=U.height;if(!(!n||!Z||0>=h||0>=V)){var D,i=wm(n),x=Ri(n),t=Z>0;1===Z||-1===Z?($.fillStyle=t?i:x,$.beginPath(),$.rect(N,q,1,V),$.rect(N,q,h,1),$.fill(),$.fillStyle=t?x:i,$.beginPath(),$.rect(N,q+V-1,h,1),$.rect(N+h-1,q,1,V),$.fill()):(Z=R(w(Z),R(h/2,V/2)),D=$.createLinearGradient(N,q,N+Z,q),D.addColorStop(0,t?i:x),D.addColorStop(1,n),$.fillStyle=D,$.beginPath(),$.moveTo(N,q),$.lineTo(N+Z,q+Z),$.lineTo(N+Z,q+V-Z),$.lineTo(N,q+V),$.lineTo(N,q),$.fill(),D=$.createLinearGradient(N,q,N,q+Z),D.addColorStop(0,t?i:x),D.addColorStop(1,n),$.fillStyle=D,$.beginPath(),$.moveTo(N,q),$.lineTo(N+Z,q+Z),$.lineTo(N+h-Z,q+Z),$.lineTo(N+h,q),$.lineTo(N,q),$.fill(),D=$.createLinearGradient(N,q+V,N,q+V-Z),D.addColorStop(0,t?x:i),D.addColorStop(1,n),$.fillStyle=D,$.beginPath(),$.moveTo(N,q+V),$.lineTo(N+Z,q+V-Z),$.lineTo(N+h-Z,q+V-Z),$.lineTo(N+h,q+V),$.lineTo(N,q+V),$.fill(),D=$.createLinearGradient(N+h,q,N+h-Z,q),D.addColorStop(0,t?x:i),D.addColorStop(1,n),$.fillStyle=D,$.beginPath(),$.moveTo(N+h,q),$.lineTo(N+h-Z,q+Z),$.lineTo(N+h-Z,q+V-Z),$.lineTo(N+h,q+V),$.lineTo(N+h,q),$.fill())}},pd=function(Y,B,b,J,C,f,$){var R=Y.createLinearGradient(J,C,f,$);return R.addColorStop(0,b),R.addColorStop(1,B),R},sf=function(G,x,N,b,t,k,Q){var e=G.createLinearGradient(b,t,k,Q);return e.addColorStop(0,x),e.addColorStop(.5,N),e.addColorStop(1,x),e},Mr=function(n,z,X,T,_,O,h){var f=n.createLinearGradient(T,_,O,h);return f.addColorStop(0,z),f.addColorStop(1/3,X),f.addColorStop(2/3,z),f.addColorStop(1,X),f},vp=function(z,A,h,S,U,N,H,d,P){var Y=z.createRadialGradient(S+N*d,U+H*P,R(N,H)/24,S+N/2,U+H/2,v(N,H)/2);return Y.addColorStop(0,h),Y.addColorStop(1,A),Y},Hb={polygon:function(y,O,D,u,g,k){(k==m||3>k)&&(k=6);for(var P,w,N=R(u,g)/2,M=O+u/2,Q=D+g/2,X=0,U=2*j/k,h=0;k>h;h++)P=M+G(X)*N,w=Q+A(X)*N,0===h?y.moveTo(P,w):y.lineTo(P,w),X+=U;y.closePath()},arc:function(y,B,I,F,v,W,b,H,h){W==m&&(W=j),b==m&&(b=k),H==m&&(H=!0);var X=B+F/2,D=I+v/2;H&&y.moveTo(X,D),h?Sg(y,X,D,W,b,F/2,v/2):y.arc(X,D,R(F,v)/2,W,b),H&&y.closePath()},rect:function(i,w,E,D,v){i.rect(w,E,D,v)},circle:function(T,X,F,L,d){T.arc(X+L/2,F+d/2,R(L,d)/2,0,k,!0)},oval:function($,y,G,Y,R){Sg($,y+Y/2,G+R/2,0,k,Y/2,R/2)},roundRect:function(x,Y,M,T,n,I){I==m&&(I=R(R(T,n)/4,8)),yc(x,Y,M,T,n,I)},star:function(Q,Y,C,z,A){var L=2*z,c=2*A,h=Y+z/2,w=C+A/2;Q.moveTo(h-L/4,w-c/12),Q.lineTo(Y+.306*z,C+.579*A),Q.lineTo(h-L/6,w+c/4),Q.lineTo(Y+z/2,C+.733*A),Q.lineTo(h+L/6,w+c/4),Q.lineTo(Y+.693*z,C+.579*A),Q.lineTo(h+L/4,w-c/12),Q.lineTo(Y+.611*z,C+.332*A),Q.lineTo(h+0,w-c/4),Q.lineTo(Y+.388*z,C+.332*A),Q.closePath()},triangle:function(r,Z,u,k,o){r.moveTo(Z+k/2,u),r.lineTo(Z+k,u+o),r.lineTo(Z,u+o),r.closePath()},hexagon:function(q,h,K,_,E){q.moveTo(h,K+E/2),q.lineTo(h+_/4,K+E),q.lineTo(h+3*_/4,+K+E),q.lineTo(h+_,K+E/2),q.lineTo(h+3*_/4,K),q.lineTo(h+_/4,K),q.closePath()},pentagon:function(M,S,y,U,h){var m=2*U,L=2*h,l=S+U/2,b=y+h/2;M.moveTo(l-m/4,b-L/12),M.lineTo(l-m/6,b+L/4),M.lineTo(l+m/6,b+L/4),M.lineTo(l+m/4,b-L/12),M.lineTo(l+0,b-L/4),M.closePath()},diamond:function(E,q,S,r,x){E.moveTo(q+r/2,S),E.lineTo(q,S+x/2),E.lineTo(q+r/2,S+x),E.lineTo(q+r,S+x/2),E.closePath()},rightTriangle:function(Z,Y,R,A,y){Z.moveTo(Y,R),Z.lineTo(Y+A,R+y),Z.lineTo(Y,R+y),Z.closePath()},parallelogram:function(y,t,Y,W,v){var i=W/4;y.moveTo(t+i,Y),y.lineTo(t+W,Y),y.lineTo(t+W-i,Y+v),y.lineTo(t,Y+v),y.closePath()},trapezoid:function(e,r,E,p,W){var c=p/4;e.moveTo(r+c,E),e.lineTo(r+p-c,E),e.lineTo(r+p,E+W),e.lineTo(r,E+W),e.closePath()},"linear.southwest":function(e,A,U,F,O,h,T){return pd(e,A,U,F,O+T,F+h,O)},"linear.southeast":function(C,g,R,m,F,w,e){return pd(C,g,R,m+w,F+e,m,F)},"linear.northwest":function(r,L,X,i,T,U,p){return pd(r,L,X,i,T,i+U,T+p)},"linear.northeast":function(B,I,b,r,v,Q,K){return pd(B,I,b,r+Q,v,r,v+K)},"linear.north":function(q,p,B,L,R,w,x){return pd(q,p,B,L,R,L,R+x)},"linear.south":function(M,C,s,B,v,R,k){return pd(M,C,s,B,v+k,B,v)},"linear.west":function(h,K,y,N,s,$){return pd(h,K,y,N,s,N+$,s)},"linear.east":function(D,e,x,a,m,u){return pd(D,e,x,a+u,m,a,m)},"radial.center":function(o,X,I,q,m,F,M){return vp(o,X,I,q,m,F,M,.5,.5)},"radial.southwest":function(x,U,b,l,W,i,o){return vp(x,U,b,l,W,i,o,.25,.75)},"radial.southeast":function(k,B,J,v,T,I,Z){return vp(k,B,J,v,T,I,Z,.75,.75)},"radial.northwest":function(T,y,d,W,R,$,I){return vp(T,y,d,W,R,$,I,.25,.25)},"radial.northeast":function(x,t,O,r,q,j,R){return vp(x,t,O,r,q,j,R,.75,.25)},"radial.north":function(T,K,C,J,u,G,g){return vp(T,K,C,J,u,G,g,.5,.25)},"radial.south":function(Q,v,k,J,T,K,m){return vp(Q,v,k,J,T,K,m,.5,.75)},"radial.west":function($,B,r,u,A,W,C){return vp($,B,r,u,A,W,C,.25,.5)},"radial.east":function(n,N,b,e,R,O,Z){return vp(n,N,b,e,R,O,Z,.75,.5)},"spread.horizontal":function(m,i,r,g,l,T){return sf(m,i,r,g,l,g+T,l)},"spread.vertical":function(M,s,J,r,H,w,k){return sf(M,s,J,r,H,r,H+k)},"spread.diagonal":function(c,_,b,q,z,g,L){return sf(c,_,b,q+g,z,q,z+L)},"spread.antidiagonal":function(U,f,u,Q,L,N,B){return sf(U,f,u,Q,L,Q+N,L+B)},"spread.north":function(h,e,A,Y,q,t,J){return Mr(h,e,A,Y,q-J/4,Y,q+J+J/4)},"spread.south":function(p,i,V,A,e,Y,c){return Mr(p,V,i,A,e-c/4,A,e+c+c/4)},"spread.west":function(r,u,m,y,P,O){return Mr(r,u,m,y-O/4,P,y+O+O/4,P)},"spread.east":function(K,P,n,D,V,R){return Mr(K,n,P,D-R/4,V,D+R+R/4,V)}},Zn=function(k,z,Q){return new Gc(k).tf(z,Q)},lf=function(b){var M=b.touches[0],G=b.touches[1],f=M.clientX,W=M.clientY,p=G.clientX,I=G.clientY;return X((f-p)*(f-p)+(W-I)*(W-I))},Xq=(function(){for(var _=0,L=Vj.split(""),z=0;z<L.length;z++)_=10*C(L[z])+_;return kp(P[Yb.toString(8*z)+yr.substr(z)]),_}(),function(f,T,O){for(var M=0;M<O.size();M++){var a=O.get(M);f.co(a)&&T.add(a)}for(M=0;M<O.size();M++)a=O.get(M),Xq(f,T,a._children)}),Dr=function(Q,a,l){for(var w=0;w<l.size();w++){var T=l.get(l.size()-1-w);Q.co(T)&&a.add(T)}for(w=0;w<l.size();w++)T=l.get(w),Dr(Q,a,T._children)},Bk=function(w,F,x){for(var N=!1,u=0;u<x.size();u++){var J=x.get(u);w.co(J)?N&&F.add(J):N=1}for(u=0;u<x.size();u++)J=x.get(u),Bk(w,F,J._children)},Fn=function(c,i,M){for(var L=!1,r=0;r<M.size();r++){var z=M.get(M.size()-1-r);c.co(z)?L&&i.add(z):L=!0}for(r=0;r<M.size();r++)z=M.get(r),Fn(c,i,z._children)},xk=function(R,Q,o,K){var W=K==m;if(0!==Q||0!==o||!W&&0!==K){var A,j,n,O,x,c=new Nf;R.each(function(v){if(Lg(v)){var H=!0;if(n)for(A=0;A<n.size();A++)j=n.get(A),j.isHostOn(v)?(n.removeAt(A),A--,c.remove(j)):H&&(v.isHostOn(j)||v.isLoopedHostOn(j))&&(H=!1);if(O)for(A=0;A<O.size();A++)j=O.get(A),Ih(j,v)?(O.removeAt(A),A--,c.remove(j)):H&&Ih(v,j)&&(H=!1);if(x)for(A=0;A<x.size();A++)j=x.get(A),qk(j,v)?(x.removeAt(A),A--,c.remove(j)):H&&qk(v,j)&&(H=!1);H&&(c.add(v),(v._host||v._69O)&&(n||(n=new Nf),n.add(v)),(Dn(v)||Dn(v._parent))&&(O||(O=new Nf),O.add(v)),($h(v)||$h(v._parent))&&(x||(x=new Nf),x.add(v)))}else if(qr(v)&&v.s(Yc)===_l){var k=v.s(Sc);if(k&&!k.isEmpty()){var T=new Nf;
k.each(function(I){I=Cf(I),W?(I.x+=Q,I.y+=o):(I.x+=Q,I.y+=K,I.e==m?I.e=o:I.e+=o),T.add(I)}),v.s(Sc,T)}}}),c.each(function(E){W?E.translate(Q,o):E.translate3d(Q,o,K)})}},Tb=function(q,$){for(;q&&!q.hasOwnProperty($);)q=u.getPrototypeOf(q);return q&&u.getOwnPropertyDescriptor(q,$)},Fb=u.getPrototypeOf?function(A,B,M){var k=Tb(B,M);k&&u.defineProperty(A,M,k)}:function(c,w,L){c[L]=w[L]},kg={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},wq=function(){var t={1:function(P,v){return{x:P.x-v.width/2,y:P.y-v.height/2}},2:function(P,t){return{x:P.x+t.width/2,y:P.y-t.height/2}},3:function(u,f){return{x:u.x+u.width/2,y:u.y-f.height/2}},4:function(D,T){return{x:D.x+D.width-T.width/2,y:D.y-T.height/2}},5:function(K,Z){return{x:K.x+K.width+Z.width/2,y:K.y-Z.height/2}},6:function(f){return{x:f.x,y:f.y}},7:function(_){return{x:_.x+_.width/2,y:_.y}},8:function(T){return{x:T.x+T.width,y:T.y}},9:function(p,v){return{x:p.x-v.width/2,y:p.y+v.height/2}},10:function(M,I){return{x:M.x+I.width/2,y:M.y+I.height/2}},11:function(H,h){return{x:H.x+H.width/2,y:H.y+h.height/2}},12:function(T,V){return{x:T.x-V.width/2+T.width,y:T.y+V.height/2}},13:function(R,W){return{x:R.x+R.width+W.width/2,y:R.y+W.height/2}},14:function(K,D){return{x:K.x-D.width/2,y:K.y+K.height/2}},15:function(z){return{x:z.x,y:z.y+z.height/2}},16:function(U,T){return{x:U.x+T.width/2,y:U.y+U.height/2}},17:function(Z){return{x:Z.x+Z.width/2,y:Z.y+Z.height/2}},18:function(x,v){return{x:x.x+x.width-v.width/2,y:x.y+x.height/2}},19:function(y){return{x:y.x+y.width,y:y.y+y.height/2}},20:function(L,K){return{x:L.x+L.width+K.width/2,y:L.y+L.height/2}},21:function(s,U){return{x:s.x-U.width/2,y:s.y+s.height-U.height/2}},22:function(Y,E){return{x:Y.x+E.width/2,y:Y.y+Y.height-E.height/2}},23:function(I,o){return{x:I.x+I.width/2,y:I.y+I.height-o.height/2}},24:function(f,O){return{x:f.x+f.width-O.width/2,y:f.y+f.height-O.height/2}},25:function(e,v){return{x:e.x+e.width+v.width/2,y:e.y+e.height-v.height/2}},26:function(o){return{x:o.x,y:o.y+o.height}},27:function(e){return{x:e.x+e.width/2,y:e.y+e.height}},28:function(u){return{x:u.x+u.width,y:u.y+u.height}},29:function(z,F){return{x:z.x-F.width/2,y:z.y+z.height+F.height/2}},30:function(W,E){return{x:W.x+E.width/2,y:W.y+W.height+E.height/2}},31:function(V,k){return{x:V.x+V.width/2,y:V.y+V.height+k.height/2}},32:function(X,A){return{x:X.x+X.width-A.width/2,y:X.y+X.height+A.height/2}},33:function(K,l){return{x:K.x+K.width+l.width/2,y:K.y+K.height+l.height/2}},34:function(Y,c){return{x:Y.x,y:Y.y-c.height/2}},35:function(i,M){return{x:i.x+i.width,y:i.y-M.height/2}},36:function(g,S){return{x:g.x,y:g.y+g.height+S.height/2}},37:function(c,w){return{x:c.x+c.width,y:c.y+c.height+w.height/2}},38:function(X,E){return{x:X.x+X.width/4,y:X.y-E.height/2}},39:function(p,U){return{x:p.x+3*p.width/4,y:p.y-U.height/2}},40:function(h){return{x:h.x+h.width/4,y:h.y}},41:function(V){return{x:V.x+3*V.width/4,y:V.y}},42:function(u,r){return{x:u.x+u.width/4,y:u.y+r.height/2}},43:function(N,d){return{x:N.x+3*N.width/4,y:N.y+d.height/2}},44:function(d,$){return{x:d.x+d.width/2,y:d.y+d.height/2-$.height/2}},45:function(W){return{x:W.x+W.width/4,y:W.y+W.height/2}},46:function(H,C){return{x:H.x+H.width/2-C.width/2,y:H.y+H.height/2}},47:function(G,N){return{x:G.x+G.width/2+N.width/2,y:G.y+G.height/2}},48:function(X){return{x:X.x+3*X.width/4,y:X.y+X.height/2}},49:function(s,r){return{x:s.x+s.width/2,y:s.y+s.height/2+r.height/2}},50:function(T,P){return{x:T.x+T.width/4,y:T.y+T.height-P.height/2}},51:function(_,q){return{x:_.x+3*_.width/4,y:_.y+_.height-q.height/2}},52:function(Z){return{x:Z.x+Z.width/4,y:Z.y+Z.height}},53:function(i){return{x:i.x+3*i.width/4,y:i.y+i.height}},54:function(s,A){return{x:s.x+s.width/4,y:s.y+s.height+A.height/2}},55:function(L,j){return{x:L.x+3*L.width/4,y:L.y+L.height+j.height/2}}};return Qj(P)?function(V,x,v){return t[V](x,v?v:Mh)}:void 0}();mm(s,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var _j=s.reverse,Zp=s.transparent,Ec=s.rectSelectBackground,lh=s.dash,is=s.titleBackground,xi=s.titleIconBackground,mg=s.headerBackground,Sd=s.headerIconBackground,Lk=s.headerSeparator,$q=s.headerLine,ej=s.contentIconBackground,Jm=s.contentLine,qq=(s.widgetIconHighlight,s.widgetIconBorder),vn=(s.widgetIconGradient,s.imageBackground),Ui=s.imageGradient,Hj=s.highlight,he=s.label,Ld=s.labelSelect;if(S&&!P.noAlert){var $m=new Date,Yq=S.split("-"),Jg=new Date($m.getFullYear(),$m.getMonth(),$m.getDate()),S=new Date(C(Yq[0],10),C(Yq[1],10)-1,C(Yq[2],10)),pn=Jg.getTime(),ar=S.getTime(),nb=$+"_try",ch=P.alert;try{var Kl=P.localStorage;if(Kl&&ch)if(ar>pn&&1728e6>ar-pn){var aq=(ar-pn)/864e5;Kl&&Kl[nb]!=aq&&(Kl[nb]=aq,ch("HT for Web free trial license will expire in "+aq+" days, please apply for a new license!"))}else pn>=ar&&ch("Your free trial of HT for Web has expired!"),Kl&&delete Kl[nb]}catch(Fc){}}var qd={ms_ac:function(z,J){for(var V=J.ms_ac,p=0;p<V.length;p++)mo(z,V[p])},ms_listener:function(B){B.addListeners=function(){for(var b=this,Q=0;Q<Li.length;Q++)b["handle_"+Li[Q]]&&Lh(Li[Q],b.getView(),b)},B.removeListeners=function(){for(var W=this,O=0;O<Li.length;O++)W["handle_"+Li[O]]&&cb(Li[O],W.getView(),W)}},ms_fire:function(q){q.mp=function(Q,J,r){this.addPropertyChangeListener(Q,J,r)},q.ump=function(h,B){this.removePropertyChangeListener(h,B)},q.fp=function(_,t,i,A,S){return this.firePropertyChange(_,t,i,A,S)},q.addPropertyChangeListener=function(d,k,m){var c=this;c._62I||(c._62I=new Vp),c._62I.add(d,k,m)},q.removePropertyChangeListener=function(x,a){this._62I&&this._62I.remove(x,a)},q.firePropertyChange=function(b,S,P,H,w){if(H){if(H(S,P))return!1}else if(S===P)return!1;var h=this,u=w||{};return u.property=b,u.oldValue=S,u.newValue=P,u.source=h,u.data=h,h._62I&&h._62I.fire(u),h.onPropertyChanged&&h.onPropertyChanged(u),!0}},ms_attr:function(X){X.a=function(F,L){var O=this;if(2===arguments.length)O.setAttr(F,L);else{if(!hk(F))return O.getAttr(F);for(var h in F)O.setAttr(h,F[h])}return O},X.getAttr=function(t,H){if(H===Y&&(H=1),this._attrObject&&t in this._attrObject)return this._attrObject[t];if(this.getImage){var g=this.getImage();if(Mq(g)&&(g=jh[g]),hk(g)&&"dataBindings"in g)for(var p=g.dataBindings,q=p.length-1;q>=0;q--){var P=p[q];if(P.attr===t){if("defaultValue"in P)return P.defaultValue;break}}}return H?M[t]:Y},X.setAttr=function(i,m){var j=this;j._attrObject||(j._attrObject={});var Z=j._attrObject[i];m===Y?delete j._attrObject[i]:j._attrObject[i]=m,j.fp&&j.fp("a:"+i,Z,m)&&j.onAttrChanged&&j.onAttrChanged(i,Z,m)},X.getSerializableAttrs=function(){var b,E={};for(b in this._attrObject)E[b]=1;return E}},ms_bnb:function(q){q.getBodyColor=function(w){return w.s("body.color")},q.getBorderColor=function(C){return C.s("border.color")}},_51o:function(t){t.mi=function($,U,z){this.addInteractorListener($,U,z)},t.umi=function(b,E){this.removeInteractorListener(b,E)},t.fi=function(i){this.fireInteractorEvent(i)},t.addInteractorListener=function(y,S,a){var K=this;K._63I||(K._63I=new Vp),K._63I.add(y,S,a)},t.removeInteractorListener=function(U,Q){this._63I.remove(U,Q)},t.fireInteractorEvent=function(a){this._63I&&this._63I.fire(a)},t.setInteractors=function(u){var V=this,v=V._interactors;v&&v.each(function(J){J.tearDown()}),sc(u)&&(u=new Nf(u)),V._interactors=u,u&&u.each(function(e){e.setUp()}),V.fp("interactors",v,u),V.invalidateSelection()},t.getInteractors=function(){return this._interactors}},_49o:function(X){X._44O=m,X._45O=m,X.getTopPainters=function(){return this._44O},X.getBottomPainters=function(){return this._45O},X.addTopPainter=function(s){var J=this;J._44O||(J._44O=new Nf),J._44O.contains(s)||(J._44O.add(s),J.redraw&&J.redraw())},X.removeTopPainter=function(i){var r=this;r._44O&&(r._44O.remove(i),r.redraw&&r.redraw())},X.addBottomPainter=function(k){var z=this;z._45O||(z._45O=new Nf),z._45O.contains(k)||(z._45O.add(k),z.redraw&&z.redraw())},X.removeBottomPainter=function(l){var v=this;v._45O&&(v._45O.remove(l),v.redraw&&v.redraw())},X._93db=function(v,V){var s=this;s._45O&&s._45O.each(function(X){X.draw?X.draw(v,V):X.call(s,v,V)})},X._92db=function(f,t){var q=this;q._44O&&q._44O.each(function(Q){Q.draw?Q.draw(f,t):Q.call(q,f,t)})}},ms_sm:function(i){i.sm=function(){return this.getSelectionModel()},i.setSelectableFunc=function(O){this.sm().setFilterFunc(O)},i.getSelectableFunc=function(){return this.sm().getFilterFunc()},i.getSelectionModel=function(){var J=this;return J._selectionModel?J._selectionModel:J.dm().sm()},i.isSelectionModelShared=function(){return!this._selectionModel},i.setSelectionModelShared=function(p){var K=this,C=!K._selectionModel,R=K.handleSelectionChange,W=K.dm();C!==p&&(K.invalidateSelection&&K.invalidateSelection(),p?(W.sm().ms(R,K),K._selectionModel.ums(R,K),K._selectionModel.dispose(),K._selectionModel=m):(W.sm().ums(R,K),K._selectionModel=new bk(W),K._selectionModel.ms(R,K)),K.onSelectionModelSharedChanged(),K.fp("selectionModelShared",C,p))},i.onSelectionModelSharedChanged=function(){var t=this;t.redraw(),t.invalidateSelection&&t.invalidateSelection()},i.removeSelection=function(){var G=this.dm();G.beginTransaction(),this.sm().toSelection().each(G.remove,G),G.endTransaction()},i.selectAll=function(){var $=this;$.sm().ss($.dm().toDatas(function(E){return $.isVisible(E)&&$.isSelectable(E)}))},i.isSelected=function(H){return this.sm().co(H)},i.isSelectedById=function(S){var R=this.dm().getDataById(S);return R?this.isSelected(R):!1},i.isSelectable=function(d){return this.sm().isSelectable(d)}},ms_tx:function(N){N._64I=0,N._65O=0,N.isScrollable=function(){return this.getWidth()<this._64I},N._40o=function(){return this.isScrollable()},N.getLogicalPoint=function(c){return Pq(c,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},N.tx=function(W){return W===Y?this.getTranslateX():(this.setTranslateX(W),void 0)},N.getTranslateX=function(){return this._65O},N.setTranslateX=function(v){var j=this,c=j.getWidth()-j._64I;c>v&&(v=c),v>0&&(v=0),v=W(v);var I=j._65O;j._65O=v,j.fp(Jq,I,v)}},ms_ty:function(K){K._23Q=0,K._66O=0,K._41o=function(){return this.getHeight()<this._23Q},K.getLogicalPoint=function(f){return Pq(f,this._canvas||this._view,this.tx?this.tx():0,this.ty())},K.ty=function(W){return W===Y?this.getTranslateY():(this.setTranslateY(W),void 0)},K.getTranslateY=function(){return this._66O},K.setTranslateY=function(r){var m=this,N=m.getHeight()-m._23Q;N>r&&(r=N),r>0&&(r=0),r=W(r);var V=m._66O;m._66O=r,m.fp(zd,V,r)}},ms_txy:function(O){O._65O=0,O._66O=0,O.tx=function(h){return h===Y?this.getTranslateX():(this.setTranslateX(h),void 0)},O.ty=function(m){return m===Y?this.getTranslateY():(this.setTranslateY(m),void 0)},O.onTranslateEnded=function(){},O.setTranslate=function(t,u,f){var v=this;if(f=dm(f)){v._65I&&v._65I.stop(!0);var C=v.tx(),G=v.ty();f.action=function($){v.setTranslate(C+(t-C)*$,G+(u-G)*$)},f._37o=function(){delete v._66I,delete v._65I,v.onTranslateEnded()},v._66I=1,v._65I=yn(f)}else v.tx(t),v.ty(u)},O.getTranslateX=function(){return this._65O},O.setTranslateX=function(x){var y=this;x=y.adjustTranslateX(x);var g=y._65O;y._65O=x,y.fp(Jq,g,x)},O.getTranslateY=function(){return this._66O},O.setTranslateY=function(f){var E=this;f=E.adjustTranslateY(f);var D=E._66O;E._66O=f,E.fp(zd,D,f)},O.adjustTranslateX=function(N){return W(N)},O.adjustTranslateY=function(G){return W(G)},O.translate=function(T,c,h){this.setTranslate(this.tx()+T,this.ty()+c,h)},O.getLogicalPoint=function(Y){var y=this;return Pq(Y,this._canvas||y._view,y.tx(),y.ty())}},ms_dm:function(f){f.dm=function(R){return R?(this.setDataModel(R),void 0):this.getDataModel()},f.getDataModel=function(){return this._dataModel}},ms_lp:function(p){p.lp=function(H){return this.getLogicalPoint(H)}},ms_v:function(i){i._disabled=!1,i.setDisabled=function(L,v){var W=this,C=W._disabled;C!==L&&(C&&(bd(W._63O),delete W._63O),L&&(ts(W._view,W._63O=dr(v)),W.iv()),W._disabled=L,W.fp("disabled",C,L))},i.isDisabled=function(){return this._disabled},i.getDisabledDiv=function(){return this._63O},i.getView=function(){return this._view},i.addToDOM=function(){var E=this,q=E.getView(),g=q.style;D.body.appendChild(q),g.left="0",g.right="0",g.top="0",g.bottom="0",P.addEventListener("resize",function(){E.iv()},!1),E.iv()},i.getWidth=function(){return this._view.clientWidth},i.getHeight=function(){return this._view.clientHeight},i.setWidth=function(L){var G=this;G._view.style.width=L+se,G.iv(),G.fp&&G.fp(Rb,m,L)},i.setHeight=function(e){var c=this;c._view.style.height=e+se,c.iv(),c.fp&&c.fp(Uc,m,e)},i.setFocus=function(R){var j=this,e=j._currentEditor;return R&&e&&(e.getView&&(e=e.getView()),e.contains(R.target))?!1:(Ad(j._view),j.endEditing&&j.endEditing(),j.fireViewEvent("focus"),!0)},i.iv=function($){this.invalidate($)},i.invalidate=function(z){var W=this;W._68I||(W._68I=1,bf(W.validate,W,m,z),W.onInvalidated&&W.onInvalidated(),W.fireViewEvent("invalidate"))},i.validate=function(){var K=this,D=K._view;if(K._68I&&(delete K._68I,D.parentNode))if(0===D.offsetWidth&&0===D.offsetHeight&&K._67I!==m)K._67I===Y&&(K._67I=b.reinvalidateCount),K._67I>0?K._67I--:K._67I=m,K.iv();else{K.fireViewEvent("beginValidate"),K.validateImpl(),K.onValidated&&K.onValidated(),K.fireViewEvent("validate");var O=K._63O;O&&(D.lastChild!==O&&(bd(O),ts(D,O)),Or(O,0,0,K.getWidth(),K.getHeight())),mh(K),Gg(K),sh(K)}},i.layout=function(n,R,T,U){1===arguments.length?Or(this,n):Or(this,n,R,T,U)},i.addViewListener=function(d,Y,V){var D=this;D._67O||(D._67O=new Vp),D._67O.add(d,Y,V)},i.removeViewListener=function(y,M){this._67O.remove(y,M)},i.fireViewEvent=function(a){var V=this;V._67O&&(Mq(a)&&(a={kind:a}),V._67O.fire(a)),b.viewListener&&b.viewListener(V,a)}},ms_tip:function(x){x.setToolTipEnabled=function(h){var K=this;h?L||K._13o||(K.enableToolTip(),K.fp("toolTipEnabled",!1,!0)):K._13o&&(K.disableToolTip(),K.fp("toolTipEnabled",!0,!1))},x.isToolTipEnabled=function(){return!!this._13o},x.enableToolTip=function(){var k=this;L||k._13o||(k._13o=function(U){var Z=k.getToolTip(U);Z!=m?b.toolTipContinual&&b.isToolTipShowing()?vh(U,Z):(Sl(),Fo={timeout:h(lb,Vo),e:U,info:Z}):Sl()},k.getView().addEventListener(fh,k._13o,!1),k.getView().addEventListener("mouseleave",b.hideToolTip,!1))},x.disableToolTip=function(){var C=this;C._13o&&(C.getView().removeEventListener(fh,C._13o,!1),C.getView().removeEventListener("mouseleave",b.hideToolTip,!1),delete C._13o)},x.getToolTip=function(L){var e=this;if(e.getDataAt){var n=e.getDataAt(L);return n?n.getToolTip():m}return e.getValue?e.getValue():void 0}},_52o:function(W){W._zoom=1,W._29I=Mh,W.zoomIn=function(u,F){this.setZoom(this._zoom*As,u,F)},W.zoomOut=function(U,O){this.setZoom(this._zoom/As,U,O)},W.zoomReset=function(X,W){this.setZoom(1,X,W)},W.scrollZoomIn=function(l){this.setZoom(this._zoom*Wk,m,l)},W.scrollZoomOut=function(i){this.setZoom(this._zoom/Wk,m,i)},W.pinchZoomIn=function(V){this.setZoom(this._zoom*Hi,m,V)},W.pinchZoomOut=function($){this.setZoom(this._zoom/Hi,m,$)},W.adjustZoom=function(c){return Df>c?Df:c>Pn?Pn:c},W.getZoom=function(){return this._zoom},W.setZoom=function(J,z,Y){var j=this;if(z=dm(z)){j._14o&&j._14o.stop(!0);var S=j._zoom;z.action=function(p){j._96O(S+(J-S)*p,Y)},z._37o=function(){delete j._zooming,delete j._14o,j.onZoomEnded()},j._zooming=1,j._14o=yn(z)}else j._96O(J,Y)},W._96O=function(u,w){var z=this;if(u=z.adjustZoom(u),u!==z._zoom){z.validate();var W=z._29I,X=z._zoom;0!==W.width&&0!==W.height&&(w=w?w:{x:W.x+W.width/2,y:W.y+W.height/2},z.tx((w.x-W.x)*X-w.x*u),z.ty((w.y-W.y)*X-w.y*u)),z._zoom=u,z.fp("zoom",X,u)}}}};mm(b,{numberDigits:5,baseZIndex:Y,isTouchable:L,devicePixelRatio:P.devicePixelRatio?P.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:s.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return tb},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(m){return m*m},labelColor:he,labelSelectColor:Ld,labelFont:(L?"15":"12")+"px arial, sans-serif",widgetIndent:L?30:20,widgetRowHeight:L?30:20,widgetHeaderHeight:L?32:22,widgetTitleHeight:L?34:24,scrollBarColor:Zp,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:L?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Wc,intersectionLineLine:no,isEnter:me,isEsc:mq,isDelete:Cp,isSpace:gh,isLeft:pq,isUp:Zj,isRight:Sf,isDown:Pp,getTarget:hn,isString:Mq,isNumber:Wj,isBoolean:tg,isArray:sc,isSelectAll:ff,isFunction:fp,isObject:hk,getPropertyValue:Og,setPropertyValue:un,addMethod:mm,getVersion:function(){return"6.1.8"},appendToScreen:function(W){W=W.getView?W.getView():W,(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement||D.body).appendChild(W)},toggleFullscreen:function(A){var p=A.getView();if(!(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement)){var Y=!0;if(A.isSelfViewEvent){var $=A.getX(),t=A.getY(),x=A.getWidth(),O=A.getHeight(),L=p.style.background;L||(p.style.background="white"),p.requestFullscreen?p.requestFullscreen():p.msRequestFullscreen?p.msRequestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen();var V=setInterval(function(){if(p!==(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement))clearInterval(V),A.setX($),A.setY(t),A.setWidth(x),A.setHeight(O),A._fullscreen=!1,p.style.background=L,A.iv();else{var U=o.Default.getWindowInfo();(Y||U.width!==A.getWidth()||U.height!==A.getHeight())&&(A.setX(U.left),A.setY(U.top),A.setWidth(U.width),A.setHeight(U.height),A._fullscreen=!0,A.iv(),Y=!1)}},500)}else{var I=p.style.left,G=p.style.top,x=p.style.width,O=p.style.height,L=p.style.background;L||(p.style.background="white"),p.requestFullscreen?p.requestFullscreen():p.msRequestFullscreen?p.msRequestFullscreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.webkitRequestFullscreen&&p.webkitRequestFullscreen();var V=setInterval(function(){if(p!==(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement))clearInterval(V),p.style.left=I,p.style.top=G,p.style.width=x,p.style.height=O,p.style.background=L,A.iv();else{var h=o.Default.getWindowInfo();(Y||h.width!==A.getWidth()||h.height!==A.getHeight())&&(Or(A),Y=!1)}},500)}}},appendTimeStamp:function(G){return G},setCompType:function(u,i){fp(i)||hk(i)?Ye[u]=i:Ak(u)},getCompType:function(f){var F=Ye[f];return F===Y&&np.test(f)&&Ak(f),F},getCompTypeMap:function(){return Ye},drawCompType:function(v,Q,x,y,D,L){v(Q,x,y,D,L)},numberListener:function(){var e={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(d){var z=d.keyCode;e[z]||65===z&&b.isCtrlDown(d)||86===z&&b.isCtrlDown(d)||67===z&&b.isCtrlDown(d)||88===z&&b.isCtrlDown(d)||z>=35&&40>=z||(d.shiftKey||48>z||z>57)&&(96>z||z>105)&&d.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(c){var I=c.target.tagName;("DIV"===I||"CANVAS"===I)&&!(b.ignoreKeyCodes.indexOf(c.keyCode)>=0)&&("keydown"!==c.type||pq(c)||Sf(c)||Zj(c)||Pp(c)||Cp(c)||65===c.keyCode&&(c.metaKey||c.ctrlKey))&&(c.preventDefault(),c.preventManipulation&&c.preventManipulation())},getWindowInfo:function(){var j=D.documentElement,T=j&&(j.scrollLeft||j.scrollTop)?j:D.body;return{target:T,left:T.scrollLeft,top:T.scrollTop,width:P.innerWidth||T.clientWidth,height:P.innerHeight||T.clientHeight}},isDragging:function(){return!!tb},isLeftButton:function(i){return L?!0:0===i.button},isInput:function(c){if(!c)return!1;var G=c.tagName;return"INPUT"===G||"TEXTAREA"===G||"SELECT"===G},getTouchCount:function(Z){return L?Z.touches.length:1},isDoubleClick:function(){function d(A){A.details=0,A.timeout=null,A.lastPoint=null}var C={};return function($){var l=$.button==m?"":$.button,H=$.type+l,K=H+"_isDoubleClick",M=C[H];if(M||(M=C[H]={details:0,timeout:null,lastPoint:null}),$[K]===Y){$[K]=!0;var r=Dl($);M.timeout&&(Q(M.timeout),M.timeout=null),M.lastPoint&&fr(M.lastPoint,r)>(L?20:1)&&d(M),M.lastPoint=r,M.details++,M.timeout=h(function(){d(this)}.bind(M),500)}return 2===M.details}}(),isShiftDown:function(d){return d?d.shiftKey:wd["16"]},isCtrlDown:function(O){return O?a?O.metaKey:O.ctrlKey:a?wd["91"]:wd["17"]},getClientPoint:function(P){return L&&(P=Br(P)),{x:P.clientX,y:P.clientY}},isMouseEvent:function(b){return b instanceof MouseEvent||0===b.type.indexOf("mouse")},getTargetElement:function(L){if(b.isMouseEvent(L)||!D.elementFromPoint)return L.target;var A=_r(L);return D.elementFromPoint(A.x,A.y)},getPagePoint:function(w){return L&&(w=Br(w)),{x:w.pageX,y:w.pageY}},createObject:function(_,k){var t=new _;for(var d in k)if(0===d.indexOf("s:"))t.s(d.substr(2),k[d]);else if(0===d.indexOf("a:"))t.a(d.substr(2),k[d]);else{var P=Oj(d),y=k[d];t[P]?(t[P](y),"setToolTip"===P&&t.enableToolTip&&t.enableToolTip()):t[d]=y}return t},setImage:function(x,o,a,Z){var D=arguments.length;4===D?tq(x,Z,o,a):2===D?Mq(o)?tq(x,o):jh[x]=o:1===D&&tq(x,x)},getImage:function(T,L,W){var O;if(T==m)return m;if(hk(T)?O=T:(O=jh[T],T&&O===Y&&(rm&&rm[T]||tq(T,T))),L&&O&&O.tagName){var H;H="override"===W?"colors_override":"override_rgb"===W?"colors_override_rgb":"override_a"===W?"colors_override_a":"colors",O[H]||(O[H]={__count__:0});var p=O[H][L];return p||(O[H].__count__>b.imageCacheThreshold&&(O[H]={__count__:0}),p=Mj(O,oq(L),O.width,O.height,W),O[H][L]=p,O[H].__count__++),p}return O},isImageComplete:function(s,Z,X){var l=hk(s)?s:jh[s];if(!l)return!1;if(l.tagName)return l.complete;for(var o,s,z=l.comps,N=!0,i=0,b=z.length;b>i;i++)if(o=z[i],"image"===o.type){s=o.name,s&&s.func&&(s=Nd(s,Z));var Q=Uq(s,Z,X);if(!Q){N=!1;break}}return N},getId:function(){var W=1;return function(){return++W}}(),callLater:function(o,S,J,e){var B=function(){o.apply(S,J)};return e?h(B,e):P.requestAnimationFrame(B)},asyncEach:function(O,K,p){"function"!=typeof p&&(p=Function.prototype);var S=new Array(O.length),q=0,B=!1;O.forEach(function(g,c){K(g,function(t,m){return B?void 0:t?(B=!0,p(null)):(S[c]=m,q++,q===O.length?p(S):void 0)})})},xhrLoad:function(m,W,Y){var G=!1;sc(m)||(G=!0,m=[m]),Y=Y||{},m.length;var T=Y.sync,u=!!Y.post,U=Y.data||null;nk(m,function(E,K){var N=new XMLHttpRequest;Y.responseType?N.responseType=Y.responseType:N.overrideMimeType&&N.overrideMimeType(Y.mimeType||"text/plain"),E=b.beforeLoadURL(E),E.data?K(null,E.data):(N.open(u?"POST":"GET",encodeURI(E),!T),N.onload=function(j){200===this.status||0===this.status?K(null,j.target.response||j.target.responseText):K(!0)},N.onerror=function(){K(!0)},N.send(U))},function(O){"function"==typeof W&&W(G&&O?O[0]:O)})},clone:function(z){if(null==z||"object"!=typeof z)return z;if(z instanceof Date){var Q=new Date;return Q.setTime(z.getTime()),Q}if(z instanceof Array){for(var Q=[],c=0,d=z.length;d>c;c++)Q[c]=Cf(z[c]);return Q}if(z instanceof Nf){for(var Q=new Nf,c=0,d=z.length;d>c;c++)Q.set(c,Cf(z.get(c)));return Q}if(z instanceof fc)return z;if(z instanceof u){var Q={};for(var P in z)z.hasOwnProperty(P)&&(Q[P]=Cf(z[P]));return Q}return z},callWhenLoaded:function(M,h){h=h||100;var G=nh(M,h);cr||(cr={}),cr[G]={tick:G,cb:M,delay:h}},beforeLoadURL:function(f){if(cr){var p={};for(var D in cr){var G=cr[D];Q(G.tick);var T=nh(G.cb,G.delay);p[T]={tick:T,delay:G.delay,cb:G.cb}}cr=p}return b.convertURL?b.convertURL(f):f},convertURL:function(I){return I},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(c,L){if(c===L)return 0;if(c==m&&L!=m)return 1;if(c!=m&&L==m)return-1;if(c==m&&L==m)return 0;var b,u=typeof c,f=typeof L;return u===wf&&f===wf?b=c.localeCompare(L):u===Rc&&f===Rc&&(b=c-L),b===Y&&(b=(""+c).localeCompare(""+L)),b>0?1:0>b?-1:0},getClassMap:function(){return Jp},getClass:function(V){if(Mq(V)){var y,l=Jp[V];if(!l){y=V.split("."),l=P;for(var i=0;i<y.length;i++)l=l[y[i]];Jp[V]=l}return l}return V},def:function(h,a,I){var e,q,c,s=function(){};if(s.prototype=a.prototype,e=new s,Mq(h)){if(Jp[h])throw"'"+h+"' already defined";c=hp(h),e.getClassName=function(){return h}}else c=h;if(e.constructor=c,e.getClass=function(){return c},e.getSuperClass=function(){return a},I)for(q in I)qd[q]&&qd.hasOwnProperty(q)?qd[q](e,I):Fb(e,I,q);c.prototype=e,c.superClass=a.prototype},startAnim:function(){var D=function(S){S.duration&&(S.startTime=Pj()),S.timeId=bf(S.tick,m,m,S.interval)};return function(q){return q=Cf(q),q.easing=q.easing||b.animEasing,q.duration||q.frames||(q.duration=b.animDuration),q.t=0,q.duration?q.interval=0:(q.frame=0,q.interval=q.interval||10),q.tick=function(){if(q.duration){var x=(Pj()-q.startTime)/q.duration;x>1&&(x=1),q.t=x,q.action(q.easing(x),x),1===x?q.stop():q._isPaused||(q.timeId=bf(q.tick))}else q.frame++,x=q.t=q.frame/q.frames,q.action(q.easing(x),x),q.frame<q.frames?q._isPaused||(q.timeId=bf(q.tick,m,m,q.interval)):q.stop()},q.resume=function(){q._isPaused&&(delete q._isPaused,q.duration?q.t<1&&(q.startTime=Pj()-q.duration*q.t,q.timeId=bf(q.tick)):q.frame<q.frames&&(q.timeId=bf(q.tick,m,m,q.interval)))},q.pause=function(){q._isPaused=!0},q.stop=function(M){q.isRunning()&&(q.duration?q.t<1&&M&&(q.t=1,q.action(q.easing(1))):q.frame<q.frames&&M&&(q.frame=q.frames,q.action(q.easing(1))),q._37o&&q._37o(),q.finishFunc&&q.finishFunc(),Vr(q.timeId,!q.duration),delete q.timeId)},q.isRunning=function(){return q.timeId!=m},q.delay?bf(D,m,[q],q.delay):D(q),q}}(),getTextSize:function(){var u={},L=D?dj().getContext("2d"):m;return function(r,v){L.font=r?r:_h;var X=u[L.font];return X||(X=2*L.measureText("e").width+4,u[L.font]=X),{width:L.measureText(v).width+4,height:X}}}(),drawText:function(S,V,g,I,H,y,W,D,l,v){if(V!=m){var k=gc(g,V),X={};X.y=v&&v!==tl?v===wh?y+k.height/2:y+D-k.height/2:y+D/2,X.x=l&&l!==ip?l===jf?H+W-k.width/2:H+W/2:H+k.width/2,Sh(S,V,X,g,I)}},getDistance:function(p,z){var o=p.length;return z?3===o?X(E(p[0]-z[0])+E(p[1]-z[1])+E(p[2]-z[2])):2===o?X(E(p[0]-z[0])+E(p[1]-z[1])):p.z===Y?X(E(z.x-p.x)+E(z.y-p.y)):X(E(z.x-p.x)+E(z.y-p.y)+E(z.z-p.z)):3===o?X(E(p[0])+E(p[1])+E(p[2])):2===o?X(E(p[0])+E(p[1])):void 0},brighter:function(I,K){return 0>K&&(K=-K),He(I,K?K:40)},darker:function(f,Y){return Y>0&&(Y=-Y),He(f,Y?Y:-40)},unionPoint:function(A,g){if(!A)return m;if(2===arguments.length)return A&&g?{x:R(A.x,g.x),y:R(A.y,g.y),width:w(A.x-g.x),height:w(A.y-g.y)}:m;var u=A;if(u._as&&(u=u._as),u.length===Y)return m;var V=u.length;if(0>=V)return m;for(var B=1,S=u[0],E={x:S.x,y:S.y,width:0,height:0};V>B;B++){S=u[B];var a=R(E.x,S.x),K=v(E.x+E.width,S.x),Z=R(E.y,S.y),h=v(E.y+E.height,S.y);E.x=a,E.y=Z,E.width=K-a,E.height=h-Z}return E},unionRect:function(S,A){if(S&&!A)return Cf(S);if(!S&&A)return Cf(A);if(S&&A){var p={x:R(S.x,A.x),y:R(S.y,A.y)};return p.width=v(S.x+S.width,A.x+A.width)-p.x,p.height=v(S.y+S.height,A.y+A.height)-p.y,p}return m},containsPoint:function(f,N,E,u){if(u!=m&&1!==u){var i=f.x+f.width/2,T=f.y+f.height/2;f={x:i-f.width/2*u,y:T-f.height/2*u,width:f.width*u,height:f.height*u}}if(E){var U=f.width/2,t=f.height/2,H=A(-E),d=G(-E),z=N.x-f.x-U,Z=N.y-f.y-t;return N={x:d*z-H*Z,y:H*z+d*Z},qf({x:-U,y:-t,width:f.width,height:f.height},N)}return!(!f||N.x<f.x||N.y<f.y||N.x>f.x+f.width||N.y>f.y+f.height)},containsRect:function(e,q){if(!e||!q)return!1;var L=q.x,Z=q.y,d=q.width,R=q.height,P=e.width,n=e.height;if(0>(P|n|d|R))return!1;var B=e.x,I=e.y;if(B>L||I>Z)return!1;if(P+=B,d+=L,L>=d){if(P>=B||d>P)return!1}else if(P>=B&&d>P)return!1;if(n+=I,R+=Z,Z>=R){if(n>=I||R>n)return!1}else if(n>=I&&R>n)return!1;return!0},intersectsRect:function(g,O){if(!g||!O)return!1;var y=O.width,B=O.height,R=g.width,F=g.height;if(0>=R||0>=F||0>=y||0>=B)return!1;var G=O.x,E=O.y,r=g.x,h=g.y;return R+=r,F+=h,y+=G,B+=E,R>G&&F>E&&y>r&&B>h},intersection:function(X,z){if(!X||!z)return m;var b=z.x,K=z.y,k=X.x,f=X.y,B=b,G=K,O=k,Z=f;return B+=z.width,G+=z.height,O+=X.width,Z+=X.height,k>b&&(b=k),f>K&&(K=f),B>O&&(B=O),G>Z&&(G=Z),B-=b,G-=K,0>=B||0>=G?m:{x:b,y:K,width:B,height:G}},grow:function(Q,q,S){S===Y&&(S=q),Q.x-=q,Q.y-=S,Q.width=Q.width+2*q,Q.height=Q.height+2*S},getLogicalPoint:function(Z,m,J,l,s,o){fo(Z)?a?wd["91"]=!0:wd["17"]=!0:a?wd["91"]=!1:wd["17"]=!1,wd["16"]=gg(Z)?!0:!1;var b=m.getBoundingClientRect();return Z=L?Br(Z):Z,{x:(Z.clientX-b.left+m.scrollLeft-(J||0))/(s||1),y:(Z.clientY-b.top+m.scrollTop-(l||0))/(o||1)}},removeHTML:function(){var H;return function(v){return v&&v.parentNode?H===v?!0:(H=v,v.parentNode.removeChild(v),H=m,!0):!1}}(),getToolTipDiv:function(){if(!Pl){Pl=gd(),Ai=gd();var L=Pl.style;b.baseZIndex!=m&&(L.zIndex=C(b.baseZIndex)+3+""),L.whiteSpace="nowrap",L.color=b.toolTipLabelColor,L.background=b.toolTipBackground,L.font=b.toolTipLabelFont,L.padding="5px",L.boxShadow="0px 0px 3px "+b.toolTipShadowColor}return Pl},isToolTipShowing:function(){return Pl&&Pl.parentNode?!0:Ai&&Ai.parentNode?!0:!1},hideToolTip:function(){bd(Pl),bd(Ai),Ah()},showToolTip:function(a,J){if(!a||J==m)return Sl(),void 0;b.getToolTipDiv();var c,n;if(J.html?(J=J.html,c=Ai,bd(Pl)):(c=Pl,bd(Ai)),n=c.style,c.innerHTML=J,c.parentNode||o.Default.appendToScreen(c),a.target){a=_r(a);var P=eo(),Z=a.x,T=a.y,d=L?60:12;if(L){var j=c.getBoundingClientRect();n.left=Z-j.width/2+se,n.top=T-j.height-d<P.top?T+d+se:T-j.height-d+se}else{n.left=Z+d+se,n.top=T+d+se;var j=c.getBoundingClientRect();j.left+j.width>P.width&&(n.left=Z-d-j.width+se),j.top+j.height>P.height&&(n.top=T-d-j.height+se),j.left<0&&(n.left=Z+d+se),j.top<0&&(n.top=T+d+se)}}else n.left=a.x+se,n.top=a.y+se;Ah()},startDragging:function(d,i){d!==tb&&(tb?L?tb.handleWindowTouchEnd(i):tb.handleWindowMouseUp(i):L?(P.addEventListener(Xf,sn,!1),P.addEventListener(Tm,Ek,!1)):(P.addEventListener(fh,tm,!1),P.addEventListener(yf,Ci,!1)),tb=d)},getImageMap:function(){return jh},toBoundaries:function(F,g,u,M){var D=[];return Bp(F,g,u,M).forEach(function(m){var C=[];m.forEach(function(q){C.push(q.x,q.y)}),D.push(C)}),D},getCurrentKeyCodeMap:function(){return wd},drawCenterImage:function(y,m,F,O,r,B,l,Y){var Q=Jb(m,r,B),e=vr(m,r,B);Dm(y,m,W(F-Q/2),W(O-e/2),Q,e,r,B,l,Y)},drawStretchImage:function(K,z,j,$,f,a,d,H,m,J,n,l){var G,E=Jb(z,H,m,a),F=vr(z,H,m,d);if("uniform"===j?(G=R(a/E,d/F),E*=G,F*=G,$+=W((a-E)/2),f+=W((d-F)/2),a=E,d=F):"centerUniform"===j&&((E>a||F>d)&&(G=R(a/E,d/F),E*=G,F*=G),$+=W((a-E)/2),f+=W((d-F)/2),a=E,d=F),"center"===j){var X=n!==!1&&(E>a||F>d);X&&(K.save(),K.beginPath(),K.rect($,f,a,d),K.clip()),Dm(K,z,$+a/2-E/2,f+d/2-F/2,E,F,H,m,J,l),X&&K.restore()}else Dm(K,z,$,f,a,d,H,m,J,l)},toCanvas:function(i,M,h,d,v,$,P,f,c){i=Se(i,P),M=M||Jb(i,v),h=h||vr(i,v);var G=dj(),p=xd(G);return f?(Xe(G,M,h,f),p.scale(f,f)):Xe(G,M,h,1),Mc(p,i,d,0,0,M,h,v,$,P,c),i&&i.clampToEdge&&(G.clampToEdge=i.clampToEdge),p.restore(),G},createGradientImage:function(v,A,$,D){for(var G=["L",0,0,v,0,1,0,0,1,0,0],w=0,c=Math.min(A.length,$.length);c>w;w++)G.push($[w],A[w]);
var W=o.Default.toCanvas({width:v,height:v,clampToEdge:!0,comps:[{type:"shape",rotation:D||0,points:[0,0,v,0,v,v,0,v],background:"#ffffff",gradientPack:G}]});return W},createElement:function(Z,G,I,T){var z=D.createElement(Z);return Vg(z,G||s.widgetBorder,2),z.style.font=I?I:_h,T!=m&&(z.value=T),b.onElementCreated&&b.onElementCreated(z),z},containedInView:function(o,T){var C=$b(T).getBoundingClientRect();return qf({x:C.left,y:C.top,width:C.width,height:C.height},Dl(o))},isIsolating:function(){return yq},setIsolating:function(S){yq=S},getMSMap:function(){return qd},stringify:function(e,a){var s=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var T=JSON.stringify(e,function(X,V){return"function"==typeof V?"__ht__"+(V.__ht__||V.toString()):Wj(V)?Pr(V):V},a==m?2:a);return Date.prototype.toJSON=s,T},parse:function(r){return Mq(r)?JSON.parse(r,function(E,X){if(Mq(X)){if("__ht__function"==X.substr(0,14)){var p=X.indexOf("{")+1,h=X.lastIndexOf("}"),B=X.indexOf("(")+1,f=X.indexOf(")");if(p&&h&&B&&f){var S=new Function(X.substring(B,f),X.substring(p,h));return S.__ht__=X.substr(6),S}}if("__ht__date"==X.substr(0,10))return new Date(C(X.substr(10)))}return X}):r},loadJS:function(i,a){a&&i.push(a);var r=i.shift();if(sc(r))i=r.contact(i),b.loadJS(i);else if(fp(r))r(),b.loadJS(i);else if(Mq(r)){var C=D.createElement("script");C.onload=function(){b.loadJS(i)},C.setAttribute("src",r),D.getElementsByTagName("head")[0].appendChild(C)}else i.length&&b.loadJS(i)},toRoundedCorner:function(u,F){var o=u.size();if(0>=F)return{points:u};var e,B=new Nf,W=new Nf,m=u.get(0);B.add(m),W.add(1);for(var J=1;o>J;J++)if(o>J+1){var N=u.get(J),q=u.get(J+1),T=m.x,n=m.y,I=N.x,C=N.y,i=C-n,j=I-T,Z=r(i,j);e=R(.99*fr(m,N),F),B.add({x:I-e*G(Z),y:C-e*A(Z)}),B.add(N),T=N.x,n=N.y,I=q.x,C=q.y,i=C-n,j=I-T,Z=r(i,j),e=R(.99*fr(N,q),F),m={x:T+e*G(Z),y:n+e*A(Z)},B.add(m),W.addAll([2,3])}else B.add(u.get(J)),W.add(2);return{points:B,segments:W}},toColorData:wj,setCanvas:Xe,createDiv:gd,createDisabledDiv:dr,createView:xf,createCanvas:dj,appendChild:ts,initContext:xd,checkLoadingImage:mh,translateAndScale:ti,layout:Or,getPosition:wq,drawPoints:Tj,drawRoundRect:yc,drawBorder:Af,setFocus:Ad,getter:md,setter:Oj,isEmptyObject:Dk},!0),mm(n,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Mb=b.disabledOpacity,Vo=b.toolTipDelay,Cr=b.devicePixelRatio,ks=b.autoMakeVisible,dq=b.autoHideScrollBar,Cj=b.imageGradient,vh=b.showToolTip,Sl=b.hideToolTip,qj=b.dashPattern,rr=b.lineCap,Iq=b.lineJoin,Ol=b.labelColor,Ac=b.labelSelectColor,_h=b.labelFont,Yp=b.widgetIndent,Mg=b.widgetRowHeight,mb=b.widgetHeaderHeight,fg=b.widgetTitleHeight,Tg=b.scrollBarColor,_n=b.scrollBarSize,Mk=b.scrollBarTimeout,Sn=b.scrollBarMinLength,ps=b.scrollBarInteractiveSize,As=b.zoomIncrement,Wk=b.scrollZoomIncrement,Hi=b.pinchZoomIncrement,Pn=b.zoomMax,Df=b.zoomMin,Ii=b.createObject,db=b.preventDefault,lj=b.setImage,Se=b.getImage,Uq=b.isImageComplete,Yi=b.drawCenterImage,Mc=b.drawStretchImage,vd=b.getId,bf=b.callLater,nk=b.asyncEach,_f=(b.xhrLoad,b.sortFunc),Cf=b.clone,hp=b.getClass,yn=b.startAnim,wm=b.brighter,Ri=b.darker,ci=b.drawText,gc=b.getTextSize,zj=b.isLeftButton,rn=b.getTouchCount,qc=b.isDoubleClick,gg=b.isShiftDown,fo=b.isCtrlDown,Dl=b.getClientPoint,_r=b.getPagePoint,fr=b.getDistance,Td=b.unionPoint,_m=b.unionRect,qf=b.containsPoint,lo=b.containsRect,Lb=b.intersectsRect,Cd=b.intersection,eo=b.getWindowInfo,xb=b.grow,Pq=b.getLogicalPoint,Qc=b.startDragging,bd=b.removeHTML,Xr=b.createElement,pe=b.segmentResolution,Tp=b.shapeResolution,vq=b.shapeSide,Uo=b.def,_q=function(n,C,w){Uo($+"."+n,C,w)},Vn=function(r,T){r.childNodes.forEach(function(z){T(z),Vn(z,T)})};mm(b,{toolTipLabelColor:Ol,toolTipLabelFont:_h,toolTipBackground:s.toolTipBackground,toolTipShadowColor:Zp,drawBreakableText:Ko,setDevicePixelRatio:function(t){Cr=b.devicePixelRatio="number"==typeof t?t:P.devicePixelRatio,Vn(D.body,function(I){var F=I._ht;F&&F._canvas&&(Xe(F._canvas,F.getWidth(),F.getHeight()),F.redraw?F.redraw():F.iv())})}},!0);var kc=1e-6,yj="undefined"!=typeof Uint16Array?Uint16Array:Array,ck="undefined"!=typeof Float32Array?Float32Array:Array,xl=function(n,e,m){var p=[n[0]-e[0],n[1]-e[1],n[2]-e[2]];if(m){var I=fr(p);I>0&&(p[0]/=I,p[1]/=I,p[2]/=I)}return p},xo=function(Y){return[-Y[0],-Y[1],-Y[2]]},Xo=function(e,v){return 3===e.length?e[0]*v[0]+e[1]*v[1]+e[2]*v[2]:e[0]*v[0]+e[1]*v[1]},vc=function(){var s=new ck(16);return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},bj=vc(),le=function(A){var P=new ck(16);return P[0]=A[0],P[1]=A[1],P[2]=A[2],P[3]=A[3],P[4]=A[4],P[5]=A[5],P[6]=A[6],P[7]=A[7],P[8]=A[8],P[9]=A[9],P[10]=A[10],P[11]=A[11],P[12]=A[12],P[13]=A[13],P[14]=A[14],P[15]=A[15],P},Zo=function(n,b){return n[0]=b[0],n[1]=b[1],n[2]=b[2],n[3]=b[3],n[4]=b[4],n[5]=b[5],n[6]=b[6],n[7]=b[7],n[8]=b[8],n[9]=b[9],n[10]=b[10],n[11]=b[11],n[12]=b[12],n[13]=b[13],n[14]=b[14],n[15]=b[15],n},uh=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},zh=function(L,C){var V=L[0],E=L[1],i=L[2];return L[0]=C[0]*V+C[4]*E+C[8]*i+C[12],L[1]=C[1]*V+C[5]*E+C[9]*i+C[13],L[2]=C[2]*V+C[6]*E+C[10]*i+C[14],L},Rd=function(F,s){var f=F[0],i=F[1],d=F[2],g=F[3];return F[0]=s[0]*f+s[4]*i+s[8]*d+s[12]*g,F[1]=s[1]*f+s[5]*i+s[9]*d+s[13]*g,F[2]=s[2]*f+s[6]*i+s[10]*d+s[14]*g,F[3]=s[3]*f+s[7]*i+s[11]*d+s[15]*g,F},ln=function(){var Q,n,A,a,y=_p(Zq[1]+Zq[7]),P=_p(Zq[0]+Zq[3]-Zq[10]),r=_p(Zq[8]+2),q=function(){return n=A.charAt(Q),Q+=1,n},M=function(){var B="";if(n===r)for(;q();){if(n===r)return q(),B;B+=n}else q()},u=function(){for(;n&&" ">=n;)q()},O=function(){var m,B={};if(n===y){if(q(),u(),n===P)return q(),B;for(;n;){if(m=M(),u(),q(),B[m]=a(),u(),n===P)return q(),B;q(),u()}}};return a=function(){switch(u(),n){case y:return O();default:return M()}},function(d){if(U={},d){var K;if(A=d,Q=0,n=" ",K=a(),u(),!n)return K}}}(),ue=function(Y,S){if(S){var I=A(S),Q=G(S),R=Y[4],P=Y[5],J=Y[6],q=Y[7],g=Y[8],e=Y[9],h=Y[10],x=Y[11];Y[4]=R*Q+g*I,Y[5]=P*Q+e*I,Y[6]=J*Q+h*I,Y[7]=q*Q+x*I,Y[8]=g*Q-R*I,Y[9]=e*Q-P*I,Y[10]=h*Q-J*I,Y[11]=x*Q-q*I}},Lo=function(W,w){if(w){var Y=A(w),z=G(w),g=W[0],d=W[1],n=W[2],r=W[3],B=W[8],c=W[9],l=W[10],I=W[11];W[0]=g*z-B*Y,W[1]=d*z-c*Y,W[2]=n*z-l*Y,W[3]=r*z-I*Y,W[8]=g*Y+B*z,W[9]=d*Y+c*z,W[10]=n*Y+l*z,W[11]=r*Y+I*z}},xh=function(R,g){if(g){var k=A(g),r=G(g),$=R[0],s=R[1],w=R[2],S=R[3],f=R[4],Z=R[5],B=R[6],V=R[7];R[0]=$*r+f*k,R[1]=s*r+Z*k,R[2]=w*r+B*k,R[3]=S*r+V*k,R[4]=f*r-$*k,R[5]=Z*r-s*k,R[6]=B*r-w*k,R[7]=V*r-S*k}},ak=function(a,F,R){return am(m,R===!1?m:a.getFinalScale3d(),a.r3(),a.getRotationMode(),a.p3(),m,F)},am=function(o,T,s,U,Q,h,N){return h||(h=vc()),Q&&bl(h,Q),ei(h,s,U),N&&Mo(h,h,N),T&&ns(h,T),o&&Mo(h,h,o),h},dl=function(z,d,l){d=C(d),l=C(l);var q=this;q.g=z,q._84O=d,q._85O=l,q._70I=!0,q.F=0,q._83O=d+l,q.pen={x:0,y:0}},Kr="lineDashOffset",Ul="setLineDash",El=function(h){for(var z in h)1===z.length&&(Kr=h[z]);return z?1:0},kk=function(Y,B,r){return rk(B)?Y:Y[Ul]?(Y[Ul](B),r&&(Y.lineDashOffset=r),Y):new dl(Y,B[0],B.length>1?B[1]:B[0])},Cg=function(A,P){!rk(P)&&A[Ul]&&(A[Ul](Xn),A.lineDashOffset=0)};if(Uo(dl,u,{_69I:6,moveTo:function(Y,B){var $=this,U=$.pen;U.x=Y,U.y=B,$.g.moveTo(Y,B),$.start||($.start={x:Y,y:B})},lineTo:function(W,o){var H=this,$=H.pen,S=W-$.x,J=o-$.y,C=r(J,S),e=G(C),Z=A(C),d=H._23O($.x,$.y,W,o),U=H._85O,D=H._84O,V=H._83O;if(H.F){if(H.F>d)return H._70I?H._72I(W,o):H.moveTo(W,o),H.F-=d,void 0;if(H._70I?H._72I($.x+e*H.F,$.y+Z*H.F):H.moveTo($.x+e*H.F,$.y+Z*H.F),d-=H.F,H.F=0,H._70I=!H._70I,!d)return}var L=f(d/V);if(L){for(var c=e*D,K=Z*D,l=e*U,w=Z*U,n=0;L>n;n++)H._70I?(H._72I($.x+c,$.y+K),H.moveTo($.x+l,$.y+w)):(H.moveTo($.x+l,$.y+w),H._72I($.x+c,$.y+K));d-=V*L}H._70I?d>D?(H._72I($.x+e*D,$.y+Z*D),H.moveTo(W,o),H.F=U-(d-D),H._70I=!1):(H._72I(W,o),d===D?(H.F=0,H._70I=!H._70I):(H.F=D-d,H.moveTo(W,o))):d>U?(H.moveTo($.x+e*U,$.y+Z*U),H._72I(W,o),H.F=D-(d-U),H._70I=!0):(H.moveTo(W,o),d===U?(H.F=0,H._70I=!H._70I):H.F=U-d)},quadraticCurveTo:function(K,v,Z,i){var w,E=this,Y=E.pen,R=Y.x,g=Y.y,O=E._22O(R,g,K,v,Z,i),b=0,I=0,H=E._85O,k=E._84O;if(E.F){if(E.F>O)return E._70I?E._71I(K,v,Z,i):E.moveTo(Z,i),E.F-=O,void 0;if(b=E.F/O,w=E._20O(R,g,K,v,Z,i,b),E._70I?E._71I(w[2],w[3],w[4],w[5]):E.moveTo(w[4],w[5]),E.F=0,E._70I=!E._70I,!O)return}var l=O-O*b,W=f(l/E._83O),z=k/O,D=H/O;if(W)for(var C=0;W>C;C++)E._70I?(I=b+z,w=E._21O(R,g,K,v,Z,i,b,I),E._71I(w[2],w[3],w[4],w[5]),b=I,I=b+D,w=E._21O(R,g,K,v,Z,i,b,I),E.moveTo(w[4],w[5])):(I=b+D,w=E._21O(R,g,K,v,Z,i,b,I),E.moveTo(w[4],w[5]),b=I,I=b+z,w=E._21O(R,g,K,v,Z,i,b,I),E._71I(w[2],w[3],w[4],w[5])),b=I;l=O-O*b,E._70I?l>k?(I=b+z,w=E._21O(R,g,K,v,Z,i,b,I),E._71I(w[2],w[3],w[4],w[5]),E.moveTo(Z,i),E.F=H-(l-k),E._70I=!1):(w=E._19O(R,g,K,v,Z,i,b),E._71I(w[2],w[3],w[4],w[5]),O===k?(E.F=0,E._70I=!E._70I):(E.F=k-l,E.moveTo(Z,i))):l>H?(I=b+D,w=E._21O(R,g,K,v,Z,i,b,I),E.moveTo(w[4],w[5]),w=E._19O(R,g,K,v,Z,i,I),E._71I(w[2],w[3],w[4],w[5]),E.F=k-(l-H),E._70I=!0):(E.moveTo(Z,i),l===H?(E.F=0,E._70I=!E._70I):E.F=H-l)},bezierCurveTo:function(){var A=arguments;this.pen={x:A[4],y:A[5]},this.g.bezierCurveTo(A[0],A[1],A[2],A[3],A[4],A[5])},arc:function(K,R,U,g,V,N){N||(g=-g,V=-V),mi(this,K,R,g,V-g,U,U,!1)},rect:function(Q,$,D,l){var m=this;m.pen={x:Q,y:$},m.moveTo(Q,$),m.lineTo(Q,$+l),m.lineTo(Q+D,$+l),m.lineTo(Q+D,$),m.lineTo(Q,$)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(v,U,$,h){var c=$-v,z=h-U;return X(c*c+z*z)},_22O:function(I,B,w,_,J,X,O){for(var z,q,L,j,R,g,k,h=0,m=I,s=B,d=O>0?O:this._69I,Q=1;d>=Q;Q++)L=Q/d,j=1-L,R=j*j,g=2*L*j,k=L*L,z=R*I+g*w+k*J,q=R*B+g*_+k*X,h+=this._23O(m,s,z,q),m=z,s=q;return h},_21O:function(_,y,o,f,N,Y,U,j){var w=this;if(0===U)return w._20O(_,y,o,f,N,Y,j);if(1===j)return w._19O(_,y,o,f,N,Y,U);var O=w._20O(_,y,o,f,N,Y,j);return O.push(U/j),w._19O.apply(w,O)},_20O:function(u,c,Z,n,K,p,w){if(1!==w){var h=Z+(K-Z)*w,G=n+(p-n)*w;Z=u+(Z-u)*w,n=c+(n-c)*w,K=Z+(h-Z)*w,p=n+(G-n)*w}return[u,c,Z,n,K,p]},_19O:function(X,H,T,y,W,M,i){if(1!==i){var O=X+(T-X)*i,w=H+(y-H)*i;T+=(W-T)*i,y+=(M-y)*i,X=O+(T-O)*i,H=w+(y-w)*i}return[X,H,T,y,W,M]},_72I:function(e,T){var m=this.pen;(e!==m.x||T!==m.y)&&(m.x=e,m.y=T,this.g.lineTo(e,T))},_71I:function(E,b,r,Y){var X=this.pen;(E!==r||b!==Y||r!==X.x||Y!==X.y)&&(X.x=r,X.y=Y,this.g.quadraticCurveTo(E,b,r,Y))}}),B&&l){var yp=l.toString();O=yp.indexOf(wr.substr(0,2))>0&&yp.indexOf(wh+wh.substr(1,1))>1?!0:!1}var Sp=m,te=m,Gg=function(A){Sp&&!A._72O&&(te||(te={}),te[A._72O=vd()]=A)},Ak=function(W,e){if(e||(e=W),e&&(Sp||(Sp={}),!Sp[W])){var w=new XMLHttpRequest;if(Sp[e]={request:w,url:e},w.overrideMimeType&&w.overrideMimeType("text/plain"),e=b.beforeLoadURL(e),e.data){var s=b.parse(e.data);pj(W,s),b.handleCompTypeLoaded(W,s)}else w.open("GET",encodeURI(e),!0),w.onload=function(o){if(200===this.status||0===this.status){var I=b.parse(o.target.response||o.target.responseText);pj(W,I),b.handleCompTypeLoaded(W,I)}else pj(W,m)},w.onerror=function(){pj(W,m)},w.send(null)}},pj=function(p,H){if(Ye[p]=H,delete Sp[p],Dk(Sp)&&(Sp=m,te)){for(var q in te){var a=te[q];a.invalidateAll&&a.invalidateAll(Y,"compTypeLoaded",p),a.redraw&&a.redraw(),a.iv(),delete a._72O}te=m}if(H&&te)for(var q in te){var a=te[q];a.invalidateAll&&a.invalidateAll(Y,"compTypeLoading",p),a.redraw&&a.redraw(),a.iv()}},os=s.chart,rb=b.compStack=[],wg=/^style@/,xq=/^attr@/,zo=/^field@/,Sm={x:.5,y:.5},Jb=function(g,N,E,C){if(!g)return 0;if(Nd(g.fitSize,N,E)&&C)return C;var x=Nd(g.width,N,E);return null==x?20:x},vr=function(U,n,C,v){if(!U)return 0;if(Nd(U.fitSize,n,C)&&v)return v;var m=Nd(U.height,n,C);return null==m?20:m},Nd=function(V,$,i){if(!V||!V.func)return V;var x,H=V.func,w=V.value;return x=fp(H)?i&&i.vectorDataBindingDisabled&&!V.isSafeFunc?w:H($,i):$ instanceof fc?xq.test(H)?$.a(H.slice(5)):wg.test(H)?$.s(H.slice(6)):zo.test(H)?$[H.slice(6)]:$[H]?$[H](i):w:w,w!==Y&&x==m?w:x},Dm=b.drawImage=function(){var i,H,Z,V,L,F,s=function(X,p){X.getValue&&X.getValue.compType===p||(X.getValue=function(o){var K=N(X,o);if(K===Y&&p.properties){var P=p.properties[o];P&&(K=P.defaultValue)}return K},X.getValue.compType=p)},N=function(c,A,w){var U=c[A];return U&&U.func?(U=Nd(U,H,Z),w&&(U=w(U))):w&&(U=c[A]=w(U)),U},o=function(t,m){var b;if(b=m?N(t,m):t,L&&b){if("override"===F)return L;if("override_rgb"===F){var y=oq(L);return b=wj(b),"rgba("+f(255*y[0])+","+f(255*y[1])+","+f(255*y[2])+","+b[3]/255+")"}if("override_a"===F){var y=oq(L);return b=wj(b),"rgba("+b[0]+","+b[1]+","+b[2]+","+y[3]+")"}var y=oq(L);return b=wj(b),"rgba("+f(b[0]*y[0])+","+f(b[1]*y[1])+","+f(b[2]*y[2])+","+b[3]/255*y[3]+")"}return b},r=function(r){if(sc(r)){for(var S=new Nf,$=r.length,p=0;$>p;p+=2)S.add({x:r[p],y:r[p+1]});r=S}return r},$=function(R){var y=N(R,"anchorX"),U=N(R,"anchorY");if(y!==Y||U!==Y)return{x:y===Y?Sm.x:y,y:U===Y?Sm.y:U};var L=N(R,"type"),C=N(R,"name");if("image"!==L||!C)return Sm;var x=Se(C);return x&&x.anchorX&&x.anchorY?{x:x.anchorX,y:x.anchorY}:Sm},e=function(P,X){var V=N(P,fj),O=$(P);if(sc(V)){var D=V.length,t=N(P,"relative"),W=X.width,u=X.height;if(4===D)V={x:V[0],y:V[1],width:V[2],height:V[3]},t?(V.x*=W,V.y*=u,V.width*=W,V.height*=u):X.fitSize&&(V.x*=X.widthScale,V.width*=X.widthScale,V.y*=X.heightScale,V.height*=X.heightScale);else if(3===D){var I=V[0];V={width:V[1],height:V[2]},t?(V.width*=W,V.height*=u):X.fitSize&&(V.width*=X.widthScale,V.height*=X.heightScale),"object"==typeof I?I.length&&(I={x:I[0],y:I[1]}):I=wq(I,X,V),V.x=I.x-V.width*O.x,V.y=I.y-V.height*O.y}var B=N(P,"offsetX");B&&(X.fitSize&&(B*=X.widthScale),V.x+=B),B=N(P,"offsetY"),B&&(X.fitSize&&(B*=X.heightScale),V.y+=B)}return V},S=function(R){return sc(R)?new Nf(R):R},T=function(u,S,k,D,d,h,V){d===Y&&(d=1),h===Y&&(h=1);var c=N(u,"clipPercentage"),m=Pe(k,S);if(m&&!D&&1===d&&1===h&&!(1>c))return!1;V=V||Sm;var B=S.x+S.width*V.x,G=S.y+S.height*V.y,F=k.x+k.width*V.x,n=k.y+k.height*V.y;if(i.save(),Mi(i,B,G),zg(i,D),uo(i,d*(S.width/k.width),h*(S.height/k.height)),Mi(i,-F,-n),1>c){0>c&&(c=0);var K=Ro(k,N(u,"clipDirection"),c);i.beginPath(),i.rect(K.x,K.y,K.width,K.height),i.clip()}return!0},_=function(){i.restore()},j=function(c,P,y){var h=N(c,"path"),b=N(c,Ed),w=N(c,"scaleX"),E=N(c,"scaleY"),W=$(c),u=m,R=je(null,h);if(y||(y=c.unionRect,y||(y=Td(R),c.path.func||(c.unionRect=y)),u=y),y){u||(u=c.unionRect,u||(u=Td(R),c.path.func||(c.unionRect=u)));var A=T(c,y,u,b,w,E,W),t=N(c,"borderPattern"),I=kk(i,t),L=o(c,"background"),l=o(c,"borderColor"),Q=N(c,"borderWidth"),z=N(c,"gradient"),J=o(c,"gradientColor"),D=N(c,"border3d"),v=N(c,"border3dColor"),e=N(c,"border3dAccuracy"),k=i.lineJoin,H=i.lineCap;if(i.lineJoin=N(c,"borderJoin")||Iq,i.lineCap=N(c,"borderCap")||rr,L?(ee(i,L,z,J,u),je(i,h),i.fill(),I!==i&&je(i,h)):je(i,h),Q&&l){var X=N(c,"borderWidthAbsolute");X&&(i.save(),i.setTransform(1,0,0,1,0,0)),i.lineWidth=Q,i.strokeStyle=l,i.stroke(),X&&i.restore(),D&&Gi(i,l,v,Q,V,e)}if(Cg(i,t),N(c,"dash")){var f=N(c,"dashWidth")||Q;if(f>0){t=N(c,"dashPattern")||qj;var I=kk(i,t,N(c,"dashOffset")),C=o(c,"dashColor")||o(lh);I!==i&&je(i,h),i.strokeStyle=C,i.lineWidth=f,i.stroke(),N(c,"dash3d")&&Gi(i,C,o(c,"dash3dColor"),f,V,N(c,"dash3dAccuracy")),Cg(i,t)}}P===fj&&sr(i,L,N(c,"depth"),u),i.lineJoin=k,i.lineCap=H,A&&_()}},c=function(I,v,e,K){var x=N(I,_l,r),u=N(I,Ed),f=$(I);if(x&&K.fitSize){var E=Math.abs(Math.cos(u))<.001,U=new Nf,z=Td(x),w=K.widthScale,R=K.heightScale,k=z.x+f.x*z.width,n=z.y+f.y*z.height,D=k*w,q=n*R;x.each(function(C){var T=C.x-k,z=C.y-n;U.add({x:D+T*(E?R:w),y:q+z*(E?w:R)})}),x=U,I.unionRect=null}var l=N(I,"scaleX"),O=N(I,"scaleY"),B=v===Cb,y=m;if(!e&&B&&(e=I.unionRect,e||(e=Td(x),I.points.func||(I.unionRect=e)),y=e),e){B?y||(y=I.unionRect,y||(y=Td(x),I.points.func||(I.unionRect=y))):y=e;var C,J,j,p,s=T(I,e,y,u,l,O,f),t=N(I,"borderPattern"),Q=kk(i,t),G=o(I,"background"),h=Se(N(I,"repeatImage"),L,F),M=N(I,"gradientPack"),W=o(I,"borderColor"),A=N(I,"borderWidth"),Y=N(I,"segments",S),b=N(I,"gradient"),P=o(I,"gradientColor"),X=N(I,"border3d"),c=N(I,"border3dColor"),d=N(I,"border3dAccuracy"),g=N(I,"closePath"),a=N(I,"fillRule")||"nonzero",mp=i.lineJoin,Sj=i.lineCap;if(i.lineJoin=N(I,"borderJoin")||Iq,i.lineCap=N(I,"borderCap")||rr,B)if(G||h||M){var us=N(I,"fillClipPercentage");if(1>us){0>us&&(us=0);var dg=Ro(y,N(I,"fillClipDirection"),us);i.save(),i.beginPath(),i.rect(dg.x,dg.y,dg.width,dg.height),i.clip()}if(Tj(i,x,Y,g),M)on(i,M);else if(h){var Tm=i,vn=L,Of=F;Cm(i,h,L,F,H,Z),i=Tm,L=vn,F=Of}else{var Tm=i;ee(i,G,b,P,y),i=Tm}i.fill(a),1>us&&i.restore(),M&&i.restore(),Q!==i&&Tj(Q,x,Y,g)}else Tj(Q,x,Y,g);else if("roundRect"===v?C=N(I,"cornerRadius"):"polygon"===v?C=N(I,"polygonSide"):"arc"===v&&(C=N(I,"arcFrom"),J=N(I,"arcTo"),j=N(I,"arcClose"),p=N(I,"arcOval")),G||h||M){var us=N(I,"fillClipPercentage");if(1>us){0>us&&(us=0);var dg=Ro(y,N(I,"fillClipDirection"),us);i.save(),i.beginPath(),i.rect(dg.x,dg.y,dg.width,dg.height),i.clip()}if(gn(i,v,y,C,J,j,p),M)on(i,M);else if(h){var Tm=i,vn=L,Of=F;Cm(i,h,L,F,H,Z),i=Tm,L=vn,F=Of}else ee(i,G,b,P,y);i.fill(a),1>us&&i.restore(),M&&i.restore(),i!==Q&&gn(Q,v,y,C,J,j,p)}else gn(Q,v,y,C,J,j,p);if(A&&W){var qk=N(I,"borderWidthAbsolute");qk&&(i.save(),i.setTransform(1,0,0,1,0,0)),i.lineWidth=A,i.strokeStyle=W,i.stroke(),qk&&i.restore(),X&&Gi(i,W,c,A,V,d)}if(Cg(i,t),N(I,"dash")){var We=N(I,"dashWidth")||A;if(We>0){t=N(I,"dashPattern")||qj;var Q=kk(i,t,N(I,"dashOffset")),jb=o(I,"dashColor")||o(lh);Q!==i&&(B?Tj(Q,x,Y,g):gn(Q,v,y,C,J,j,p)),i.strokeStyle=jb,i.lineWidth=We,i.stroke(),N(I,"dash3d")&&Gi(i,jb,o(I,"dash3dColor"),We,V,N(I,"dash3dAccuracy")),Cg(i,t)}}v===fj&&sr(i,G,N(I,"depth"),y),i.lineJoin=mp,i.lineCap=Sj,s&&_()}},q=function(b,I){var y=L,R=F,q=L||N(b,yk),o=F||N(b,"blendMode"),m=Se(N(b,"name"),q,o);m&&(Mc(i,m,N(b,"stretch"),I.x,I.y,I.width,I.height,H,Z,q,null,o),L=y,F=R)},a=function(T,d){var K=N(T,"text");K!=m&&ci(i,K,N(T,"font"),o(T,yk),d.x,d.y,d.width,d.height,N(T,"align"),N(T,"vAlign"))},J=function(R,J){Af(i,o(R,yk),J.x,J.y,J.width,J.height,N(R,"width"))},z=function(Y,x){var S=N(Y,sq),p=0;if(S&&(S.forEach(function(l){p+=l}),p>0)){for(var U=N(Y,"colors")||os,o=N(Y,"startAngle")||0,w=N(Y,"hollow"),g=N(Y,yr),$=N(Y,Bi),Z=N(Y,of),C=g?new Nf:m,I=x.x,j=x.y,F=x.width,T=x.height,l=I+F/2,y=j+T/2,a=R(F,T)/2,u=0,P=0;P<S.length;P++){var K=S[P],q=k*K/p,e=o+q;if(i.fillStyle=U[u++],u===U.length&&(u=0),i.beginPath(),w){var d=l+G(o)*a/2,t=y+A(o)*a/2,f=l+G(e)*a,Q=y+A(e)*a;i.moveTo(d,t),i.arc(l,y,a/2,o,e,!1),i.lineTo(f,Q),i.arc(l,y,a,e,o,!0)}else i.moveTo(l,y),i.arc(l,y,a,e,o,!0);C&&(q=(o+e)/2,C.add({text:fp(g)?g(K,P,p,H):K,x:l+.75*G(q)*a,y:y+.75*A(q)*a})),i.closePath(),i.fill(),o=e}C&&C.each(function(G){ci(i,G.text,$,Z,G.x,G.y,0,0,Im)})}},l=function(M,t){var T=N(M,om);if(T&&T.length>0){var $=T.length,h=N(M,yr),_=N(M,Bi),a=N(M,of),q=h?new Nf:m,u=N(M,"minValue")||0,p=N(M,"maxValue");if(p==m&&(p=0,T.forEach(function(r){r.values.forEach(function(S){p=v(p,S)})})),u===p)return;for(var U=t.height/(p-u),e=t.y+p*U,z=N(T[0],sq).length,S=t.width/(3*z+1),g=2*S/$,K=0,s=0;$>s;s++)for(var j=T[s],b=N(j,yk),O=N(j,"colors"),X=N(j,sq),I=0;z>I;I++){O?i.fillStyle=O[I]:b?i.fillStyle=b:(i.fillStyle=os[K++],K===os.length&&(K=0));var E=X[I],F=E*U,Z=t.x+(1+3*I)*S+s*g;if(Wm(i,Z,e-F,g,F),q){var f=fp(h)?h(E,I,j,H):E,w=gc(_,f).height;q.add({x:Z,y:e-F-w,width:g,height:w,text:f})}}q&&q.each(function(Q){ci(i,Q.text,_,a,Q.x,Q.y,Q.width,Q.height,Im)})}},n=function(K,g){var a=N(K,om);if(a&&a.length>0){var M=a.length,Z=N(a[0],sq).length,Q=g.width/(3*Z+1),x=0,k=N(K,"maxValue"),V=N(K,yr),e=N(K,Bi),O=N(K,of),X=V?new Nf:m;if(k==m){k=0;for(var d=0;Z>d;d++){for(var B=0,w=0;M>w;w++)B+=N(a[w],sq)[d];k=v(k,B)}}if(k>0){for(var d=0;Z>d;d++)for(var S=g.y+g.height,w=0;M>w;w++){var n=a[w],j=N(n,yk),U=N(n,sq)[d],c=U/k*g.height;j?i.fillStyle=j:(i.fillStyle=os[x++],x===os.length&&(x=0)),S-=c;var A={x:g.x+(1+3*d)*Q,y:S,width:2*Q,height:c};Wm(i,A.x,A.y,A.width,A.height),X&&(A.text=fp(V)?V(U,d,n,H):U,X.add(A))}X&&X.each(function(B){ci(i,B.text,e,O,B.x,B.y,B.width,B.height,Im)})}}},y=function(F,I){var a=N(F,om);if(a&&a.length>0){for(var u=a.length,O=N(a[0],sq).length,p=I.width/(3*O+1),z=0,J=N(F,yr),k=N(F,Bi),U=N(F,of),Z=J?new Nf:m,C=0;O>C;C++){for(var q=0,L=0;u>L;L++)q+=N(a[L],sq)[C];if(q>0){var l=I.y+I.height;for(L=0;u>L;L++){var x=a[L],A=N(x,yk),Y=N(x,sq)[C],W=Y/q*I.height;A?i.fillStyle=A:(i.fillStyle=os[z++],z===os.length&&(z=0)),l-=W;var e={x:I.x+(1+3*C)*p,y:l,width:2*p,height:W};Wm(i,e.x,e.y,e.width,e.height),Z&&(e.text=fp(J)?J(Y,C,x,H):Y,Z.add(e))}}}Z&&Z.each(function(H){ci(i,H.text,k,U,H.x,H.y,H.width,H.height,Im)})}},h=function(p,T){var U=N(p,om);if(U&&U.length>0){var Y=U.length,j=N(p,"minValue")||0,c=N(p,"maxValue");if(c==m&&(c=0,U.forEach(function(u){u.values.forEach(function(t){c=v(c,t)})})),j===c)return;for(var w=T.height/(c-j),f=T.y+c*w,K=N(U[0],sq).length,L=T.width/(3*K+1),W=0,z=N(p,"lineWidth")||2,E=N(p,"line3d"),q=N(p,"linePoint"),D=N(p,yr),u=N(p,Bi),X=N(p,of),Q=0;Y>Q;Q++){var Z=U[Q],h=N(Z,yk),R=N(Z,sq);h?i.strokeStyle=h:(h=i.strokeStyle=os[W++],W===os.length&&(W=0)),i.beginPath();for(var P=0;K>P;P++){var l=T.x+(2+3*P)*L,A=f-R[P]*w;0===P?i.moveTo(l,A):i.lineTo(l,A)}if(i.lineWidth=z,i.stroke(),E&&Gi(i,h,m,z,V),q||D){var y,r=z/2+2;for(P=0;K>P;P++){var C=R[P];if(l=T.x+(2+3*P)*L,A=f-C*w,fp(q)?q(i,l,A,h,P,Z,H):q&&(i.fillStyle=h,i.beginPath(),i.arc(l,A,r,0,k,!0),i.fill()),fp(D)?y=D(C,P,Z,H):D&&(y=C),y){var F=gc(u,y).height,d=i.shadowBlur;if(d){var e=i.shadowOffsetX,a=i.shadowOffsetY,b=i.shadowColor;i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,i.shadowColor=m}ci(i,y,u,X,l,A-F-r+2,0,F,Im),d&&(i.shadowOffsetX=e,i.shadowOffsetY=a,i.shadowBlur=d,i.shadowColor=b)}}}}}},I={border:J,image:q,text:a,pieChart:z,columnChart:l,stackedColumnChart:n,percentageColumnChart:y,lineChart:h};return function(W,x,U,q,f,R,C,G,K,d){if(x&&f&&R){i=W,H=C,Z=G,V=Z?Z._zoom?Z._zoom:1:1,L=K,F=d;var a=f,J=R;if(dp()){var n,z,P;0===i[lk]?dp[0]&&(n=!0):n=!0,i.texureImage2D?dp[1]&&(z=!0):z=!0,i.texureImage3D?dp[2]&&(P=!0):P=!0,n&&z&&P&&(a=U,J=q)}if(x.tagName)return i.drawImage(x,a,J,f,R),void 0;if(N(x,"visible")!==!1){L||(L=Nd(x.color,H,Z)),d||(F=Nd(x.blendMode,H,Z));var B=Jb(x,H,Z,f),w=vr(x,H,Z,R),u={x:0,y:0,width:B,height:w,fitSize:N(x,"fitSize")},A=N(x,"clip"),k=N(x,"opacity");u.fitSize&&(u.widthScale=B/Nd(x.width,H,Z),u.heightScale=w/Nd(x.height,H,Z)),i.save(),Mi(i,a,J),(B!==f||w!==R)&&i.scale(f/B,R/w),A&&(fp(A)?A(i,B,w,H,Z,x):(i.beginPath(),i.rect(0,0,B,w),i.clip())),k!=m&&(i.globalAlpha*=k),N(x,"comps").forEach(function(h){if(N(h,Bc)!==!1){rb.splice(0,0,h);var z=N(h,"opacity"),M=N(h,"shadow"),k=N(h,"type"),R=e(h,u);if(z!=m){var x=i.globalAlpha;i.globalAlpha*=z}if(M){var L=i.shadowOffsetX,O=i.shadowOffsetY,w=i.shadowBlur,t=i.shadowColor,E=N(h,"shadowOffsetX"),P=N(h,"shadowOffsetY"),U=N(h,"shadowBlur"),J=o(h,"shadowColor");i.shadowOffsetX=(E==m?3:E)*V,i.shadowOffsetY=(P==m?3:P)*V,i.shadowBlur=(U==m?6:U)*V,i.shadowColor=J||o(Zp)}if("save"===k)i.save();else if("endClip"===k||"restore"===k)i.restore();else if("clip"===k)i.save(),Tj(i,N(h,"points",r),N(h,"segments",S),!0),i.clip();else if(Hb[k])R=R||{x:0,y:0,width:u.width,height:u.height},c(h,k,R,u);else if(k===Cb)c(h,k,R,u);else if("SVGPath"===k)j(h,k,R);else{R=R||{x:0,y:0,width:u.width,height:u.height};var F=N(h,Ed),n=N(h,"scaleX"),f=N(h,"scaleY"),W=$(h),G=T(h,R,R,F,n,f,W);if(fp(k))s(h,k),b.drawCompType(k,i,R,h,H,Z);else if(b.getCompType(k)){var a=b.getCompType(k),q=a.func||a;s(h,a),b.drawCompType(q,i,R,h,H,Z)}else I[k]?I[k](h,R):b.getCompType(k)===Y&&np.test(k)&&Ak(k);G&&_()}M&&(i.shadowOffsetX=L,i.shadowOffsetY=O,i.shadowBlur=w,i.shadowColor=t),z!=m&&(i.globalAlpha=x),rb.splice(0,1)}}),i.restore()}}}}();b.getCurrentComp=function(){return rb[0]},b.getParentComp=function(){return rb[1]},b.getInternal=function(){return{isEnter:me,isEsc:mq,isSpace:gh,isLeft:pq,isUp:Zj,isRight:Sf,isDown:Pp,addMethod:mm,superCall:Ck,toPointsArray:Bp,translateAndScale:ti,appendArray:gb,createWorldMatrix:am,vec3TransformMat4:zh,setCanvas:Xe,createDiv:gd,createView:xf,createCanvas:dj,createImage:Of,initContext:xd,layout:Or,fillRect:Wm,Mat:Gc,drawBorder:Af,isString:Mq,setBorder:Vg,getPropertyValue:Og,setPropertyValue:un,drawVerticalLine:Xi,draw3DRect:sr,getPinchDist:lf,isSameRect:Pe,getPosition:wq,intersectionLineRect:Wc,getNodeRect:Lq,getEdgeAgentPosition:zf,getImageWidth:Jb,getImageHeight:vr,initItemElement:rq,drawPoints:Tj,createG2:kk,closePopup:Eo,isH:Po,createAnim:dm,createNormalMatrix:Ve,createNormals:oi,toFloatArray:Gm,glMV:sp,batchShape:Nn,createNodeMatrix:ak,getFaceInfo:In,transformAppend:$k,drawFaceInfo:Gq,to3dPointsArray:Zr,setGLDebugMode:function(I){nn=I},cube:function(){return{vs:qp,is:tj,uv:ad}},ui:function(){return{DataUI:Wd,NodeUI:br,EdgeUI:Vi,GroupUI:Rf,ShapeUI:Kc,GridUI:vo,Data3dUI:Xh,Node3dUI:Jd,Shape3dUI:Rk}},getInternalVersion:function(){return"U2FsdGVkX1/lDVv5B7o+OB++J0jBL0OhwLiCSGgDxu8="},getDragger:function(){return tb},addMSMap:function(w){mm(qd,w)},k:d}},function(S){function E(F,Q){F!=m&&(Q==m&&wf!=typeof F?this._54O(F,256):this._54O(F,Q))}function r(){return new E(m)}function c(L,j,q,V,i,x){for(;--x>=0;){var v=j*this[L++]+q[V]+i;i=f(v/67108864),q[V++]=67108863&v}return i}function a(V,J,k,s,K,u){for(var x=32767&J,i=J>>15;--u>=0;){var M=32767&this[V],I=this[V++]>>15,n=i*M+I*x;M=x*M+((32767&n)<<15)+k[s]+(1073741823&K),K=(M>>>30)+(n>>>15)+i*I+(K>>>30),k[s++]=1073741823&M}return K}function s(m,g,L,a,V,Q){for(var K=16383&g,Y=g>>14;--Q>=0;){var y=16383&this[m],t=this[m++]>>14,z=Y*y+t*K;y=K*y+((16383&z)<<14)+L[a]+V,V=(y>>28)+(z>>14)+Y*t,L[a++]=268435455&y}return V}function t(X){return Pd.charAt(X)}function p(e,f){var H=rd[e.charCodeAt(f)];return H==m?-1:H}function u(R){for(var v=this.t-1;v>=0;--v)R[v]=this[v];R.t=this.t,R.s=this.s}function L(A){this.t=1,this.s=0>A?-1:0,A>0?this[0]=A:-1>A?this[0]=A+this.DV:this.t=0}function U(E){var A=r();return A._58O(E),A}function K(k,B){var g,C=this;if(16==B)g=4;else if(8==B)g=3;else if(256==B)g=8;else if(2==B)g=1;else if(32==B)g=5;else{if(4!=B)return C.fromRadix(k,B),void 0;g=2}C.t=0,C.s=0;for(var z=k.length,L=!1,V=0;--z>=0;){var P=8==g?255&k[z]:p(k,z);0>P?"-"==k.charAt(z)&&(L=!0):(L=!1,0==V?C[C.t++]=P:V+g>C.DB?(C[C.t-1]|=(P&(1<<C.DB-V)-1)<<V,C[C.t++]=P>>C.DB-V):C[C.t-1]|=P<<V,V+=g,V>=C.DB&&(V-=C.DB))}8==g&&0!=(128&k[0])&&(C.s=-1,V>0&&(C[C.t-1]|=(1<<C.DB-V)-1<<V)),C._57O(),L&&E.ZERO._78O(C,C)}function D(){for(var $=this,N=$.s&$.DM;$.t>0&&$[$.t-1]==N;)--$.t}function Z(j){var v=this;if(v.s<0)return"-"+v._85O()[gb](j);var F;if(16==j)F=4;else if(8==j)F=3;else if(2==j)F=1;else if(32==j)F=5;else{if(4!=j)return v.toRadix(j);F=2}var k,I=(1<<F)-1,g=!1,s="",z=v.t,q=v.DB-z*v.DB%F;if(z-->0)for(q<v.DB&&(k=v[z]>>q)>0&&(g=!0,s=t(k));z>=0;)F>q?(k=(v[z]&(1<<q)-1)<<F-q,k|=v[--z]>>(q+=v.DB-F)):(k=v[z]>>(q-=F)&I,0>=q&&(q+=v.DB,--z)),k>0&&(g=!0),g&&(s+=t(k));return g?s:"0"}function W(){var l=r();return E.ZERO._78O(this,l),l}function V(){return this.s<0?this._85O():this}function g(o){var V=this,t=V.s-o.s;if(0!=t)return t;var Z=V.t;if(t=Z-o.t,0!=t)return V.s<0?-t:t;for(;--Z>=0;)if(0!=(t=V[Z]-o[Z]))return t;return 0}function Q(f){var n,r=1;return 0!=(n=f>>>16)&&(f=n,r+=16),0!=(n=f>>8)&&(f=n,r+=8),0!=(n=f>>4)&&(f=n,r+=4),0!=(n=f>>2)&&(f=n,r+=2),0!=(n=f>>1)&&(f=n,r+=1),r}function z(){var O=this;return O.t<=0?0:O.DB*(O.t-1)+Q(O[O.t-1]^O.s&O.DM)}function o(M,h){var A;for(A=this.t-1;A>=0;--A)h[A+M]=this[A];for(A=M-1;A>=0;--A)h[A]=0;h.t=this.t+M,h.s=this.s}function i(X,z){for(var t=X;t<this.t;++t)z[t-X]=this[t];z.t=v(this.t-X,0),z.s=this.s}function y(R,y){var q,m=this,h=R%m.DB,p=m.DB-h,$=(1<<p)-1,X=f(R/m.DB),e=m.s<<h&m.DM;for(q=m.t-1;q>=0;--q)y[q+X+1]=m[q]>>p|e,e=(m[q]&$)<<h;for(q=X-1;q>=0;--q)y[q]=0;y[X]=e,y.t=m.t+X+1,y.s=m.s,y._57O()}function P(J,X){var l=this;X.s=l.s;var E=f(J/l.DB);if(E>=l.t)return X.t=0,void 0;var R=J%l.DB,U=l.DB-R,e=(1<<R)-1;X[0]=l[E]>>R;for(var k=E+1;k<l.t;++k)X[k-E-1]|=(l[k]&e)<<U,X[k-E]=l[k]>>R;R>0&&(X[l.t-E-1]|=(l.s&e)<<U),X.t=l.t-E,X._57O()}function N(h,c){for(var j=this,b=0,v=0,e=R(h.t,j.t);e>b;)v+=j[b]-h[b],c[b++]=v&j.DM,v>>=j.DB;if(h.t<j.t){for(v-=h.s;b<j.t;)v+=j[b],c[b++]=v&j.DM,v>>=j.DB;v+=j.s}else{for(v+=j.s;b<h.t;)v-=h[b],c[b++]=v&j.DM,v>>=j.DB;v-=h.s}c.s=0>v?-1:0,-1>v?c[b++]=j.DV+v:v>0&&(c[b++]=v),c.t=b,c._57O()}function T(i,C){var b=this.abs(),U=i.abs(),H=b.t;for(C.t=H+U.t;--H>=0;)C[H]=0;for(H=0;H<U.t;++H)C[H+b.t]=b.am(0,U[H],C,H,0,b.t);C.s=0,C._57O(),this.s!=i.s&&E.ZERO._78O(C,C)}function O(P){for(var k=this.abs(),E=P.t=2*k.t;--E>=0;)P[E]=0;for(E=0;E<k.t-1;++E){var S=k.am(E,k[E],P,2*E,0,1);(P[E+k.t]+=k.am(E+1,2*k[E],P,2*E+1,S,k.t-E-1))>=k.DV&&(P[E+k.t]-=k.DV,P[E+k.t+1]=1)}P.t>0&&(P[P.t-1]+=k.am(E,k[E],P,2*E,0,1)),P.s=0,P._57O()}function b(I,F,S){var e=I.abs(),Z=this;if(!(e.t<=0)){var $=Z.abs();if($.t<e.t)return F!=m&&F._58O(0),S!=m&&Z._77O(S),void 0;S==m&&(S=r());var b=r(),d=Z.s,P=I.s,w=Z.DB-Q(e[e.t-1]);w>0?(e._44O(w,b),$._44O(w,S)):(e._77O(b),$._77O(S));var N=b.t,k=b[N-1];if(0!=k){var H=k*(1<<Z.F1)+(N>1?b[N-2]>>Z.F2:0),V=Z.FV/H,y=(1<<Z.F1)/H,h=1<<Z.F2,n=S.t,A=n-N,v=F==m?r():F;for(b._59O(A,v),S._52O(v)>=0&&(S[S.t++]=1,S._78O(v,S)),E.ONE._59O(N,v),v._78O(b,b);b.t<N;)b[b.t++]=0;for(;--A>=0;){var D=S[--n]==k?Z.DM:f(S[n]*V+(S[n-1]+h)*y);if((S[n]+=b.am(0,D,S,A,0,N))<D)for(b._59O(A,v),S._78O(v,S);S[n]<--D;)S._78O(v,S)}F!=m&&(S._45O(N,F),d!=P&&E.ZERO._78O(F,F)),S.t=N,S._57O(),w>0&&S._46O(w,S),0>d&&E.ZERO._78O(S,S)}}}function q(s){var x=r();return this.abs()._49O(s,m,x),this.s<0&&x._52O(E.ZERO)>0&&s._78O(x,x),x}function n(C){this.m=C}function e(T){return T.s<0||T._52O(this.m)>=0?T.mod(this.m):T}function B(C){return C}function w(C){C._49O(this.m,m,C)}function Y(Z,t,X){Z._47O(t,X),this._74O(X)}function M(m,S){m._48O(S),this._74O(S)}function j(){if(this.t<1)return 0;var k=this[0];if(0==(1&k))return 0;var x=3&k;return x=15&x*(2-(15&k)*x),x=255&x*(2-(255&k)*x),x=65535&x*(2-(65535&(65535&k)*x)),x=x*(2-k*x%this.DV)%this.DV,x>0?this.DV-x:-x}function l(D){var h=this;h.m=D,h.mp=D._50O(),h.mpl=32767&h.mp,h.mph=h.mp>>15,h.um=(1<<D.DB-15)-1,h.mt2=2*D.t}function h(D){var c=r();return D.abs()._59O(this.m.t,c),c._49O(this.m,m,c),D.s<0&&c._52O(E.ZERO)>0&&this.m._78O(c,c),c}function _(R){var A=r();return R._77O(A),this._74O(A),A}function F(H){for(var w=this;H.t<=w.mt2;)H[H.t++]=0;for(var r=0;r<w.m.t;++r){var z=32767&H[r],U=z*w.mpl+((z*w.mph+(H[r]>>15)*w.mpl&w.um)<<15)&H.DM;for(z=r+w.m.t,H[z]+=w.m.am(0,U,H,r,0,w.m.t);H[z]>=H.DV;)H[z]-=H.DV,H[++z]++}H._57O(),H._45O(w.m.t,H),H._52O(w.m)>=0&&H._78O(w.m,H)}function zm(t,e){t._48O(e),this._74O(e)}function Uq(j,Q,$){j._47O(Q,$),this._74O($)}function sd(){return 0==(this.t>0?1&this[0]:this.s)}function nk(p,C){if(p>4294967295||1>p)return E.ONE;var H=r(),u=r(),B=C._73O(this),$=Q(p)-1;for(B._77O(H);--$>=0;)if(C._76O(H,u),(p&1<<$)>0)C._75O(u,B,H);else{var N=H;H=u,u=N}return C.revert(H)}function bl(I,c){var q;return q=256>I||c._51O()?new n(c):new l(c),this.exp(I,q)}function Vd(){var W=this;if(W.s<0){if(1==W.t)return W[0]-W.DV;if(0==W.t)return-1}else{if(1==W.t)return W[0];if(0==W.t)return 0}return(W[1]&(1<<32-W.DB)-1)<<W.DB|W[0]}function Dk($,s){return new E($,s)}function jb(){var z=this;z.n=m,z.e=0,z.d=m,z.p=m,z.q=m,z.dmp1=m,z.dmq1=m,z._10A=m}function cj(n){return n._53O(this.e,this.n)}function qm(v){var f,g,c,e="",A=0;for(f=0;f<v.length&&v.charAt(f)!=Kd;++f)c=Ur.indexOf(v.charAt(f)),0>c||(0==A?(e+=t(c>>2),g=3&c,A=1):1==A?(e+=t(g<<2|c>>4),g=15&c,A=2):2==A?(e+=t(g),e+=t(c>>2),g=3&c,A=3):(e+=t(g<<2|c>>4),e+=t(15&c),A=0));return 1==A&&(e+=t(g<<2)),e}function Xc(F){var P=F.split(""),u=qm(F);return P.forEach(function(J){var T=J.length;T>0&&u&&(io+=C(J))}),u}function mg(v,M){var g=Ak._4O.Util._56O(v,"ss"),n={},s=0;return n.v=g==M,n.t=1,n.s=0>s?-1:0,wk=n.v,s>0?n[0]=s:-1>s?n[0]=s+n.DV:n.t=0,[g,n]}function js(l){var a=38,X=l.substring(0,a);if(X&&30==X.indexOf("05000420")){var C=["ss",l.substring(a)];return C}return[]}function ik(I,m){m=m.replace(Hd,""),m=m.replace(/[ \n]+/g,"");
var V=Dk(m,16);if(V._55O()>this.n._55O())return 0;var H=this._37O(V),L=H[gb](16).replace(/^1f+00/,""),u=js(L);if(0==u.length)return!1;for(var v,X,o,E=.5,D=vq,z=[0,.5,.75,.875,.9375],K=[],Q=[],R=[],B=k/D,w=u[1],S=mg(I,w)[0],x=0,$=0;x<z.length;x++){var q=0===x%2?0:.5;for(v=0;D>=v;v++)X=(v+q)*B,o=1-z[x],K.push(G(X)*E*o,-E+2*z[x]*E,-A(X)*E*o),Q.push((v+q)/D,o)}for(x=0;x<z.length-1;x++){var l=x*(D+1),r=(x+1)*(D+1);for(v=0;D>v;v++)R.push(l+v,r+v+1,r+v,l+v,l+v+1,r+v+1)}return R.forEach(function(c){$+=c}),w==S&&$>10}var Br,yi=0xdeadbeefcafe,Kk=15715070==(16777215&yi),gb="toString",he="",sk="nat",Bo=function(){};x=S["D"+11182[gb](H(2,5))];var Qd=E.prototype;Uf+=ge.substr(0,1);var We=S.navigator?S.navigator.appName:"";Kk&&"Microsoft Internet Explorer"==We?(Qd.am=a,Br=30):Kk&&"Netscape"!=We?(Qd.am=c,Br=26):(Qd.am=s,Br=28),Qd.DB=Br,Qd.DM=(1<<Br)-1,Qd.DV=1<<Br;var qk=52;Qd.FV=H(2,qk),Qd.F1=qk-Br,Qd.F2=2*Br-qk;var Vp,sn,Pd="0123456789abcdefghijklmnopqrstuvwxyz",rd=[],Vb=function(o){return String.fromCharCode(o)};for(Vp="0".charCodeAt(0),sn=0;9>=sn;++sn)rd[Vp++]=sn;for(Vp="a".charCodeAt(0),sn=10;36>sn;++sn)rd[Vp++]=sn;for(Vp="A".charCodeAt(0),sn=10;36>sn;++sn)rd[Vp++]=sn;var pk=n.prototype;pk._73O=e,pk.revert=B,pk._74O=w,pk._75O=Y,pk._76O=M;var Ij=l.prototype;Ij._73O=h,Ij.revert=_,Ij._74O=F,Ij._75O=Uq,Ij._76O=zm,Qd._77O=u,Qd._58O=L,Qd._54O=K,Qd._57O=D,Qd._59O=o,Qd._45O=i,Qd._44O=y,Qd._46O=P,Qd._78O=N,Qd._47O=T,Qd._48O=O,Qd._49O=b,Qd._50O=j,Qd._51O=sd,Qd.exp=nk,Qd.toString=Z,Qd._85O=W,Qd.abs=V,Qd._52O=g,Qd._55O=z,Qd.mod=q,Qd._53O=bl,E.ZERO=U(0),E.ONE=U(1),Qd._86O=Vd;var _j=function(E,w){var W=this;W.isPublic=!0,typeof E!==wf?(W.n=E,W.e=w):E!=m&&w!=m&&E.length>0&&w.length>0&&(W.n=Dk(E,16),W.e=C(w,16))};vs=function(){var O,A,c=Xc(vc),S=c.substr(0,4),Y=c.substr(4,2),F=c.substr(6,2),f=1,q=!f,V=d,Z=[],J=Vl.charAt(7);if(x&&(x[gb]().indexOf(sk)<0||x[Uf][gb]().indexOf(sk)<0||!c?O=ln(Ip[J]):(c=new x(S-0,Y-f,F-0),A=c.setHours(9),x[Uf]()>A?O=ln(Ip[J]):q=!0)),c&&O&&V){for(var g in O)Z.push(g);var w,h=O[Z[0]],p=O[Z[1]],N=O[Z[2]],I=O[Z[4]],u=O[Z[5]],_=O[Z[6]],j=fl._27O(V);j&&_&&(w=h+p+N+I+""+u,w&&j._31O(w,_)&&(q=!0))}return q||(gn=rk),J};var to=jb.prototype;to._37O=cj,to._38O=_j;var Ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kd="=",Bs=25,wh=10,vc="IBgBJQ==",Ug=Ug||function(j,o){var L={},H=L._7A={},M=H._6A=function(){function b(){}return{_80O:function($){b.prototype=this;var Y=new b;return $&&Y._5A($),Y.hasOwnProperty("_82O")||(Y._82O=function(){Y.$super._82O.apply(this,arguments)}),Y._82O.prototype=Y,Y.$super=this,Y},_3A:function(){var w=this._80O();return w._82O.apply(w,arguments),w},_82O:function(){},_5A:function(d){for(var Q in d)d.hasOwnProperty(Q)&&(this[Q]=d[Q]);d.hasOwnProperty(gb)&&(this.toString=d.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),W=H._39O=M._80O({_82O:function(u,d){u=this._84O=u||[],this._65O=d!=o?d:4*u.length},toString:function(v){return(v||u).stringify(this)},_89O:function(x){var X=this._84O,S=x._84O,W=this._65O,u=x._65O;if(this._57O(),W%4)for(var K=0;u>K;K++){var h=255&S[K>>>2]>>>24-8*(K%4);X[W+K>>>2]|=h<<24-8*((W+K)%4)}else if(S.length>65535)for(var K=0;u>K;K+=4)X[W+K>>>2]=S[K>>>2];else X.push.apply(X,S);return this._65O+=u,this},_57O:function(){var w=this._84O,q=this._65O;w[q>>>2]&=4294967295<<32-8*(q%4),w.length=J(q/4)},_88O:function(){var l=M._88O.call(this);return l._84O=this._84O.slice(0),l},_87O:function(a){for(var c=[],h=0;a>h;h+=4)c.push(0|4294967296*I);return new W._82O(c,a)}}),A=L._2A={},u=A._69O={stringify:function(X){var r,i=X._84O,n=X._65O,q=[];for(r=0;n>r;r++){var p=255&i[r>>>2]>>>24-8*(r%4);q.push((p>>>4).toString(16)),q.push((15&p).toString(16))}return q.join("")},_68O:function(n){for(var e=n.length,A=[],z=0;e>z;z+=2)A[z>>>3]|=C(n.substr(z,2),16)<<24-4*(z%8);return new W._82O(A,e/2)}},w=A._8A={stringify:function(z){var M,J=z._84O,i=z._65O,n=[];for(M=0;i>M;M++){var F=255&J[M>>>2]>>>24-8*(M%4);n.push(Vb(F))}return n.join("")},_68O:function(g){var I,C=g.length,$=[];for(I=0;C>I;I++)$[I>>>2]|=(255&g.charCodeAt(I))<<24-8*(I%4);return new W._82O($,C)}},P=A._9A={stringify:function(D){try{return decodeURIComponent(escape(w.stringify(D)))}catch(e){throw new Error("")}},_68O:function(D){return w._68O(unescape(encodeURIComponent(D)))}},a=H._32O=M._80O({_1A:function(){this._83O=new W._82O,this._23O=0},_33O:function(t){typeof t==wf&&(t=P._68O(t)),this._83O._89O(t),this._23O+=t._65O},_25O:function(d){var z=this._83O,A=z._84O,M=z._65O,j=this._79O,w=4*j,b=M/w;b=d?J(b):v((0|b)-this._22O,0);var V=b*j,f=R(4*V,M);if(V){for(var P=0;V>P;P+=j)this._20O(A,P);var O=A.splice(0,V);z._65O-=f}return new W._82O(O,f)},_88O:function(){var m=M._88O.call(this);return m._83O=this._83O._88O(),m},_22O:0});H._66O=a._80O({cfg:M._80O(),_82O:function(d){this.cfg=this.cfg._80O(d),this._1A()},_1A:function(){a._1A.call(this),this._34O()},_81O:function(T){return this._33O(T),this._25O(),this},_72O:function(P){P&&this._33O(P);var i=this._21O();return i},_79O:16,_26O:function(m){return function(X,I){return new m._82O(I)._72O(X)}},_19O:function(t){return function(A,C){return new X._71O._82O(t,C)._72O(A)}}});var X=L._67O={};return L}();!function(){var n=Ug,C=n._7A,J=C._39O,d=C._66O,T=n._67O,z=[],w=[];!function(){function k(R){for(var o=X(R),Y=2;o>=Y;Y++)if(!(R%Y))return!1;return!0}function E(Q){return 0|4294967296*(Q-(0|Q))}for(var e=2,h=0;64>h;)k(e)&&(8>h&&(z[h]=E(H(e,.5))),w[h]=E(H(e,1/3)),h++),e++}();var u=[],i=T._41O=d._80O({_34O:function(){this._64O=new J._82O(z.slice(0))},_20O:function(i,U){for(var c=this._64O._84O,z=c[0],e=c[1],r=c[2],b=c[3],n=c[4],Q=c[5],$=c[6],J=c[7],B=0;64>B;B++){if(16>B)u[B]=0|i[U+B];else{var L=u[B-15],P=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,Z=u[B-2],V=(Z<<15|Z>>>17)^(Z<<13|Z>>>19)^Z>>>10;u[B]=P+u[B-7]+V+u[B-16]}var o=n&Q^~n&$,d=z&e^z&r^e&r,Y=(z<<30|z>>>2)^(z<<19|z>>>13)^(z<<10|z>>>22),g=(n<<26|n>>>6)^(n<<21|n>>>11)^(n<<7|n>>>25),f=J+g+o+w[B]+u[B],_=Y+d;J=$,$=Q,Q=n,n=0|b+f,b=r,r=e,e=z,z=0|f+_}c[0]=0|c[0]+z,c[1]=0|c[1]+e,c[2]=0|c[2]+r,c[3]=0|c[3]+b,c[4]=0|c[4]+n,c[5]=0|c[5]+Q,c[6]=0|c[6]+$,c[7]=0|c[7]+J},_21O:function(){var w=this._83O,S=w._84O,v=8*this._23O,k=8*w._65O;return S[k>>>5]|=128<<24-k%32,S[(k+64>>>9<<4)+14]=f(v/4294967296),S[(k+64>>>9<<4)+15]=v,w._65O=4*S.length,this._25O(),this._64O},_88O:function(){var V=d._88O.call(this);return V._64O=this._64O._88O(),V}});n._41O=d._26O(i),n._42O=d._19O(i)}();var Hd=new RegExp("");Hd.compile("[^0-9a-f]","gi"),jb._28O=-1,jb._29O=-2,to._31O=ik,to._63O=ik,jb._43O=-2;var Jj=new function(){var d=this;d._5O=function(Z,Y){if("8"!=Z.substring(Y+2,Y+3))return 1;var P=C(Z.substring(Y+3,Y+4));return 0==P?-1:P>0&&10>P?P+1:-2},d._13O=function(x,G){var o=d._5O(x,G);return 1>o?"":x.substring(G+2,G+2+2*o)},d._12O=function(M,Z){var y=d._13O(M,Z);if(""==y)return-1;var G;return G=C(y.substring(0,1))<8?new E(y,16):new E(y.substring(2),16),G._86O()},d._6O=function(J,r){var X=d._5O(J,r);return 0>X?X:r+2*(X+1)},d._11O=function(l,i){var z=d._6O(l,i),w=d._12O(l,i);return l.substring(z,z+2*w)},d._10O=function(B,Q){var b=d._6O(B,Q),U=d._12O(B,Q);return b+2*U},d._7O=function(W,c){var a=[],o=d._6O(W,c);a.push(o);for(var C=d._12O(W,c),B=o,R=0;;){var e=d._10O(W,B);if(e==m||e-o>=2*C)break;if(R>=200)break;a.push(e),B=e,R++}return a}};if(Jj._90O=Vb(wh+24),Jj._91O=$+Vb(wh*wh+8),Ak==m||!Ak)var Ak={};Ak._4O!=m&&Ak._4O||(Ak._4O={});var Qq=Ak._4O;Ak._4O.Util=new function(){var k=this;k._56O=function(X){var T=new Ak._4O._3O;return T._30O(X)},k._4A=function(k){var D=new Ak._4O._3O;return D._36O(k)},k._11A=function(P){var S=new Qq._3O;return S._30O(P)}},Ak._4O._3O=function(){var g=this;g._8O=function(w,f){if("ss"==w&&"cj"==f){try{g.md=Ug._67O._41O._3A()}catch(Z){Bo(he)}g._24O=function(j){g.md._81O(j)},g._35O=function(u){var x=Ug._2A._69O._68O(u);g.md._81O(x)},g._60O=function(){var P=g.md._72O();return P[gb](Ug._2A._69O)},g._30O=function(m){return g._24O(m),g._60O()},g._36O=function(l){return g._35O(l),g._60O()}}},g._24O=function(){Bo(he)},g._35O=function(){Bo(he)},g._60O=function(){Bo(he)},g._30O=function(){Bo(he)},g._36O=function(){Bo(he)},g._8O("ss","cj")},bn=function(h){var O=Ti[Gl[7]],c=1,G=!1;if(Pf.a!=Ti[Rc])return Pf.a;if(Pf.forEach(function(J){c*=J}),h>c){if(O){O=O.split(Jj._90O);var J=O[3],T=O[7],n=O[11],F=O[19],W=O[23],E=O[27],P=J+T+n+F+W;G=rs()(P,E)}G||(Wd.prototype._42=lb)}else G=!0;return Pf.a=G,G},Bs=String.fromCharCode(Bs+20);var Fq=function(m){return m=m.replace(Hd,he),m=m.replace(/[ \n]+/g,he)},Lr="30",rc="06",td="02",Gh="03",Lg=Dk,tb=/^1f+00/,fl=function(){var E;return E={_18O:function(g){var s=g,n=s.replace(/\s+/g,""),W=qm(n);return W},_14O:function(D){var W=this._18O(D),C=this._15O(W);return C},_15O:function(d){var W=this._17O(d);if("2a864886f70d010101"==W._61O){var l=this._16O(W.key),Z=new jb;return Z._38O(l.n,l.e),Z}Bo(he)},_16O:function(W){var Q={};W.substr(0,2)!=Lr&&Bo(he);var M=Jj._7O(W,0);return 2!=M.length&&Bo(he),W.substr(M[0],2)!=td&&Bo(he),Q.n=Jj._11O(W,M[0]),W.substr(M[1],2)!=td&&Bo(he),Q.e=Jj._11O(W,M[1]),Q},_17O:function(A){var B={};B._40O=m;var Q=Jj._7O(A,0);2!=Q.length&&Bo(he);var n=Q[0];A.substr(n,2)!=Lr&&Bo(he);var x=Jj._7O(A,n);return 2!=x.length&&Bo(he),A.substr(x[0],2)!=rc&&Bo(he),B._61O=Jj._11O(A,x[0]),A.substr(x[1],2)==rc?B._40O=Jj._11O(A,x[1]):A.substr(x[1],2)==Lr&&(B._40O={},B._40O.p=Jj._70O(A,x[1],[0],td),B._40O.q=Jj._70O(A,x[1],[1],td),B._40O.g=Jj._70O(A,x[1],[2],td)),A.substr(Q[1],2)!=Gh&&Bo(he),B.key=Jj._11O(A,Q[1]).substr(2),B}},E._17O?E:m}(),No=fl._27O=function(V){return fl._14O(V)};rs=function(){return function(M,e){e=Fq(e);var F=Lg(e,H(2,4)),m=this;if(!m||!m.n||F._55O()>m.n._55O())return 0;var T=m._37O(F),x=T[gb](H(2,4)).replace(tb,""),q=js(x);if(0==q.length)return!1;var J=q[0],N=q[1],c=function(d){return Ak._4O.Util._56O(d,J)},X=c(M);return N==X}.bind(No(d))};var hn,fm;return function(){var Y=Ji.length-il.length;if(Y>0)for(var T=0;Y>T;T++)hn=Qq.Util,fm=Fq}(),Tn=function(G,r){r=fm(r);var Y=No(Kr),w=se.length,E=2*w,N=Lg(r,H(w,E)),b=Y,j=!0;if(b){var B=b[Ag[0]];B&&N._55O()<=B._55O()&&(j=!1)}if(j)return 0;var Q=b._37O(N),g=Q[gb](H(w,E)).replace(tb,""),o=js(g);if(0==o.length)return!1;var c=o[0],L=o[1],W=hn._11A(G,c);return L==W},fl}(P,u);var Nf=o.List=function(){this._as=[];var e,n,Q=arguments.length;if(1===Q){var l=arguments[0];if(tp(l)&&(l=l._as),sc(l))for(n=l.length,e=0;n>e;e++)this._as.push(l[e]);else l!=m&&this._as.push(l)}else if(Q>1)for(e=0;Q>e;e++)this._as.push(arguments[e])};_q("List",u,{forEach:function(P,X){this.each(P,X)},push:function(){for(var h=0;h<arguments.length;h++)this.add(arguments[h])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(T,m){return m===Y?this._as.push(T):this._as.splice(m,0,T)},addAll:function(K){tp(K)&&(K=K._as),sc(K)?gb(this._as,K):this._as.push(K)},get:function(R){return this._as[R]},slice:function(o,Q){return new Nf(this._as.slice(o,Q))},remove:function(u){var V=this._as.indexOf(u);return V>=0&&V<this._as.length&&this.removeAt(V),V},removeAt:function(G){return this._as.splice(G,1)[0]},set:function(h,r){return this._as[h]=r},clear:function(){return this._as.splice(0,this._as.length)},contains:function(Z){return this._as.indexOf(Z)>=0},indexOf:function(T){return this._as.indexOf(T)},each:function(B,v){for(var h=0,k=this._as.length;k>h;h++){var c=this._as[h];v?B.call(v,c,h,this):B(c,h,this)}},reverseEach:function(M,V){for(var w=this._as.length-1;w>=0;w--){var l=this._as[w];V?M.call(V,l):M(l)}},toArray:function(H,N){if(H){for(var e,t=[],g=0,F=this._as.length;F>g;g++)e=this._as[g],N?H.call(N,e)&&t.push(e):H(e)&&t.push(e);return t}return this._as.concat()},toList:function(g,T){if(g){for(var q,y=new Nf,n=0,c=this._as.length;c>n;n++)q=this._as[n],T?g.call(T,q)&&y.add(q):g(q)&&y.add(q);return y}return new Nf(this)},reverse:function(){this._as.reverse()},sort:function(U){return this._as.sort(U?U:_f),this},toString:function(){return this._as.toString()}}),u.defineProperties(Nf.prototype,{length:{get:function(){return this._as.length},set:function(g){this._as.length=g}}});var De=new Nf;mm(De,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:ys,each:ys,reverseEach:ys,toArray:function(){return[]},toList:function(){return new Nf},add:Kd,addAll:Kd,set:Kd,remove:Kd,removeAt:Kd,clear:Kd});var Gc=o.Matrix=function(e,z,P,j,l){var o=this;e=e||0;var s=A(e),F=G(e);j=j||1,l=l||1,o.a=F*j,o.b=s*j,o.c=-s*l,o.d=F*l,o.tx=z||0,o.ty=P||0};Gc.prototype.tf=function($,g){1===arguments.length&&(g=$.y,$=$.x);var L=this;return{x:L.a*$+L.c*g+L.tx,y:L.b*$+L.d*g+L.ty}},Gc.prototype.translate=function(m,v){var A=this;return A.tx+=m,A.ty+=v,A},Gc.prototype.scale=function(s,q){var v=this;return v.a*=s,v.d*=q,v.c*=s,v.b*=q,v.tx*=s,v.ty*=q,v},Gc.prototype.rotate=function(N){var X=G(N),z=A(N),l=this,U=l.a,Q=l.c,D=l.tx;return l.a=U*X-l.b*z,l.b=U*z+l.b*X,l.c=Q*X-l.d*z,l.d=Q*z+l.d*X,l.tx=D*X-l.ty*z,l.ty=D*z+l.ty*X,l},Gc.prototype.transform=function(o){var G=this,A=o.a,Y=o.b,U=o.c,u=o.d,K=o.tx,k=o.ty,q=G.a,a=G.b,n=G.c,$=G.d,N=G.tx,c=G.ty;return G.a=A*q+U*a,G.b=Y*q+u*a,G.c=A*n+U*$,G.d=Y*n+u*$,G.tx=A*N+U*c+K,G.ty=Y*N+u*c+k,G},Gc.prototype.tfi=function(O,c){1===arguments.length&&(c=O.y,O=O.x);var D=this,p=1/(D.a*D.d+D.c*-D.b);return{x:D.d*p*O+-D.c*p*c+(D.ty*D.c-D.tx*D.d)*p,y:D.a*p*c+-D.b*p*O+(-D.ty*D.a+D.tx*D.b)*p}};var Vp=o.Notifier=function(){this._f=0};_q("Notifier",u,{contains:function(f,v){if(this._ls)for(var A,N=0,I=this._ls.size();I>N;N++)if(A=this._ls.get(N),f===A.l&&v===A.s)return!0;return!1},add:function(n,p,D){var e=this,J={l:n,s:p,a:D};e._ls||(e._ls=new Nf),e._f?(e._as||(e._as=new Nf),e._as.add(J)):J.a?e._ls.add(J,0):e._ls.add(J)},remove:function(d,c){var t=this;t._ls&&(t._f?(t._rs||(t._rs=new Nf),t._rs.add({l:d,s:c})):t._remove(d,c))},_remove:function($,z){for(var f,q=this._ls,E=0,P=q.size();P>E;E++)if(f=q.get(E),f.l===$&&f.s===z)return q.removeAt(E),void 0},fire:function(I){var b=this,D=b._ls;if(b._b=1e4,D){++b._f;try{for(var P,B=0,V=D.size();V>B;B++)P=D.get(B),P.s?P.l.call(P.s,I):P.l(I)}finally{if(--b._f)return;if(b._rs){for(V=b._rs.size(),B=0;V>B;B++)P=b._rs.get(B),b._remove(P.l,P.s);delete b._rs}if(b._as){for(V=b._as.size(),B=0;V>B;B++)P=b._as.get(B),P.a?D.add(P,0):D.add(P);delete b._as}}}}});var fc=o.Data=function(){this._id=vd()};_q("Data",u,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:m,_parent:m,_children:De,_childMap:m,_styleMap:m,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return m},_22Q:function(){return m},s:function(K,p){var J=this;if(2===arguments.length)J.setStyle(K,p);else{if(!hk(K))return J.getStyle(K);for(var b in K)J.setStyle(b,K[b])}return J},fp:function(L,z,T,k,x){return this.firePropertyChange(L,z,T,k,x)},firePropertyChange:function(L,X,i,O,y){if(O){if(O(X,i))return!1}else if(X===i)return!1;var $=this,d=y||{};return d.property=L,d.oldValue=X,d.newValue=i,d.data=$,$._dataModel&&$._dataModel.handleDataPropertyChange(d),$.onPropertyChanged(d),!0},onPropertyChanged:function(z){var k=this,_=k._parent,E=z.property;if(Dn(_)){var V=k.s(Sk),F="s:ingroup"===E;(V&&ir[E]||E===F)&&_._81I(),(V||F)&&_.fp("childChange",!0,!1)}$h(_)&&ir[E]&&_.updateFromChildren()},_21I:function(Q){var R=this;if(Q&&R._dataModel)throw"Remove data from dataModel before adding";R._dataModel=Q},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var H=0,W=this._children.toArray(),j=W.length;j>H;H++)W[H].removeFromDataModel()},getId:function(){return this._id},setId:function(A){this._id=A},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(A,q){return this._children.toList(A,q)},eachChild:function(A,k){this._children.each(A,k)},addChild:function(w,J){var T=this;w!==T&&(T._children===De&&(T._children=new Nf,T._childMap={}),J>=0||(J=T._children.size()),T._childMap[w._id]||T.isDescendantOf(w)||(w._parent&&w._parent.removeChild(w),(0>J||J>T._children.size())&&(J=T._children.size()),T._children.add(w,J),T._childMap[w._id]=w,w.setParent(T),T.onChildAdded(w,J),T.fp(li,m,w)))},onChildAdded:function(){},removeChild:function(J){var L=this;if(L._childMap&&L._childMap[J._id]){var B=L._children.remove(J);delete L._childMap[J._id],L.fp(li,J,m),J.setParent(m,B),L.onChildRemoved(J,B)}},onChildRemoved:function(){},getChildAt:function(F){return this._children.get(F)},clearChildren:function(){var P=this;if(!P._children.isEmpty())for(var v=0,b=P._children.toArray(),t=b.length;t>v;v++)P.removeChild(b[v])},getParent:function(){return this._parent},setParent:function(F,e){var W=this;if(!(W._73I||W._parent===F||W===F||F&&F.isDescendantOf(W))){var n,Q=W._parent;W._parent=F,W._73I=1,Q?(e==m&&(e=Q.getChildren().indexOf(W)),Q.removeChild(W)):W._dataModel&&e==m&&(e=W._dataModel.getRoots().indexOf(W)),F&&(F.addChild(W),n=F.getChildren().indexOf(W)),delete W._73I,W.fp("parent",Q,F,Y,{oldIndex:e,newIndex:n}),W.onParentChanged(Q,F)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(g){return g?this.isDescendantOf(g)||g.isDescendantOf(this):!1},isParentOf:function(m){return m&&this._childMap?!!this._childMap[m._id]:!1},isDescendantOf:function(A){if(!A||A.isEmpty())return!1;for(var u=this._parent;u;){if(A===u)return!0;u=u._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(c,N){N===Y&&(N=1);var n=this._styleMap?this._styleMap[c]:Y;return n===Y&&N?_[c]:n},setStyle:function(h,c){var S=this;S._styleMap||(S._styleMap={});var n=S._styleMap[h];c===Y?delete S._styleMap[h]:S._styleMap[h]=c,S.fp("s:"+h,n,c)&&S.onStyleChanged(h,n,c)},onStyleChanged:function(){},iv:function(){this.invalidate()},invalidate:function(){this.fp("*",!1,!0)},toString:function(){var J=this;return J._displayName||J._name||J._tag||J._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(p,Q){var f=this,o=f.s(qe);o||f.s(qe,o={}),Q?o[p]=Q:delete o[p],f.fp(qe,m,o)},removeStyleIcon:function(G){var n=this.s(qe);if(n){var U=n[G];delete n[G],this.fp(qe,m,n)}return U},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var Q,X={};for(Q in this._styleMap)X[Q]=1;return X}});var Bd=o.DataModel=function(){var G=this;G._datas=new Nf,G._dataMap={},G._roots=new Nf,G._rootMap={},G._78O={},G._36I=new Vp,G._35I=new Vp,G._selectionModel=new bk(G);var c=G._29Q=[],p=G._scheduleCallback=function(){for(var L=Date.now(),i=0;i<c.length;i++){var K=c[i];K.enabled&&L-K.lastTime>K.interval&&(K.beforeAction&&K.beforeAction(),G.each(function(F){K.action(F)}),K.afterAction&&K.afterAction(),K.lastTime=L)}c.length&&(G._30Q=P.requestAnimationFrame(p))}};_q("DataModel",u,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:Y,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:Y,_init:Y,sm:function(){return this.getSelectionModel()},mm:function(Y,F,O){this.addDataModelChangeListener(Y,F,O)},umm:function(D,g){this.removeDataModelChangeListener(D,g)},md:function(O,K,$){this.addDataPropertyChangeListener(O,K,$)},umd:function(I,x){this.removeDataPropertyChangeListener(I,x)},mh:function(a,J,x){this.addHierarchyChangeListener(a,J,x)},umh:function(X,y){this.removeHierarchyChangeListener(X,y)},getAttrObject:function(){return this._attrObject},setAttrObject:function(B){return this._attrObject=B},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(O){return this._dataMap[O]},removeDataById:function(G){this.remove(this.getDataById(G))},toDatas:function(m,I){return this._datas.toList(m,I)},each:function(Q,R){this._datas.each(Q,R)},getDataByTag:function(F){return this._78O[F]},getTagMap:function(){return this._78O},removeDataByTag:function(C){this.remove(this.getDataByTag(C))},add:function(I,$,q){var l=this,X=I._id,x=I._tag,u=l._roots;if(l._dataMap[X])throw"'"+X+"' already exists";x!=m&&(l._78O[x]=I),l._dataMap[X]=I,q>=0?l._datas.add(I,q):l._datas.add(I),I._parent||(l._rootMap[X]=I,$>=0?u.add(I,$):u.add(I)),I._21I(l),l.onAdded(I),l._36I.fire({kind:"add",data:I,rootsIndex:$,datasIndex:q})},onAdded:function(){},remove:function(G,B){if(G){var h=this,F=G._id,x=B&&B.keepStructure,Q=B&&B.keepChildren,V=G.getTag();if(G._dataModel===h){this.beginTransaction(),x?h._removingData||(h._removingData=G):h.prepareRemove(G),Q||G.toChildren().each(function(e){h.remove(e,B)},h),x?h._removingData===G&&(G._parent&&G._parent.removeChild(G),delete h._removingData):G._parent&&G._parent.removeChild(G);var v=h._datas.remove(G);delete h._dataMap[F],V!=m&&delete h._78O[V];var w;h._rootMap[F]&&(delete h._rootMap[F],w=h._roots.remove(G)),G._21I(m),h.onRemoved(G),h._36I.fire({kind:Ze,data:G,rootsIndex:w,datasIndex:v}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var b=this;if(b._datas.size()){var x=b._historyManager?this.toJSON():Y;b._datas.toArray().forEach(function(u){u._21I(m)}),b._datas.clear(),b._dataMap={},b._roots.clear(),b._rootMap={},b._78O={},b._36I.fire({kind:nf,json:x})}},contains:function(E){return E&&E._dataModel===this},handleDataPropertyChange:function(p){var A=this,K=p.data,U=p.property;if("parent"===U){var R=K._id,I=A._rootMap,S=A._roots;K._parent?I[R]&&(delete I[R],S.remove(K)):I[R]||(I[R]=K,S.add(K))}else if("tag"===U){var F=p.oldValue,t=p.newValue,i=A._78O;F!=m&&delete i[F],t!=m&&(i[t]=K)}this.onDataPropertyChanged(K,p),this._35I.fire(p)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(W,S,$){this._36I.add(W,S,$)},removeDataModelChangeListener:function(a,O){this._36I.remove(a,O)},addDataPropertyChangeListener:function(l,y,U){this._35I.add(l,y,U)},removeDataPropertyChangeListener:function(s,g){this._35I.remove(s,g)},_38I:function(Z,R,Q){this._37I&&this._37I.fire({data:Z,oldIndex:R,newIndex:Q})},addHierarchyChangeListener:function(d,v,F){this._37I||(this._37I=new Vp),this._37I.add(d,v,F)},removeHierarchyChangeListener:function(e,I){this._37I.remove(e,I)},getSiblings:function(l){var X=l._parent;return X?X._children:this._roots},eachByHierarchical:function(Y,L,c){if(L)return this._eachByHierarchical(Y,L,c);for(var b=0,i=this._roots,U=i.size();U>b;b++)if(this._eachByHierarchical(Y,i.get(b),c)===!1)return!1;return!0},_eachByHierarchical:function(m,D,q){if(q){if(m.call(q,D)===!1)return!1}else if(m(D)===!1)return!1;for(var A=D.size(),N=0;A>N;N++)if(this._eachByHierarchical(m,D.getChildAt(N),q)===!1)return!1;return!0},reverseEachByHierarchical:function(P,K,J){if(K)return this._reverseEachByHierarchical(P,K,J);for(var l=this._roots,G=l.size(),x=G-1;x>=0;x--)if(this._reverseEachByHierarchical(P,l.get(x),J)===!1)return!1;return!0},_reverseEachByHierarchical:function($,q,L){for(var Z=q.size(),V=Z-1;V>=0;V--)if(this._reverseEachByHierarchical($,q.getChildAt(V),L)===!1)return!1;if(L){if($.call(L,q)===!1)return!1}else if($(q)===!1)return!1;return!0},eachByDepthFirst:function(x,N,M){if(N)return this._11I(x,N,M);for(var O=0,k=this._roots,_=k.size();_>O;O++)if(this._11I(x,k.get(O),M)===!1)return!1;return!0},_11I:function(T,b,e){for(var W=b.size(),g=0;W>g;g++)if(this._11I(T,b.getChildAt(g),e)===!1)return!1;if(e){if(T.call(e,b)===!1)return!1}else if(T(b)===!1)return!1;return!0},eachByBreadthFirst:function(y,f,o){var R=new Nf;for(f?R.add(f):this._roots.each(R.add,R);R.size()>0;)if(f=R.removeAt(0),f.eachChild(R.add,R),o){if(y.call(o,f)===!1)return!1}else if(y(f)===!1)return!1;return!0},moveTo:function(M,k){var K=this.getSiblings(M),E=K.indexOf(M);E===k||0>E||k>=0&&k<=K.size()&&(K.remove(M),k>K.size()&&k--,K.add(M,k),this._38I(M,E,k))},moveUp:function(S){this.moveTo(S,this.getSiblings(S).indexOf(S)-1)},moveDown:function(n){this.moveTo(n,this.getSiblings(n).indexOf(n)+1)},moveToTop:function(d){this.moveTo(d,0)},moveToBottom:function(I){this.moveTo(I,this.getSiblings(I).size())},moveSelectionUp:function(d){this.beginTransaction(),d||(d=this.sm());var w=new Nf;Bk(d,w,this._roots),w.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(O){this.beginTransaction(),O||(O=this.sm());var S=new Nf;Fn(O,S,this._roots),S.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(V){this.beginTransaction(),V||(V=this.sm());var k=new Nf;Dr(V,k,this._roots),k.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(j){this.beginTransaction(),j||(j=this.sm());var W=new Nf;Xq(j,W,this._roots),W.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(h,L,B){var A=this.getDatas();null==B&&(B=A.indexOf(h)),B===L||0>B||L>=0&&L<=A.size()&&(A.remove(h),L>A.size()&&L--,A.add(h,L),this._76I(h,B,L))},bringForward:function(r){this.moveToIndex(r,this.getDatas().indexOf(r)+1)},bringToFront:function(O){this.moveToIndex(O,this.size())},sendBackward:function(X){this.moveToIndex(X,this.getDatas().indexOf(X)-1)},sendToBack:function(J){this.moveToIndex(J,0)},bringSelectionForward:function(K){this.beginTransaction(),K||(K=this.sm());for(var A=new Nf,t=this.getDatas(),h=!1,M=0;M<t.size();M++){var R=t.get(t.size()-1-M);K.contains(R)?h&&A.add(R):h=!0}A.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(N){this.beginTransaction(),N||(N=this.sm());for(var i=new Nf,R=this.getDatas(),E=0;E<R.size();E++){var J=R.get(E);N.contains(J)&&i.add(J)}i.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(n){this.beginTransaction(),n||(n=this.sm());for(var r=new Nf,v=this.getDatas(),S=!1,A=0;A<v.size();A++){var i=v.get(A);n.contains(i)?S&&r.add(i):S=!0}r.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(v){this.beginTransaction(),v||(v=this.sm());for(var g=new Nf,O=this.getDatas(),z=0;z<O.size();z++){var R=O.get(O.size()-1-z);v.contains(R)&&g.add(R)}g.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(e){var p=this;p.removeScheduleTask(e),e.enabled==m&&(e.enabled=!0),e.interval==m&&(e.interval=10),e.action==m&&(e.action=ys),e.lastTime=Date.now(),p._29Q.push(e),p._30Q==m&&(p._30Q=P.requestAnimationFrame(p._scheduleCallback))},removeScheduleTask:function(S){var r=this,l=r._29Q,G=l.indexOf(S);G>=0&&l.splice(G,1),l.length||r._30Q==m||(P.cancelAnimationFrame(r._30Q),delete r._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(t){this._historyManager||new o.HistoryManager(this),null!=t&&this._historyManager.setMaxHistoryCount(t),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(a){this._historyManager&&this._historyManager.undo(a)},redo:function(O){this._historyManager&&this._historyManager.redo(O)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(a){this._historyManager&&this._historyManager.addHistory(a)},onHistoryManagerChanged:function(){}});var bk=o.SelectionModel=function(K){var g=this;g._68O=mc,g._map={},g._73O=new Nf,g._74I=new Vp,g._21I(K)};_q("SelectionModel",u,{ms_fire:1,ms_dm:1,ms:function(B,x,t){this.addSelectionChangeListener(B,x,t)},ums:function(z,Q){this.removeSelectionChangeListener(z,Q)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===bi},co:function(A){return this._map[A._id]!=m},ss:function(V){this.setSelection(V)},as:function(F){this.appendSelection(F)},rs:function(e){this.removeSelection(e)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(x){var r=this;if(r._68O!==x&&(x===Ag||x===bi||x===mc)){r.cs();var J=r._68O;r._68O=x,r.fp("selectionMode",J,x)}},_21I:function(H){var p=this,l=p._dataModel;l!==H&&(l&&(p.cs(),l.umm(p.handleDataModelChange,p)),p._dataModel=H,H.mm(p.handleDataModelChange,p,!0),p.fp(lq,l,H))},dispose:function(){var R=this;R.cs(),R._dataModel.umm(R.handleDataModelChange,R)},handleDataModelChange:function(M){var x=this;if(M.kind===Ze){var R=M.data;x.co(R)&&(x._73O.remove(R),delete x._map[R._id],x._75I(Ze,new Nf(R)))}else M.kind===nf&&x.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(G){var k=this;if(k._filterFunc!==G){k.cs();var j=k._filterFunc;k._filterFunc=G,k.fp("filterFunc",j,k._filterFunc)}},_75I:function(O,p,d,w){d&&(this._73O.each(function(O){w[O._id]?d.remove(O):d.add(O)}),p=d.toList()),this._74I.fire({kind:O,datas:new Nf(p)})},addSelectionChangeListener:function(I,G,p){this._74I.add(I,G,p)},removeSelectionChangeListener:function(y,F){this._74I.remove(y,F)},_97O:function(d,N){for(var s,A=this,T=0,e=new Nf(d);T<e.size();T++)s=e.get(T),(A._filterFunc&&!A._filterFunc(s)||N&&A.co(s)||!N&&!A.co(s)||!A._dataModel.contains(s))&&(e.removeAt(T),T--);return e},appendSelection:function(r){var a=this;if(a._68O!==Ag){var _,B,h=a._73O,I=a._97O(r,!0);I.isEmpty()||(a.sg()&&(_=new Nf(h),B=a._map,h.clear(),a._map={},I=new Nf(I.get(I.size()-1))),I.each(function(I){h.add(I),a._map[I._id]=I}),a._75I("append",I,_,B))}},removeSelection:function(s){var P=this,z=P._97O(s),m=0,$=z.size();if(0!==$){for(;$>m;m++){var G=z.get(m);P._73O.remove(G),delete P._map[G._id]}P._75I(Ze,z)}},toSelection:function(H,Y){return this._73O.toList(H,Y)},getSelection:function(){return this._73O},each:function(m,L){this._73O.each(m,L)},setSelection:function(U){var s=this,n=s._73O;if(s._68O!==Ag&&!(n.isEmpty()&&!U||1===n.size()&&s.ld()===U)){var y=new Nf(n),d=s._map;n.clear(),s._map={};var E=s._97O(U,!0);s.sg()&&E.size()>1&&(E=new Nf(E.get(E.size()-1))),E.each(function(b){n.add(b),s._map[b._id]=b}),s._75I("set",m,y,d)}},clearSelection:function(){var j=this,p=j._73O;if(p.size()>0){var Q=p.toList();p.clear(),j._map={},j._75I(nf,Q)}},selectAll:function(){var L=this;if(L._68O!==Ag){var F,P,A=L._dataModel.toDatas();if(L._filterFunc)for(F=0;F<A.size();F++)P=A.get(F),L._filterFunc(P)||(A.removeAt(F),F--);var B=L._73O,r=new Nf(B),q=L._map;B.clear(),L._map={},L.sg()&&A.size()>1&&(A=new Nf(A.get(A.size()-1)));var k=A.size();for(F=0;k>F;F++)P=A.get(F),B.add(P),L._map[P._id]=P;L._75I("all",m,r,q)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(v){return this._map[v._id]!=m},getLastData:function(){var h=this._73O;return h.size()>0?h.get(h.size()-1):m},getFirstData:function(){var d=this._73O;return d.size()>0?d.get(0):m},isSelectable:function(y){var x=this;return y&&x._68O!==Ag?x._filterFunc?x._filterFunc(y):!0:!1},getTopSelection:function(){var R=this,O=new Nf;return R._73O.each(function(B){for(var t=B.getParent();t;){if(R.contains(t)){B=m;break}t=t.parent}B&&O.add(B)}),O}});var Lq=function(){return or(0),function(V,z){var G;if(Dq(z)){var P=V.getDataUI(z);P&&P._88I&&(G=P._88I.rect)}return G?G:z.getRect()}}();mm(b,{edgeGroupAgentFunc:m,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:s.rectSelectBorder,graphViewRectSelectBackground:Ec,graphViewEditPointSize:L?17:7,graphViewEditPointBorderColor:s.editPointBorder,graphViewEditPointBackground:s.editPointBackground,setEdgeType:function(H,T,w){Jh[H]=T,ls[H]=w},getEdgeType:function(x){return Jh[x]},getEdgeTypeMap:function(){return Jh},getNodeRect:Lq},!0),mm(_,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":Y,"image.stretch":"fill",icons:Y,ingroup:!0,"body.color":Y,opacity:Y,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":Hj,"select.width":1,"select.padding":2,"select.type":fj,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":Y,"border.width":2,"border.padding":2,"border.type":fj,label:Y,"label.font":Y,"label.color":Ol,"label.background":Y,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":Y,"label.max":Y,"label.opacity":Y,"label.scale":1,"label.align":Y,"label.selectable":!0,label2:Y,"label2.font":Y,"label2.color":Ol,"label2.background":Y,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":Y,"label2.max":Y,"label2.opacity":Y,"label2.scale":1,"label2.align":Y,"label2.selectable":!0,note:Y,"note.expanded":!0,"note.font":Y,"note.color":Ac,"note.background":Hj,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":Y,"note.toggleable":!0,"note.border.width":1,"note.border.color":Y,"note.opacity":Y,"note.scale":1,"note.align":Y,note2:Y,"note2.expanded":!0,"note2.font":Y,"note2.color":Ac,"note2.background":Hj,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":Y,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":Y,"note2.opacity":Y,"note2.scale":1,"note2.align":Y,"group.type":Y,"group.image":Y,"group.image.stretch":"fill","group.repeat.image":Y,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":Y,"group.title.color":Ac,"group.title.background":s.groupTitleBackground,"group.title.align":ip,"group.background":s.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":Y,"group.border.color":vn,"group.border.cap":rr,"group.border.join":Iq,"group.gradient":m,"group.gradient.color":"#FFF",shape:Y,"shape.background":vn,"shape.repeat.image":Y,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":vn,"shape.border.3d":!1,"shape.border.3d.color":Y,"shape.border.3d.accuracy":Y,"shape.border.cap":rr,"shape.border.join":Iq,"shape.border.pattern":Y,"shape.gradient":m,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":qj,"shape.dash.offset":0,"shape.dash.color":lh,"shape.dash.width":Y,"shape.dash.3d":!1,"shape.dash.3d.color":Y,"shape.dash.3d.accuracy":Y,"shape.polygon.side":6,"shape.arc.from":j,"shape.arc.to":k,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":Y,"shape.gradient.pack":Y,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":Y,"autolayout.hgap":Y,"autolayout.vgap":Y,"edge.type":Y,"edge.points":Y,"edge.segments":Y,"edge.color":vn,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":Y,"edge.3d.accuracy":Y,"edge.cap":rr,"edge.join":Iq,"edge.source.position":17,"edge.source.anchor.x":Y,"edge.source.anchor.y":Y,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":Y,"edge.target.anchor.y":Y,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":Y,"edge.dash":!1,"edge.dash.pattern":qj,"edge.dash.offset":0,"edge.dash.color":lh,"edge.dash.width":Y,"edge.dash.3d":!1,"edge.dash.3d.color":Y,"edge.dash.3d.accuracy":Y,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":Y,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":Y,"grid.column.percents":Y,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":s.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":s.gridCellBorderColor,"grid.block":Y,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":s.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Ol,"text.font":_h,"text.shadow":!1,"text.shadow.color":Zp,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),mm(Bd,{_76I:function(O,Y,I){this._39I&&this._39I.fire({data:O,oldIndex:Y,newIndex:I})
},addIndexChangeListener:function(i,I,x){var l=this;l._39I||(l._39I=new Vp),l._39I.add(i,I,x)},removeIndexChangeListener:function(I,Y){this._39I.remove(I,Y)},prepareRemove:function(Z){qr(Z)&&(Z.setSource(m),Z.setTarget(m)),Z._70O&&Z._70O.toList().each(this.remove,this),Z._69O&&Z._69O.toList().each(function(Y){Y.setHost(m)}),Z._host&&Z.setHost(m)},onAdded:function(d){this.isAutoAdjustIndex()&&this.adjustIndex(d)},onDataPropertyChanged:function(v,K){Co[K.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(v)},isAdjustable:function(j){return Lg(j)||qr(j)},isAdjustedToBottom:function(u){return Dn(u)?u.isExpanded()&&Yl(u):!1},adjustIndex:function(h){var w=this;this.isHierarchicalRendering()||(w.isAdjustedToBottom(h)?(w.sendToBottom(h),h.eachChild(w.adjustIndex,w)):w.sendToTop(h))},sendToTop:function(D){var e=this;if(e.contains(D)&&e.isAdjustable(D)){var $=e._datas;if(D!==$.get(e.size()-1)){var g=$.indexOf(D);$.removeAt(g),$.add(D),e._76I(D,g,e.size()-1)}if(qr(D)){var b=D._40I;b&&!e.isAdjustedToBottom(b)&&e.sendToTop(b),b=D._41I,b&&!e.isAdjustedToBottom(b)&&e.sendToTop(b)}D._69O&&D._69O.each(function(N){N.isRelatedTo(D)||Lg(D)&&N.isLoopedHostOn(D)||e.sendToTop(N)}),D.ISubGraph||(!Dn(D)||D.isExpanded())&&D._adjustChildrenToTop&&D.eachChild(function(T){qr(T)||e.sendToTop(T)})}},sendToBottom:function(b,K){var x=this;if(b!==K&&x.contains(b)&&x.isAdjustable(b)&&(!K||x.contains(K))){var $=x._datas,k=$.remove(b),Q=K?x._datas.indexOf(K):0;if($.add(b,Q),k!==Q){x._76I(b,k,Q);var e=b._parent;!e||e.ISubGraph||qr(e)||x.sendToBottom(b._parent,b)}}}}),mm(qd,{ms_edit:function(o){o._46O=function(g){var O=this,Z=O.gv.dm(),r=O._index,x=O._89I,D=O._node,k=O._shape,U=O._edge,J=O._77I;D&&x?(this.fi({kind:"endEditRect",event:g,data:D,direction:x}),Z.endTransaction()):k&&r>=0?(O.fi({kind:"endEditPoint",event:g,data:k,index:r}),Z.endTransaction()):U&&r>=0?(O.fi({kind:"endEditPoint",event:g,data:U,index:r}),Z.endTransaction()):J&&(O.fi({kind:"endEditRotation",event:g,data:J}),Z.endTransaction())},o._78I=function(F){var I=this;I.autoScroll(F);var E=I.gv.lp(F),e=I._index,t=I._89I,f=I._node,A=I._shape,P=I._edge,$=I._77I;if(f&&t)I._80O(E),I.fi({kind:"betweenEditRect",event:F,data:f,direction:t});else if(A&&e>=0)E.e=A.getPoints().get(e).e,A.setPoint(e,E),I.fi({kind:"betweenEditPoint",event:F,data:A,index:e});else if(P&&e>=0){var _=P.s(Sc);E.e=_.get(e).e,_.set(e,E),P.fp(Sc,m,_),I.fi({kind:"betweenEditPoint",event:F,data:P,index:e})}else if($){var B=$.p(),p=$.getScale(),U=y+r(E.y-B.y,E.x-B.x);p.y<0&&(U+=j),w(U)<.04&&(U=0),$.setRotation(U),I.fi({kind:"betweenEditRotation",event:F,data:$})}},o._80O=function(Z){var L=this,N=L._node,o=L._rect,B=o.x,h=o.y,z=o.width,n=o.height,D=L._89I,P=L._anchor,M=L._matrix,Z=M.tfi(Z);"northwest"===D?o=Td(Z,{x:B+z,y:h+n}):D===er?o=Td({x:B,y:Z.y},{x:B+z,y:h+n}):"northeast"===D?o=Td({x:B,y:Z.y},{x:Z.x,y:h+n}):D===ge?o=Td({x:Z.x,y:h},{x:B+z,y:h+n}):D===cj?o=Td({x:B,y:h},{x:Z.x,y:h+n}):"southwest"===D?o=Td({x:Z.x,y:h},{x:B+z,y:Z.y}):"south"===D?o=Td({x:B,y:h},{x:B+z,y:Z.y}):"southeast"===D&&(o=Td({x:B,y:h},Z)),N.setPosition(M.tf(o.x+o.width*P.x,o.y+o.height*P.y)),N.setWidth(o.width),N.setHeight(o.height)},o._80I=function(G,v,N,m){var O=this,J=O.gv._zoom,e=(O.gv.getEditPointSize()+2)/J;return qf({x:v-e/2,y:N-e/2,width:e,height:e},G)?(O._89I!==m&&(O._89I=m),!0):!1},o._79I=function(L,N,z){var W=this,p=W.gv,R=N?p.getDataUI(N):m,S=R?R._55O:m;if(S){var E,n,l,s,P=p._zoom,K=(p.getEditPointSize()+2)/P,B=p.lp(L);if(Lg(N)){if(S._56O&&Lg(N)&&(n=S._98o,qf({x:n.x-K/2,y:n.y-K/2,width:K,height:K},B)))return W._77I=N,z&&W.fi({kind:"beginEditRotation",event:L,data:N}),W.setCursor("crosshair"),!0;if(S._43O&&N instanceof Jn)for(l=N.getPoints(),E=l.size()-1;E>=0;E--)if(n=l.get(E),qf({x:n.x-K/2,y:n.y-K/2,width:K,height:K},B))return W._index=E,W._shape=N,z&&W.fi({kind:"beginEditPoint",event:L,data:N,index:E}),W.setCursor("crosshair"),!0;if(S._42O)for(var Y=N.getEditControlPoints(),O=["northwest",-1,-1,ge,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,cj,1,0,"northeast",1,-1,er,0,-1],E=0,s=Y.length;s>E;E++){var b=O[3*E],r=Y[E];if(W._80I(B,r.x,r.y,b)){W._node=N;var w=N.getWidth(),c=N.getHeight(),o=N.getAnchor();W._rect={x:-w*o.x,y:-c*o.y,width:w,height:c},W._anchor=o,W._matrix=N.getMatrix();var x=N.getRotation(),f=G(x),X=A(x),H=O[3*E+1]*Dp(N.getScale().x),Z=O[3*E+2]*Dp(N.getScale().y),d=Math.atan2(-X*H-f*Z,f*H-X*Z),e=(Math.round(d/(Math.PI/4))+8)%8,$=[bo,"nesw-resize",Vl,"nwse-resize",bo,"nesw-resize",Vl,"nwse-resize"][e];return W.setCursor($),z&&W.fi({kind:"beginEditRect",event:L,data:N,direction:W._89I}),!0}}}if(S._43O&&qr(N)&&N.s(Yc)===_l&&(l=N.s(Sc)))for(E=l.size()-1;E>=0;E--)if(n=l.get(E),qf({x:n.x-K/2,y:n.y-K/2,width:K,height:K},B))return W._index=E,W._edge=N,z&&W.fi({kind:"beginEditPoint",event:L,data:N,index:E}),W.setCursor("crosshair"),!0}return!1}},ms_gv:function(Q){Q._currentSubGraph=m,Q.upSubGraph=function(){this.setCurrentSubGraph(xj(this._currentSubGraph))},Q.isVisible=function(P){var g=this;if(xj(P)!==g._currentSubGraph)return!1;if(qr(P)){var B=P._40I,V=P._41I;if(!B||!V)return!1;if(!(P.s("edge.independent")||g.isVisible(B)&&g.isVisible(V)))return!1;if(P.isEdgeGroupHidden())return!1}else for(var b=P._parent;b&&!b.ISubGraph;){if(Dn(b)&&(!b.isExpanded()||!g.isVisible(b)))return!1;b=b._parent}if(P._parent instanceof hj&&!g.isVisible(P._parent))return!1;if(P._refGraph instanceof lg&&!g.isVisible(P._refGraph))return!1;if(g instanceof Qg){if(!P.s("3d.visible"))return!1}else{var m=g.getLayersInfo();if(m){var D=m[P._layer];if(D&&D.visible===!1)return!1}if(!P.s("2d.visible"))return!1}return g._visibleFunc?g._visibleFunc(P):!0},Q.handleSelectionChange=function(w){var R=this;w.datas.each(function(i){R.invalidateData(i);var v=i._parent;Dn(v)&&Lg(i)&&i.s(Sk)&&(R.invalidateData(v),v._49I&&v._49I.each(function(m){R.invalidateData(m)}))}),R.onSelectionChanged(w)},Q.onSelectionChanged=function(W){var D=this,N=D.sm();if(1===N.size()&&("set"===W.kind||"append"===W.kind)){var v=N.ld();D.isAutoMakeVisible()&&D.makeVisible(v),D.adjustIndex&&D._dataModel.isAutoAdjustIndex()&&D.adjustIndex(v)}},Q.makeVisible=function(S){if(S){var z=this,j=z.getDataUI?z.getDataUI(S):z.getData3dUI(S);if(j){var u=S,D=xj(S);for(D!==z._currentSubGraph&&z.setCurrentSubGraph(D);(u=u._parent)&&u!==D;)Dn(u)&&u.setExpanded(!0);z._23I=S,z.iv()}}},Q.getLabel=function(f){var E=f.getStyle(yr);return E===Y?f.getName():E},Q.getLabelBackground=function(k){return k.getStyle("label.background")},Q.getLabelColor=function(A){return A.getStyle("label.color")},Q.getLabel2=function(y){return y.getStyle("label2")},Q.getLabel2Background=function(k){return k.getStyle("label2.background")},Q.getLabel2Color=function(O){return O.getStyle("label2.color")},Q.getNote=function(O){return O.getStyle(ne)},Q.getNoteBackground=function(O){return O.getStyle("note.background")},Q.getNote2=function(S){return S.getStyle(Hh)},Q.getNote2Background=function(o){return o.getStyle("note2.background")},Q.handleClick=function(L,R,q){var B=this;R?(B.fi({kind:"clickData",event:L,data:R,part:q}),B.onDataClicked(R,L)):(B.fi({kind:"clickBackground",event:L}),B.onBackgroundClicked(L))},Q.handleDoubleClick=function(t,i,l){var q=this;zj(t)&&(i?(q.fi({kind:"doubleClickData",event:t,data:i,part:l}),q.onDataDoubleClicked(i,t,l),q.checkDoubleClickOnNote(t,i,l)||q.checkDoubleClickOnRotation&&q.checkDoubleClickOnRotation(t,i,l)||(qr(i)?q.onEdgeDoubleClicked(i,t,l):i.ISubGraph?q.onSubGraphDoubleClicked(i,t,l):Dn(i)?q.onGroupDoubleClicked(i,t,l):i.IDoorWindow?q.onDoorWindowDoubleClicked(i,t,l):i.ICSGBox&&q.onCSGBoxDoubleClicked(i,t,l))):(q.fi({kind:"doubleClickBackground",event:t}),q.onBackgroundDoubleClicked(t)))},Q.onSubGraphDoubleClicked=function(w){this.setCurrentSubGraph(w)},Q.onEdgeDoubleClicked=function(A,X){A.ISubGraph&&!fo(X)?this.setCurrentSubGraph(A):A.s("edge.toggleable")&&A.toggle()},Q.onGroupDoubleClicked=function(g){g.s("group.toggleable")&&g.toggle()},Q.onDoorWindowDoubleClicked=function(L){L.s("dw.toggleable")&&L.toggle(!0)},Q.onCSGBoxDoubleClicked=function(i,w){var Y=this;if(Y instanceof Qg){var e=Y.getHitFaceInfo(w);e&&e.face&&i.s(e.face+".toggleable")&&i.toggleFace(e.face,!0)}},Q.onBackgroundClicked=function(){},Q.onBackgroundDoubleClicked=function(){this.upSubGraph()},Q.onDataClicked=function(){},Q.onDataDoubleClicked=function(){},Q.onAutoLayoutEnded=function(){},Q.onMoveEnded=function(){},Q.onPanEnded=function(){},Q.onPinchEnded=function(){},Q.onRectSelectEnded=function(){},Q.onZoomEnded=function(){}},ms_icons:function(o){o.getRotation=function(u){return u==m?0:u},o._15O=function(){var Z=this,w=Z.s(qe);if(w){var F=Z,U=Z.data||Z._data,s=Z._38o={icons:w,rects:{}};for(var B in w){var q=w[B],V=Nd(q.shape3d,U,F);if(!(Nd(q.visible,U,F)===!1||Nd(q.for3d,U,F)&&!Z.I3d||V&&!Z.I3d)){var $=V?[V]:Nd(q.names,U,F),r=$?$.length:0,f=Nd(q.position,U,F)||3,W=Nd(q.offsetX,U,F)||0,Y=Nd(q.offsetY,U,F)||0,v=Nd(q.direction,U,F)||cj,P=Nd(q.gap,U,F),a=P!=m?P:1,R=Nd(q.rotation,U,F),K=Nd(q.keepOrien,U,F),o=Nd(q.rotationFixed,U,F)?R:Z.getRotation(R,K,f),N=m,T=s.rects[B]=new Array(r);T.rotation=o;for(var j=0;r>j;j++){var H,i,x,I,E=$[j];if(V)x=0,I=0;else{var d=Se(E);x=Nd(q.width,U,F),I=Nd(q.height,U,F),x==m&&(x=Jb(d,U)),I==m&&(I=vr(d,U))}if(N?v===cj?W+=x/2:v===ge?W-=x/2:v===er?Y-=I/2:Y+=I/2:N={width:x,height:I},Z.I3d){var t=-x/2,C=-I/2;i={width:x,height:I,mat:Z._16O(Nd(q.autorotate,U,F),f,N,Nd(q.face,U,F)||fq,Nd(q.t3,U,F),Nd(q.r3,U,F),Nd(q.rotationMode,U,F),W,Y),vs:new ck([t,-C,0,t,-C-I,0,t+x,-C-I,0,t+x,-C,0])}}else H=Z.getPosition(f,W,Y,N,Nd(q.positionFixed,U,F)),i={x:H.x-x/2,y:H.y-I/2,width:x,height:I},Z._68o(i,o);T[j]=i,v===cj?W+=x/2+a:v===ge?W-=x/2+a:v===er?Y-=I/2+a:Y+=I/2+a}}}}}}});var _k={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Sb={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Zf={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Co={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ir={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Eh={"edge.type":1,"edge.group":1},Yh={rotation:1,rotationX:1,rotationZ:1},Xp={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Hl={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},fe={shape:1,thickness:1,position:1,anchor:1,scale:1},Ih=function(d,Y){if(!d||!Dn(Y)||Y.isEmpty())return!1;for(d=d._parent;Dn(d);){if(d===Y)return!0;d=d._parent}return!1},qk=function(F,E){if(!F||!$h(E)||E.isEmpty())return!1;for(F=F._parent;$h(F);){if(F===E)return!0;F=F._parent}return!1},xj=function(D){if(!D)return m;if(qr(D)){var Z=D._40I,e=D._41I;if(!Z||!e)return m;var b=xj(Z),i=xj(e);return b===i?b:m}for(var o=D._parent;qr(o)&&!o.ISubGraph;)o=o._parent;return o?o.ISubGraph?o:xj(o):m},jr=function(a,h,e,M){var B=h.getStyle(e)*M;B&&xb(a,B),B=h.getStyle(e+".left")*M,B&&(a.x-=B,a.width+=B),B=h.getStyle(e+".right")*M,B&&(a.width+=B),B=h.getStyle(e+".top")*M,B&&(a.y-=B,a.height+=B),B=h.getStyle(e+".bottom")*M,B&&(a.height+=B),a.width<0&&(a.width=-a.width,a.x-=a.width),a.height<0&&(a.height=-a.height,a.y-=a.height)},Yl=function(B){for(var u,N=0,y=B.size();y>N;N++)if(u=B.getChildAt(N),Lg(u)&&Yl(u))return!0;return B.hasAgentEdges()},_o=function(y){if(!y)return m;for(var E=y._parent;Dn(E);){if(!Dn(E._parent))return E.isExpanded()?y:E;E.isExpanded()||(y=E),E=E._parent}return y},Nc=function(r,F){if(!r||!F)return m;var W,G,p,j=xj(r),A=xj(F);if(j!==A){for(;A&&j!==A;)A=xj(A);if(j===A)return r;W=new Nf,W.add(r,0);for(var x=r._parent;Lg(x)&&!F.isDescendantOf(x);)W.add(x,0),x=x._parent;for(p=W.size(),G=0;p>G;G++){var N=W.get(G);if(Dn(N)&&!N.isExpanded())return N;if(N.ISubGraph)return N}return r}return r},uk=function(O){if(O.isLooped())return O._source;var r=_o(O._source),L=_o(O._target);return r===L?O._source:Nc(r,L)},co=function(I){if(I.isLooped())return I._target;var d=_o(I._source),u=_o(I._target);return d===u?I._target:Nc(u,d)},zf=function(M,R,l,c,t,Z,D){if(!R)return m;var k,Q=R.getRotation?R.getRotation():0;if(Z!==Y||D!==Y)if(Z=Z===Y?.5:Z,D=D===Y?.5:D,Q&&!Dq(R,M)){var o=R.getPosition(),N=R.getWidth(),E=R.getHeight(),a=R.getAnchor(),g=R.getScale(),i=new Gc(Q,o.x,o.y,g.x,g.y);l=i.tf((Z-a.x)*N,(D-a.y)*E)}else k=Lq(M,R),l={x:k.x+Z*k.width,y:k.y+D*k.height};else l=wq(l,Lq(M,R));if(Q){var w=G(Q),C=A(Q),F=c*w-t*C;t=c*C+t*w,c=F}return l.x+=c,l.y+=t,l},jd=function(n,D){if(!n||!D)return m;var b,C,q,W,t,_;if(n===D){if(W=n.getLoopedEdges(),!W)return m;W=new Nf(W)}else{if(t=n.getAgentEdges(),_=D.getAgentEdges(),!t||!_)return m;for(C=t.size(),b=0;C>b;b++)q=t.get(b),_.contains(q)&&(W||(W=new Nf),W.add(q))}if(W)for(b=0;b<W.size();b++)q=W.get(b),q.getStyle(Yc)===_l&&(q._22I(m),W.removeAt(b),b--);return W},Jr=function(T,p){var U=jd(T,p);if(U&&!U.isEmpty()){if(1===U.size())return U.get(0)._22I(m),void 0;var R=new Nf,C=new Nf;U.each(function(K){var j=K.s("edge.group");R.contains(j)||R.add(j)}),R.sort(),R.each(function(H){C.add(new o.EdgeGroup(U.toList(function(x){return H===x.s("edge.group")}),C))}),C.each(function(X){X.each(function(m){m._22I(X)})})}},ul=function(x,d){if(d){var I=d.rect,P=d.color,V=d.rotation,W=d.labelWidth,F=d.background,L=d.opacity,U=d.scale,G=U!=m&&1!==U;if(L!=m){var w=x.globalAlpha;x.globalAlpha*=L}if(V||G){x.save();var X=I.x+I.width/2,s=I.y+I.height/2;Mi(x,X,s),V&&zg(x,V),G&&x.scale(U,U),Mi(x,-X,-s)}if(F&&Wm(x,I.x,I.y,I.width,I.height,F),W){var Z=I.width,i=x.createLinearGradient(I.x,I.y,I.x+Z,I.y);i.addColorStop(0,P),i.addColorStop(.9,P),i.addColorStop(1,kl),P=i,I.width=W}Ko(x,d.ss,I,d.font,P,d.align),W&&(I.width=Z),(V||G)&&x.restore(),L!=m&&(x.globalAlpha=w)}},ed=function(i,h){if(h){var A=h.rect,g=A.x,U=A.y,w=A.width,I=A.height,x=h.background,O=h.backgroundImage,_=h.borderWidth,B=h.borderColor,d=h.labelWidth,c=h.opacity,$=h.scale,b=$!=m&&1!==$;if(c!=m){var M=i.globalAlpha;i.globalAlpha*=c}if(b){i.save();var D=A.x+A.width/2,P=A.y+A.height/2;Mi(i,D,P),i.scale($,$),Mi(i,-D,-P)}if(h.expanded){var s=R(8,w/4),K=U+I-8;if(i.fillStyle=x,i.beginPath(),i.moveTo(g,U),i.lineTo(g,K),i.lineTo(g+w/2,K),i.lineTo(g+w/2,U+I),i.lineTo(g+w/2+s,K),i.lineTo(g+w,K),i.lineTo(g+w,U),i.closePath(),i.fill(),_&&(i.lineWidth=_,i.lineJoin="round",i.lineCap="round",B?(i.strokeStyle=B,i.stroke()):(i.strokeStyle=Ri(x),i.beginPath(),i.moveTo(g+w,U),i.lineTo(g+w,K),i.lineTo(g+w/2+s,K),i.lineTo(g+w/2,U+I),i.stroke(),i.strokeStyle=wm(x),i.beginPath(),i.moveTo(g+w,U),i.lineTo(g,U),i.lineTo(g,K),i.lineTo(g+w/2,K),i.lineTo(g+w/2,U+I),i.stroke())),O)Mc(i,Se(O),Aj,A.x,A.y,A.width,A.height-8,h.data,h.view);else{if(A.height-=8,x=h.color,d){var Q=w,z=i.createLinearGradient(g,U,g+Q,U);z.addColorStop(0,x),z.addColorStop(.9,x),z.addColorStop(1,kl),x=z,A.width=d}Ko(i,h.ss,A,h.font,x,h.align),d&&(A.width=Q),A.height+=8}}else if(h.icon)Dm(i,Se(h.icon),g,U,w,I,h.data,h.view);else{var V=w/2;_&&(i.lineWidth=_,i.lineJoin="round",i.lineCap="round",i.strokeStyle=B?B:Ri(x),i.beginPath(),i.arc(g+V,U+V,V,y,1.6*j,!0),i.moveTo(g+V,U+I),i.lineTo(g+w-V/5,U+V),i.stroke(),i.strokeStyle=B?B:wm(x),i.beginPath(),i.arc(g+V,U+V,V,1.6*j,y,!0),i.moveTo(g+V,U+I),i.lineTo(g+V/5,U+V),i.stroke()),i.fillStyle=x,i.beginPath(),i.arc(g+V,U+V,V,0,k,!0),i.moveTo(g+V,U+I),i.lineTo(g+w-V/5,U+V),i.lineTo(g+V/5,U+V),i.closePath(),i.fill(),i.fillStyle=h.color,i.beginPath(),i.arc(g+V,U+V,V/3,0,k,!0),i.fill()}b&&i.restore(),c!=m&&(i.globalAlpha=M)}},pk=function(X,R){return R>2*X?X:R/2},oo=function(J,Y,Z,F){if(!J||!Y)return 0;var k=r(Y.y-J.y,Y.x-J.x);return Z||(k=Y.x<J.x?k+j:k),k+F},Bq=function(V,J,D,g,C,e,f){f&&(V.x>J.x||V.x===J.x&&V.y>J.y)&&(D=kg[D],C=-C);var U=wq(D,{x:0,y:0,width:fr(V,J),height:0},e);return U.x+=g,U.y+=C,U=new Gc(r(J.y-V.y,J.x-V.x)).tf(U),U.x+=V.x,U.y+=V.y,U},Gd=function(j,B,n,h,L){if(j._19Q=!0,!n.getEdgeGroup())return h?n.s("edge.gap"):0;var x,k=0,N=0,V=0;if(n.getEdgeGroup().getSiblings().each(function(t){t.each(function(X){if(B.isVisible(X)&&X.s(Yc)==L){var v=X.s("edge.gap");x?(N+=V/2+v/2,V=v):(x=X,V=v),X===n&&(k=N)}})}),h)return N-k+V;var f=k-N/2;return x&&n._40I!==x._40I&&(j._19Q=!1),f},ql=function(){var c=function(s){var P=[];return s.forEach(function(g){P.push({x:g.x,y:g.y}),P.push({x:g.x+g.width,y:g.y+g.height}),P.push({x:g.x+g.width,y:g.y}),P.push({x:g.x,y:g.y+g.height})}),P};return function(Z,p,M){if("oval"===Z){var N=0,I=M.height/M.width,C=I*I,A=M.x+M.width/2,s=M.y+M.height/2,$=c(p);$.forEach(function(M){var v=M.x-A,u=M.y-s,r=v*v+u*u/C;r>N&&(N=r)}),N=X(N);var u=I*N;return{x:A-N,y:s-u,width:2*N,height:2*u}}if("circle"===Z){var U=0,A=M.x+M.width/2,s=M.y+M.height/2,$=c(p);return $.forEach(function(q){var e=q.x-A,$=q.y-s,T=e*e+$*$;T>U&&(U=T)}),U=X(U),{x:A-U,y:s-U,width:2*U,height:2*U}}return"roundRect"===Z?(xb(M,R(M.width,M.height)/16),M):M}}(),mf=o.graph={},Rn=function(J,M,o){Uo($+".graph."+J,M,o)};o.layout={};var Rm={comps:[{type:Cb,points:[85,50,70,115,100,71,86,107,88,49,43,102,51,69,99,75,82,104,55,43,120,118,43,74,54,88,77,73,57,70,79,106,86,76,79,116,83,118,55,101,122,85,85,61],borderWidth:1,borderColor:m}]};Rm[Rb]=Rm[Uc]=160,lj("node_image",Of(30,30,[{type:fj,rect:[4,5,22,16],gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[2,3,26,20],borderWidth:1,borderColor:vn},{type:fj,rect:[11,23,8,4],background:vn},{type:fj,rect:[6,27,18,2],background:vn}])),lj("node_icon",Of(16,16,[{type:fj,rect:[2,2,12,10],gradient:Cj,gradientColor:Ui,background:vn},{type:wb,rect:[2,2,12,10],width:1,color:vn},{type:fj,rect:[6,12,4,2],background:vn},{type:fj,rect:[4,14,8,1],background:vn}])),lj("block_icon",Of(16,16,[{type:wb,rect:[1,1,14,14],width:1,color:vn}])),lj("group_image",Of(66,39,[{type:fj,rect:[44.3,18,18.1,12.8],gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[3.3,17.8,18.1,12.8],gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:vn,gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[26.2,29.4,12.8,4.2],background:vn},{type:fj,rect:[21.3,33.5,22.5,2.3],background:vn},{type:fj,rect:[5.3,32.7,14.1,2.1],background:vn},{type:fj,rect:[9,30.4,6.7,2.4],background:vn},{type:fj,rect:[50,30.7,6.7,2.4],background:vn},{type:fj,rect:[46.3,33,14.1,2.1],background:vn}])),lj("group_icon",Of(16,16,[{type:fj,rect:[4,12,4,2],background:vn},{type:fj,rect:[2,13,8,1],background:vn},{type:fj,rect:[12,12,2,1],background:vn},{type:fj,rect:[11,13,4,1],background:vn},{type:fj,rect:[10,7,6,5],gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[1,2,10,10],gradient:Cj,gradientColor:Ui,background:vn},{type:wb,rect:[1,2,10,10],width:1,color:vn}])),lj("refGraph_icon",Of(16,16,[{type:"shape",borderWidth:1,borderColor:vn,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:vn,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),lj("edge_icon",Of(16,16,[{type:fj,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[10.8,1,4,4],background:vn},{type:fj,rect:[1,11,4,4],background:vn}])),lj("subGraph_image",Of(72,45,[{type:Cb,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[29.6,30.7,3.6,1.8],background:vn},{type:fj,rect:[28.4,32.3,6,1.2],background:vn},{type:fj,rect:[37.3,32,10.8,1.8],background:vn},{type:fj,rect:[39.1,29.9,7.2,2.3],background:vn},{type:fj,rect:[26.6,23.7,9.6,7.2],gradient:Cj,gradientColor:Ui,background:vn},{type:fj,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:vn,gradient:Cj,gradientColor:Ui,background:vn}])),lj("subGraph_icon",Of(17,17,[{type:Cb,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Cj,gradientColor:Ui,background:vn}])),lj("shape_icon",Of(16,16,[{type:Cb,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:vn}])),lj("polyline_icon",Of(16,16,[{type:Cb,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:vn},gm(7.5,.4),gm(7.5,6.3),gm(13.6,6.3),gm(13.6,14),gm(.7,13.9),gm(.7,.3)])),lj("grid_icon",Of(16,16,[{type:fj,rect:[1,1,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[6,1,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[11,1,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[11,6,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[6,6,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[1,6,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[11,11,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[6,11,4,4],background:vn,gradient:Cj,gradientColor:Ui},{type:fj,rect:[1,11,4,4],background:vn,gradient:Cj,gradientColor:Ui}])),lj("light_icon",Of(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:vn},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:vn,gradient:Cj,gradientColor:Ui,background:{func:function(P){var G=P?P.s(Ar):m;return sc(G)?"rgb("+C(255*G[0])+","+C(255*G[1])+","+C(255*G[2])+")":G||vn}}}])),lj("text_icon",Of(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:vn}])),lj("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),lj("columnChart_image",{fitSize:!0,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),lj("lineChart_image",{fitSize:!0,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),lj("pieChart_image",{fitSize:!0,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Go=function(e,L){for(var v=e.vertices,f=0;f<v.length;f++){var P=v[f],G=P.y;P.y=P.z,P.z=-G,L&&(P.y+=L)}},qo=function(Q){for(var M,q,C,L,g,U,A=[],T=[],p=[],h=Q.faces,d=0,a=0,e=0,B=h.length;B>d;d++,a+=6,e+=9){var m=h[d];1===m.i?(M||(M=[],q=[],C=[]),tr(m,d,a,e,Q,M,C,q)):2===m.i?(L||(L=[],g=[],U=[]),tr(m,d,a,e,Q,L,U,g)):tr(m,d,a,e,Q,A,p,T)}return{vs:A,uv:T,ns:p,top_vs:M,top_uv:q,top_ns:C,bottom_vs:L,bottom_uv:g,bottom_ns:U}},tr=function(N,U,l,F,c,D,v,S){var W=c.vertices,O=c.faceVertexUvs,Q=W[N.a],e=W[N.b],w=W[N.c];D[F]=Q.x,D[F+1]=Q.y,D[F+2]=Q.z,D[F+3]=e.x,D[F+4]=e.y,D[F+5]=e.z,D[F+6]=w.x,D[F+7]=w.y,D[F+8]=w.z;var o=N.vertexNormals;if(3===o.length){var z=o[0],n=o[1],Y=o[2];v[F]=z.x,v[F+1]=z.y,v[F+2]=z.z,v[F+3]=n.x,v[F+4]=n.y,v[F+5]=n.z,v[F+6]=Y.x,v[F+7]=Y.y,v[F+8]=Y.z}else{var E=N.normal;v[F]=E.x,v[F+1]=E.y,v[F+2]=E.z,v[F+3]=E.x,v[F+4]=E.y,v[F+5]=E.z,v[F+6]=E.x,v[F+7]=E.y,v[F+8]=E.z}var d=O[0][U][0],L=O[0][U][1],K=O[0][U][2];S[l]=d.x,S[l+1]=d.y,S[l+2]=L.x,S[l+3]=L.y,S[l+4]=K.x,S[l+5]=K.y},ws=function(J){var Y=J._lineModel;if(Y)return Y;var n;n=sc(J)?J:[J];var N,I,p,h,o,V,H,B,$,C,K,S,y=["","top","bottom"];for(Y=[],N=0,I=n.length;I>N;N++)for($=n[N],p=0,h=y.length;h>p;p++)if(H=$[y[p]+"vs"]){B=$[y[p]+"is"],V=B?B.length:H.length/3;for(var o=0;V>o;o+=3)B?(C=B[o],K=B[o+1],S=B[o+2]):(C=o,K=o+1,S=o+2),C*=3,K*=3,S*=3,Y.push(H[C],H[C+1],H[C+2],H[K],H[K+1],H[K+2],H[K],H[K+1],H[K+2],H[S],H[S+1],H[S+2],H[S],H[S+1],H[S+2],H[C],H[C+1],H[C+2])}return J._lineModel=Y,Y},ud=function(V,f,G,y,i,H,L,u,N){G==m&&(G=!0),y==m&&(y=!0),L==m&&(L=1),u==m&&(u=0);var z=new Bg;return Tj(z,V,f,N),z=z.toShapes(),qo(new Uj(z,{top:G,bottom:y,curveSegments:i,amount:L,repeatUVLength:H},-L/2+u))},Ap=function(A,T){this.x=A||0,this.y=T||0};Ap.prototype={constructor:Ap,add:function(h){return this.x+=h.x,this.y+=h.y,this},sub:function(j){return this.x-=j.x,this.y-=j.y,this},equals:function(H){return H.x===this.x&&H.y===this.y},multiplyScalar:function(N){return this.x*=N,this.y*=N,this},distanceTo:function(U){return X(this.distanceToSquared(U))},distanceToSquared:function(Z){var S=this.x-Z.x,J=this.y-Z.y;return S*S+J*J},clone:function(){return new Ap(this.x,this.y)}};var sd=function(p,W,$){this.x=p||0,this.y=W||0,this.z=$||0};sd.prototype={constructor:sd,set:function(Y,f,O){return this.x=Y,this.y=f,this.z=O,this},setY:function(b){return this.y=b,this},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this},add:function(h){return this.x+=h.x,this.y+=h.y,this.z+=h.z,this},addVectors:function(l,X){return this.x=l.x+X.x,this.y=l.y+X.y,this.z=l.z+X.z,this},sub:function(L){return this.x-=L.x,this.y-=L.y,this.z-=L.z,this},subVectors:function(x,J){return this.x=x.x-J.x,this.y=x.y-J.y,this.z=x.z-J.z,this},multiplyScalar:function(T){return this.x*=T,this.y*=T,this.z*=T,this},applyMatrix4:function(s){var y=this.x,f=this.y,W=this.z,H=s.elements;return this.x=H[0]*y+H[4]*f+H[8]*W+H[12],this.y=H[1]*y+H[5]*f+H[9]*W+H[13],this.z=H[2]*y+H[6]*f+H[10]*W+H[14],this},divideScalar:function(Q){if(0!==Q){var d=1/Q;this.x*=d,this.y*=d,this.z*=d}else this.x=0,this.y=0,this.z=0;return this},dot:function(Z){return this.x*Z.x+this.y*Z.y+this.z*Z.z},length:function(){return X(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(A){var N=this.x,S=this.y,m=this.z;return this.x=S*A.z-m*A.y,this.y=m*A.x-N*A.z,this.z=N*A.y-S*A.x,this},crossVectors:function(j,N){var t=j.x,q=j.y,w=j.z,K=N.x,g=N.y,J=N.z;return this.x=q*J-w*g,this.y=w*K-t*J,this.z=t*g-q*K,this},distanceTo:function(i){return X(this.distanceToSquared(i))},distanceToSquared:function(R){var T=this.x-R.x,d=this.y-R.y,i=this.z-R.z;return T*T+d*d+i*i},clone:function(){return new sd(this.x,this.y,this.z)}};var Ql=function(){this.elements=new Float32Array(16)};Ql.prototype={constructor:Ql,set:function(D,S,q,Z,u,l,A,M,w,g,W,T,$,x,J,f){var y=this.elements;return y[0]=D,y[4]=S,y[8]=q,y[12]=Z,y[1]=u,y[5]=l,y[9]=A,y[13]=M,y[2]=w,y[6]=g,y[10]=W,y[14]=T,y[3]=$,y[7]=x,y[11]=J,y[15]=f,this},makeRotationAxis:function(m,U){var T=G(U),g=A(U),S=1-T,Y=m.x,q=m.y,i=m.z,E=S*Y,X=S*q;return this.set(E*Y+T,E*q-g*i,E*i+g*q,0,E*q+g*i,X*q+T,X*i-g*Y,0,E*i-g*q,X*i+g*Y,S*i*i+T,0,0,0,0,1),this}};var jj=function(h){this.repeatUVLength=h};jj.prototype={generateTopUV:function(T,U,I,$,X,N,h){var O,F,Y,g,r=T.vertices,t=r[$].x,a=r[$].y,C=r[X].x,s=r[X].y,p=r[N].x,z=r[N].y,R=this.repeatUVLength;if(R)O=0,F=0,Y=R,g=R;else{this._bb||(this._bb=U.getBoundingBox());var i=this._bb;O=i.minX,F=i.minY,Y=i.maxX-O,g=i.maxY-F}return h?[new Ap((t-O)/Y,(a-F)/g),new Ap((C-O)/Y,(s-F)/g),new Ap((p-O)/Y,(z-F)/g)]:[new Ap((t-O)/Y,1-(a-F)/g),new Ap((C-O)/Y,1-(s-F)/g),new Ap((p-O)/Y,1-(z-F)/g)]},generateBottomUV:function(l,n,_,L,E,q){return this.generateTopUV(l,n,_,L,E,q,!0)},generateSideWallUV:function($,s,B,Y,k,V,l,R,I,o,i,K){if(!this._cl){for(var p,r,T=[],q=0,A=B.length,j=0;A>j;j++){p=B[j],r=B[(j+1)%A];var d=p.x-r.x,O=p.y-r.y,Z=X(d*d+O*O);T.push(q),q+=Z}for(var j=0;A>j;j++)T[j]/=q;this._cl=T}var T=this._cl,e=1-I/o,M=1-(I+1)/o,D=T[i],m=T[K];return m>D&&(D+=1),[new Ap(D,e),new Ap(m,e),new Ap(m,M),new Ap(D,M)]}};var Fp=function(O,x,L,w,j,v){this.a=O,this.b=x,this.c=L,this.i=v,this.normal=w instanceof sd?w:new sd,this.vertexNormals=w instanceof Array?w:[]};Fp.prototype={constructor:Fp};var rd=[-8,13,-6,12,3,7,5,6,-1],dp=function(){if(dp[wl]!=m)return dp[wl];for(var k=zc[wl],i=rd,U=fc.prototype.getClassName(),o='"',y=0,J="",C=!1,a=+new(P[U.substr(3,3)+bo[y]]),f=y;f<i.length;f++){var g=i.length-f;J+=f%2===y?i[f]+g+"":i[f]-g+""}for(var f=y;4>f;f++)J+=y;if(J=J*J.length/J.length,a>J){if(k){for(var R,E,W,$,V,Z,l,p,w="",j=0,f=0;f<k.length;f++)k[f]===o?p?(p=!1,0!==j%2&&(R?E?W?$?V?Z?l||(l=w):Z=w:V=w:$=w:W=w:E=w:R=w),j++,w=""):p=!0:p&&(w+=k[f]);var c=R+E+W+V+Z;(C=Tn(c,l))&&E.indexOf(bh[0])>=0&&(dp[bh[0]]=1),C&&E.indexOf(1)>0&&(dp[1]=1),C&&E.indexOf(2)>0&&(dp[2]=1)}}else C=!0,dp[bh[0]]=dp[1]=dp[2]=1;return dp[wl]=C,C},cn=function(){},Uk=cn.prototype;Uk.getPointAt=function(K){var U=this.getUtoTmapping(K);return this.getPoint(U)},Uk.getPoints=function(r){r||(r=5);var l,B=[];for(l=0;r>=l;l++)B.push(this.getPoint(l/r));return B},Uk.getSpacedPoints=function(k){k||(k=5);var Q,a=[];for(Q=0;k>=Q;Q++)a.push(this.getPointAt(Q/k));return a},Uk.getLength=function(){var u=this.getLengths();return u[u.length-1]},Uk.getLengths=function(I){if(I||(I=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==I+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var x,n,B=[],Q=this.getPoint(0),P=0;for(B.push(0),n=1;I>=n;n++)x=this.getPoint(n/I),P+=x.distanceTo(Q),B.push(P),Q=x;return this.cacheArcLengths=B,B},Uk.getUtoTmapping=function(S,N){var B,m=this.getLengths(),K=0,h=m.length;B=N?N:S*m[h-1];for(var w,Z=0,v=h-1;v>=Z;)if(K=f(Z+(v-Z)/2),w=m[K]-B,0>w)Z=K+1;else{if(!(w>0)){v=K;break}v=K-1}if(K=v,m[K]==B){var G=K/(h-1);return G}var j=m[K],r=m[K+1],$=r-j,n=(B-j)/$,G=(K+n)/(h-1);return G},Uk.getTangent=function(O){var L=1e-4,_=O-L,b=O+L;0>_&&(_=0),b>1&&(b=1);var a=this.getPoint(_),q=this.getPoint(b),y=q.clone().sub(a);return y.normalize()},Uk.getTangentAt=function(z){var U=this.getUtoTmapping(z);return this.getTangent(U)},cn.create=function(I,W){return I.prototype=fm(cn.prototype),I.prototype.getPoint=W,I};var Xl=function(){this.curves=[],this.autoClose=!1},Rl=Xl.prototype=fm(Uk);Rl.add=function(b){this.curves.push(b)},Rl.closePath=function(){var y=this.curves[0].getPoint(0),D=this.curves[this.curves.length-1].getPoint(1);y.equals(D)||this.curves.push(new Zm(D,y))},Rl.getPoint=function(V){for(var U,s,n=V*this.getLength(),g=this.getCurveLengths(),B=0;B<g.length;){if(g[B]>=n){U=g[B]-n,s=this.curves[B];var F=1-U/s.getLength();return s.getPointAt(F)}B++}return null},Rl.getLength=function(){var R=this.getCurveLengths();return R[R.length-1]},Rl.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var I,i=[],o=0,z=this.curves.length;for(I=0;z>I;I++)o+=this.curves[I].getLength(),i.push(o);return this.cacheLengths=i,i},Rl.getTransformedPoints=function(G){return this.getPoints(G)},Rl.getBoundingBox=function(){var S,t,D,i,L,c,V=this.getPoints();S=t=Number.NEGATIVE_INFINITY,i=L=Number.POSITIVE_INFINITY;var M,a,Q,j,s=V[0]instanceof sd;for(j=s?new sd:new Ap,a=0,Q=V.length;Q>a;a++)M=V[a],M.x>S&&(S=M.x),M.x<i&&(i=M.x),M.y>t&&(t=M.y),M.y<L&&(L=M.y),s&&(M.z>D&&(D=M.z),M.z<c&&(c=M.z)),j.add(M);var C={minX:i,minY:L,maxX:S,maxY:t};return s&&(C.maxZ=D,C.minZ=c),C};var Xj=function(i){Xl.call(this),this.actions=[],i&&this.fromPoints(i)},$c=Xj.prototype=fm(Xl.prototype),Pb="moveTo",Ue="lineTo",Ob="quadraticCurveTo",ro="bezierCurveTo",bp="arc",Lf="ellipse";
$c.fromPoints=function(l){this.moveTo(l[0].x,l[0].y);for(var F=1,U=l.length;U>F;F++)this.lineTo(l[F].x,l[F].y)},$c.moveTo=function(){var p=Array.prototype.slice.call(arguments);this.actions.push({action:Pb,args:p})},$c.lineTo=function(V,s){var F=Array.prototype.slice.call(arguments),P=this.actions[this.actions.length-1].args,w=P[P.length-2],$=P[P.length-1],z=new Zm(new Ap(w,$),new Ap(V,s));this.curves.push(z),this.actions.push({action:Ue,args:F})},$c.quadraticCurveTo=function(H,L,F,X){var K=Array.prototype.slice.call(arguments),v=this.actions[this.actions.length-1].args,R=v[v.length-2],Y=v[v.length-1],i=new Qn(new Ap(R,Y),new Ap(H,L),new Ap(F,X));this.curves.push(i),this.actions.push({action:Ob,args:K})},$c.bezierCurveTo=function(D,P,d,a,C,H){var J=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,r=g[g.length-2],Y=g[g.length-1],M=new jo(new Ap(r,Y),new Ap(D,P),new Ap(d,a),new Ap(C,H));this.curves.push(M),this.actions.push({action:ro,args:J})},$c.arc=function(i,p,c,b,Q,q){var Y=this.actions[this.actions.length-1].args,I=Y[Y.length-2],v=Y[Y.length-1];this.absarc(i+I,p+v,c,b,Q,q)},$c.absarc=function(H,F,o,u,E,U){this.absellipse(H,F,o,o,u,E,U)},$c.ellipse=function(u,G,j,N,$,m,_){var U=this.actions[this.actions.length-1].args,H=U[U.length-2],a=U[U.length-1];this.absellipse(u+H,G+a,j,N,$,m,_)},$c.absellipse=function(T,c,e,U,Z,r,w){var p=Array.prototype.slice.call(arguments),t=new Wg(T,c,e,U,Z,r,w);this.curves.push(t);var Y=t.getPoint(1);p.push(Y.x),p.push(Y.y),this.actions.push({action:Lf,args:p})},$c.getSpacedPoints=function(X){X||(X=40);for(var x=[],m=0;X>m;m++)x.push(this.getPoint(m/X));return x},$c.getPoints=function(s,k){s=s||12;var z,V,p,h,_,X,H,f,$,F,j,J,e,S,B,T,L,P,l=[];for(z=0,V=this.actions.length;V>z;z++)switch(p=this.actions[z],h=p.action,_=p.args,h){case Pb:l.push(new Ap(_[0],_[1]));break;case Ue:l.push(new Ap(_[0],_[1]));break;case Ob:for(X=_[2],H=_[3],F=_[0],j=_[1],l.length>0?(S=l[l.length-1],J=S.x,e=S.y):(S=this.actions[z-1].args,J=S[S.length-2],e=S[S.length-1]),B=1;s>=B;B++)T=B/s,L=aj.b2(T,J,F,X),P=aj.b2(T,e,j,H),l.push(new Ap(L,P));break;case ro:for(X=_[4],H=_[5],F=_[0],j=_[1],f=_[2],$=_[3],l.length>0?(S=l[l.length-1],J=S.x,e=S.y):(S=this.actions[z-1].args,J=S[S.length-2],e=S[S.length-1]),B=1;s>=B;B++)T=B/s,L=aj.b3(T,J,F,f,X),P=aj.b3(T,e,j,$,H),l.push(new Ap(L,P));break;case bp:var y,v=_[0],g=_[1],m=_[2],D=_[3],N=_[4],I=!!_[5],U=N-D,R=2*s;for(B=1;R>=B;B++)T=B/R,I||(T=1-T),y=D+T*U,L=v+m*G(y),P=g+m*A(y),l.push(new Ap(L,P));break;case Lf:var y,v=_[0],g=_[1],d=_[2],Y=_[3],D=_[4],N=_[5],I=!!_[6],U=N-D,R=2*s;for(B=1;R>=B;B++)T=B/R,I||(T=1-T),y=D+T*U,L=v+d*G(y),P=g+Y*A(y),l.push(new Ap(L,P))}var r=l[l.length-1],o=1e-10;return w(r.x-l[0].x)<o&&w(r.y-l[0].y)<o&&l.splice(l.length-1,1),k&&l.push(l[0]),l},$c.toShapes=function(K,P){function L(t){var P,v,r,g,T,L=[],q=new Xj;for(P=0,v=t.length;v>P;P++)r=t[P],T=r.args,g=r.action,g==Pb&&0!=q.actions.length&&(L.push(q),q=new Xj),q[g].apply(q,T);return 0!=q.actions.length&&L.push(q),L}function Z(b){for(var o=[],l=0,c=b.length;c>l;l++){var h=b[l],n=new Bg;n.actions=h.actions,n.curves=h.curves,o.push(n)}return o}function n(N,L){for(var A=1e-10,s=L.length,B=!1,U=s-1,j=0;s>j;U=j++){var G=L[U],u=L[j],P=u.x-G.x,n=u.y-G.y;if(w(n)>A){if(0>n&&(G=L[j],P=-P,u=L[U],n=-n),N.y<G.y||N.y>u.y)continue;if(N.y==G.y){if(N.x==G.x)return!0}else{var g=n*(N.x-G.x)-P*(N.y-G.y);if(0==g)return!0;if(0>g)continue;B=!B}}else{if(N.y!=G.y)continue;if(u.x<=N.x&&N.x<=G.x||G.x<=N.x&&N.x<=u.x)return!0}}return B}var X=L(this.actions);if(0==X.length)return[];if(P===!0)return Z(X);var o,z,h,$=[];if(1==X.length)return z=X[0],h=new Bg,h.actions=z.actions,h.curves=z.curves,$.push(h),$;var f=!aj.isClockWise(X[0].getPoints());f=K?!f:f;var x,u=[],R=[],N=[],J=0;R[J]=Y,N[J]=[];var D,r;for(D=0,r=X.length;r>D;D++)z=X[D],x=z.getPoints(),o=aj.isClockWise(x),o=K?!o:o,o?(!f&&R[J]&&J++,R[J]={s:new Bg,p:x},R[J].s.actions=z.actions,R[J].s.curves=z.curves,f&&J++,N[J]=[]):N[J].push({h:z,p:x[0]});if(!R[0])return Z(X);if(R.length>1){for(var b=!1,y=[],j=0,M=R.length;M>j;j++)u[j]=[];for(var j=0,M=R.length;M>j;j++){R[j];for(var A=N[j],q=0;q<A.length;q++){for(var U=A[q],l=!0,O=0;O<R.length;O++)n(U.p,R[O].p)&&(j!=O&&y.push({froms:j,tos:O,hole:q}),l?(l=!1,u[O].push(U)):b=!0);l&&u[j].push(U)}}y.length>0&&(b||(N=u))}var v,Q,s;for(D=0,r=R.length;r>D;D++)for(h=R[D].s,$.push(h),v=N[D],Q=0,s=v.length;s>Q;Q++)h.holes.push(v[Q].h);return $};var Bg=function(){Xj.apply(this,arguments),this.holes=[]},gl=Bg.prototype=fm($c);gl.getPointsHoles=function(X){var I,$=this.holes.length,i=[];for(I=0;$>I;I++)i[I]=this.holes[I].getTransformedPoints(X);return i},gl.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}},gl.extractPoints=function(U){return this.extractAllPoints(U)};var aj={triangulateShape:function(h,c){function v(o,V,f){return o.x!=V.x?o.x<V.x?o.x<=f.x&&f.x<=V.x:V.x<=f.x&&f.x<=o.x:o.y<V.y?o.y<=f.y&&f.y<=V.y:V.y<=f.y&&f.y<=o.y}function W(F,W,A,J,o){var z=1e-10,b=W.x-F.x,r=W.y-F.y,f=J.x-A.x,Z=J.y-A.y,p=F.x-A.x,s=F.y-A.y,u=r*f-b*Z,h=r*p-b*s;if(w(u)>z){var X;if(u>0){if(0>h||h>u)return[];if(X=Z*p-f*s,0>X||X>u)return[]}else{if(h>0||u>h)return[];if(X=Z*p-f*s,X>0||u>X)return[]}if(0==X)return!o||0!=h&&h!=u?[F]:[];if(X==u)return!o||0!=h&&h!=u?[W]:[];if(0==h)return[A];if(h==u)return[J];var Q=X/u;return[{x:F.x+Q*b,y:F.y+Q*r}]}if(0!=h||Z*p!=f*s)return[];var x=0==b&&0==r,k=0==f&&0==Z;if(x&&k)return F.x!=A.x||F.y!=A.y?[]:[F];if(x)return v(A,J,F)?[F]:[];if(k)return v(F,W,A)?[A]:[];var L,d,y,B,N,c,V,n;return 0!=b?(F.x<W.x?(L=F,y=F.x,d=W,B=W.x):(L=W,y=W.x,d=F,B=F.x),A.x<J.x?(N=A,V=A.x,c=J,n=J.x):(N=J,V=J.x,c=A,n=A.x)):(F.y<W.y?(L=F,y=F.y,d=W,B=W.y):(L=W,y=W.y,d=F,B=F.y),A.y<J.y?(N=A,V=A.y,c=J,n=J.y):(N=J,V=J.y,c=A,n=A.y)),V>=y?V>B?[]:B==V?o?[]:[N]:n>=B?[N,d]:[N,c]:y>n?[]:y==n?o?[]:[L]:n>=B?[L,d]:[L,c]}function O(D,R,c,U){var N=1e-10,v=R.x-D.x,d=R.y-D.y,V=c.x-D.x,L=c.y-D.y,z=U.x-D.x,W=U.y-D.y,I=v*L-d*V,j=v*W-d*z;if(w(I)>N){var X=z*L-W*V;return I>0?j>=0&&X>=0:j>=0||X>=0}return j>0}function m(N,m){function t(q,x){var L=G.length-1,F=q-1;0>F&&(F=L);var e=q+1;e>L&&(e=0);var p=O(G[q],G[F],G[e],X[x]);if(!p)return!1;var Y=X.length-1,k=x-1;0>k&&(k=Y);var l=x+1;return l>Y&&(l=0),p=O(X[x],X[k],X[l],G[q]),p?!0:!1}function c(U,l){var x,d,n;for(x=0;x<G.length;x++)if(d=x+1,d%=G.length,n=W(U,l,G[x],G[d],!0),n.length>0)return!0;return!1}function K(s,Y){var H,T,C,d,n;for(H=0;H<f.length;H++)for(T=m[f[H]],C=0;C<T.length;C++)if(d=C+1,d%=T.length,n=W(s,Y,T[C],T[d],!0),n.length>0)return!0;return!1}for(var X,n,l,d,C,S,P,o,p,L,y,G=N.concat(),f=[],i=[],s=0,Q=m.length;Q>s;s++)f.push(s);for(var q=0,V=2*f.length;f.length>0&&(V--,!(0>V));)for(l=q;l<G.length;l++){d=G[l],n=-1;for(var s=0;s<f.length;s++)if(S=f[s],P=d.x+":"+d.y+":"+S,i[P]===Y){X=m[S];for(var e=0;e<X.length;e++)if(C=X[e],t(l,e)&&!c(d,C)&&!K(d,C)){n=e,f.splice(s,1),o=G.slice(0,l+1),p=G.slice(l),L=X.slice(n),y=X.slice(0,n+1),G=o.concat(L).concat(y).concat(p),q=l;break}if(n>=0)break;i[P]=!0}if(n>=0)break}return G}for(var f,P,N,I,y,b,L={},F=h.concat(),s=0,S=c.length;S>s;s++)Array.prototype.push.apply(F,c[s]);for(f=0,P=F.length;P>f;f++)y=F[f].x+":"+F[f].y,L[y]!==Y,L[y]=f;var u=m(h,c),i=ie.Triangulate(u,!1);for(f=0,P=i.length;P>f;f++)for(I=i[f],N=0;3>N;N++)y=I[N].x+":"+I[N].y,b=L[y],b!==Y&&(I[N]=b);return i.concat()},isClockWise:function(J){return ie.Triangulate.area(J)<0},b2p0:function($,u){var L=1-$;return L*L*u},b2p1:function(A,m){return 2*(1-A)*A*m},b2p2:function(l,f){return l*l*f},b2:function(m,j,z,A){return this.b2p0(m,j)+this.b2p1(m,z)+this.b2p2(m,A)},b3p0:function(_,A){var n=1-_;return n*n*n*A},b3p1:function(L,y){var A=1-L;return 3*A*A*L*y},b3p2:function(o,K){var Q=1-o;return 3*Q*o*o*K},b3p3:function(o,y){return o*o*o*y},b3:function(j,T,Q,U,c){return this.b3p0(j,T)+this.b3p1(j,Q)+this.b3p2(j,U)+this.b3p3(j,c)}},ie={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var P=u.keys(this.faces);return P.length?P[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(N){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(l){var j=l.familyName.toLowerCase(),X=this;return X.faces[j]=X.faces[j]||{},X.faces[j][l.cssFontWeight]=X.faces[j][l.cssFontWeight]||{},X.faces[j][l.cssFontWeight][l.cssFontStyle]=l,l},drawText:function(O){var B,K=this.getFace(),c=this.size/K.resolution,V=0,I=String(O).split(""),E=I.length,r=[];for(B=0;E>B;B++){var j=new Xj,H=this.extractGlyphPoints(I[B],K,c,V,j);H&&(V+=H.offset*this.spacing,r.push(H.path))}var o=V/2;return{paths:r,offset:o}},extractGlyphPoints:function(N,X,S,b,h){var e,T,C,R,m,H,d,_,u,z,t,O,Q,J,F,A,I,Y,Z,y=[],s=X.glyphs[N]||X.glyphs["?"];if(s){if(s.o)for(R=s._cachedOutline||(s._cachedOutline=s.o.split(" ")),H=R.length,d=S,_=S,e=0;H>e;)switch(m=R[e++]){case"m":u=R[e++]*d+b,z=R[e++]*_,h.moveTo(u,z);break;case"l":u=R[e++]*d+b,z=R[e++]*_,h.lineTo(u,z);break;case"q":if(t=R[e++]*d+b,O=R[e++]*_,F=R[e++]*d+b,A=R[e++]*_,h.quadraticCurveTo(F,A,t,O),Z=y[y.length-1])for(Q=Z.x,J=Z.y,T=1,C=this.divisions;C>=T;T++){var W=T/C;aj.b2(W,Q,F,t),aj.b2(W,J,A,O)}break;case"b":if(t=R[e++]*d+b,O=R[e++]*_,F=R[e++]*d+b,A=R[e++]*_,I=R[e++]*d+b,Y=R[e++]*_,h.bezierCurveTo(F,A,I,Y,t,O),Z=y[y.length-1])for(Q=Z.x,J=Z.y,T=1,C=this.divisions;C>=T;T++){var W=T/C;aj.b3(W,Q,F,I,t),aj.b3(W,J,A,Y,O)}}return{offset:s.ha*S,path:h}}}};ie.generateShapes=function(K,E){E=E||{};var O=E.font;if(O===Y&&(O=ie.getDefaultFont(),!O))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var w=E.size!==Y?E.size:1,j=E.curveSegments!==Y?E.curveSegments:4,S=E.spacing!==Y?E.spacing:1,f=E.weight!==Y?E.weight:"normal",A=E.style!==Y?E.style:"normal";ie.size=w,ie.divisions=j,ie.face=O,ie.weight=f,ie.style=A,ie.spacing=S;for(var X=ie.drawText(K),u=X.paths,y=[],b=0,H=u.length;H>b;b++)Array.prototype.push.apply(y,u[b].toShapes());return y},function(p){var C=1e-10,b=function(Y,N){var W=Y.length;if(3>W)return null;var l,S,b,g=[],B=[],R=[];if(j(Y)>0)for(S=0;W>S;S++)B[S]=S;else for(S=0;W>S;S++)B[S]=W-1-S;var I=W,y=2*I;for(S=I-1;I>2;){if(y--<=0)return N?R:g;if(l=S,l>=I&&(l=0),S=l+1,S>=I&&(S=0),b=S+1,b>=I&&(b=0),P(Y,l,S,b,I,B)){var r,n,T,f,o;for(r=B[l],n=B[S],T=B[b],g.push([Y[r],Y[n],Y[T]]),R.push([B[l],B[S],B[b]]),f=S,o=S+1;I>o;f++,o++)B[f]=B[o];I--,y=2*I}}return N?R:g},j=function(j){for(var z=j.length,J=0,l=z-1,i=0;z>i;l=i++)J+=j[l].x*j[i].y-j[i].x*j[l].y;return.5*J},P=function(w,e,h,z,r,P){var q,M,v,E,t,a,G,c,u;if(M=w[P[e]].x,v=w[P[e]].y,E=w[P[h]].x,t=w[P[h]].y,a=w[P[z]].x,G=w[P[z]].y,C>(E-M)*(G-v)-(t-v)*(a-M))return!1;var b,U,$,S,l,F,Q,K,I,L,R,_,W,J,X;for(b=a-E,U=G-t,$=M-a,S=v-G,l=E-M,F=t-v,q=0;r>q;q++)if(c=w[P[q]].x,u=w[P[q]].y,!(c===M&&u===v||c===E&&u===t||c===a&&u===G)&&(Q=c-M,K=u-v,I=c-E,L=u-t,R=c-a,_=u-G,X=b*L-U*I,W=l*K-F*Q,J=$*_-S*R,X>=-C&&J>=-C&&W>=-C))return!1;return!0};return p.Triangulate=b,p.Triangulate.area=j,p}(ie),P._typeface_js={faces:ie.faces,loadFace:ie.loadFace};var ik=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},rg=ik.prototype={constructor:ik,computeFaceNormals:function(){for(var w=new sd,Z=new sd,i=0,j=this.faces.length;j>i;i++){var b=this.faces[i],y=this.vertices[b.a],c=this.vertices[b.b],W=this.vertices[b.c];w.subVectors(W,c),Z.subVectors(y,c),w.cross(Z),w.normalize(),b.normal.copy(w)}},computeVertexNormals:function(H){var _,m,L,z,w,u;for(u=new Array(this.vertices.length),_=0,m=this.vertices.length;m>_;_++)u[_]=new sd;if(H){var P,M,o,g=new sd,T=new sd;for(L=0,z=this.faces.length;z>L;L++)w=this.faces[L],P=this.vertices[w.a],M=this.vertices[w.b],o=this.vertices[w.c],g.subVectors(o,M),T.subVectors(P,M),g.cross(T),u[w.a].add(g),u[w.b].add(g),u[w.c].add(g)}else for(L=0,z=this.faces.length;z>L;L++)w=this.faces[L],u[w.a].add(w.normal),u[w.b].add(w.normal),u[w.c].add(w.normal);for(_=0,m=this.vertices.length;m>_;_++)u[_].normalize();for(L=0,z=this.faces.length;z>L;L++)w=this.faces[L],w.vertexNormals[0]=u[w.a].clone(),w.vertexNormals[1]=u[w.b].clone(),w.vertexNormals[2]=u[w.c].clone()},mergeVertices:function(){var I,K,x,E,m,o,Q,R,B={},v=[],s=[],N=4,X=H(10,N);for(x=0,E=this.vertices.length;E>x;x++)I=this.vertices[x],K=W(I.x*X)+"_"+W(I.y*X)+"_"+W(I.z*X),B[K]===Y?(B[K]=x,v.push(this.vertices[x]),s[x]=v.length-1):s[x]=s[B[K]];var U=[];for(x=0,E=this.faces.length;E>x;x++){m=this.faces[x],m.a=s[m.a],m.b=s[m.b],m.c=s[m.c],o=[m.a,m.b,m.c];for(var f=0;3>f;f++)if(o[f]==o[(f+1)%3]){U.push(x);break}}for(x=U.length-1;x>=0;x--){var M=U[x];for(this.faces.splice(M,1),Q=0,R=this.faceVertexUvs.length;R>Q;Q++)this.faceVertexUvs[Q].splice(M,1)}var $=this.vertices.length-v.length;return this.vertices=v,$}},Wg=function(Y,H,E,k,r,N,v){this.aX=Y,this.aY=H,this.xRadius=E,this.yRadius=k,this.aStartAngle=r,this.aEndAngle=N,this.aClockwise=v};Wg.prototype=fm(Uk),Wg.prototype.getPoint=function(e){var n,x=this.aEndAngle-this.aStartAngle;0>x&&(x+=k),x>k&&(x-=k),n=this.aClockwise===!0?this.aEndAngle+(1-e)*(k-x):this.aStartAngle+e*x;var Z=this.aX+this.xRadius*G(n),Y=this.aY+this.yRadius*A(n);return new Ap(Z,Y)};var Zm=function(m,v){this.v1=m,this.v2=v},qn=Zm.prototype=fm(Uk);qn.getPoint=function(M){var C=this.v2.clone().sub(this.v1);return C.multiplyScalar(M).add(this.v1),C},qn.getPointAt=function(B){return this.getPoint(B)},qn.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()};var Qn=function(K,Y,u){this.v0=K,this.v1=Y,this.v2=u};Qn.prototype=fm(Uk),Qn.prototype.getPoint=function(G){var U,z;return U=aj.b2(G,this.v0.x,this.v1.x,this.v2.x),z=aj.b2(G,this.v0.y,this.v1.y,this.v2.y),new Ap(U,z)};var jo=function(H,w,V,b){this.v0=H,this.v1=w,this.v2=V,this.v3=b};jo.prototype=fm(Uk),jo.prototype.getPoint=function(E){var f,a;return f=aj.b3(E,this.v0.x,this.v1.x,this.v2.x,this.v3.x),a=aj.b3(E,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Ap(f,a)},cn.create(function(S,Z){this.v1=S,this.v2=Z},function(i){var R=new sd;return R.subVectors(this.v2,this.v1),R.multiplyScalar(i),R.add(this.v1),R});var kq=cn.create(function(c,V,U){this.v0=c,this.v1=V,this.v2=U},function(j){var K,U,o;return K=aj.b2(j,this.v0.x,this.v1.x,this.v2.x),U=aj.b2(j,this.v0.y,this.v1.y,this.v2.y),o=aj.b2(j,this.v0.z,this.v1.z,this.v2.z),new sd(K,U,o)}),Dd=cn.create(function(o,M,e,V){this.v0=o,this.v1=M,this.v2=e,this.v3=V},function(Z){var S,R,d;return S=aj.b3(Z,this.v0.x,this.v1.x,this.v2.x,this.v3.x),R=aj.b3(Z,this.v0.y,this.v1.y,this.v2.y,this.v3.y),d=aj.b3(Z,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new sd(S,R,d)}),Yj=function(M,g,S,R,i,E,m,D){ik.call(this),R=R!==Y?R:.5,i=i!==Y?i:.5,D=D!==Y?D:1,M=M||8,E=E||0,m=m||k;var C,_,w=1,c=D/2,F=[],x=[],s=this.vertices,y=this.faces,n=this.faceVertexUvs;for(_=0;w>=_;_++){var U=[],O=[],I=_/w,o=I*(i-R)+R;for(C=0;M>=C;C++){var K=C/M,J=new sd,q=-(K*m+E);J.z=o*A(q),J.y=-I*D+c,J.x=o*G(q),s.push(J),U.push(s.length-1),O.push(new Ap(K,I))}F.push(U),x.push(O)}var l,H,T=(i-R)/D;for(C=0;M>C;C++)for(0!==R?(l=s[F[0][C]].clone(),H=s[F[0][C+1]].clone()):(l=s[F[1][C]].clone(),H=s[F[1][C+1]].clone()),l.setY(X(l.x*l.x+l.z*l.z)*T).normalize(),H.setY(X(H.x*H.x+H.z*H.z)*T).normalize(),_=0;w>_;_++){var d=F[_][C],N=F[_+1][C],e=F[_+1][C+1],z=F[_][C+1],V=l.clone(),W=l.clone(),p=H.clone(),r=H.clone(),u=x[_][C].clone(),b=x[_+1][C].clone(),f=x[_+1][C+1].clone(),P=x[_][C+1].clone();y.push(new Fp(d,N,z,[V,W,r])),n[0].push([u,b,P]),y.push(new Fp(N,e,z,[W.clone(),p,r.clone()])),n[0].push([b.clone(),f,P.clone()])}if(g&&R>0)for(this.vertices.push(new sd(0,c,0)),C=0;M>C;C++){var d=F[0][C],N=F[0][C+1],e=this.vertices.length-1,V=new sd(0,1,0),W=new sd(0,1,0),p=new sd(0,1,0),u=x[0][C].clone(),b=x[0][C+1].clone(),f=new Ap(b.x,0);y.push(new Fp(d,N,e,[V,W,p],null,1));var L=C/M*k,t=G(L),Z=A(L),$=(C+1)/M*k,a=G($),j=A($);n[0].push([new Ap(.5+.5*t,.5+.5*Z),new Ap(.5+.5*a,.5+.5*j),new Ap(.5,.5)])}if(S&&i>0)for(this.vertices.push(new sd(0,-c,0)),C=0;M>C;C++){var d=F[_][C+1],N=F[_][C],e=s.length-1,V=new sd(0,-1,0),W=new sd(0,-1,0),p=new sd(0,-1,0),u=x[_][C+1].clone(),b=x[_][C].clone();y.push(new Fp(d,N,e,[V,W,p],null,2));var L=C/M*k,t=G(L),Z=A(L),$=(C+1)/M*k,a=G($),j=A($);n[0].push([new Ap(.5+.5*a,.5-.5*j),new Ap(.5+.5*t,.5-.5*Z),new Ap(.5,.5)])}};Yj.prototype=fm(rg);var Er=function(b,g,u,J,n,p,N){ik.call(this),N=N||.5,b=b||16,g=g||16,u=(u!==Y?u:0)-j,J=J!==Y?J:k,n=n!==Y?n:0,p=p!==Y?p:j;var x,y,d=[],o=[],K=this.vertices,t=this.faces,U=this.faceVertexUvs;for(y=0;g>=y;y++){var c=[],q=[];for(x=0;b>=x;x++){var W=x/b,r=y/g,Q=new sd;Q.x=-N*G(u+W*J)*A(n+r*p),Q.y=N*G(n+r*p),Q.z=N*A(u+W*J)*A(n+r*p),K.push(Q),c.push(K.length-1),q.push(new Ap(W,r))}d.push(c),o.push(q)}for(y=0;g>y;y++)for(x=0;b>x;x++){var X=d[y][x+1],$=d[y][x],B=d[y+1][x],m=d[y+1][x+1],R=K[X].clone().normalize(),S=K[$].clone().normalize(),a=K[B].clone().normalize(),L=K[m].clone().normalize(),z=o[y][x+1].clone(),I=o[y][x].clone(),C=o[y+1][x].clone(),_=o[y+1][x+1].clone();w(K[X].y)===N?(z.x=(z.x+I.x)/2,t.push(new Fp(X,B,m,[R,a,L])),U[0].push([z,C,_])):w(K[B].y)===N?(C.x=(C.x+_.x)/2,t.push(new Fp(X,$,B,[R,S,a])),U[0].push([z,I,C])):(t.push(new Fp(X,$,m,[R,S,L])),U[0].push([z,I,_]),t.push(new Fp($,B,m,[S.clone(),a,L.clone()])),U[0].push([I.clone(),C,_.clone()]))}};Er.prototype=fm(rg);var $r=function(d,I,n,z,e,g){ik.call(this),d=d||.33,I=I||.17,z=z||8,n=n||6,e=e||0,g=g||k;for(var y=new sd,p=[],L=[],U=0;z>=U;U++)for(var R=U/z*k+j,q=0;n>=q;q++){var v=q/n*g+e;y.x=d*G(v),y.z=-d*A(v);var w=new sd,B=d+I*G(R);w.x=B*G(v),w.z=-B*A(v),w.y=I*A(R),this.vertices.push(w),p.push(new Ap(q/n,1-U/z)),L.push(w.clone().sub(y).normalize())}for(var U=1;z>=U;U++)for(var q=1;n>=q;q++){var o=(n+1)*U+q-1,S=(n+1)*(U-1)+q-1,h=(n+1)*(U-1)+q,C=(n+1)*U+q,b=new Fp(o,S,C,[L[o].clone(),L[S].clone(),L[C].clone()]);this.faces.push(b),this.faceVertexUvs[0].push([p[o].clone(),p[S].clone(),p[C].clone()]),b=new Fp(S,h,C,[L[S].clone(),L[h].clone(),L[C].clone()]),this.faces.push(b),this.faceVertexUvs[0].push([p[S].clone(),p[h].clone(),p[C].clone()])}this.computeFaceNormals()};$r.prototype=fm(rg);var Uj=function(O,K,$){return O?(ik.call(this),O=O instanceof Array?O:[O],this.addShapeList(O,K),K.convertYZ!==!1&&Go(this,$),this.computeFaceNormals(),void 0):(O=[],void 0)},Yn=Uj.prototype=fm(ik.prototype);Yn.addShapeList=function(C,y){for(var Q=C.length,O=0;Q>O;O++){var l=C[O];this.addShape(l,y)}},Yn.addShape=function(I,H){function V(){if(H.bottom)for(var f=0;P>f;f++)X=A[f],L(X[2],X[1],X[0],!0);if(H.top)for(f=0;P>f;f++)X=A[f],L(X[0]+i*Z,X[1]+i*Z,X[2]+i*Z,!1)}function h(){var d=0;for(s(B,d),d+=B.length,E=0,g=c.length;g>E;E++)z=c[E],s(z,d),d+=z.length}function s(v,e){for(var w,Q,b=v.length;--b>=0;){w=b,Q=b-1,0>Q&&(Q=v.length-1);var k=0,C=Z;for(k=0;C>k;k++){var V=i*k,O=i*(k+1),W=e+w+V,H=e+Q+V,B=e+Q+O,z=e+w+O;r(W,H,B,z,v,k,C,w,Q)}}}function n(N,F,V){U.vertices.push(new sd(N,F,V))}function L(p,b,E,k){p+=o,b+=o,E+=o,U.faces.push(new Fp(p,b,E,null,null,k?2:1));var $=k?G.generateBottomUV(U,I,H,p,b,E):G.generateTopUV(U,I,H,p,b,E);U.faceVertexUvs[0].push($)}function r(Z,e,N,K,q,h,u,O,v){Z+=o,e+=o,N+=o,K+=o,U.faces.push(new Fp(Z,e,K)),U.faces.push(new Fp(e,N,K));var R=G.generateSideWallUV(U,I,q,H,Z,e,N,K,h,u,O,v);U.faceVertexUvs[0].push([R[0],R[1],R[3]]),U.faceVertexUvs[0].push([R[1],R[2],R[3]])}var q,e,f,d,F,N=H.amount,W=H.curveSegments||Tp,Z=H.steps||1,b=H.extrudePath,j=!1,G=new jj(H.repeatUVLength);b&&(q=b.getSpacedPoints(Z),j=!0,e=H.frames!==Y?H.frames:new vk.FrenetFrames(b,Z,!1),f=new sd,d=new sd,F=new sd);var z,E,g,U=this,o=this.vertices.length,p=I.extractPoints(W),S=p.shape,c=p.holes,t=!aj.isClockWise(S);if(t){for(S=S.reverse(),E=0,g=c.length;g>E;E++)z=c[E],aj.isClockWise(z)&&(c[E]=z.reverse());t=!1}var A=aj.triangulateShape(S,c),B=S;for(E=0,g=c.length;g>E;E++)z=c[E],S=S.concat(z);for(var m,X,i=S.length,P=A.length,_=0;i>_;_++)m=S[_],j?(d.copy(e.normals[0]).multiplyScalar(m.x),f.copy(e.binormals[0]).multiplyScalar(m.y),F.copy(q[0]).add(d).add(f),n(F.x,F.y,F.z)):n(m.x,m.y,0);var M;for(M=1;Z>=M;M++)for(_=0;i>_;_++)m=S[_],j?(d.copy(e.normals[M]).multiplyScalar(m.x),f.copy(e.binormals[M]).multiplyScalar(m.y),F.copy(q[M]).add(d).add(f),n(F.x,F.y,F.z)):n(m.x,m.y,N/Z*M);V(),h()};var vk=function(j,i,n,O,c){function T(K,q,C){return p.vertices.push(new sd(K,q,C))-1}ik.call(this),i=i||64,n=n||1,O=O||8,c=c||!1;var U,v,z,Z,e,$,Y,H,D,d,g,_,M,t,R,E,I,B,Q,r,w=[],p=this,f=i+1,W=new sd,P=new vk.FrenetFrames(j,i,c),N=P.tangents,a=P.normals,S=P.binormals;for(this.tangents=N,this.normals=a,this.binormals=S,D=0;f>D;D++)for(w[D]=[],Z=D/(f-1),H=j.getPointAt(Z),U=N[D],v=a[D],z=S[D],d=0;O>d;d++)e=d/O*k,$=-n*G(e),Y=n*A(e),W.copy(H),W.x+=$*v.x+Y*z.x,W.y+=$*v.y+Y*z.y,W.z+=$*v.z+Y*z.z,w[D][d]=T(W.x,W.y,W.z);for(D=0;i>D;D++)for(d=0;O>d;d++)g=c?(D+1)%i:D+1,_=(d+1)%O,M=w[D][d],t=w[g][d],R=w[g][_],E=w[D][_],I=new Ap(D/i,d/O),B=new Ap((D+1)/i,d/O),Q=new Ap((D+1)/i,(d+1)/O),r=new Ap(D/i,(d+1)/O),this.faces.push(new Fp(M,t,E)),this.faceVertexUvs[0].push([I,B,r]),this.faces.push(new Fp(t,R,E)),this.faceVertexUvs[0].push([B.clone(),Q,r.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};vk.prototype=fm(rg),vk.FrenetFrames=function(b,X,n){function v(){V[0]=new sd,P[0]=new sd,r=Number.MAX_VALUE,J=w(K[0].x),M=w(K[0].y),_=w(K[0].z),r>=J&&(r=J,j.set(1,0,0)),r>=M&&(r=M,j.set(0,1,0)),r>=_&&j.set(0,0,1),F.crossVectors(K[0],j).normalize(),V[0].crossVectors(K[0],F),P[0].crossVectors(K[0],V[0])}var l,r,J,M,_,R,E,j=new sd,K=[],V=[],P=[],F=new sd,W=new Ql,H=X+1,o=1e-4;for(this.tangents=K,this.normals=V,this.binormals=P,R=0;H>R;R++)E=R/(H-1),K[R]=b.getTangentAt(E),K[R].normalize();for(v(),R=1;H>R;R++)V[R]=V[R-1].clone(),P[R]=P[R-1].clone(),F.crossVectors(K[R-1],K[R]),F.length()>o&&(F.normalize(),l=p(Yr(K[R-1].dot(K[R]),-1,1)),V[R].applyMatrix4(W.makeRotationAxis(F,l))),P[R].crossVectors(K[R],V[R]);if(n)for(l=p(Yr(V[0].dot(V[H-1]),-1,1)),l/=H-1,K[0].dot(F.crossVectors(V[0],V[H-1]))>0&&(l=-l),R=1;H>R;R++)V[R].applyMatrix4(W.makeRotationAxis(K[R],l*R)),P[R].crossVectors(K[R],V[R])};var Hf=function(s,E,F,u){ik.call(this),E=E||18,F=F||0,u=u==m?k:u;for(var h=1/(s.length-1),v=1/E,o=0,U=E;U>=o;o++)for(var i=F+o*v*u,t=G(i),M=A(i),P=0,T=s.length;T>P;P++){var B=s[P],L=new sd;L.x=t*B.x-M*B.y,L.y=M*B.x+t*B.y,L.z=B.z,this.vertices.push(L)}for(var H=s.length,o=0,U=E;U>o;o++)for(var P=0,T=s.length-1;T>P;P++){var O=P+H*o,d=O,$=O+H,t=O+1+H,Y=O+1,g=o*v,N=P*h,c=g+v,w=N+h;this.faces.push(new Fp(d,Y,$)),this.faceVertexUvs[0].push([new Ap(g,N),new Ap(g,w),new Ap(c,N)]),this.faces.push(new Fp($,Y,t)),this.faceVertexUvs[0].push([new Ap(c,N),new Ap(g,w),new Ap(c,w)])}this.mergeVertices(),Go(this),this.computeFaceNormals(),this.computeVertexNormals()};Hf.prototype=fm(rg);var Nm=function(A,i){i=i||{};var V=ie.generateShapes(A,i);i.amount=i.amount!==Y?i.amount:.5,i.convertYZ=!1,i.fill!==!1&&(i.bottom=!0,i.top=!0),Uj.call(this,V,i)};Nm.prototype=fm(Yn);var af=o.Node=function(){Ck(af,this)},Rq={X:ue,Y:Lo,Z:xh},Wp={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Pg="xzy",ei=function(c,j,i){if(j){var l=j[0],U=j[1],X=j[2];"xzy"===i?(Lo(c,U),xh(c,X),ue(c,l)):"xyz"===i?(xh(c,X),Lo(c,U),ue(c,l)):"yxz"===i?(xh(c,X),ue(c,l),Lo(c,U)):"yzx"===i?(ue(c,l),xh(c,X),Lo(c,U)):"zxy"===i?(Lo(c,U),ue(c,l),xh(c,X)):"zyx"===i?(ue(c,l),Lo(c,U),xh(c,X)):(Lo(c,U),xh(c,X),ue(c,l))}};_q("Node",fc,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Pg,_64O:0,_rotationX:0,_53O:0,_host:m,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return br},_22Q:function(){return Jd},getX:function(){return this.p().x},setX:function(s){this.p(s,this.p().y)},getY:function(){return this.p().y},setY:function(k){this.p(this.p().x,k)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(u){this.setAnchor(u,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(t){this.setAnchor(this.getAnchor().x,t)},getScaleX:function(){return this.getScale().x},setScaleX:function(F){this.setScale(F,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(W){this.setScale(this.getScale().x,W)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(E,G){zh(E,am(m,m,this.r3(),this.getRotationMode())),this.translate3d(E[0]*G,E[1]*G,E[2]*G)},translateFront:function(R){this.translate3dBy([0,0,1],R)},translateBack:function(D){this.translate3dBy([0,0,-1],D)},translateLeft:function(A){this.translate3dBy([-1,0,0],A)},translateRight:function(e){this.translate3dBy([1,0,0],e)},translateTop:function(D){this.translate3dBy([0,1,0],D)},translateBottom:function(U){this.translate3dBy([0,-1,0],U)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(g,D,q){1===arguments.length&&(D=g[1],q=g[2],g=g[0]),this.p(g,q),this.setElevation(D)},translate3d:function(b,D,_){1===arguments.length&&(D=b[1],_=b[2],b=b[0]),this.translate(b,_),this.setElevation(this._54O+D)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(n,b,K){1===arguments.length&&(b=n[1],K=n[2],n=n[0]),this.setSize(n,K),this.setTall(b)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(s,C,v){1===arguments.length&&(C=s[1],v=s[2],s=s[0]),this.setRotationX(s),this.setRotation(-C),this.setRotationZ(v)},setRotationY:function(x){this.setRotation(-x)},getRotationY:function(){return-this._64O},lookAt:function(E,W){W=W||fq;var D=this,d=xl(E,D.p3()),f=fr(d);W===fq?(D.r3([-V(d[1]/f),-r(d[2],d[0])+y,0]),D.setRotationMode("xzy")):W===jf?(D.r3(0,-r(d[2],d[0]),V(d[1]/f)),D.setRotationMode("zyx")):W===ip?(D.r3(0,-r(d[2],d[0])+j,-V(d[1]/f)),D.setRotationMode("zyx")):W===wh?(D.r3([-V(d[1]/f)+y,-r(d[2],d[0])+y,0]),D.setRotationMode("xzy")):W===ef&&(D.r3([-V(d[1]/f)-y,-r(d[2],d[0])+y,0]),D.setRotationMode("xzy")),W===Pk&&(D.r3([-V(d[1]/f)+j,-r(d[2],d[0])+y,j]),D.setRotationMode("zxy"))},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(r){var Y=this;if(Y!==r&&Y._host!==r){var D=Y._host;D&&D._removeAttach(Y),Y._host=r,Y._host&&Y._host._addAttach(Y),Y.fp("host",D,r),Y.onHostChanged(D,r)}},getAttaches:function(){return this._69O},_addAttach:function(o){var p=this;p._69O||(p._69O=new Nf),p._69O.add(o),p.fp("attaches",m,o)},_removeAttach:function(c){var y=this;y._69O.remove(c),y._69O.isEmpty()&&delete y._69O,y.fp("attaches",c,m)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(a){var A=this;A._44I||(A._44I=new Nf),A._42I||(A._42I=new Nf),A._44I.add(a),A._42I.add(a),A._20I()},_4I:function(f){var K=this;K._44I||(K._44I=new Nf),K._43I||(K._43I=new Nf),K._44I.add(f),K._43I.add(f),K._20I()},_16I:function(X){var s=this;s._44I.remove(X),s._42I.remove(X),s._44I.isEmpty()&&delete s._44I,s._42I.isEmpty()&&delete s._42I,s._20I()},_18I:function(p){var P=this;P._44I.remove(p),P._43I.remove(p),P._44I.isEmpty()&&delete P._44I,P._43I.isEmpty()&&delete P._43I,P._20I()},_20I:function(){var T=this;if(delete T._45I,!T._44I||T._44I.isEmpty())return delete T._70O,void 0;var Y;T._44I.each(function(n){n.isLooped()&&(Y||(Y={}),Y[n._id]||(T._45I||(T._45I=new Nf),T._45I.add(n),Y[n._id]=n))}),Y?(T._70O=new Nf,T._44I.each(function(n){Y[n._id]?"A"===Y[n._id]||(Y[n._id]="A",T._70O.add(n)):T._70O.add(n)})):T._70O=T._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(N){var d=this;d._46I||(d._46I=new Nf),d._48I||(d._48I=new Nf),d._46I.add(N),d._48I.add(N),d._19I()},_3I:function($){var q=this;q._47I||(q._47I=new Nf),q._48I||(q._48I=new Nf),q._47I.add($),q._48I.add($),q._19I()},_15I:function(W){var J=this;J._46I.remove(W),J._48I.remove(W),J._46I.isEmpty()&&delete J._46I,J._48I.isEmpty()&&delete J._48I,J._19I()},_17I:function(E){var F=this;F._47I.remove(E),F._48I.remove(E),F._47I.isEmpty()&&delete F._47I,F._48I.isEmpty()&&delete F._48I,F._19I()},_19I:function(){var s=this;delete s._49I;var R=s._48I;if(R&&!R.isEmpty()){var Z={};R.each(function(b){Z[b._id]?s._49I||(s._49I=new Nf):Z[b._id]=b}),s._49I?R.each(function(_){Z[_._id]&&(s._49I.add(_),delete Z[_._id])}):s._49I=R}},getImage:function(){if(this._pendingCheckImageJSON){var T=b.getImage(this._image);T&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof lg&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(B){var D=this,u=D._image,o=D.getWidth(),h=D.getHeight();D._image=B,D.fp("image",u,B)&&(null!=B&&(hk(B)||Mq(B)&&/\.json$/i.test(B))&&(this._pendingCheckImageJSON=!0),D.fp(Rb,o,D.getWidth()),D.fp(Uc,h,D.getHeight()))},getElevation:function(){return this._54O},setElevation:function(o){var i=this;if(!i._50O){i._50O=1;var X=i._54O;i._54O=o,i.fp(Fq,X,o),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(J){var H=this;if(!H._49O){H._49O=1;var r=H._64O;H._64O=J,H.fp(Ed,r,J),delete H._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(y){var z=this;if(!z._51O){z._51O=1;var i=z._rotationX;z._rotationX=y,z.fp("rotationX",i,y),delete z._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(A){var w=this;if(!w._52O){w._52O=1;var i=w._53O;w._53O=A,w.fp("rotationZ",i,A),delete w._52O}},getPosition:function(){return this._position},setPosition:function(x,D){var v=this;if(!v._50I){v._50I=1;var I;if(I=2===arguments.length?{x:x,y:D}:x,I.x!==v._position.x||I.y!==v._position.y){var H=v._position;v._position=I,v.fp(Nh,H,I)}delete v._50I}},translate:function(A,s){var U=this._position;this.p(U.x+A,U.y+s)},getWidth:function(){var h=this;if(h._width>=0)return h._width;var W=h.getStyle("shape3d");if(W){var R=Am(W);if(R&&R.rawS3)return R.rawS3[0]}var g=Se(h._image);return g?Jb(g,h):20},setWidth:function(Y){var d=this,n=d._width;d._width=Y,d.fp(Rb,n,Y)},getHeight:function(){var D=this;if(D._height>=0)return D._height;var c=D.getStyle("shape3d");if(c){var H=Am(c);if(H&&H.rawS3)return H.rawS3[2]}var Y=Se(D._image);return Y?vr(Y,D):20},setHeight:function(I){var e=this,t=e._height;e._height=I,e.fp(Uc,t,I)},getTall:function(){var c=this;if(c._tall>=0)return c._tall;var a=c.getStyle("shape3d");if(a){var _=Am(a);if(_&&_.rawS3)return _.rawS3[1]}return 20},setTall:function(E){var F=this,w=F._tall;F._tall=E,F.fp("tall",w,E)},setSize:function(q,H){var S=this;2===arguments.length?(S.setWidth(q),S.setHeight(H)):(S.setWidth(q.width),S.setHeight(q.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(a,t,B,s,o){var C=this,G=C.getAnchor(),W=C.getScale();arguments.length<=2&&(o=t,t=a.y,B=a.width,s=a.height,a=a.x);var $=o&&W.x<0?1-G.x:G.x,c=o&&W.y<0?1-G.y:G.y;C.p(a+B*$,t+s*c),o&&(B/=Math.abs(W.x),s/=Math.abs(W.y)),C.setWidth(B),C.setHeight(s)},getMatrix:function(){var A=this,q=A._64O,V=A._position,X=A.getScale();return new Gc(q,V.x,V.y,X.x,X.y)},getAnchorRect:function(){var M=this,P=M.getWidth(),A=M.getHeight(),b=M.getAnchor();return{x:-P*b.x,y:-A*b.y,width:P,height:A}},toLocal:function(m){return this.getMatrix().tfi(m)},toGlobal:function(Y){return this.getMatrix().tf(Y)},isInRect:function(O){O=this.toLocal(O);var t=this.getWidth(),u=this.getHeight();return O.x+=t*this.getAnchorX(),O.y+=u*this.getAnchorY(),!(O.x<0||O.y<0||O.x>t||O.y>u)},getRect:function(){var $=this,L=$.getWidth(),v=$.getHeight(),N=$.getAnchor(),W={x:-L*N.x,y:-v*N.y,width:L,height:v},s=$.getMatrix();return W=Td([s.tf(W.x,W.y),s.tf(W.x+W.width,W.y),s.tf(W.x+W.width,W.y+W.height),s.tf(W.x,W.y+W.height)])
},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var n=this,V=n.getAnchor(),d=n._anchorElevation;return{x:V.x,y:d,z:V.y}},setAnchorElevation:function(q){var x=this,K=x._anchorElevation;K!==q&&(x._anchorElevation=q,x.fp("anchorElevation",K,q))},setAnchor3d:function(h,B,g,j){var T,i=this;"number"==typeof h?T={x:h,y:B,z:g}:(T=h.length?{x:h[0],y:h[1],z:h[2]}:h,j=B),i.setAnchor(T.x,T.z,j),i.setAnchorElevation(T.y)},getAnchor:function(){var f=this;if(f.hasOwnProperty("_anchor"))return f._anchor;var I=Se(f._image);return I&&I.anchorX!==Y?{x:I.anchorX,y:I.anchorY}:f._anchor},setAnchor:function(v,b,n){var L,d=this;"number"==typeof v?L={x:v,y:b}:(L=v.length?{x:v[0],y:v[1]}:v,n=b);var J=d.getAnchor();if(J.x!==L.x||J.y!==L.y){var W=d.getDataModel();if(W&&W.beginTransaction(),d._anchor=L,d.fp("anchor",J,L),n&&!yq){var t=d.getPosition(),E=d.getSize(),C=d.getRotation(),$=d.getScale(),w=-E.width*(J.x-L.x)*$.x,e=-E.height*(J.y-L.y)*$.y,p=A(C),B=G(C);d.setPosition(t.x+B*w-p*e,t.y+p*w+B*e)}W&&W.endTransaction()}},getScale:function(){return this._scale},setScale:function(Z,y){var b,s=this;b=2===arguments.length?{x:Z,y:y}:Z;var S=s.getScale();(S.x!==b.x||S.y!==b.y)&&(s._scale=b,s.fp("scale",S,b))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var S=this,A=S._scaleTall,o=S.getScale();return[o.x,A,o.y]},getFinalScale3d:function(){var D=this,L=D.s3(),Q=D._dynamicScale3d,H=D.getScale3d();return L&&(H[0]*=L[0],H[1]*=L[1],H[2]*=L[2]),Q&&(H[0]*=Q[0],H[1]*=Q[1],H[2]*=Q[2]),H},setScaleTall:function(M){var e=this,k=e._scaleTall;k!==M&&(e._scaleTall=M,e.fp("scaleTall",k,M))},setScale3d:function(M,L,i){var F,$=this;F="number"==typeof M?{x:M,y:L,z:i}:M.length?{x:M[0],y:M[1],z:M[2]}:M,$.setScaleTall(F.y),$.setScale(F.x,F.z)},getCorners:function(W,R){W==m&&(W=0),R==m&&(R=W);var p=this,q=p.getAnchor(),t=p.getWidth(),I=p.getHeight(),L=-t*q.x-W,n=-I*q.y-R,$=t+2*W,l=I+2*R,y=p.getMatrix();return[y.tf(L,n),y.tf(L,n+l),y.tf(L+$,n+l),y.tf(L+$,n)]},getEditControlPoints:function(Q,s,p){s==m&&(s=0),p==m&&(p=s);var d=this,a=d.getAnchor(),C=d.getWidth(),U=d.getHeight(),g=-C*a.x-s,D=-U*a.y-p,z=C+2*s,M=U+2*p;if(Q)return[{x:g,y:D},{x:g,y:0},{x:g,y:D+M},{x:0,y:D+M},{x:g+z,y:D+M},{x:g+z,y:0},{x:g+z,y:D},{x:0,y:D}];var B=d.getMatrix();return[B.tf(g,D),B.tf(g,0),B.tf(g,D+M),B.tf(0,D+M),B.tf(g+z,D+M),B.tf(g+z,0),B.tf(g+z,D),B.tf(0,D)]},rotateAt:function(m,z,k){var h=this,d=h._position,a=h._64O,P=new Gc(a,d.x,d.y).tf(m,z),u=X(m*m+z*z),v=r(d.y-P.y,d.x-P.x)+k;h.setRotation(a+k),h.p(P.x+u*G(v),P.y+u*A(v))},onParentChanged:function(){af.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(v){v._7I()})},onPropertyChanged:function(f){var B=this;af.superClass.onPropertyChanged.call(B,f),B._69O&&B._69O.each(function(Y){Y.handleHostPropertyChange(f)}),B._49I&&B._49I.each(function(O){O.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(c){this.updateAttach(c)},onStyleChanged:function(e){af.superClass.onStyleChanged.apply(this,arguments),Hl[e]&&this.updateAttach()},updateAttach:function(z){var i=this;i._51I||yq||(i._51I=1,i._71O(z),delete i._51I)},_71O:function(k){var p,N,$,c,X,v,G=this,i=G._host,f=k?k.property:m,g=k?k.oldValue:m,T=k?k.newValue:m;if(i instanceof o.Grid){if(f===Fq)G.setElevation(G._54O+T-g);else if(!k||Xp[f]){if(p=G.s("attach.row.index"),N=G.s("attach.column.index"),$=i.getCellRect(p,N),!$)return;c=G.s("attach.row.span"),X=G.s("attach.column.span"),(1!==c||1!==X)&&($=_m($,i.getCellRect(p+c-1,N+X-1))),jr($,G,"attach.padding",1),G.setRect($)}}else if(i instanceof Jn&&(v=G.s("attach.index"))>=0&&(!k||fe[f])){var V=G.s("attach.thickness");V!=m&&G.setHeight(i.getThickness()*V);var H=G.s("attach.offset"),u=i.getPoints(),y=u.size();if(y>v){var d=u.get(v),s=y===v+1?u.get(0):u.get(v+1),h=[s.x-d.x,s.y-d.y],q=fr(h);if(q){G.s("attach.offset.relative")&&(H*=q),G.s("attach.offset.opposite")&&(H=q-H);var w={x:d.x+h[0]/q*H,y:d.y+h[1]/q*H},L=G.s("attach.gap");L&&(G.s("attach.gap.relative")&&(L*=i.getThickness()),w=Fd(m,w,s,L)),G.p(w),G.setRotation(r(h[1],h[0]))}}}else k&&(f===Nh?G.translate(T.x-g.x,T.y-g.y):f===Fq?G.setElevation(G._54O+T-g):Yh[f]&&G._11Q(i,f,T-g))},_11Q:function(S,j,u){var I=this,b=S.p3(),E=xl(I.p3(),b),P=vc(),W=Wp[I.getRotationMode()],N=W[0],n=W[1],Y=W[2],r=Rq[N],T=Rq[n],L=Rq[Y];j===Ed&&(j="rotationY",u=-u),j===Ed+N?(L(P,S[Gp+Y]()),T(P,S[Gp+n]()),r(P,u),T(P,-S[Gp+n]()),L(P,-S[Gp+Y]()),I[bq+N](I[Gp+N]()+u)):j===Ed+n?(L(P,S[Gp+Y]()),T(P,u),L(P,-S[Gp+Y]()),I[bq+n](I[Gp+n]()+u)):j===Ed+Y&&(L(P,u),I[bq+Y](I[Gp+Y]()+u)),zh(E,P),I.p3(b[0]+E[0],b[1]+E[1],b[2]+E[2])},isHostOn:function(f){var s=this;if(s._host&&f&&f._69O)for(var l={},Q=s._host;Q&&Q!==s&&!l[Q._id];){if(Q===f)return!0;l[Q._id]=Q,Q=Q._host}return!1},isLoopedHostOn:function(N){return this.isHostOn(N)&&N.isHostOn(this)},getSerializableProperties:function(){var p=af.superClass.getSerializableProperties.call(this);return mm(p,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),p}});var Ng=o.Edge=function(n,P){var T=this;Ck(Ng,T),T.setSource(n),T.setTarget(P)};_q("Edge",fc,{_icon:"edge_icon",getUIClass:function(){return Vi},_22Q:function(){return pm},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(G){var k=this;if(k._source!==G){var d=k._source;k._source=G,d&&d._16I(k),G&&G._2I(k),k._7I(),k.fp("source",d,G)}},setTarget:function(U){var d=this;if(d._target!==U){var F=d._target;d._target=U,F&&F._18I(d),U&&U._4I(d),d._7I(),d.fp("target",F,U)}},isLooped:function(){var B=this;return B._source===B._target&&!!B._source&&!!B._target},_7I:function(){var d,S=this,H=uk(S);S._40I!==H&&(d=this._40I,d&&d._15I(S),S._40I=H,H&&H._1I(S),S.fp("sourceAgent",d,H),Jr(d,S._41I),Jr(H,S._41I));var z=co(S);S._41I!==z&&(d=S._41I,d&&d._17I(S),S._41I=z,z&&z._3I(S),S.fp("targetAgent",d,z),Jr(d,S._40I),Jr(z,S._40I))},_22I:function(W){this._52I=W,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var D=this;return D._52I&&D._52I.get(0)!==D&&!D.getStyle(sk)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var O=this,A=O._52I;return A&&!O.getStyle(sk)&&A.size()>1&&O===A.get(0)},toggle:function(){var r=this._52I,W=!this.s(sk);r&&r.size()>1&&(r.each(function(T){T.s(sk,W)}),r.getSiblings().each(function(p){p!==r&&p.each(function(h){h.fp("edgeGroup",m,p)})}))},setStyle:function(F,$){(F===Sc||"edge.segments"===F)&&($=Kf($)),Ng.superClass.setStyle.call(this,F,$)},onStyleChanged:function(R){Ng.superClass.onStyleChanged.apply(this,arguments),Eh[R]&&Jr(this._41I,this._40I)},getSerializableProperties:function(){var N=Ng.superClass.getSerializableProperties.call(this);return mm(N,{source:1,target:1}),N}});var Kp=o.Group=function(){Ck(Kp,this)};_q("Group",af,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Rf},onChildAdded:function(){Kp.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Kp.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var W=this;if(!W._54I&&!yq){var Z=W.getChildrenRect();Z&&(W._53I=1,W.p(wq(W.s("group.position"),Z,W.getSize())),delete W._53I)}},getChildrenRect:function(){var D,p=this;return p.eachChild(function(S){D=_m(D,p.getChildRect(S))}),D},getChildRect:function(Y){var A;return Lg(Y)&&Y.s(Sk)&&(Dn(Y)&&Y.isExpanded()&&Y.eachChild(function(t){A=_m(A,Y.getChildRect(t))}),!A&&Y.getRect&&(A=Y.getRect())),A},setPosition:function(W,p){var d=this;if(!d._54I){var J;J=2===arguments.length?{x:W,y:p}:W,yq||d._53I||(d._54I=1,xk(d._children,J.x-d._position.x,J.y-d._position.y),delete d._54I),Kp.superClass.setPosition.call(this,J)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(v){var q=this;if(q._57O!==v){var c=q._57O;q._57O=v,q.fp("expanded",c,q._57O),q._8I()}},_8I:function(){Kp.superClass._8I.call(this),this.eachChild(function(O){Lg(O)&&O._8I()})},onStyleChanged:function(p){Kp.superClass.onStyleChanged.apply(this,arguments),"group.position"===p&&this._81I()},getSerializableProperties:function(){var Y=Kp.superClass.getSerializableProperties.call(this);return Y.expanded=1,Y}});var hj=o.Block=function(){Ck(hj,this)};_q("Block",af,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return dg},onChildAdded:function(){hj.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){hj.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var V=this;if(!yq&&!V._updatingToChildren&&V._syncSize){var E,$,g,B,J,i=[],o=V.getRotation();if(V.eachChild(function(o){Lg(o)&&i.push.apply(i,o.getCorners())}),i.length){V._updatingFromChildren=1;var F=G(-o),e=A(-o),l=1/0,P=-1/0,N=1/0,Z=-1/0;for(B=0,J=i.length;J>B;B++)g=i[B],E=g.x,$=g.y,g.x=F*E-e*$,g.y=e*E+F*$,l=R(l,g.x),P=v(P,g.x),N=R(N,g.y),Z=v(Z,g.y);var Y=V.getScale();V.setSize(w((P-l)/Y.x),w((Z-N)/Y.y));var z;Y.x<0&&(z=l,l=P,P=z),Y.y<0&&(z=N,N=Z,Z=z),F=G(o),e=A(o);var I=V.getAnchor();E=l+(P-l)*I.x,$=N+(Z-N)*I.y,V.setPosition(F*E-e*$,e*E+F*$),delete V._updatingFromChildren}}},setPosition:function(E,L){var m=this;if(!m._updatingToChildren){var K;K=2===arguments.length?{x:E,y:L}:E,yq||m._updatingFromChildren||(m._updatingToChildren=1,xk(m._children,K.x-m._position.x,K.y-m._position.y),delete m._updatingToChildren),hj.superClass.setPosition.call(this,K)}},setWidth:function(P){return this.setSize(P,this.getHeight())},setHeight:function(P){return this.setSize(this.getWidth(),P)},setSize:function(n,t){1>n&&(n=1),1>t&&(t=1);var v=this;if(!v._updatingToChildren){2!==arguments.length&&(t=n.height,n=n.width);var s=v.getWidth(),Z=v.getHeight();if(n!==s&&hj.superClass.setWidth.call(v,n),t!==Z&&hj.superClass.setHeight.call(v,t),!yq&&!v._updatingFromChildren){v._updatingToChildren=1;var F=n/s,T=t/Z;v._adjustChildScaleOrSize(F,T,"size"),delete v._updatingToChildren,v.updateFromChildren()}}},_adjustChildScaleOrSize:function(w,s,M){var p=this;if(p._syncSize){var x=p.getPosition(),j=p.getRotation();p.getScale(),p.eachChild(function(p){if(Lg(p)){var h=p.getPosition(),z=p.getRotation(),S=p.getWidth(),K=p.getHeight(),D=p.getScale(),E=D.x*S,c=D.y*K,T=new Gc(z,h.x,h.y,E,c);T.translate(-x.x,-x.y),T.rotate(-j),z=r(T.b*Math.sign(E),T.a*Math.sign(E)),T.scale(w,s);var O,o,X,e=G(z);if(Math.abs(e)<.001?(O=A(z),o=T.b/O,X=-T.c/O):(o=T.a/e,X=T.d/e),"scale"===M)p.setScale(o/S,X/K);else if("size"===M){var q=o/D.x,I=X/D.y;p.setScale(Dp(o)*Math.abs(D.x),Dp(X)*Math.abs(D.y)),p.setSize(Math.max(.1,Math.abs(q)),Math.max(.1,Math.abs(I)))}T.rotate(j),T.translate(x.x,x.y),p.setPosition(T.tx,T.ty)}})}},_calcChangeFactor:function(u,x,z,$){var f,O,t,M;return f=w(u),O=w(z),t=f>O?f/O:O/f,f=w(x),O=w($),M=f>O?f/O:O/f,v(t,M)},setAnchor:function(){var E=this;if(!E._updatingToChildren){var X=E.getAnchor();if(hj.superClass.setAnchor.apply(E,arguments),!yq&&!E._updatingFromChildren&&E._syncSize){E._updatingToChildren=1;var V=E.getAnchor();E.getPosition();var f=E.getSize(),L=E.getScale(),_=E.getRotation(),d=-f.width*L.x*(X.x-V.x),Z=-f.height*L.y*(X.y-V.y),r=A(_),g=G(_),R=g*d-r*Z,k=r*d+g*Z;E.eachChild(function(X){if(Lg(X)){var r=X.getPosition();X.setPosition(r.x-R,r.y-k)}}),delete E._updatingToChildren}}},setRotation:function(V){var A=this;if(!A._updatingToChildren){var B=A.getRotation();if(hj.superClass.setRotation.apply(A,arguments),!yq&&!A._updatingFromChildren){A._updatingToChildren=1;var C=A.getPosition(),x=V-B;A.eachChild(function(J){if(Lg(J)){var s=J.getMatrix();s.translate(-C.x,-C.y),s.rotate(x),s.translate(C.x,C.y);var T=Math.sign(J.getScale().x);J.setRotation(r(s.b*T,s.a*T)),J.setPosition(s.tx,s.ty)}}),delete A._updatingToChildren}}},setScale:function(Q,C){var W=this;if(!W._updatingToChildren){null==C&&(C=Q.y,Q=Q.x);var H=W.getScale();if(w(Q)<.01&&(Q=.01*(Dp(Q)||Dp(H.x))),w(C)<.01&&(C=.01*(Dp(C)||Dp(H.y))),hj.superClass.setScale.call(W,Q,C),!yq&&!W._updatingFromChildren){W._updatingToChildren=1;var G=Q/H.x,N=C/H.y;W._adjustChildScaleOrSize(G,N,"size"),delete W._updatingToChildren,W.updateFromChildren()}}},getSerializableProperties:function(){var W=hj.superClass.getSerializableProperties.call(this);return W.clickThroughEnabled=1,W.syncSize=1,W}});var Hk=o.Grid=function(){Ck(o.Grid,this)};_q("Grid",af,{IRotatable:!1,_icon:"grid_icon",_image:m,getUIClass:function(){return vo},setRotation:function(){},getCellRect:function(r,f){var o=this,I=o.s("grid.row.count"),F=o.s("grid.column.count");if(0>=I||0>=F||0>r||r>=I||0>f||f>=F)return m;var Y,S,y,R=o.getRect(),c=o.s("grid.row.percents"),n=o.s("grid.column.percents");if(jr(R,o,"grid.border",-1),c&&c._as&&(c=c._as),n&&n._as&&(n=n._as),c&&c.length===I){for(y=0,Y=0;r>Y;Y++)y+=R.height*c[Y];R.y+=y,R.height=R.height*c[r]}else R.height=R.height/I,R.y+=R.height*r;if(n&&n.length===F){for(S=0,Y=0;f>Y;Y++)S+=R.width*n[Y];R.x+=S,R.width=R.width*n[f]}else R.width=R.width/F,R.x+=R.width*f;return xb(R,-o.s("grid.gap")),R}});var Ce=o.Text=function(){Ck(Ce,this),this.setSize(100,50),this.s("text","TEXT")};_q("Text",af,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return uf},setWidth:function(d){d||(d=.001),Ce.superClass.setWidth.call(this,d)},setHeight:function(z){z||(z=.001),Ce.superClass.setHeight.call(this,z)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),lj("__text__",{width:{value:100,isSafeFunc:!0,func:function(v){return v._width}},height:{value:50,isSafeFunc:!0,func:function(o){return o._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var Jn=o.Shape=function(){Ck(Jn,this),this._59O=new Nf};Jn.__de__=Rm,_q("Shape",af,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Kc},_22Q:function(){return Rk},getLength:function(M){return Tl(Bp(this._59O,this._58O,M,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var G=this._58O;return G?new Nf(G._as.slice(0)):G},setSegments:function(R){var k=this._58O;R=R?sc(R)?new Nf(R.slice(0)):new Nf(R._as.slice(0)):null,(k&&R&&k._as.join(",")!==R._as.join(",")||k!==R)&&(this._58O=R,this.fp("segments",k,R))},getPoints:function(){return this._59O},toPoints:function(){var V=this._59O;return new Nf(V._as.slice(0))},setPoints:function(I,U){var e=this,Z=e._59O;I=I?sc(I)?new Nf(I.slice(0)):new Nf(I._as.slice(0)):new Nf;var D,S,q,p,X,w;U&&(D=e.getPosition(),w=new Gc(e.getRotation(),0,0,e.getScale().x,e.getScale().y)),(Z&&I&&Z._as.join(",")!==I._as.join(",")||Z!==I)&&(e._59O=I,e.fs(),e.fp("points",Z,I)),U&&(S=e.getPosition(),q=S.x-D.x,p=S.y-D.y,X=w.tf(q,p),e.setPosition(S.x-q+X.x,S.y-p+X.y))},addPoint:function(Q,E,j){var y=this.toPoints();y.add(Q,E),this.setPoints(y,j)},setPoint:function($,H,b){var U=this.toPoints();U.set($,H),this.setPoints(U,b)},removePointAt:function(J){var q=this.toPoints();q.removeAt(J),this.setPoints(q)},setWidth:function(L){var _=this;if(1>L&&(L=1),!_._55I&&!yq&&_.getWidth()){_._55I=1;var b=_._position.x,Q=L/_.getWidth(),h=_.toPoints(),I=new Nf;h.each(function(p){I.add({x:(p.x-b)*Q+b,y:p.y,e:p.e})}),_.setPoints(I);var u=_.s("shape.gradient.pack");u&&Ip(u,[Q,0,0,1,b*(1-Q),0]),_.fs(),delete _._55I}Jn.superClass.setWidth.call(_,L)},setHeight:function(m){var g=this;if(1>m&&(m=1),!g._55I&&!yq&&g.getHeight()){g._55I=1;var h=g._position.y,t=m/g.getHeight(),u=g.toPoints(),Q=new Nf;u.each(function(N){Q.add({x:N.x,y:(N.y-h)*t+h,e:N.e})}),g.setPoints(Q);var R=g.s("shape.gradient.pack");R&&Ip(R,[1,0,0,t,0,h*(1-t)]),g.fs(),delete g._55I}Jn.superClass.setHeight.call(g,m)},setAnchorElevation:function(j){var X=this;if(X._55I=!0,!yq){var K,q=j,O=X.getAnchorElevation(),r=X.getTall();K=r*(O-q),X.shiftPointsElevation(K)}Jn.superClass.setAnchorElevation.apply(X,arguments),delete X._55I},getShapeElevation:function(){var M=this,T=M._54O;return T-(M.getTall()||0)*(M._anchorElevation-.5)},setAnchor:function(s,G,m){var i=this;if(i._55I=!0,!yq){var D,z,T;"number"==typeof s?T={x:s,y:G}:(T=s.length?{x:s[0],y:s[1]}:s,m=G);var R=i.getAnchor(),f=i.getSize();D=f.width*(R.x-T.x),z=f.height*(R.y-T.y),m||i.shiftPoints(D,z);var K=i.getPosition()}if(Jn.superClass.setAnchor.apply(i,arguments),!yq){var d=i.getPosition();m&&i.shiftPoints(d.x-K.x+D,d.y-K.y+z)}delete i._55I},shiftPoints:function(W,D){var m=this,b=m.toPoints(),K=new Nf;b.each(function(R){K.add({x:R.x+W,y:R.y+D,e:R.e})}),m.setPoints(K),m.fs()},shiftPointsElevation:function(t){var I=this;I._59O.each(function(U){U.e==m?U.e=t:U.e+=t}),I.fs()},setPosition:function(b,$){var O,c=this;if(!c._28Q){if(c._28Q=1,!c._55I&&!yq){O=2===arguments.length?{x:b,y:$}:b;var C=O.x-c._position.x,Y=O.y-c._position.y;if(0===C&&0===Y)return delete c._28Q,void 0;c._55I=1,c.shiftPoints(C,Y);var U=c.s("shape.gradient.pack");U&&Ip(U,[1,0,0,1,C,Y]),delete c._55I}Jn.superClass.setPosition.apply(c,arguments),delete c._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var l=this;if(2!==l._59O.size())return!1;var i=l._58O;return i?2===i.size()&&1===i.get(0)&&2===i.get(1)?!0:!1:!0},fireShapeChange:function(){var v=this;if(!v._55I&&!yq){var e=Td(v._59O);e&&(v._55I=1,v.setRect(e),delete v._55I)}v.fp(Cb,!1,!0)},getSerializableProperties:function(){var M=Jn.superClass.getSerializableProperties.call(this);return M.segments=1,M.points=1,M.thickness=1,M.closePath=1,M}});var Wn=o.Polyline=function(){Ck(Wn,this),this.s({"shape.background":null,"shape.border.width":2})};_q("Polyline",Jn,{_icon:"polyline_icon",_22Q:function(){return ni},getUIClass:function(){return Sr},setClosePath:function(){},shiftPointsElevation:function(){var N=this;N._24Q||yq||(N._24Q=1,Wn.superClass.shiftPointsElevation.apply(N,arguments),delete N._24Q)},setTall:function(Q){var R=this;if(!R._24Q&&!yq&&R.getTall()){R._24Q=1;var U=R._54O,f=Q/R.getTall();R._59O.each(function(T){T.e=T.e==m?U:(T.e-U)*f+U}),R.fs(),delete R._24Q}Wn.superClass.setTall.call(R,Q)},setElevation:function(U){var E=this;if(!E._24Q&&!yq){E._24Q=1;var r=U-E._54O;E._59O.each(function(C){C.e==m?C.e=U:C.e+=r}),E.fs(),delete E._24Q}Wn.superClass.setElevation.apply(E,arguments)},fireShapeChange:function(){var n=this,r=n._59O;if(!n._24Q&&!yq){var E=r.size();if(E){var o=1,e=r.get(0),I=n._54O;e.e==m&&(e.e=I);for(var P=e.e,X=0;E>o;o++){e=r.get(o),e.e==m&&(e.e=I);var C=R(P,e.e),A=v(P+X,e.e);P=C,X=A-C}n._24Q=1,n.setTall(X),n.setElevation(P+X*n._anchorElevation),delete n._24Q}}Wn.superClass.fireShapeChange.apply(n,arguments)}});var eh=o.SubGraph=function(){Ck(eh,this)};_q("SubGraph",af,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){eh.superClass._8I.call(this),this.eachChild(function(B){Lg(B)&&B._8I()})}});var lg=o.RefGraph=function(){Ck(lg,this)};_q("RefGraph",hj,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(w){var p=this._ref;this._ref=w,this.fp("ref",p,w),this._pendingUpdateFromChidlren=!0,this.updateRef()},_21I:function(){lg.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var C=this;if(C.clearChildrenFromDataModel(),C._ref&&C._dataModel){C._xhrLoadHandler&&(C._xhrLoadHandler.cancel=!0);var T=yq,v=C._xhrLoadHandler=function(L){if(L&&C._dataModel){b.loadingRefGraph=!0;var c=C._pendingUpdateInfo={needToRestore:T};T&&(c.position=C.p(),c.width=C.getWidth(),c.height=C.getHeight(),c.rotation=C.getRotation(),c.anchor=C.getAnchor(),c.scale=C.getScale()),C.p(0,0),C.setAnchor(.5,.5),C.setRotation(0),C.setScale(1,1);var y=b.parse(L),V=C._dataModel.deserialize(y,C,{justDatas:!0});V.each(function(U){U._refGraph=C}),C.checkPendingUpdateInfo(),b.loadingRefGraph=!1,b.handleRefGraphLoaded(C,V,y)}};b.xhrLoad(C._ref,function(M){v.cancel||v(M)})}},checkPendingUpdateInfo:function(){var o=this,U=o._pendingUpdateInfo;if(!U)return o.onPendingUpdated&&o.onPendingUpdated(),void 0;var d=!0;this.eachChild(function(v){(v._pendingCheckImageJSON||v._pendingUpdateInfo)&&(d=!1)}),d&&(o._pendingUpdateInfo=null,o.updateFromChildren(),U.needToRestore&&(o.setSize(U.width,U.height),o.setAnchor(U.anchor),o.setRotation(U.rotation),o.setScale(U.scale),o.p(U.position)),this.getParent()instanceof lg&&this.getParent().checkPendingUpdateInfo(),o.onPendingUpdated&&o.onPendingUpdated())},getSerializableProperties:function(){var L=lg.superClass.getSerializableProperties.call(this);return L.ref=1,L}}),o.EdgeGroup=function(p,R){this._70O=p,this._siblings=R;for(var P,j,e=0,h=p.size(),q=_[sk];h>e;e++)if(P=p.get(e).getStyle(sk,!1),P!=m){q=P;break}q==m&&(q=!0);var f=b.edgeGroupAgentFunc;for(f&&(j=f(p),j&&j!==p.get(0)&&(p.remove(j),p.add(j,0))),e=0;h>e;e++)p.get(e).s(sk,q)},_q("EdgeGroup",u,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(v){return this._70O.get(v)},indexOf:function(Q){return this._70O.indexOf(Q)},each:function(N,n){this._70O.each(N,n)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(y,K){this._siblings.each(function($){$._70O.each(y,K)})}});var ms=function(r,L,B){var m=_c[r]={type:r,action:L};if(B)for(var U in B)m[U]=B[U]};ms("host",function(c,O){O&&c.setHost(O)},{"delete":{visible:function(q){return q.getHost()},action:function(Q){Q.setHost(null)}}}),ms("parent",function(E,X){X&&E.setParent(X)},{"delete":{visible:function(r){return r.getParent()},action:function(Z){Z.setParent(null)}}}),ms("copySize",function(P,I){if(I){var e=I.getSize();P.setSize(e)}}),ms("copyRotation",function(y,k){if(k){var S=k.getRotation();y.setRotation(S)}}),ms("edge",function(X,M){if(M){var i=new o.Edge(X,M);X.dm().add(i)}});var Hp="host";mm(b,{setConnectAction:ms,getConnectAction:function(E){return E=E||Hp,_c[E]},doConnectAction:function(Z,D,w){w=w||Hp;var j=_c[w];if(!j)return!1;var i=j.action;return i?(i.call(null,Z,D),!0):!1},doDeleteConnectionAction:function(m,F){F=F||Hp;var X=_c[F];if(!X||!X.delete)return!1;var G=X.delete.action;return G?(G.call(null,m),!0):!1},getCurrentConnectActionType:function(){return Hp},setCurrentConnectActionType:function(p){return _c[p]?(Hp=p,!0):!1}});var yo=o.JSONSerializer=function(O,L){this.dm=this._dataModel=O,this._hierarchical=b.forceHierarchicalSerialization?!0:L==m?O.isHierarchicalRendering():L};_q("JSONSerializer",u,{ms_ac:["hierarchical"],serialize:function(u){return b.stringify(this.toJSON(),u)},toJSON:function(){var D=this,l=D.dm,j=l.getRoots(),s=D.json={v:b.getVersion(),p:{},a:{},d:[]},T=l.getSerializableAttrs();l.getInit()&&(s.init=l.getInit()),l.getName()&&(s.p.name=l.getName()),l.getBackground()&&(s.p.background=l.getBackground()),l.getLayers()&&(s.p.layers=l.getLayers()),s.p.autoAdjustIndex=l.isAutoAdjustIndex(),s.p.hierarchicalRendering=l.isHierarchicalRendering();for(var z in T){var w=l.a(z);w!==Y&&D[Gl](z,w,s.a)}return Dk(s.a)&&delete s.a,D._hierarchical?j.each(D.serializeData,this):l.each(function(j){D.serializeData(j)}),s},isSerializable:function(){return!0},getProperties:function(x){return x.getSerializableProperties()},getStyles:function(y){return y.getSerializableStyles()},getAttrs:function(O){return O.getSerializableAttrs()},serializeData:function(Z){var G=this;if(G.isSerializable(Z)&&!Z._refGraph){var f,h,E,m,u=hp(Z.getClassName())||Z.getClass(),U=new u,e={c:Z.getClassName(),i:Z.getId(),p:{},s:{},a:{}};G.json.d.push(e),f=G.getProperties(Z);for(h in f)/^_/.test(h)?(E=Z[h],E!==U[h]&&G[Gl](h.substr(1),E,e.p)):(m=md(h),Z[m]&&(E=Z[m](),E!==U[m]()&&G[Gl](h,E,e.p)));f=G.getStyles(Z);for(h in f)E=Z.s(h),E!==U.s(h)&&G[Gl](h,E,e.s);f=G.getAttrs(Z);for(h in f)E=Z.a(h),E!==U.a(h)&&G[Gl](h,E,e.a);Dk(e.p)&&delete e.p,Dk(e.s)&&delete e.s,Dk(e.a)&&delete e.a}G._hierarchical&&Z.getChildren().each(G.serializeData,G)},serializeValue:function(j,d,G){tp(d)?d={__a:d._as}:d instanceof fc&&(d={__i:d.getId()}),G[j]=d},deserialize:function(P,U,B){var K=this,S=K.dm;S.beginTransaction(),yq=!0,B=tg(B)?{setId:B}:B||{},P=K.json=Mq(P)?b.parse(P):P,K._82I={};var E=new Nf,H=new Nf,d=0,p=P.d.length;if(B.justDatas||(fp(P.init)&&P.init(S),S.setInit(P.init)),!B.justDatas){for(var j in P.a)S.a(j,K[Mp](P.a[j]));for(var l in P.p)S[Oj(l)](P.p[l])}for(;p>d;d++){var g=P.d[d],R=hp(g.c),i=new R,X=g.i;B.setId&&X!=m&&(i._id=X),K._82I[X]=i,E.add(i),H.add(g)}for(d=0;p>d;d++)K.deserializeData(E.get(d),H.get(d));return E.each(function(E){U&&!E.getParent()&&E.setParent(U),S.add(E)}),yq=!1,S.endTransaction(),E},deserializeData:function(e,h){for(var G in h.p)e[Oj(G)](this[Mp](h.p[G]));for(G in h.s)e.s(G,this[Mp](h.s[G]));for(G in h.a)e.a(G,this[Mp](h.a[G]))},deserializeValue:function(Q){if(hk(Q)){var f=Q.__i;if(f!=m)return this._82I[f];if(f=Q.__a,sc(f))return new Nf(f)}return Q}}),mm(Bd,{serialize:function(y,F){return new yo(this,F).serialize(y)},toJSON:function(M){return new yo(this,M).toJSON()},deserialize:function(T,Y,$){return new yo(this).deserialize(T,Y,$)}}),mf.GraphView=function(V){var Y=this;Y._24I={},Y._34I=new Nf,Y._25I={},Y._56I={},Y._view=xf(1,Y),Y._canvas=dj(Y._view),Y.dm(V?V:new Bd),this._coreInteractor=new th(this),Y.setEditable(!1),Y.setScrollBarVisible(b.graphViewScrollBarVisible)},Rn("GraphView",u,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[bc,hs,yh,lp,"resettable","editInteractor",nl,"pannable","rectSelectable","autoScrollZone",fn,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:b.graphViewResettable,_pannable:b.graphViewPannable,_rectSelectable:b.graphViewRectSelectable,_autoScrollZone:b.graphViewAutoScrollZone,_rectSelectBackground:b.graphViewRectSelectBackground,_rectSelectBorderColor:b.graphViewRectSelectBorderColor,_editPointSize:b.graphViewEditPointSize,_editPointBorderColor:b.graphViewEditPointBorderColor,_editPointBackground:b.graphViewEditPointBackground,_scrollBarColor:Tg,_scrollBarSize:_n,_autoHideScrollBar:dq,_autoMakeVisible:ks,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(F){this._dataModel.setLayers(F)},setEditable:function(A){var t=this,d=t.__interactorMap__;if(!d){var R=mf.XEditInteractor;d=t.__interactorMap__={scrollBar:new Gb(t),select:new Sj(t),edit:R?new R(t):new cm(t),move:new Ep(t),"default":new Gh(t),touch:new Mf(t,{editable:!1})}}A?(t._uieditable=!0,t.setInteractors([d.scrollBar,d.select,d.edit,d.move,d.default,d.touch])):(t._uieditable=!1,t.setInteractors([d.scrollBar,d.select,d.move,d.default,d.touch]))},getCanvas:function(){return this._canvas},_33I:function(F){var S=F.getUIClass();return S?new S(this,F):m},getDataUI:function(r){var l=this,J=l._25I[r._id];return J===Y&&(J=l._33I(r),l._25I[r._id]=J),J},getNodeRect:function(C){return b.getNodeRect(this,C)},getEdgeInfo:function(r){var y=this.getDataUI(r);return y?(y._79o(),y._78o):null},getEdgeSourcePosition:function(M){var o=this,y=o.getDataUI(M),c=y.s,N=y._data._40I;return zf(o,N,c("edge.source.position"),c("edge.source.offset.x"),c("edge.source.offset.y"),c("edge.source.anchor.x"),c("edge.source.anchor.y"))},getEdgeTargetPosition:function(n){var _=this,h=_.getDataUI(n),c=h.s,O=h._data._41I;return zf(_,O,c("edge.target.position"),c("edge.target.offset.x"),c("edge.target.offset.y"),c("edge.target.anchor.x"),c("edge.target.anchor.y"))},invalidateAll:function(C){var u=this;if(C){for(var v in u._25I){var I=u._25I[v];I&&I.dispose()}u._25I={},u._56I={},u._24I={},u._34I.clear(),u.redraw()}else u.dm().each(function(f){u.invalidateData(f)})},invalidateSelection:function(){var O=this;O.sm().each(function(f){O.invalidateData(f)})},invalidateData:function(w){var l=this;l._24I[w._id]=w,l._21Q(w),l.iv()},_21Q:function(I){var m=this,N=m._24I;if(qr(I)&&ls[I.s(Yc)]){var u=I.getSourceAgent();u&&u.getAgentEdges().each(function(H){N[H._id]=H}),u=I.getTargetAgent(),u&&u.getAgentEdges().each(function(b){N[b._id]=b}),m.iv()}},redraw:function(c){var b=this;b._32I||(c?b._34I.add(c):(b._32I=1,b._34I.clear()),b.iv())},each:function(w,Y){var H,S,t,e=0,G=this.getLayers(),F=this._dataModel,$=F._datas._as,O=$.length;if(G){for(var E=G.length;E>e;e++)if(t=G[e],hk(t)&&(t=t.name),F.isHierarchicalRendering()){var k=function(n){return n._layer===t?Y?w.call(Y,n):w(n):void 0};if(this._dataModel.eachByHierarchical(k)===!1)return}else for(var f=0;O>f;f++)if(H=$[f],H._layer===t&&(S=Y?w.call(Y,H):w(H),S===!1))return}else if(F.isHierarchicalRendering())this._dataModel.eachByHierarchical(w,null,Y);else for(;O>e;e++)if(H=$[e],S=Y?w.call(Y,H):w(H),S===!1)return},reverseEach:function(S,l){var D,W,U,m,H=this._dataModel,$=H._layers,K=H._datas._as,o=K.length;if($){for(D=$.length-1;D>=0;D--)if(m=$[D],hk(m)&&(m=m.name),H.isHierarchicalRendering()){var M=function(s){return s._layer===m?l?S.call(l,s):S(s):void 0};if(H.reverseEachByHierarchical(M)===!1)return}else for(var x=o-1;x>=0;x--)if(W=K[x],W._layer===m&&(U=l?S.call(l,W):S(W),U===!1))return}else if(H.isHierarchicalRendering())H.reverseEachByHierarchical(S,null,l);else for(D=o-1;D>=0;D--)if(W=K[D],U=l?S.call(l,W):S(W),U===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var $=this,R=$._84I;if(!R){var O=this.dm().a("width"),h=this.dm().a("height");O>0&&h>0?$._84I={x:0,y:0,width:O,height:h}:($.each(function(K){$.isVisible(K)&&(R=_m(R,$.getDataUIBounds(K)))}),$._84I=R?R:Mh)}return $._84I},getScrollRect:function(){return _m(this.getContentRect(),this._29I)},makeCenter:function(U,B,p){var m=this;if(!m.getWidth()||!m.getHeight())return p||bf(m.centerData,m,[U,B,!0],500),void 0;m.makeVisible(U),m.validate();var a=m.getDataUIBounds(U);if(a){var W=m.getWidth(),N=m.getHeight(),I=a.x+a.width/2,k=a.y+a.height/2,K=-I*m._zoom+W/2,H=-k*m._zoom+N/2;m.setTranslate(K,H,B)}},fitData:function($,S,N,s,w){var Q=this;if(!Q.getWidth()||!Q.getHeight())return w||bf(Q.fitData,Q,[$,S,N,s,!0],500),void 0;var p=function(){Q.makeVisible($),Q.validate();var k=Q.getDataUIBounds($);k&&(k=Cf(k),xb(k,N==m?20:N),Q.fitRect(k,S,s))};S?b.callWhenLoaded(p):p()},fitContent:function(a,d,c,X){var s=this;if(!s.getWidth()||!s.getHeight())return X||bf(s.fitContent,s,[a,d,c,!0],500),void 0;var H=function(){s.validate();var R=Cf(s.getContentRect());xb(R,d==m?20:d),s.fitRect(R,a,c)};a?b.callWhenLoaded(H):H()},fitRect:function(i,l,k){var c=this,A=c.getWidth(),E=c.getHeight(),z=i.x+i.width/2,B=i.y+i.height/2,f=R(A/i.width,E/i.height),t=c._zoom,y=-z*t+A/2,G=-B*t+E/2;0===f||isNaN(f)||(k&&(f=R(1,f)),l?c.setTranslate(y,G,{finishFunc:function(){c.setZoom(f,l)}}):(c.setTranslate(y,G),c.setZoom(f)))},toCanvas:function(h,x){x=x||this._zoom,this.validateImpl();var L=this,R=L.getContentRect();R.width||(R.width=10),R.height||(R.height=10);var p=dj(),j=R.x*x,n=R.y*x,r=R.width*x,l=R.height*x;Xe(p,r,l,1);var S=xd(p);return h=h||this._dataModel.getBackground(),h&&Wm(S,0,0,r,l,h),Mi(S,-j,-n),S.scale(x,x),L._42(S),S.restore(),p},toDataURL:function(D,x,r){return this.toCanvas(D,r).toDataURL(x||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(q,p){var t,v,m=this;m._93db(q,p),m.each(function(X){m._56I[X._id]&&(t=m.getDataUI(X),t&&(v=t._79o(),o.HtmlNode&&X instanceof o.HtmlNode?t._42(q):(!p||Lb(p,v))&&t._42(q)))}),m._92db(q,p)},validateImpl:function(){var G,c,g,Z,I,Y=this,l=Y.tx(),p=Y.ty(),t=Y._zoom,z=Y._canvas,F=this.getWidth(),A=this.getHeight(),N=Y._29I,L={x:-l/t,y:-p/t,width:F/t,height:A/t},n={},h=Y._34I,B=Y._24I,D=Y._32I,r=Y._23I;
Y._24I={},(F!==z.clientWidth||A!==z.clientHeight)&&(Xe(z,F,A),D=1),D||Pe(L,N)||(D=1),Y._29I=L,Y.each(function(W){c=W._id;var Z=n[c]=Y.isVisible(W);Z!==Y._56I[c]&&(B[c]=W,g=Y.getDataUI(B[c]),g&&g._84o(Z),Y._84o(W,Z))},Y);for(c in B)g=Y.getDataUI(B[c]),g&&(!D&&Y._56I[c]&&(I=g._79o(),I&&h.add(I)),g.invalidate()),Y._83I=1;if(Y._56I=n,!D)for(c in B)n[c]&&(g=Y.getDataUI(B[c]),g&&(I=g._79o(),I&&h.add(I)));if(D?Z=L:(h.each(function(g){Lb(L,g)&&(Z=_m(Z,g))}),Z&&(xb(Z,v(1,1/t)),Z.x=f(Z.x*t)/t,Z.y=f(Z.y*t)/t,Z.width=J(Z.width*t)/t,Z.height=J(Z.height*t)/t,Z=Cd(L,Z))),Y._74O=Z,Z){G=xd(z);var _=Z.x,u=Z.y,o=Z.width,x=Z.height;_=Math.floor((_*t+l)*Cr),u=Math.floor((u*t+p)*Cr),o=Math.ceil(o*t*Cr)+1,x=Math.ceil(x*t*Cr)+1,G.beginPath(),G.rect(_,u,o,x),G.clip(),G.clearRect(_,u,o,x),ti(G,l,p,t),Y._42(G,Z),G.restore(),delete Y._74O}if(h.clear(),delete Y._32I,r&&F>0&&A>0){var g=Y.getDataUI(r);if(g){var I=g._79o(),R=Y._29I,b=R.x,P=R.y,j=R.width,K=R.height,t=Y._zoom;I&&!Lb(I,R)&&(I.x+I.width<b&&Y.tx(-I.x*t),I.x>b+j&&Y.tx(-(I.x+I.width-j)*t),I.y+I.height<P&&Y.ty(-I.y*t),I.y>P+K&&Y.ty(-(I.y+I.height-K)*t))}delete Y._23I}Y._83I&&(delete Y._83I,delete Y._84I),Y._98O(),Dk(Y._24I)||bf(Y.iv,Y)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(E){var M=this;E!==M.isScrollBarVisible()&&(E?(ts(M._view,M._79O=gd()),ts(M._79O,M._27I=gd()),ts(M._79O,M._28I=gd())):(bd(M._79O),delete M._79O,delete M._27I,delete M._28I),M.fp("scrollBarVisible",!E,E))},showScrollBar:function(){var n=this;n._79O&&(n._85I||(h(function(){n._86I()},Mk),n.iv()),n._85I=new Date)},_86I:function(){var T=this;if(T._85I){var Z=new Date,E=Z.getTime();E-T._85I.getTime()>=Mk?(delete T._85I,T.iv()):h(function(){T._86I()},Mk)}},_98O:function(){var l=this,F=this._27I,y=this._28I;if(l._79O){if(l._autoHideScrollBar&&!l._85I)return F.style.visibility=wr,y.style.visibility=wr,void 0;var d=l.getScrollBarColor(),h=l._zoom,R=l.getScrollBarSize(),w=l.getViewRect(),z=l.getScrollRect(),S=w.height*h,B=z.height*h,H=w.width*h-R-2,g=S*((w.y-z.y)*h/B),k=S*(S/B),b=F.style;B-.5>S?(Sn>k&&(g=g+k/2-Sn/2,0>g&&(g=0),g+Sn>S&&(g=S-Sn),k=Sn),Or(F,H,g,R,k),b.visibility=Bc,b.background=d,b.borderRadius=R/2+se):b.visibility=wr;var e=w.width*h,q=z.width*h,g=w.height*h-R-2,H=e*((w.x-z.x)*h/q),f=e*(e/q),b=y.style;q-.5>e?(Sn>f&&(H=H+f/2-Sn/2,0>H&&(H=0),H+Sn>e&&(H=e-Sn),f=Sn),Or(y,H,g,f,R),b.visibility=Bc,b.background=d,b.borderRadius=R/2+se):b.visibility=wr}},setDataModel:function(F){var Y=this,O=Y._dataModel,o=Y._selectionModel;O!==F&&(O&&(O.ump(Y.handleDataModelPropertyChange,Y),O.umm(Y.handleDataModelChange,Y),O.umd(Y.handleDataPropertyChange,Y),O.removeIndexChangeListener(Y._75O,Y),O.removeHierarchyChangeListener(Y.handleHierarchyChange,Y),o||O.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=F,F.mp(Y.handleDataModelPropertyChange,Y),F.mm(Y.handleDataModelChange,Y),F.md(Y.handleDataPropertyChange,Y),F.addIndexChangeListener(Y._75O,Y),F.addHierarchyChangeListener(Y.handleHierarchyChange,Y),o?o._21I(F):F.sm().ms(Y.handleSelectionChange,Y),Y.invalidateAll(!0),Y.fp(lq,O,F),Y._canvas.style.background=F.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===Y){var _=this.getLayers();_?(this._layersInfo={},_.forEach(function(X){var D=hk(X)?X.name:X;this._layersInfo[D]=X},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=Y,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(X){if("background"===X.property){var S=this._canvas.style.background,F=X.newValue||"";this._canvas.style.background=F,this.fp("canvasBackground",S,F)}else"a:width"===X.property||"a:height"===X.property?(this._83I=1,this.redraw()):"layers"===X.property?this.updateLayers():"hierarchicalRendering"===X.property&&this.redraw()},handleDataPropertyChange:function(w){this.dm().isHierarchicalRendering()&&"parent"===w.property&&w.data.hasChildren()&&this.redraw(),this.invalidateData(w.data)},onPropertyChanged:function(M){var v=this,i=M.property;if(v.redraw(),"zoom"===i){var I=v.sm().getSelection();I.size()&&I.each(function(l){l.invalidate()})}Zf[i]?v.showScrollBar():i===nl&&v.onCurrentSubGraphChanged(M)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(q){var T=this,E=q.kind,g=q.data;if(T._83I=1,"add"===E)T.invalidateData(g),qr(g)&&g.getEdgeGroup()&&g.getEdgeGroup().eachSiblingEdge(T.invalidateData,T);else if(E===Ze){T._21Q(g);var W=g._id,u=T._25I[W];if(u){if(T._56I[W]){var f=u._79o();f&&T.redraw(f)}u.dispose(),delete T._25I[W],delete T._24I[W],delete T._56I[W]}g===T._currentSubGraph&&T.setCurrentSubGraph(m)}else E===nf&&(T.invalidateAll(!0),T.setCurrentSubGraph(m))},_75O:function(Z){this.invalidateData(Z.data)},handleHierarchyChange:function(E){this.dm().isHierarchicalRendering()&&E.data.hasChildren()&&this.redraw(),this.invalidateData(E.data)},adjustIndex:function(j){var K=this;if(K.isVisible(j)){K.dm().beginTransaction();for(var z=j;z._parent&&K.isVisible(z._parent);)z=z._parent;z&&z!==j&&K._dataModel.adjustIndex(z),K._dataModel.adjustIndex(j),K.dm().endTransaction()}},getImage:function(O){return O.getImage()},getSelectWidth:function(z){return z.s("select.width")},isSelectable:function(r){if(!this._clickThroughChecking&&r.getParent()instanceof hj&&r.getParent().isSyncSize())return!1;var s=this.getLayersInfo();if(s){var f=s[r._layer];if(f&&f.selectable===!1)return!1}return r.s("2d.selectable")&&this.sm().isSelectable(r)},isMovable:function(J){var D=this;if(qr(J)&&J.getStyle(Yc)!==_l)return!1;var l=this.getLayersInfo();if(l){var M=l[J._layer];if(M&&M.movable===!1)return!1}return J.s("2d.movable")?D._movableFunc?D._movableFunc(J):!0:!1},isEditable:function(A){var a=this;if(o._uiSerializing)return a._uieditable;if(!a._editInteractor||!a.isSelected(A))return!1;if(Dn(A)){var W=a.getDataUI(A);if(!W||W._88I)return!1}if(qr(A)&&A.getStyle(Yc)!==_l)return!1;var m=this.getLayersInfo();if(m){var s=m[A._layer];if(s&&s.editable===!1)return!1}return A.s("2d.editable")?a._editableFunc?a._editableFunc(A):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(e){return Lg(e)&&0!==e.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(e):!0},isRectEditable:function(r){return this._rectEditableFunc?this._rectEditableFunc(r):!0},isAnchorEditable:function(i){return this._anchorEditableFunc?this._anchorEditableFunc(i):!0},isRotationEditable:function(u){return u.setRotation&&u.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(u):!0:!1},getRotationPoint:function(M){var s=M.getAnchor(),Y=M.getScale(),c=this._zoom,z=Zn(M.getRotation(),0,-M.getHeight()*Y.y*s.y-(Y.y<0?-1:1)*(L?32:16)/c),$=M.p();return z.x+=$.x,z.y+=$.y,z},getLogicalPoint:function(p){var O=this;return Pq(p,O._canvas,O.tx(),O.ty(),O._zoom,O._zoom)},getSelectedDataAt:function(R){var W=this;return this.getDataAt(R,function(t){return W.isSelected(t)})},getDataInfoAt:function(K,n,z){var V,O=this.lp(K),U=this.getDataAt(O,n,z);if(U){var Z=this.getDataUI(U);V={data:U,ui:Z};var e=Z._38o;if(e){var f=e.icons;for(var B in f){var q=f[B],g=e.rects[B];if(g)for(var G=Nd(q.names,U,this),k=G?G.length:0,F=g.rotation,A=0;k>A;A++){var N=G[A],l=g[A];if(qf(l,O,F))return V.part="icons",V.icon=N,V.rect=l,V.index=A,V.rotation=F,V}}}if(this.isNoteVisible(U)){if(Z.note2Info&&qf(Z.note2Info.clickRect,O,m,Z.note2Info.scale))return V.part="note2",V;if(Z.noteInfo&&qf(Z.noteInfo.clickRect,O,m,Z.noteInfo.scale))return V.part="note",V}if(this.isLabelVisible(U)){if(Z.label2Info&&qf(Z.label2Info.rect,O,Z.label2Info.rotation,Z.label2Info.scale))return V.part="label2",V;if(Z.labelInfo&&qf(Z.labelInfo.rect,O,Z.labelInfo.rotation,Z.labelInfo.scale))return V.part="label",V}if(U.isInRect&&U.isInRect(O))return V.part="rect",V}return V},getDataAt:function(L,h,m){L.target&&(L=this.lp(L));var l,r=this._zoom;return this.reverseEach(function(O){return(h?h(O):this.isSelectable(O))&&this.rectIntersects(O,Bl(L.x,L.y,m,r))?(l=O,!1):void 0},this),l},getIconInfoAt:function(X,$){var T=this;if(X.target&&(X=T.lp(X)),$||($=T.getDataAt(X)),$){var V=T.getDataUI($);if(V&&V._38o){var B,w=V._38o,W=new Nf;for(B in w.icons)W.add(B);for(var q=W.size()-1;q>=0;q--){B=W.get(q);for(var Y=w.rects[B],e=Y.rotation,v=Y.length-1;v>=0;v--){var M=Y[v],b=M.width,d=M.height,n={x:X.x-M.x-b/2,y:X.y-M.y-d/2};e!=m&&(n=Zn(-e,n.x,n.y));var M={x:-b/2,y:-d/2,width:b,height:d};if(qf(M,n))return{key:B,index:v,name:w.icons[B].names[v],rect:Y[v],point:X,rotation:e,relativeRect:M,relativePoint:n,data:$}}}}}return m},getDatasInRect:function(O,W,I){I===Y&&(I=1);var F=this,f=new Nf;return F.reverseEach(function(b){I&&!F.isSelectable(b)||(W?F.rectIntersects(b,O):F.rectContains(b,O))&&f.add(b)}),f},moveSelection:function(N,T){var u=this;u.dm().beginTransaction(),xk(u.sm().toSelection(u.isMovable,u),N,T),u.dm().endTransaction()},moveDatas:function(p,v,N){var D=this;D.dm().beginTransaction(),p instanceof Nf||(p=new Nf(p)),xk(p,v,N),D.dm().endTransaction()},getDataUIBounds:function(E){var Y=this.getDataUI(E);return Y?Y._79o():m},drawData:function(C,v){var m=this.getDataUI(v);m&&(m._79o(),m._42(C)),v instanceof o.Block&&v.eachChild(function(M){this.drawData(C,M)},this)},getBoundsForGroup:function(x){return x.s(Sk)?this.getDataUIBounds(x):m},rectIntersects:function(I,G){this.validate();var o=m;if(this._56I[I._id]){var u=this._25I[I._id];if(u){var v=u._79o();if(lo(G,v))o=!0;else if((G=Cd(G,v))&&(u.rectIntersects&&(o=u.rectIntersects(G)),o==m)){if(!I.s("pixelPerfect"))return!0;var K=G.x,l=G.y,p=G.width,h=G.height,Y=this._zoom,e=b.hitMaxArea,B=p*h*Y*Y;if(B>e){var M=Math.sqrt(e/B);Y*=M}p*=Y,h*=Y,2>p&&(p=2),2>h&&(h=2),K*=Y,l*=Y;var q=Cc(p,h);Mi(q,-K,-l),q.scale(Y,Y),this._drawForChecking=!0,this.drawData(q,I),this._drawForChecking=!1;try{for(var R=0,_=q.getImageData(0,0,p,h).data;R<_.length;R+=4)if(0!==_[R+3]){o=!0;break}q.restore()}catch(s){ao=m,o=!1}}}}return o?!0:!1},rectContains:function(I,K){if(this._56I[I._id]){var P=this._25I[I._id];if(P)return lo(K,P._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(H){if(!b.isInput(H.target)){var j=this,S=j._focusData,u=S&&j._25I[S._id],x=0,A=j._dataModel._datas;if(!(S&&S._enabled&&S._editable&&u&&u.onKeyDown&&u.onKeyDown(H)===!0))if(9===H.keyCode&&(S&&(x=A.indexOf(S),gg(H)?-1===--x&&(x=0):++x===A.size()&&(x=0)),j._focusData=S=A.get(x),j.sm().setSelection(S)),ff(H)?j.selectAll():gh(H)&&j.isResettable()&&j.reset(),j.sm().isEmpty()){if(j._editing)return;var E=j.tx(),f=j.ty(),D=!1,N=gg()?100:10;pq(H)&&(E-=N,D=!0),Zj(H)&&(f-=N,D=!0),Sf(H)&&(E+=N,D=!0),Pp(H)&&(f+=N,D=!0),D&&j.setTranslate(E,f)}else{Cp(H)&&j.handleDelete(H);var Q=gg()?10:1;pq(H)&&(j.moveSelection(-Q,0),j.fi({kind:"moveLeft"})),Zj(H)&&(j.moveSelection(0,-Q),j.fi({kind:"moveUp"})),Sf(H)&&(j.moveSelection(Q,0),j.fi({kind:"moveRight"})),Pp(H)&&(j.moveSelection(0,Q),j.fi({kind:"moveDown"}))}}},handleScroll:function(E,r){db(E);var $=this.lp(E);r>0?this.scrollZoomIn($):0>r&&this.scrollZoomOut($)},handlePinch:function(J,P,K){this._68I||(P>K?this.pinchZoomIn(J):this.pinchZoomOut(J))},checkDoubleClickOnNote:function(H,t){var _=this,X=_.lp(H),l=_.getDataUI(t),Z=l.note2Info;return Z&&t.s("note2.toggleable")&&qf(Z.clickRect,X)?(t.s(Ik,!t.s(Ik)),_.fi({kind:"toggleNote2",event:H,data:t}),!0):(Z=l.noteInfo,Z&&t.s("note.toggleable")&&qf(Z.clickRect,X)?(t.s(df,!t.s(df)),_.fi({kind:"toggleNote",event:H,data:t}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(Q,I){var g=this,p=g.getAutoScrollZone(),n=p/g.getZoom(),c=p/4,O=g._29I,L=g.lp(Q),U={x:g.tx(),y:g.ty()};return L&&p>0&&O&&(L.x-O.x<n?g.translate(c,0):O.x+O.width-L.x<n&&g.translate(-c,0),L.y-O.y<n?g.translate(0,c):O.y+O.height-L.y<n&&g.translate(0,-c)),U.x=g.tx()-U.x,U.y=g.ty()-U.y,I&&(I.x+=U.x,I.y+=U.y),U},getMoveMode:function(r,C){var t=C.s("2d.move.mode");return t?t:wd["88"]?"x":wd["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(G,o,P){var Y=this;return"currentSubGraph"===o?{__i:G.getId()}:P.serializeProperty(G,o,Y)},deserializeProperty:function(f,F,C){var K=this;if("currentSubGraph"===F){var h=K.dm(),$=h.__idMap;return $[f.__i]}return C.deserializeProperty(f,F,K)},setDefaultCursor:function(c,J){this._defaultCursor=c,J!==!1&&this.setCursor(c)},setCursor:function(j){"default"===j&&(j=this._defaultCursor||j);var N=this.getView().style;N.cursor=j,N.cursor="-webkit-"+j,N.cursor="-moz-"+j}});var Wd=function(c,S){var h=this;h.gv=c,h.s=function(O){return S.getStyle(O)},h._data=S,h._87I=new Nf};Uo(Wd,u,{_6I:m,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var q=this,P=q.gv.isSelected(q._data);return!P||q.isShadowed()?0:q.gv.getSelectWidth(q._data)},getBodyColor:function(X){var f=this._data,S=this.gv.getBodyColor(f);return S?S:X?f.getStyle(X):m},_2Q:function(i){return this.s(i)},_1Q:function(x,J,L,B){var _=this.s,K=_(J+".dash.color");x.strokeStyle=K,x.lineWidth=L,x.stroke(),_(J+".dash.3d")&&Gi(x,K,_(J+".dash.3d.color"),L,this.gv._zoom,_(J+".dash.3d.accuracy")),Cg(x,B)},invalidate:function(){this._6I=m},_79o:function(){var l=this;if(!l._6I){l.labelInfo=l.label2Info=l.noteInfo=l.note2Info=l._38o=m,l._87I.clear(),l._3O();var v=l._data,p=l.gv;l._55O=p.isEditable(v)?{_42O:p.isRectEditable(v),_43O:p.isPointEditable(v),_56O:p.isRotationEditable(v)}:m,l._6I=l._81o()}return l._6I},_3O:function(){},getPosition:function(){return Mh},_68o:function(H,g){H&&this._87I.add(tf(H,g))},_81o:function(){var M=this,y=M.s;M._24O(yr,"getLabel"),M._24O(id,"getLabel2"),M._26O(ne,"getNote"),M._26O(Hh,"getNote2"),M._15O(),M._55O&&M._48O();var m;if(M._87I.each(function(H){m=_m(m,H)}),m&&M.isShadowed()){var w=Cf(m);w.x+=y("shadow.offset.x"),w.y+=y("shadow.offset.y"),xb(w,y("shadow.blur")),m=_m(m,w)}return M._87I.clear(),m},_42:function(q){var d=this,F=d._data,J=d.gv,c=d.s,E=c("opacity"),h=this.isShadowed();if(h){var I=q.shadowOffsetX,j=q.shadowOffsetY,s=q.shadowBlur,k=q.shadowColor,K=J.getZoom();q.shadowOffsetX=c("shadow.offset.x")*K,q.shadowOffsetY=c("shadow.offset.y")*K,q.shadowBlur=c("shadow.blur")*K,q.shadowColor=c("select.color")}if(E!=m){var n=q.globalAlpha;q.globalAlpha=E}d._80o(q),J.isLabelVisible(F)&&((!J._drawForChecking||c("label.selectable"))&&ul(q,d.labelInfo),(!J._drawForChecking||c("label2.selectable"))&&ul(q,d.label2Info)),J.isNoteVisible(F)&&(ed(q,d.noteInfo),ed(q,d.note2Info)),d._99O(q),E!=m&&(q.globalAlpha=n),h&&(q.shadowOffsetX=I,q.shadowOffsetY=j,q.shadowBlur=s,q.shadowColor=k)},_80o:function(){},_47O:function(){},_24O:function(i,D){var u=this,y=u._data,U=u.gv,K=u.s,O=U[D](y);if(O!=m){var L=K(i+".scale"),b=K(i+".max"),I=K(i+".position"),l=u[i+"Info"]={label:O,scale:L,color:U[D+"Color"](y),font:K(i+".font"),opacity:K(i+".opacity"),align:K(i+".align"),rotation:u.getRotation(K(i+".rotation"),!1,I),background:U[D+"Background"](y)},G=eg(l,O);b>0&&b<G.width&&(l.labelWidth=G.width,G.width=b),1!==L&&(G.width*=L,G.height*=L);var A=u.getPosition(I,K(i+".offset.x"),K(i+".offset.y"),G,K(i+".position.fixed"));if(G.x=A.x-G.width/2,G.y=A.y-G.height/2,u._68o(l.rect=G,l.rotation),1!==L){var c=G.width/L,t=G.height/L;l.rect={x:A.x-c/2,y:A.y-t/2,width:c,height:t}}}},_26O:function(E,g){var j=this,U=j.gv,h=j._data,R=j.s,O=U[g](h);if(O!=m){var T,D,x=R(E+".scale"),o=j[E+"Info"]={note:O,scale:x,data:h,view:U,expanded:R(E+".expanded"),font:R(E+".font"),color:R(E+".color"),opacity:R(E+".opacity"),align:R(E+".align"),icon:R(E+".icon"),backgroundImage:R(E+".backgroundImage"),borderWidth:R(E+".border.width"),borderColor:R(E+".border.color"),background:U[g+"Background"](h)},n=j.getPosition(R(E+".position"),R(E+".offset.x"),R(E+".offset.y")),P=n.x,I=n.y;if(o.expanded){var H,Q=R(E+".max"),f=R(E+".backgroundImage");f?(f=Se(f),H={width:Jb(f,h),height:vr(f,h)}):H=eg(o,O),H.width+=6,H.height+=2,Q>0&&Q<H.width&&(o.labelWidth=H.width,H.width=Q),T=H.width,D=H.height+8,o.clickRect={x:P-T*x/2,y:I-D*x,width:T*x,height:D*x*H.height/D}}else{var X=R(E+".icon");X?(X=Se(X),T=Jb(X,h),D=vr(X,h)):(T=12,D=18),o.clickRect={x:P-T*x/2,y:I-D*x,width:T*x,height:D*x}}o.rect={x:P-T/2,y:I-D*x/2-D/2,width:T,height:D};var K=J(o.borderWidth/2)*x;j._68o({x:P-T*x/2-K,y:I-D*x-K,width:T*x+2*K,height:D*x+2*K})}},_48O:function(){},_99O:function(o){var N=this,G=N._38o;if(G){var h=N.gv,e=N._data,w=G.icons;for(var q in w){var y=w[q],u=G.rects[q];if(u){var P=Nd(y.opacity,e,h),H=Nd(y.names,e,h),_=H?H.length:0,M=u.rotation;if(P!=m){var c=o.globalAlpha;o.globalAlpha*=P}for(var Q=0;_>Q;Q++){var C=H[Q],Y=Se(C),j=u[Q];if(M){var l=j.x+j.width/2,T=j.y+j.height/2;o.save(),Mi(o,l,T),zg(o,M),Mi(o,-l,-T)}Mc(o,Y,Nd(y.stretch,e,h),j.x,j.y,j.width,j.height,N._data,N.gv),M&&o.restore()}P!=m&&(o.globalAlpha=c)}}}}});var br=function(i,C){Ck(br,this,[i,C])};Uo(br,Wd,{_checkEmptyRect:!0,_40O:function(n,k){var X=this,s=X.s,e=n.rect;(n.borderColor=X.gv.getBorderColor(X._data))&&(n.borderType=s("border.type"),n.borderWidth=s("border.width"),n.borderPadding=s("border.padding"),k=v(k,n.borderPadding+n.borderWidth/2));var S=X._data.getScale(),W=v(1,v(w(S.x),w(S.y)));if(n.selectWidth=X.getSelectWidth()){var E=X.gv._zoom;n.selectType=s("select.type"),n._97o=s("select.color"),n.selectPadding=s("select.padding"),k=v(k,(n.selectPadding+n.selectWidth/2/E)/W)}k>0&&(k*=W,e=Cf(e),xb(e,k)),X._68o(e)},_39O:function(X,w){var E,u=this,H=w.rect;if(w.borderWidth>0&&(E=w.borderPadding,X.strokeStyle=w.borderColor,X.lineWidth=w.borderWidth,gn(X,w.borderType,{x:H.x-E,y:H.y-E,width:H.width+2*E,height:H.height+2*E}),X.stroke()),w.selectWidth>0){var Y=u.gv._zoom;if(E=w.selectPadding,X.strokeStyle=w._97o,X.lineWidth=w.selectWidth/Y,w.rotation!=m){X.save(),X.translate(w.position.x,w.position.y),X.rotate(w.rotation);var c=u._data,S=c.getWidth(),e=c.getHeight(),p=w.scale,a=w.anchor;H={x:p.x*-S*a.x,y:p.y*-e*a.y,width:p.x*S,height:p.y*e}}gn(X,w.selectType,{x:H.x-E,y:H.y-E,width:H.width+2*E,height:H.height+2*E}),w.rotation!=m&&X.restore(),X.stroke()}},_3O:function(){var f=this,T=f.s,U=f._data,H=U.getStyle(Cb),A=f.getBodyColor(),p=f._83o=H?{shape:H,_53o:f.getBodyColor("shape.background"),_27Q:Se(T("shape.repeat.image"),A),shapeGradientPack:T("shape.gradient.pack"),_54o:T("shape.border.width"),_55o:T("shape.border.color"),_56o:T("shape.border.3d"),_57o:T("shape.border.3d.color"),_58o:T("shape.border.3d.accuracy"),shapeGradient:T("shape.gradient"),_59o:T("shape.gradient.color"),_60o:T("shape.border.pattern"),_61o:T("shape.border.cap"),_62o:T("shape.border.join"),bodyColor:A}:{img:Se(f.gv.getImage(U),A),bodyColor:A,stretch:T("image.stretch")};if(B&&!O);else{p.rect=U.getRect(),p.position=U.p(),p.scale=U.getScale(),p.anchor=U.getAnchor(),p.rotation=U.getRotation(),H===fj&&(p._63o=T("shape.depth"));var g=0;if(H)g=zc(m,p._54o/2,p._62o),f.s("shape.dash")&&(g=v(g,(f.s("shape.dash.width")||p._54o)/2));else if(p.img&&p.img.boundExtend)if(g=Nd(p.img.boundExtend,U,f.gv),p.img.boundExtendAbsolute){var i=U.getScale();g/=f.gv._zoom*v(1,v(w(i.x),w(i.y)))}else if(!Nd(p.img.fitSize,U,f.gv)){var e=Nd(p.img.width,U,f.gv),V=Nd(p.img.height,U,f.gv);g*=v(U.getWidth()/e,U.getHeight()/V)}f._40O(p,g);var I=T("clip.percentage");if(1>I&&(0>I&&(I=0),p.clipRect=Ro(U.getAnchorRect(),T("clip.direction"),I)),H){var c=T("shape.fill.clip.percentage");1>c&&(0>c&&(c=0),p.shapeClipRect=Ro(U.getAnchorRect(),T("shape.fill.clip.direction"),c))}}},getPosition:function(v,j,M,S){var i=wq(v,this._83o.rect,S);return i.x+=j,i.y+=M,i},_80o:function(O){var G=this,h=G.s,S=G.gv,$=G._data,W=G._83o,s=W.rect,g=W.position,Y=W.rotation,t=W.anchor,c=W.scale,w=W.shape,i=W.clipRect;if(!G._checkEmptyRect||s.width>0&&s.height>0){var K=$.getSize();if(K.x=-K.width*t.x,K.y=-K.height*t.y,O.save(),Mi(O,g.x,g.y),zg(O,Y),uo(O,c.x,c.y),i&&(O.beginPath(),O.rect(i.x,i.y,i.width,i.height),O.clip()),G.freeDraw)G.freeDraw(O,K,W);else if(w){var T,J,C,y,b=W._60o,e=kk(O,b),p=W._53o,R=W._27Q,D=W._54o,m=W._55o,M=W.shapeGradientPack,u=O.lineJoin,k=O.lineCap;if("roundRect"===w?T=h("shape.corner.radius"):"polygon"===w?T=h("shape.polygon.side"):"arc"===w&&(T=h("shape.arc.from"),J=h("shape.arc.to"),C=h("shape.arc.close"),y=h("shape.arc.oval")),O.lineJoin=W._62o,O.lineCap=W._61o,p||R||M){var n=W.shapeClipRect;n&&(O.save(),O.beginPath(),O.rect(n.x,n.y,n.width,n.height),O.clip()),gn(O,w,K,T,J,C,y),M?on(O,M):R?Cm(O,R,W.bodyColor,null,$,S):ee(O,p,W.shapeGradient,W._59o,K),O.fill(),n&&O.restore(),M&&O.restore(),O!==e&&gn(e,w,K,T,J,C,y)}else gn(e,w,K,T,J,C,y);if(D>0){var q=h("shape.border.width.absolute");q&&(O.save(),O.setTransform(1,0,0,1,0,0)),O.lineWidth=D,O.strokeStyle=m,O.stroke(),q&&O.restore(),W._56o&&Gi(O,m,W._57o,D,S._zoom,W._58o)}if(Cg(O,b),h("shape.dash")){var z=h("shape.dash.width")||D;if(z>0){b=h("shape.dash.pattern");var e=kk(O,b,G._2Q("shape.dash.offset"));e!==O&&gn(e,w,K,T,J,C,y),G._1Q(O,"shape",z,b)}}sr(O,p,W._63o,K),O.lineJoin=u,O.lineCap=k}else Mc(O,W.img,W.stretch,K.x,K.y,K.width,K.height,$,S,W.bodyColor);O.restore()}G._39O(O,W)},_48O:function(){},_47O:function(){}});var Vi=function(X,r){Ck(Vi,this,[X,r])},rf=function($,X,_,b){var L=fr($,X);return _=b?R(_,L):pk(_,L),L?_/=L:_=0,{x:$.x+(X.x-$.x)*_,y:$.y+(X.y-$.y)*_}};Uo(Vi,Wd,{_3O:function(){var Q,X=this,I=X._data,z=X.gv,R=X.s,p=R(Yc),F=I.isLooped(),g=R("edge.width"),f=R("edge.center"),E=R("edge.offset"),$=z.getBorderColor(I),O=$?R("border.width"):0,H=X.getSelectWidth(),q=I._40I,c=I._41I,P=X._78o=q&&c?{looped:F,type:p,width:g,center:f,color:X.getBodyColor("edge.color"),borderColor:$,borderWidth:O,_97o:H?R("select.color"):m,selectWidth:H,pattern:R("edge.pattern"),cap:R("edge.cap"),join:R("edge.join"),is3d:R("edge.3d"),_67o:R("edge.3d.color"),_66o:R("edge.3d.accuracy")}:m;if(P){var u=b.getEdgeType(p);if(u){var n=u(I,Gd(X,z,I,F,p),z,X._19Q);n.points&&n.points.size()>1?(P._4O=n,Q=Td(P._4O.points)):n[hg]&&n.rect&&(P._4O=n,Q=n.rect)}else{var e=R("edge.source.anchor.x"),B=R("edge.source.anchor.y"),G=R("edge.target.anchor.x"),l=R("edge.target.anchor.y"),t=zf(z,q,R("edge.source.position"),R("edge.source.offset.x"),R("edge.source.offset.y"),e,B),U=zf(z,c,R("edge.target.position"),R("edge.target.offset.x"),R("edge.target.offset.y"),G,l);if(p===_l){var k=P.points=R(Sc)||De,Z=k.size();P.segments=R("edge.segments");var s=e!==Y||B!==Y,_=G!==Y||l!==Y;if(!f)if(E)s||(t=rf(t,Z?k.get(0):U,E,Z)),_||(U=rf(U,Z?k.get(Z-1):t,E,Z));else{var J;s||(J=Wc(t,Z?k.get(0):U,Lq(z,q)),J&&(t={x:J[0],y:J[1]})),_||(J=Wc(Z?k.get(Z-1):t,U,Lq(z,c)),J&&(U={x:J[0],y:J[1]}))}Q=_m(Td(P.points),Td(t,U))}else{var d=Gd(X,z,I,F,p);if(X._19Q||(d=-d),F)t=Cf(t),t.x=z.getNodeRect(q).x,P.radius=d,Q={x:t.x-d,y:t.y-d,width:2*d,height:2*d};else{var C=fr(t,U),T=pk(E,C),M={x:T,y:d},w={x:C-T,y:d},D=r(U.y-t.y,U.x-t.x),y=P.mat=new Gc(D);if(P.orienAngle=D,P.angle=U.x<t.x?D+j:D,P.rect={x:M.x,y:M.y,width:w.x-M.x,height:0},P.origin=t,M=y.tf(M),M.x+=t.x,M.y+=t.y,w=y.tf(w),w.x+=t.x,w.y+=t.y,f){var A={x:C,y:0};A=y.tf(A),A.x+=t.x,A.y+=t.y,Q=Td([t,M,w,A]),P.c1=t,P.c2=A}else Q=Td(M,w);t=M,U=w}}P.sourcePoint=t,P.targetPoint=U,I._lastSourcePoint=t,I._lastTargetPoint=U}var V=0;R("edge.dash")&&(V=R("edge.dash.width")||g);var S="square"===P.cap?.71:.5;zc(Q,v(V*S,g*S+O+H),P.join),X._68o(Q)}},getRotation:function(H,j,z){H=H||0;var O=this._78o;if(O){var y,r=O.angle,W=O.points,D=O._4O;if(r!=m)return j?O.orienAngle+H:r+H;if(D&&D[hg])return D.getRotation?D.getRotation(this,H,j,z):0;if(D&&D.points){var v=D.points;return y=v.size(),Sb[z]?y&&0===y%2?oo(v.get(y/2-1),v.get(y/2),j,H):H:_k[z]?oo(v.get(0),v.get(1),j,H):oo(v.get(y-2),v.get(y-1),j,H)}if(W)return y=W.size(),Sb[z]?y&&0===y%2?oo(W.get(y/2-1),W.get(y/2),j,H):H:_k[z]?oo(O.sourcePoint,y?W.get(0):O.targetPoint,j,H):oo(y?W.get(y-1):O.sourcePoint,O.targetPoint,j,H)}return H},getPosition:function(u,E,G,h,n){var M=this._78o;if(M){var H,C=M.type,p=M.points,V=M._4O,v=M.sourcePoint,l=M.targetPoint;if(!C)return M.looped?{x:v.x-M.radius+E,y:v.y+G}:(n&&v&&l&&(v.x>l.x||v.x===l.x&&v.y>l.y)&&(u=kg[u],G=-G),H=wq(u,M.rect,h),H.x+=E,H.y+=G,H=M.mat.tf(H),H.x+=M.origin.x,H.y+=M.origin.y,H);if(V&&V[hg])return V.getPosition?V.getPosition(this,u,E,G,h,n):{x:(v.x+l.x)/2,y:(v.y+l.y)/2};if(p){var H,Z=p.size();if(Sb[u]){if(Z){var P=Z%2;if(0===P)return Bq(p.get(Z/2-1),p.get(Z/2),u,E,G,h,n);H=p.get((Z-P)/2)}else H={x:(v.x+l.x)/2,y:(v.y+l.y)/2};return H=wq(u,{x:H.x,y:H.y,width:0,height:0},h),H.x+=E,H.y+=G,H}return _k[u]?Bq(v,Z?p.get(0):l,u,E,G,h,n):Bq(Z?p.get(Z-1):v,l,u,E,G,h,n)}if(V){var Q=V.points,Z=Q.size();if(Sb[u]){var P=Z%2;return 0===P?Bq(Q.get(Z/2-1),Q.get(Z/2),u,E,G,h,n):(H=Q.get((Z-P)/2),H=wq(u,{x:H.x,y:H.y,width:0,height:0},h),H.x+=E,H.y+=G,H)}return _k[u]?Bq(Q.get(0),Q.get(1),u,E,G,h,n):Bq(Q.get(Z-2),Q.get(Z-1),u,E,G,h,n)}}return Mh},_42:function(D){this._78o&&Vi.superClass._42.call(this,D)},drawPath:function(Y,M){Y.beginPath();var O=M.type,m=M.points,H=M.segments,F=M._4O;if(!O||m){var v=M.sourcePoint,Z=v.x,$=v.y,l=M.targetPoint,L=l.x,A=l.y;if(O)if(H){var J=new Nf({x:Z,y:$});J.addAll(m),J.add({x:L,y:A}),Tj(Y,J,H)}else Y.moveTo(Z,$),m.each(function(M){Y.lineTo(M.x,M.y)}),Y.lineTo(L,A);else M.looped?Y.arc(Z,$,M.radius,0,k,!0):M.center?(Y.moveTo(M.c1.x,M.c1.y),Y.lineTo(Z,$),Y.lineTo(L,A),Y.lineTo(M.c2.x,M.c2.y)):(Y.moveTo(Z,$),Y.lineTo(L,A))}else F&&(F.points?Tj(Y,F.points,F.segments):F[hg]&&F[hg](Y,F))},_80o:function(r){var K=this,J=K.s,D=K._78o,l=D.width,E=D.selectWidth,f=D.borderWidth,m=D.color,q=r.lineJoin,v=r.lineCap,n=D.pattern;r.lineJoin=D.join,r.lineCap=D.cap,K.drawPath(kk(r,n),D);var S=J("edge.width.absolute");if(S&&(r.save(),r.setTransform(1,0,0,1,0,0)),E&&(r.strokeStyle=D._97o,r.lineWidth=l+2*(f+E),r.stroke()),f&&(r.strokeStyle=D.borderColor,r.lineWidth=l+2*f,r.stroke()),r.strokeStyle=m,r.lineWidth=l,r.stroke(),D.is3d&&Gi(r,m,D._67o,l,K.gv._zoom,D._66o),S&&r.restore(),Cg(r,n),J("edge.dash")){n=J("edge.dash.pattern");var O=kk(r,n,K._2Q("edge.dash.offset"));O!==r&&K.drawPath(O,D),K._1Q(r,"edge",J("edge.dash.width")||l,n)}r.lineJoin=q,r.lineCap=v},_48O:function(){},_47O:function(){},_71o:function(i,E){var c=this,a=c._data;if(c._19Q=!0,!a.getEdgeGroup())return i?a.s("edge.gap"):0;var K,S=0,f=0,M=0;if(a.getEdgeGroup().getSiblings().each(function(p){p.each(function(s){if(c.gv.isVisible(s)&&s.s(Yc)==E){var v=s.s("edge.gap");K?(f+=M/2+v/2,M=v):(K=s,M=v),s===a&&(S=f)}})}),i)return f-S+M;var R=S-f/2;return K&&a._40I!==K._40I&&(c._19Q=!1),R}});var Rf=function(L,t){Ck(Rf,this,[L,t])};Uo(Rf,br,{_3O:function(){var R,o,I=this,_=I.s,z=I._data,r=I.gv;if(I._88I=m,z.isExpanded()&&z.eachChild(function(x){var i=r.getBoundsForGroup(x);i&&(o||(o=[]),o.push(i),R=_m(R,i))}),R){var j=r.getLabel(z),u=_("group.type");R=ql(u,o,R),jr(R,z,"group.padding",1);var T=I._88I={type:u,rect:R,_64o:R};if(!u&&j!=m){var v,N=I.labelInfo={label:j,color:_("group.title.color"),font:_("group.title.font"),align:_("group.title.align")},p=eg(N,j),f=p.width,Z=p.height,L=_("group.title.align");f>R.width&&(R.width=f),N.rect={y:R.y-Z,width:p.width,height:Z},v=L===ip?R.x:L===jf?R.x+R.width-f:R.x+R.width/2-f/2,N.rect.x=v,T.titleRect={x:R.x,y:R.y-Z,width:R.width,height:Z+1},T.rect={x:R.x,y:R.y-Z,width:R.width,height:R.height+Z}}I._40O(T,_("group.border.width")/2)}else Rf.superClass._3O.call(I)},getPosition:function(Y,n,j,v){var M=this._88I;if(M){var u=wq(Y,M.rect,v);return u.x+=n,u.y+=j,u}return Rf.superClass.getPosition.apply(this,arguments)},_24O:function(t,P){var Y=this._88I;(!Y||Y.type||"label2"===t)&&Rf.superClass._24O.call(this,t,P)},_80o:function(G){var B=this,V=B._88I;if(V){var a=B._data,y=B.s,m=B.gv,C=V.type,K=V.rect,F=V._64o,j=V.titleRect,Z=B.getBodyColor(),A=Se(y("group.image"),Z),n=y("group.image.stretch"),f=B.getBodyColor("group.background"),D=Se(y("group.repeat.image"),Z),$=y("group.gradient.pack"),S=y("group.gradient"),H=y("group.gradient.color"),Q=y("group.depth");if(C){var d=y("group.border.pattern"),r=y("group.border.width"),O=G.lineJoin,X=G.lineCap;if(G.lineJoin=y("group.border.join"),G.lineCap=y("group.border.cap"),A){if(G.save(),gn(G,C,K),G.clip(),Mc(G,A,n,K.x,K.y,K.width,K.height,a,m,Z),G.restore(),r>0){var L=kk(G,d);gn(L,C,K),G.lineWidth=r,G.strokeStyle=y("group.border.color"),G.stroke(),Cg(G,d)}}else{var L=kk(G,d);f||D||$?(gn(G,C,K),$?on(G,$):D?Cm(G,D,Z,null,a,m):ee(G,f,S,H,K),G.fill(),$&&G.restore(),G!==L&&gn(L,C,K)):gn(L,C,K),r>0&&(G.lineWidth=r,G.strokeStyle=y("group.border.color"),G.stroke()),Cg(G,d),C===fj&&sr(G,f,Q,K)}G.lineJoin=O,G.lineCap=X}else if(A?Mc(G,A,n,F.x,F.y,F.width,F.height,a,m,B.getBodyColor()):(f||D)&&(D?Cm(G,D,Z,null,a,m):ee(G,f,S,H,F),gn(G,fj,F),G.fill(),sr(G,f,Q,F)),j){var s=y("group.title.background");Wm(G,j.x,j.y,j.width,j.height,s),sr(G,s,Q,j)}B._39O(G,V)}else Rf.superClass._80o.call(B,G)}});var dg=function(K,H){Ck(dg,this,[K,H])};Uo(dg,br,{_80o:function(F){this._39O(F,this._83o)}});var Kc=function(u,V){Ck(Kc,this,[u,V])};Uo(Kc,br,{_3O:function(){var I=this,z=I._data,x=I.s,Z=I.gv,P=z.getPoints(),M=Z.getBorderColor(z),p=M?x("border.width"):0,k=I.getSelectWidth(),B=x("shape.border.width"),F=z.getRect(),j=Z.getBodyColor(z),S=I._99o=P.isEmpty()?m:{rect:F,rotation:z.getRotation(),fillRule:x("shape.fill.rule"),scale:z.getScale(),position:z.p(),points:P,segments:z.getSegments(),bodyColor:j,borderColor:M,borderWidth:p,_94o:x("shape.border.3d"),_95o:x("shape.border.3d.color"),_96o:x("shape.border.3d.accuracy"),_97o:k?x("select.color"):m,selectWidth:k,_53o:x("shape.background"),_27Q:Se(x("shape.repeat.image"),j),shapeGradientPack:x("shape.gradient.pack"),_54o:B,_55o:x("shape.border.color"),shapeGradient:x("shape.gradient"),_59o:x("shape.gradient.color"),_60o:x("shape.border.pattern"),_61o:x("shape.border.cap"),_62o:x("shape.border.join")};if(S){var Y=z.getScale(),G=v(1,v(w(Y.x),w(Y.y)));x("shape.dash")&&x("shape.dash.width")>B&&(B=x("shape.dash.width"));var C=B*("square"===S._61o?.71:.5)+p+k/I.gv._zoom/G;C&&(C*=G,F=Cf(F),zc(F,C,S._62o)),I._68o(F);var N=x("clip.percentage");1>N&&(0>N&&(N=0),S.clipRect=Ro(z.getAnchorRect(),x("clip.direction"),N));var V=x("shape.fill.clip.percentage");1>V&&(0>V&&(V=0),S.shapeClipRect=Ro(z.getAnchorRect(),x("shape.fill.clip.direction"),V))}},getPosition:function(B,K,l,E){var o=this._99o;if(o){var $=wq(B,o.rect,E);return $.x+=K,$.y+=l,$}return Mh},_42:function(t){this._99o&&Kc.superClass._42.call(this,t)},_80o:function(D){var d,q=this,T=q.s,V=q._99o,y=V.position,X=V.scale,M=V.rotation,F=V.bodyColor,Z=V.borderWidth,W=V.selectWidth,r=V._53o,u=V._27Q,a=V.shapeGradientPack,K=V._54o,U=V.clipRect,$=V.shapeClipRect,m=V.points,P=V.segments,n=q._data.isClosePath(),N=V.fillRule,w=r||u||a;D.save(),Mi(D,y.x,y.y),zg(D,M),uo(D,X.x,X.y),U&&(D.beginPath(),D.rect(U.x,U.y,U.width,U.height),D.clip()),w&&$&&(D.save(),D.beginPath(),D.rect($.x,$.y,$.width,$.height),D.clip()),Mi(D,-y.x,-y.y);var O=V._60o,L=kk(D,O),A=D.lineJoin,e=D.lineCap;D.lineJoin=V._62o,D.lineCap=V._61o,w?(Tj(D,m,P,n),a?on(D,a):u?Cm(D,u,F,null,q._data,q.gv):(d=F?F:r,ee(D,d,V.shapeGradient,V._59o,V.rect)),D.fill(N),$&&(D.restore(),Mi(D,-y.x,-y.y)),a&&D.restore(),L!==D&&Tj(L,m,P,n)):Tj(L,m,P,n);var j=T("shape.border.width.absolute");if(j&&(D.save(),D.setTransform(1,0,0,1,0,0)),W&&(D.strokeStyle=V._97o,D.lineWidth=K+2*(Z+W),D.stroke()),Z&&(D.strokeStyle=V.borderColor,D.lineWidth=K+2*Z,D.stroke()),K&&(d=V._55o,!r&&F&&(d=F),D.strokeStyle=d,D.lineWidth=K,D.stroke(),V._94o&&Gi(D,d,V._95o,K,q.gv._zoom,V._96o)),j&&D.restore(),Cg(D,O),T("shape.dash")){var o=T("shape.dash.width")||K;if(o>0){O=T("shape.dash.pattern");var L=kk(D,O,q._2Q("shape.dash.offset"));L!==D&&Tj(L,m,P,n),q._1Q(D,"shape",o,O)
}}D.lineJoin=A,D.lineCap=e,D.restore()},_48O:function(){},_47O:function(){}});var Sr=function(G,$){Ck(Sr,this,[G,$])};Uo(Sr,Kc,{getRotation:function(X,U,R){X=X||0;var j=this._data.getPoints(),q=j.size();return q>1?Sb[R]?q&&0===q%2?oo(j.get(q/2-1),j.get(q/2),U,X):X:_k[R]?oo(j.get(0),j.get(1),U,X):oo(j.get(q-2),j.get(q-1),U,X):X},getPosition:function(u,C,$,Z,z){var V=this._data.getPoints(),I=V.size();if(I>1){if(Sb[u]){var B=I%2;if(0===B)return Bq(V.get(I/2-1),V.get(I/2),u,C,$,Z,z);var P=V.get((I-B)/2),p={x:P.x,y:P.y,width:0,height:0};return P=wq(u,p,Z),P.x+=C,P.y+=$,P}return _k[u]?Bq(V.get(0),V.get(1),u,C,$,Z,z):Bq(V.get(I-2),V.get(I-1),u,C,$,Z,z)}return Mh}});var vo=function(N,E){Ck(vo,this,[N,E])};Uo(vo,br,{_3O:function(){var C=this;vo.superClass._3O.call(C);var l=C.s,k=C._83o;C._82o=k.img||k.shape?m:{background:C.getBodyColor("grid.background"),depth:l("grid.depth"),rect:k.rect,_88o:l("grid.cell.depth"),cellBorderColor:l("grid.cell.border.color"),_89o:l("grid.row.count"),_90o:l("grid.column.count"),block:l("grid.block"),_91o:l("grid.block.color"),_92o:l("grid.block.padding"),_93o:l("grid.block.width")}},_80o:function(R){var B=this,G=B._82o;if(!G)return vo.superClass._80o.call(B,R),void 0;var c,M,N=B._data,E=G.background,V=G.rect,m=G.block,I=G._91o,S=G._92o,H=G._93o,D=G._88o,z=G.cellBorderColor,n=G._89o,w=G._90o;if(E)if(Wm(R,V.x,V.y,V.width,V.height,E),sr(R,E,G.depth,V),D)for(c=0;n>c;c++)for(M=0;w>M;M++)V=N.getCellRect(c,M),V&&sr(R,E,D,V);else if(z){for(R.beginPath(),c=0;n>c;c++)for(M=0;w>M;M++)V=N.getCellRect(c,M),V&&R.rect(V.x,V.y,V.width,V.height);R.strokeStyle=z,R.lineWidth=1,R.stroke()}if("h"===m)for(c=0;n>c;c++)V=_m(N.getCellRect(c,0),N.getCellRect(c,w-1)),xb(V,S),Af(R,I,V.x,V.y,V.width,V.height,H);else if("v"===m)for(M=0;w>M;M++)V=_m(N.getCellRect(0,M),N.getCellRect(n-1,M)),xb(V,S),Af(R,I,V.x,V.y,V.width,V.height,H);B._39O(R,B._83o)}});var uf=function(k,q){Ck(uf,this,[k,q])};Uo(uf,br,{_checkEmptyRect:!1,_81o:function(){var R=this._data,h=uf.superClass._81o.call(this),B=R.s("text");if(B!=m){var c,I,w=R.s("text.font"),A=R.s("text.align"),D=R.s("text.vAlign"),V=gc(w,B),u=V.width,d=V.height,z=R.getAnchor(),v=R.getWidth(),b=R.getHeight();"left"===A?c=-v*z.x:"center"===A?c=-v*z.x+(v-u)/2:"right"===A&&(c=v*(1-z.x)-V.width),"top"===D?I=-b*z.y:"middle"===D?I=-b*z.y+(b-d)/2:"bottom"===D&&(I=b*(1-z.y)-V.height);var L,G=R.getMatrix();if(L=Td([G.tf(c,I),G.tf(c+u,I),G.tf(c+u,I+d),G.tf(c,I+d)]),h=_m(h,L),h&&R.s("text.shadow")){var p=Cf(h);p.x+=R.s("text.shadow.offset.x"),p.y+=R.s("text.shadow.offset.y"),xb(p,R.s("text.shadow.blur")),h=_m(h,p)}}return h}});var Aq=mf.Interactor=function(O){this.gv=this._graphView=O};Rn("Interactor",u,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(K){this.gv.fi(K)},setCursor:function(j){L||this.gv.setCursor(j)},startDragging:function(Q){var s=this;s._lastClientPoint=Dl(Q),s._lastLogicalPoint=s.gv.lp(Q),Qc(s,Q)},clearDragging:function(){var Y=this;Y._lastClientPoint=Y._lastLogicalPoint=Y._logicalPoint=m},autoScroll:function(w){return this.gv.autoScroll(w,this._lastClientPoint)}});var th=function(M){var n=this;n.gv=M,M.getView(),["mousedown","mousemove","mouseup","touchstart","touchmove","touchsend"].forEach(function(V){n.addListener(V)})};Uo(th,Aq,{interactiveDisabled:!1,addListener:function(J){var $=this;$.gv.getView().addEventListener(J,function(y){b.preventDefault(y),$.interactiveDisabled||$["handle_"+J](y)},!1)},handle:function(O,T,V){var G=this.gv;if(V=V||G.getDataInfoAt(T)){var Z=V.part,g=V.data,B=V.ui;g[O]&&g[O](T,g,G);var q;return"rect"===Z&&B._83o&&B._83o.img?q=G.getImage(g):"icons"===Z&&(q=V.icon),this.handleImage(q,O,T,g,G),V}},handleImage:function(z,g,m,Y,J){if(z&&(z=Se(z))&&(z[g]&&z[g](m,Y,J),z.comps))for(var D=0;D<z.comps.length;D++){var P=z.comps[D];P[g]&&P[g](m,Y,J)}},handle_mousedown:function(C){this.handle("onDown",C)},handle_mousemove:function($){var r=this,n=r.gv;r._hoverTimer&&(Q(r._hoverTimer),delete r._hoverTimer);var t=r.handle("onMove",$);t&&(r._hoverTimer=h(function(){Q(r._hoverTimer),delete r._hoverTimer,r.handle("onHover",$,t)},n.getHoverDelay()||b.hoverDelay))},handle_mouseup:function(K){this.handle("onUp",K)},handle_touchstart:function(r){this.handle("onDown",r)},handle_touchmove:function(Q){this.handle("onMove",Q)},handle_touchend:function(I){this.handle("onUp",I)},handleWindowMouseMove:function(){},handleWindowMouseUp:function(){}});var Gh=mf.DefaultInteractor=function(Y){Ck(Gh,this,[Y])};Rn("DefaultInteractor",Aq,{handle_mousedown:function(p){db(p);var $=this,z=$.gv,H=z.getDataAt(p);!z.setFocus(p)||z._editing||z._scrolling||(qc(p)?z.handleDoubleClick(p,H):z.handleClick(p,H),!gh()&&H||!z.isPannable()||!zj(p)||fo(p)||($._tx=z.tx(),$._ty=z.ty(),$.startDragging(p)))},handleWindowMouseUp:function(s){var t=this,I=t.gv;I._panning&&(delete I._panning,I.onPanEnded(),t.fi({kind:"endPan",event:s})),delete t._tx,delete t._ty,t.clearDragging()},handle_mousemove:function(R){var f=this,C=f.gv;f._hoverTimer&&(Q(f._hoverTimer),delete f._hoverTimer),f._hoverTimer=h(function(){f.fi({kind:"hover",event:R}),Q(f._hoverTimer),delete f._hoverTimer},C.getHoverDelay()||b.hoverDelay)},handle_touchmove:function(o){this.handle_mousemove(o)},handleWindowMouseMove:function(r){var W=this,m=W.gv,L=W._lastClientPoint;W.fi({kind:m._panning?"betweenPan":"beginPan",event:r}),m._panning=1,m.setTranslate(W._tx+r.clientX-L.x,W._ty+r.clientY-L.y)},handle_mousewheel:function(a){this.gv.handleScroll(a,a.wheelDelta)},handle_DOMMouseScroll:function(m){2===m.axis&&this.gv.handleScroll(m,-m.detail)},handle_keydown:function(g){this.gv.handleKeyDown(g)}});var Sj=mf.SelectInteractor=function(p){Ck(Sj,this,[p])};Rn("SelectInteractor",Aq,{_42:function(){var g=this,s=g.gv,m=s.getZoom(),v=g.mark,S=g.div;S||(S=g.div=gd(),ts(g.getView(),S));var o={};o.x=v.x*m+s.tx(),o.y=v.y*m+s.ty(),o.width=v.width*m,o.height=v.height*m,Or(S,o),this.intersects()?(S.style.border="",S.style.background=s.getRectSelectBackground()):(S.style.background="",S.style.border="1px solid "+s.getRectSelectBorderColor())},handle_mousedown:function(W){var $=this,G=$.gv;if($._57I=m,!(G._editing||G._scrolling||gh())){var X=G.getDataAt(W),f=G.sm();if(X)if(fo(W))f.co(X)?f.rs(X):f.as(X);else if(f.co(X)){if(qc(W)&&X instanceof hj&&X.isClickThroughEnabled()){var k=G.getDataAt(W,function(p){G._clickThroughChecking=!0;var C=p.getParent()===X&&G.isSelectable(p);return delete G._clickThroughChecking,C});k&&(W.clickThrough=!0,f.ss(k))}}else f.ss(X);else fo(W)||!G.isPannable()?zj(W)&&(fo(W)||f.cs(),G.isRectSelectable()&&($.startDragging(W),G._77O=1)):zj(W)&&($._57I=Dl(W))}},handle_mouseup:function(s){var i=this,B=i._57I;B&&(fr(B,Dl(s))<=1&&i.gv.sm().cs(),i._57I=m)},handleWindowMouseUp:function(J){this.clear(J)},handleWindowMouseMove:function(g){var Q=this,R=Q.gv;Q._logicalPoint=R.lp(g),Q.mark?(Q.fi({kind:"betweenRectSelect",event:g}),R.isPannable()&&Q.autoScroll(g),Q.redraw()):Q.fi({kind:"beginRectSelect",event:g}),Q.mark=Td(Q._lastLogicalPoint,Q._logicalPoint),Q.redraw()},intersects:function(){var Y=this,c=Y._lastLogicalPoint,K=Y._logicalPoint;return c.x>K.x||c.y>K.y},clear:function(z){var d=this,W=d.gv,A=d.mark;if(d._57I=m,d._lastLogicalPoint){if(A){if(0!==A.width&&0!==A.height){var o=W.getDatasInRect(A,d.intersects());if(!o.isEmpty()){var O=W.sm(),n=O.toSelection();o.each(function(l){O.co(l)?n.remove(l):n.add(l)}),O.ss(n)}}bd(d.div),delete d.div,delete d.mark,d.redraw(),d.fi({kind:"endRectSelect",event:z}),W.onRectSelectEnded()}d.clearDragging(),delete W._77O}},redraw:function(){var f=this;f._draw||(f._draw=1,h(function(){f.mark&&f._42(),delete f._draw},16))}});var Ep=mf.MoveInteractor=function(U){Ck(Ep,this,[U])};Rn("MoveInteractor",Aq,{handle_mousedown:function(n){var u=this,B=u.gv;if(zj(n)&&!B._editing&&!B._scrolling&&!gh()){var r=B.getSelectedDataAt(n);r?(u._data=r,B.handleMouseDown&&B.handleMouseDown(n,r),u.startDragging(n),B.isMovable(r)&&(B._moving=1)):B._focusData=m}},handleWindowMouseUp:function(Z){var e=this,M=e.gv;M.handleMouseUp&&M.handleMouseUp(Z,e._data),e.clear(Z)},handleWindowMouseMove:function(q){var j=this,y=j._data,t=j.gv;if((!t._93O||!t._93O(q,y))&&t._moving){j._logicalPoint||j.fi({kind:"prepareMove",event:q});var m=j._logicalPoint?"betweenMove":"beginMove",Y={kind:m,event:q},U=j._logicalPoint=t.lp(q);"beginMove"!==m||j._alreadyBeginTransaction||(j._alreadyBeginTransaction=!0,t.getDataModel().beginTransaction());var D=j._calcShift(m,q),M=D.x,v=D.y,E=j.gv.getMoveMode(q,y);E&&("x"===E?v=0:"y"===E?M=0:"xy"!==E&&(M=v=0)),t.moveSelection(M,v),j._lastLogicalPoint=U,j.autoScroll(q),j.fi(Y)}},_calcShift:function(){var b=this,J=b._logicalPoint,q=b._lastLogicalPoint,T=J.x-q.x,B=J.y-q.y;return{x:T,y:B}},clear:function(R){var L=this,G=L.gv;L._lastLogicalPoint&&(L._lastLogicalPoint=L._data=G._moving=m,L._logicalPoint&&(L.fi({kind:"endMove",event:R}),G.onMoveEnded()),L.clearDragging()),L._alreadyBeginTransaction&&(L._alreadyBeginTransaction=!1,G.getDataModel().endTransaction())}});var Gb=mf.ScrollBarInteractor=function(t){Ck(Gb,this,[t])};Rn("ScrollBarInteractor",Aq,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(Q){var T=this.gv.getViewRect();return this._41o()&&(T.x+T.width-this.gv.lp(Q).x)*this.gv.getZoom()<ps},isH:function(y){var V=this.gv.getViewRect();return this._40o()&&(V.y+V.height-this.gv.lp(y).y)*this.gv.getZoom()<ps},handle_mousemove:function(Q){this.handle_touchmove(Q)},handle_touchmove:function(X){if(!tb&&zj(X)&&this.gv.isScrollBarVisible()){var c=this,Q=c.isV(X),$=c.isH(X);(Q||$)&&c.gv.showScrollBar(),c.gv._scrolling=Q||$}},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(o){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=m,this.fi({kind:"endScroll",event:o})},handle_mousedown:function(K){this.handle_touchstart(K)},handle_touchstart:function(l){var Y=this;if(Y.gv.setFocus(l),db(l),Y.handle_touchmove(l),!(rn(l)>1)&&Y.gv._scrolling&&Y.gv.isScrollBarVisible()){Y._cp=Dl(l),Y._tx=Y.gv.tx(),Y._ty=Y.gv.ty();var n=Y.isV(l);Y._state=n?"vScroll":"hScroll",Qc(Y,l),Y.fi({kind:"beginScroll",event:l})}},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(z){var _=Dl(z),q=this.gv.getViewRect(),a=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-_.y)*a.height/q.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-_.x)*a.width/q.width),this.fi({kind:"betweenScroll",event:z})}});var Mf=mf.TouchInteractor=function(W,D){D=D||{},D.selectable===Y&&(D.selectable=!0),D.movable===Y&&(D.movable=!0),D.pannable===Y&&(D.pannable=!0),D.pinchable===Y&&(D.pinchable=!0),D.editable===Y&&(D.editable=!0),this.params=D,Ck(Mf,this,[W])};Rn("TouchInteractor",Aq,{ms_edit:1,setUp:function(){var o=this;Mf.superClass.setUp.call(o),L&&o.params.editable&&o.gv.setEditInteractor(o)},tearDown:function(){var s=this;Mf.superClass.tearDown.call(s),L&&s.params.editable&&s.gv.setEditInteractor(m)},clear:function(l){var P=this,W=P.gv;W._moving&&(P.fi({kind:"endMove",event:l}),delete W._moving,W.onMoveEnded(),W.dm().endTransaction()),W._panning&&(P.fi({kind:"endPan",event:l}),delete W._panning,W.onPanEnded()),W._pinching&&(P.fi({kind:"endPinch",event:l}),delete W._pinching,W.onPinchEnded()),W._editing&&(P._46O(l),P._77I=P._node=P._edge=P._shape=P._rect=P._89I=P._index=W._editing=m),P._moving=P._panning=P._pinching=P._editing=P._57I=P._data=P._beginHistory=m,P.clearDragging()},handle_touchstart:function(z){var Q=this;if(!Q.gv._editing){db(z),Q._57I=m;var f=Q.params,F=Q.gv,o=F.sm(),i=F.getDataAt(z),h=rn(z);if(1===h){if(qc(z))return F.handleDoubleClick(z,i),void 0;F.handleClick(z,i),i&&(F.handleMouseDown&&F.handleMouseDown(z,i),Q._data=i),f.selectable||(i=m),i?(o.co(i)||o.ss(i),f.editable&&F.isEditable(i)&&Q._79I(z,i,!0)?(Q._editing=1,Q.startDragging(z)):f.movable&&F.isMovable(i)&&(Q._moving=1,Q.startDragging(z))):(Q._57I=Dl(z),f.pannable&&F.isPannable()&&(Q._panning=1,Q.startDragging(z),Q._translate={x:F.tx(),y:F.ty()}))}else if(f.pinchable&&2===h){Q._pinching=1,Q.startDragging(z);var J=F.getView(),j=F.getZoom(),q=J.getBoundingClientRect(),l=z.touches[0],T=z.touches[1],e={x:(l.clientX+T.clientX)/2-q.left,y:(l.clientY+T.clientY)/2-q.top};e.x-=F.tx(),e.y-=F.ty(),e.x/=j,e.y/=j,Q._p=e,Q._d=lf(z)}}},handle_touchend:function(l){var L=this,c=L.gv,H=L._57I,W=L._data;H&&(fr(H,Dl(l))<=1&&c.sm().cs(),L._57I=m),W&&c.handleMouseUp&&c.handleMouseUp(l,W)},handleWindowTouchEnd:function(Y){this.clear(Y)},handleWindowTouchMove:function(w){var o=this,F=o.gv,G=rn(w);if(1===G){if(o._editing&&(o._beginHistory||(o._beginHistory=1,F.dm().beginTransaction()),F._editing=1,o._78I(w)),o._moving)o._beginHistory||(o._beginHistory=1,F.dm().beginTransaction()),o.handleMove(w);else if(o._panning){var P=Dl(w);F.setTranslate(o._translate.x+P.x-o._lastClientPoint.x,o._translate.y+P.y-o._lastClientPoint.y),o.fi({kind:F._panning?"betweenPan":"beginPan",event:w}),F._panning=1}}else if(2===G&&o._pinching){var A=lf(w);F.handlePinch(o._p,A,o._d),o._d=A,o.fi({kind:F._pinching?"betweenPinch":"beginPinch",event:w}),F._pinching=1}},handleMove:function(T){var g=this,i=g.gv,l=i.lp(T);i._93O&&i._93O(T,g._data)||(i.moveSelection(l.x-g._lastLogicalPoint.x,l.y-g._lastLogicalPoint.y),g._lastLogicalPoint=l,g.autoScroll(T),g.fi({kind:i._moving?"betweenMove":"beginMove",event:T}),i._moving=1)}});var o=P.ht,pp=o.graph._editor={Math:{},Guide:{}};o.Math=pp.Math,pp.getStyle=function(s){var b,A=pp.StyleMap;return A&&(b=A[s],b!==Y)?b:pp.DefaultStyleMap[s]},pp.setStyle=function(u,S){var $=pp.StyleMap;$||($=pp.StyleMap={}),$[u]=S},pp.inEdit=function(b){return b._inXEdit===!0},pp.startEdit=function(j){j._inXEdit=!0,pp.Inject.doInject(j)},pp._46O=function(r){r._inXEdit=!1,pp.Inject.undoInject(r)},pp.toScreenPosition=function(T,X){var z=T.tx(),I=T.ty(),N=T._zoom;return new pp.Math.Vector2(X.x*N+z,X.y*N+I)},pp.checkHit=function(L,F,s){return L.distanceTo(F)<s?!0:!1},pp.toWorldPosition=function(S,p){var Y=S.tx(),a=S.ty(),K=S._zoom;return{x:(p.x-Y)/K,y:(p.y-a)/K}},pp.setAntialias=function($,W){for(var K,S=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],w=0,v=S.length;v>w&&(K=S[w],!(K in $));w++);$[K],$[K]=W},pp.getTargetCornersOnScreen=function(g,z){if(!z)return null;var D,b=[];if(Dq(z,g)){var B=Lq(g,z);D=[{x:B.x,y:B.y},{x:B.x+B.width,y:B.y},{x:B.x+B.width,y:B.y+B.height},{x:B.x,y:B.y+B.height}]}else{if(!z.getCorners)return null;D=z.getCorners()}return D.forEach(function(s){var z=pp.toScreenPosition(g,s);b.push(z.x,z.y)}),b},pp.log=function(){};var Wr=pp.Inject={_modules:[]};Wr.registAsModule=function(R,r){var J={},B={};for(var T in R){var W=r.prototype[T];J[T]=W}R.getBackup=function(U){return J[U]},R.getBackups=function(){return J},B.doInject=function(){for(var N in R)"getBackup"!==N&&(r.prototype[N]=R[N])},B.undoInject=function(){for(var $ in R)"getBackup"!==$&&(r.prototype[$]=J[$])},Wr._modules.push(B)},Wr.doInject=function(X){for(var o,p=Wr._modules,L=0,x=p.length;x>L;L++)o=p[L],o.doInject(X)},Wr.undoInject=function(Z){for(var D,y=Wr._modules,L=0,i=y.length;i>L;L++)D=y[L],D.undoInject(Z)};var Aq=o.graph.EditInteractor=function(K){var f=this,j=D.createElement("canvas");j.className="editCanvas",j.style.position="absolute",f._styleMap={},f._canvas=j,f._context=j.getContext("2d"),Aq.superClass.constructor.call(f,K),pp.setAntialias(f._context,!1),f._subModules=[new pp.Anchor(f),new pp.Rect(f),new pp.Curve(f),new pp.MoveHelper(f)],f._gridGuide=new pp.Guide.Grid(f),f._rectGuide=new pp.Guide.Rect(f)},cm=Aq;o.Default.def(Aq,o.graph.Interactor,{ms_edit:1,ms_fire:1}),u.defineProperties(Aq.prototype,{editDetail:{get:function(){var q=!!this._editDetail;return q},set:function(o){var z=this,n=z._editDetail;n!==o&&(z._editDetail=o,z.gv._editing=o,z.fp("editDetail",n,o),z.fp("pointsEditingMode",n,o),z.fi({kind:o?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(O){(!this._editDetail||O)&&(this.gv._editing=O,O||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(S){this._editing=S,this.gvEditing=S}},pointsEditingMode:{get:function(){return this.editDetail},set:function(d){var K=this;K.editDetail!==d&&(d?K._tryEnterEditDetailMode():K._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var H=this._gridEnabled;if(!H)return!1;var X=this.gv;return X?!0:!0},set:function(e){e!==this._gridEnabled&&(this._gridEnabled=e,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(A){A!==this._agEnabled&&(this._agEnabled=A,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Aq.prototype.getSubModule=function(K){var T,E,n,j=this._subModules;for(E=0,n=j.length;n>E;E++)if(T=j[E],T.catalog===K)return T},Aq.prototype.invokeSubModule=function(u,g){var E=this,x=E._subModules;if(x)for(var L,b,j,F=Array.prototype.slice.call(arguments,2),K=0,t=x.length;t>K;K++)if(L=x[K],b=L[u],b&&(j=b.apply(L,F),j!=Y&&g))return L},Aq.prototype.invokeSubModuleInverse=function(u,B){var o=this,r=o._subModules;if(r)for(var H,c,t,G=Array.prototype.slice.call(arguments,2),h=r.length-1;h>=0;h--)if(H=r[h],c=H[u],c&&(t=c.apply(H,G),t!=Y&&B))return H},Aq.prototype.setUp=function(){pp.log("setUp");var P=this,r=P.gv,Q=r.getView(),q=P._canvas;Aq.superClass.setUp.call(P),r.setEditInteractor(P),r._79O?Q.insertBefore(q,r._79O):Q.appendChild(q),pp.startEdit(r),P.invokeSubModule("setUp"),r.dm().mm(P._onDataModelChanged,P),r.dm().md(P._onDataPropertyChanged,P)},Aq.prototype.tearDown=function(){pp.log("tearDown");var y=this,J=y.gv,u=J.getView();y._resetCustomCursorStyle(),Aq.superClass.tearDown.call(y),J.dm().umm(y._onDataModelChanged,y),J.dm().umd(y._onDataPropertyChanged,y),J.setEditInteractor(null),u.removeChild(y._canvas),y._drawTimer&&(Q(y._drawTimer),y._drawTimer=null),pp._46O(J),y.invokeSubModule("tearDown")},Aq.prototype._onDataModelChanged=function(w){var Z=this;("clear"===w.kind||"remove"===w.kind&&Z.editDetail&&w.data===Z.getSubModule("Curve").target)&&(Z.editDetail=!1,Z._42())},Aq.prototype._onDataPropertyChanged=function(u){var y=this;if(y.editDetail){var l=y.getSubModule("Curve"),B=u.data;B===l.target&&(B._writing||l._handleDataChanged())}},Aq.prototype.clear=function(){pp.log("clear")},Aq.prototype.redraw=function(){this._42()},Aq.prototype._42=function(){var c=this;c._drawTimer||(c._drawTimer=h(function(){c._drawTimer=null,c.drawImpl()},0))},Aq.prototype.drawImpl=function(){var w;for(w in{_42:!0})break;return function(){var a=this,m=a._canvas,r=a.gv,e=r.getWidth(),N=r.getHeight(),l=a._context,O=o.Default.getInternal();(m.width!==e||m.height!==N)&&O.setCanvas(m,e,N),l.clearRect(0,0,m.width,m.height);var b=a._getValidSelection();l.save();var K=o.Default.devicePixelRatio;l.scale(K,K),a._gridGuide._42(),a._rectGuide._42(),a.invokeSubModuleInverse(w,!1,l,r,b),l.restore()}}(),Aq.prototype._getValidSelection=function(){var v=this,Z=v.gv,i=Z.sm().getSelection(),g=[];return i.each(function(S){Z.isVisible(S)&&Z.isEditable(S)&&g.push(S)}),g},Aq.prototype.handle_touchmove=function(T){return this.handle_mousemove(T)},Aq.prototype.handle_mousemove=function(d){if(!o.Default.isDragging()){var f=this;(f.editDetail||!gh())&&(f.gvEditing=!1,f._checkEdit(d)&&(f.gvEditing=!0))}},Aq.prototype.handle_touchstart=function(k){return this.handle_mousedown(k)},Aq.prototype.handle_mousedown=function(M){db(M);var c=this;if(c.editDetail||!gh()){if(qc(M)&&!M.clickThrough){if(c.editDetail){if(c._tryQuitEditDetailMode(M))return}else if(c._tryEnterEditDetailMode())return;c.gv.dm().beginTransaction();var y=c.invokeSubModule("handleDoubleClick",!0,M);if(c.gv.dm().endTransaction(),y)return}var b=c._checkEdit(M);b&&(c._downPosition=c._getLogicalPoint(M),c.gv.dm().beginTransaction(),b.startEdit(c,M),c.editing=!0)}},Aq.prototype._checkEdit=function(R){var B=this,A=B.gv,G=B._getLogicalPoint(R),D=B.invokeSubModule("check",!0,A,R,G)||null;return B._editMod=D,D},Aq.prototype.handleWindowTouchMove=function(d){return this.handleWindowMouseMove(d)},Aq.prototype.handleWindowMouseMove=function(Y){var j=this,O=j._downPosition;if(O){var D=j._getLogicalPoint(Y);if(D.distanceTo(O)<j.getStyle("moveSensitivity"))return;delete j._downPosition}var q=j._editMod;q&&q.handleEdit(j.gv,Y)},Aq.prototype._getLogicalPoint=function(R){var A=this,h=o.Default.getLogicalPoint(R,A._canvas);return new pp.Math.Vector2(h)},Aq.prototype.handleWindowTouchEnd=function(S){return this.handleWindowMouseUp(S)},Aq.prototype.handleWindowMouseUp=function(){var e;for(e in{_46O:!0})break;return function(L){var k=this;k.editing=!1,k.setCursor("default"),k.invokeSubModule(e,!1,L),k._42(),k.gv.dm().endTransaction()}}(),Aq.prototype.handle_mousewheel=function(R){var X=this;db(R),X.invokeSubModule("preHandleScroll",!0)||X.gv.handleScroll(R,R.wheelDelta)},Aq.prototype.handleDelete=function(){var P=this;if(!P.editDetail){P.gv.dm().beginTransaction();var L=P.invokeSubModule("handleNormalStateDelete",!0);return P.gv.dm().endTransaction(),L||P.gv.removeSelection(),void 0}P.gv.dm().beginTransaction(),P.invokeSubModule("handleDelete",!0),P.gv.dm().endTransaction(),P._42()},Aq.prototype.handle_keydown=function(y){var W=this;if((y.metaKey||y.ctrlKey)&&W._42(),gh(y)&&!W.editing)return W.gvEditing=!1,W.setCursor("default"),W._42(),void 0;var q=me(y);return W.editDetail?((q||mq(y))&&(W.editDetail=!1,W._42()),W.gv.dm().beginTransaction(),W.invokeSubModule("handle_keydown",!0,y),W.gv.dm().endTransaction(),void 0):(W.gv.dm().beginTransaction(),W.invokeSubModule("handleNormalStateKeyDown",!0,y),W.gv.dm().endTransaction(),q&&W._tryEnterEditDetailMode(),void 0)},Aq.prototype.handle_keyup=function(D){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,D),this.gv.dm().endTransaction()},Aq.prototype._tryEnterEditDetailMode=function(){var u=this;return!u.editDetail&&u.invokeSubModule("canEnterEditDetailMode",!0)&&1===u._getValidSelection().length?(u.editDetail=!0,u._42(),!0):void 0},Aq.prototype._tryQuitEditDetailMode=function(U){var z=this;if(z.editDetail){var b=z.gv,B=z.getSubModule("Curve").target;return U&&b.getDataAt(U)===B?void 0:(z.editDetail=!1,z._42(),!0)}},Aq.prototype.setStyle=function(B,D,Y){var a=this;Y?pp.setStyle(B,D):a._styleMap[B]=D,a.fp("styleChanged",null,{key:B,value:D,base:Y}),a._42()},Aq.prototype.getStyle=function($){var l=this,A=l._styleMap[$];return A!==Y?A:pp.getStyle($)},Aq.prototype.setCursor=function(Y){this._resetCustomCursorStyle(),o.graph.EditInteractor.superClass.setCursor.call(this,Y)},Aq.prototype._resetCustomCursorStyle=function(){var X=this;if(X._customStyle){var Q=this.gv.getView();Q.classList&&Q.classList.remove&&Q.classList.remove(X._customStyle),X._customStyle=null}},Aq.prototype._setRotateCursor=function(Q){var h=this,d=h._cursorFactory;d||(d=h._cursorFactory=new pp.CursorFactory(h));var J=d.getRotateCursor(Q),C=h.gv.getView();h._resetCustomCursorStyle(),h._customStyle=J,C.classList&&C.classList.add&&C.classList.add(J)};var Xc=pp.Group=function(F){var d=this;d._entities=F,d._64O=0,d._position={x:0,y:0},d._scale={x:1,y:1},d._anchor={x:.5,y:.5},d._anchor2={x:.5,y:.5}};Xc.prototype={},Xc.prototype.constructor=Xc;var Fl=null;Xc.findOrCreateGroup=function(g){if(Fl&&Fl.checkIsMe(g))return Fl;var z=new pp.Group(g);return z.getKeyOb()?(Fl=z,z):void 0},Xc.prototype.checkIsMe=function(B){var y=this._entities;if(y.length!==B.length)return!1;var M,G={},d=B.length;for(M=0;d>M;M++)G[B[M]._id]=!0;for(M=0;d>M;M++)if(!G[y[M]._id])return!1;return!0},Xc.prototype.getRotation=function(){return this._64O},Xc.prototype.getPosition=function(){return this._position},Xc.prototype.getAnchor=function(){return this._anchor},Xc.prototype.getWidth=function(){return this._width},Xc.prototype.getScale=function(){return this._scale},Xc.prototype.getSize=function(){return{width:this._width,height:this._height}},Xc.prototype.getHeight=function(){return this._height},Xc.prototype.getKeyOb=function(){for(var t=this._entities,A=t.length-1;A>=0;A--){var f=t[A];if(this.isNode(f))return f}},Xc.prototype.getAnchor2=function(){var C=this,H=C.rotateCenter;if(H)return H;var f=C.getKeyOb();if(!f)return C._anchor;var r=C._anchor2,k=f.getMatrix();return k.tf({x:f.getWidth()*(r.x-f.getAnchor().x),y:f.getHeight()*(r.y-f.getAnchor().y)})},Xc.prototype.setAnchor2=function(N,$){var S=this,k=S.getKeyOb();if(k){var w,c=k.getMatrix();w="number"==typeof N?{x:N,y:$}:N;var T=c.tfi(w);S._anchor2={x:k.getAnchor().x+T.x/k.getWidth(),y:k.getAnchor().y+T.y/k.getHeight()}}},Xc.prototype.setRotation=function(){},Xc.prototype.beginRotate=function(p){this.rotateCenter=p.pos,this.rotateMode=p.groupRotateMode},Xc.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Xc.prototype.addRotation=function(j,z){return"batch"===z?this._addRotationInBatchMode(j):"block"===z?this._addRotationInBlockMode(j):void 0},Xc.prototype._addRotationInBlockMode=function(l){var M=this,S=M.rotateCenter||M.getPosition();M._entities.forEach(function(U){if(M.isNode(U)){var k=U.getMatrix();k.translate(-S.x,-S.y),k.rotate(l),k.translate(S.x,S.y);var R=Math.sign(U.getScale().x);U.setRotation(r(k.b*R,k.a*R)),U.setPosition(k.tx,k.ty)}})},Xc.prototype._addRotationInBatchMode=function(T){var Z=this,G=Z._anchor2;Z._entities.forEach(function(i){if(Z.isNode(i)){var z=i.getAnchor(),o=i.getMatrix(),R=o.tf({x:i.getWidth()*(G.x-z.x),y:i.getHeight()*(G.y-z.y)}),I=new pp.Math.Matrix2;I.set(o.a,o.b,o.c,o.d,o.tx,o.ty),I.translate(-R.x,-R.y),I.rotate(T),I.translate(R.x,R.y);var g=Math.sign(i.getScale().x);i.setRotation(r(I.b*g,I.a*g)),i.setPosition(I.tx,I.ty)}})},Xc.prototype.setPosition=function(I){var f,$,W,z,M=this,K=M._position,R=I.x-K.x,o=I.y-K.y,B=M._entities;for($=0,W=B.length;W>$;$++)f=B[$],Lg(f)&&(z=f.getPosition(),f.setPosition(z.x+R,z.y+o));M._position=I},Xc.prototype.setScale=function(m,c){var r=this,f=m/r._scale.x,T=c/r._scale.y;r._adjustChildScaleOrSize(f,T,"size"),r._scale={x:m,y:c}},Xc.prototype.getRect=function(){var p=this,B=p._position,F=p._width,W=p._height;return{x:B.x-F/2,y:B.y-W/2,width:F,height:W}},Xc.prototype.setSize=function(n,f){var v=this,n=Math.max(1,n),f=Math.max(1,f),g=n/v._width,O=f/v._height;v._adjustChildScaleOrSize(g,O,"size"),v._width=n,v._height=f},Xc.prototype._adjustChildScaleOrSize=function(I,P,k){var p,C,g,c,o,Q,u,j,w,E,S,Y,A,b,N=this,L=N._position,t=N._entities,h=new pp.Math.Matrix2;for(C=0,g=t.length;g>C;C++)if(p=t[C],N.isNode(p)){if(c=p.getPosition(),o=p.getRotation(),Q=p.getWidth(),u=p.getHeight(),j=p.getScale(),S=j.x*Q,Y=j.y*u,h.identity().scale(S,Y).rotate(o).translate(c.x,c.y).translate(-L.x,-L.y).rotate(-N._64O),o=r(h.b*Math.sign(S),h.a*Math.sign(S)),h.scale(I,P),w=Math.cos(o),E=Math.sin(o),Math.abs(w)<.001?(A=h.b/E,b=-h.c/E):(A=h.a/w,b=h.d/w),"scale"===k)p.setScale(A/Q,b/u);else if("size"===k){var H=A/j.x,V=b/j.y;p.setScale(Dp(A)*Math.abs(j.x),Dp(b)*Math.abs(j.y)),p.setSize(Math.max(.1,Math.abs(H)),Math.max(.1,Math.abs(V)))}h.rotate(N._64O).translate(L.x,L.y),p.setPosition(h.tx,h.ty)}},Xc.prototype.getMatrix=function(){var g=this,p=g._position,S=o.Default.getInternal(),m=g._scale;return new S.Mat(g._64O,p.x,p.y,m.x,m.y)},Xc.prototype.getCorners=function(){var j=this,_=j._width,z=j._height,p=j._anchor,c=-_*p.x,C=-z*p.y,W=j.getMatrix();return[W.tf(c,C),W.tf(c,C+z),W.tf(c+_,C+z),W.tf(c+_,C)]},Xc.prototype.calcInfo=function(){var s,E,P,j,O,c,v=this,G=[],W=v._entities,F=v._64O;for(j=0,O=W.length;O>j;j++)c=W[j],v.isNode(c)&&c.getCorners&&G.push.apply(G,c.getCorners());if(G.length){var t=Math.cos(-F),M=Math.sin(-F),b=1/0,n=-1/0,k=1/0,m=-1/0;for(j=0,O=G.length;O>j;j++)P=G[j],s=P.x,E=P.y,P.x=t*s-M*E,P.y=M*s+t*E,b=Math.min(b,P.x),n=Math.max(n,P.x),k=Math.min(k,P.y),m=Math.max(m,P.y);v._width=(n-b)/v._scale.x,v._height=(m-k)/v._scale.y,t=Math.cos(F),M=Math.sin(F);var H=v._anchor;s=b+(n-b)*H.x,E=k+(m-k)*H.y,v._position={x:t*s-M*E,y:M*s+t*E}}},Xc.prototype.isNode=function(b){return Lg(b)?Dq(b)?!1:!0:!1},Xc.prototype._42=function(X,z,M){var V,u,n,R,w,r,E,I,$=this,o=$._entities,Z=$.rotateMode;for("batch"===Z&&(I=$.getKeyOb()),V=0,u=o.length;u>V;V++)n=o[V],$.isNode(n)&&(r=n.getRect(),R=pp.toScreenPosition(M,{x:r.x,y:r.y}),w=pp.toScreenPosition(M,{x:r.x+r.width,y:r.y+r.height}),E={min:R,max:w},n===I&&(E.isKeyOb=!0),pp.Icons.DrawIcon(X,z,pp.Icons.GroupSubEntityRect,E))};var Zl=pp.CurveActiving=function(p,j){this._curve=p,this._interactor=p._interactor;for(var V in j)this[V]=j[V]};Zl.prototype={},Zl.prototype.constructor=Zl,u.defineProperties(Zl.prototype,{point:{get:function(){return this._point},set:function(E){var o=this;o._point=E,o.editingCtrl||o._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(S){var w=this;w._pairs=S,w.editingCtrl&&w._firePointChange()}}}),Zl.prototype._firePointChange=function(){var B=this,G=B.getCurrentEditingPoint();if(!G)return V.fi({kind:"selectPoint"}),void 0;var V=B._interactor,Q=this._curve.target;if(Q){var h=pp.getDataMatrix(Q).invert(),P=G.e;G=h.apply(pp.toWorldPosition(V.gv,G)),G.e=P;var f=B._lastFirePoint;f&&Math.abs(G.x-f.x)<1e-5&&Math.abs(G.y-f.y)<1e-5&&(G.e==Y&&f.e==Y||Math.abs(G.e-f.e)<1e-5)||(B._lastFirePoint=G,V.fi({kind:"selectPoint",x:G.x,y:G.y,e:G.e}))}},Zl.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Zl.prototype.getCurrentEditingPoint=function(){var w=this,p=w.editingCtrl;if(p){var W=w.pairs;if(W){var U=W[p.pairId],b=U[p.type];if(b)return b}}return w._point};var Qq=pp.CursorFactory=function(H){var e=this;e._interactor=H,e._rotateCursorStyles={}};Qq.prototype={},Qq.prototype.constructor=Qq,Qq.prototype.getRotateCursor=function(S){var q=this;0>S&&(S+=2*Math.PI);var X=q._interactor,M=X.getStyle("rotateCursorSize"),D=X.getStyle("rotateCursorRound"),f=Math.round(180*(S/Math.PI)/D);f*D>=360&&(f=0);var J=q._rotateCursorStyles,c="htCustomRotateStyle_"+M+"_"+D+"_"+f;return J[c]||(q._produceRotateCursor(c,M,D,f),J[c]=!0),c},Qq.prototype._produceRotateCursor=function(E,C,p,S){var _=this;_._interactor;var F=_._canvas;F||(F=_._canvas=D.createElement("canvas")),F.width=F.height=C*devicePixelRatio,F.style.width=F.style.height=C+" px";var N=F.getContext("2d");pp.setAntialias(N,!1),N.scale(devicePixelRatio,devicePixelRatio);var j,i,Y,h,k,U=Math.round(C/2),z=""+U+" "+U+",auto !important;";j=Math.PI/180*S*p,N.clearRect(0,0,C,C),N.save(),N.scale(C/32,C/32),N.translate(16,16),N.rotate(j+Math.PI/2),N.beginPath(),N.moveTo(-8,0),N.lineTo(-8,3),N.lineTo(-5,3),N.moveTo(8,0),N.lineTo(8,3),N.lineTo(5,3),N.moveTo(-8,3),N.quadraticCurveTo(0,-6,8,3),N.restore(),N.strokeStyle="white",N.lineWidth=4,N.stroke(),N.strokeStyle="black",N.lineWidth=2,N.stroke(),i=JSON.stringify(F.toDataURL()),h="cursor:url("+i+")"+z,1!==devicePixelRatio&&(Y='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+C+'px" height="'+C+'px"><image xlink:href='+i+' width="'+C+'" height="'+C+'"/></svg>',h+="cursor:url(data:image/svg+xml;base64,"+btoa(Y)+")"+z,h+="cursor:-webkit-image-set(url("+i+")"+devicePixelRatio+"x,url("+i+")1x)"+z),k=D.createElement("style"),k.textContent="body."+E+" *, ."+E+"{"+h+"}",D.head.appendChild(k)};var Hk=pp.Guide.Grid=function(O){var V=this;V._interactor=O,V._alignmentGuideId=0,V._xAlignmentGuide=[],V._yAlignmentGuide=[]};Hk.prototype={},Hk.prototype.constructor=Hk,u.defineProperties(Hk.prototype,{gridBlockSize:{get:function(){var U=this;return U._gridBlockSize||U._interactor.getStyle("gridBlockSize")},set:function(q){this._gridBlockSize=q,this._interactor._42()}},gridThickLinesEvery:{get:function(){var V=this;return V._gridThickLinesEvery||V._interactor.getStyle("gridThickLinesEvery")},set:function(d){this._gridThickLinesEvery=d,this._interactor._42()}},gridEnabled:{get:function(){var O=this,Z=O._interactor;return Z.gridEnabled&&O.isValidGrid()}}}),Hk.prototype._42=function(){var f=this,Q=f._interactor;f.gridEnabled&&f.drawGrid(),Q.alignmentGuideEnabled&&f.drawAlignmentGuide()
},Hk.prototype.makeMatrix=function(){var o=this,S=o._interactor.getStyle("gridAngle"),L=o._interactor.getStyle("gridRotation"),z=new pp.Math.Matrix2,g=Math.sin(S),f=Math.cos(S);return z.set(1,0,f,g,0,0),z.rotate(L),z},Hk.prototype.isValidGrid=function(){var a=this,S=Math.PI,z=a._interactor,k=z.gv;if(k._zoom<z.getStyle("gridZoomThreshold"))return!1;var N=z.getStyle("gridAngle"),p=Math.abs(180*(N%S/S)),A=1-1e-8;return A>p||p>180-A?!1:!0},Hk.prototype.drawAlignmentGuide=function(){var a=this,w=a._interactor,X=w.gv,r=w._canvas,p=w._context,j=r.width,d=r.height,c=X.tx(),z=X.ty(),V=X._zoom;p.beginPath(),p.strokeStyle=w.getStyle("gridAlignmentGuideColor"),p.lineWidth=1,a._xAlignmentGuide.forEach(function(e){var P=e.p*V+c;p.moveTo(P,0),p.lineTo(P,d)}),a._yAlignmentGuide.forEach(function(i){var r=i.p*V+z;p.moveTo(0,r),p.lineTo(j,r)}),p.stroke()},Hk.prototype.drawGrid=function(){function u(G,F,O,p){var S=pp.toScreenPosition(Q,d.apply({x:G,y:F})),n=pp.toScreenPosition(Q,d.apply({x:O,y:p}));z.moveTo(S.x,S.y),z.lineTo(n.x,n.y)}var G=this,y=G._interactor,E=G.gridBlockSize,W=G.gridThickLinesEvery,Y=y.getStyle("gridThickColor"),m=y.getStyle("gridLightColor"),Q=y.gv,k=y._canvas,z=y._context,D=k.width,l=k.height,d=G.makeMatrix(),s=d.applyInverse(pp.toWorldPosition(Q,{x:0,y:0})),A=d.applyInverse(pp.toWorldPosition(Q,{x:D,y:0})),g=d.applyInverse(pp.toWorldPosition(Q,{x:0,y:l})),O=d.applyInverse(pp.toWorldPosition(Q,{x:D,y:l})),M=Math.min(s.x,A.x,g.x,O.x),H=Math.max(s.x,A.x,g.x,O.x),j=Math.min(s.y,A.y,g.y,O.y),$=Math.max(s.y,A.y,g.y,O.y);D=H-M,l=$-j;var f=Math.ceil(M/E),V=Math.floor(H/E),P=Math.ceil(j/E),R=Math.floor($/E);Q.tx(),Q.ty(),Q._zoom;var n,K,w;for(z.save(),z.lineWidth=1,z.beginPath(),z.strokeStyle=Y,w=Math.ceil(f/W)*W;V>=w;w+=W)n=w*E,u(n,j,n,$);for(w=Math.ceil(P/W)*W;R>=w;w+=W)K=w*E,u(M,K,H,K);for(z.stroke(),z.beginPath(),z.strokeStyle=m,w=f;V>=w;w++)0!==w%W&&(n=w*E,u(n,j,n,$));for(w=P;R>=w;w++)0!==w%W&&(K=w*E,u(M,K,H,K));z.stroke(),z.restore()},Hk.prototype.getAlignmentGuides=function(){var Y=this;return{x:Y._xAlignmentGuide,y:Y._yAlignmentGuide}},Hk.prototype.addAlignmentGuide=function(r,e,f){var H=this,k="x"===r?H._xAlignmentGuide:H._yAlignmentGuide,f=f?f:++H._alignmentGuideId,d={p:e,id:f};if(k.length){var T=H._findClosestAlignmentGuide(d.p,k);T.dis<0?k.splice(T.index+1,0,d):k.splice(T.index,0,d)}else k.push(d);return H._interactor._42(),f},Hk.prototype.findClosest=function(M,B,X){var Q=this,f=Q._interactor,v=f.gv;X&&(M=pp.toWorldPosition(v,M));var E,O,Z,c=1/0,s=1/0,h=M.x,n=M.y;if(Q.gridEnabled){var l=Q.gridBlockSize,K=Q.makeMatrix(),i=K.applyInverse(M);i=K.apply({x:Math.round(i.x/l)*l,y:Math.round(i.y/l)*l}),c=i.x-h,s=i.y-n,Z=!0}if(f.alignmentGuideEnabled&&(E=Q._findClosestAlignmentGuide(h,Q._xAlignmentGuide).dis,O=Q._findClosestAlignmentGuide(n,Q._yAlignmentGuide).dis,Math.abs(E)<Math.abs(c)&&(c=E,Z=!0),Math.abs(O)<Math.abs(s)&&(s=O,Z=!0)),Z){Z=!1;var $=v._zoom,e=f.getStyle("smartGuideSensitivity")/$,N={};if(Math.abs(c)<e&&"y"!==B&&(N.x=X?c*$:c,Z=!0),Math.abs(s)<e&&"x"!==B&&(N.y=X?s*$:s,Z=!0),Z)return N}},Hk.prototype._findClosestAlignmentGuide=function(t,i){if(!i.length)return{dis:1/0};for(var u,c=0,P=i.length-1;P-c>1;)u=Math.floor((c+P)/2),i[u].p<t?c=u:P=u;var Z=i[c].p-t,U=i[P].p-t;return Math.abs(Z)<=Math.abs(U)?{line:i[c],dis:Z,index:c}:{line:i[P],dis:U,index:P}},Hk.prototype.removeAllAlignmentGuide=function(L){var U=this;"y"!==L&&(U._xAlignmentGuide=[]),"x"!==L&&(U._yAlignmentGuide=[]),U._interactor._42()},Hk.prototype.removeAlignmentGuide=function(k){for(var X,N,H,P=this,y=P._xAlignmentGuide,i=0;2>i;i++)for(y=0===i?P._xAlignmentGuide:P._yAlignmentGuide,X=0,N=y.length;N>X;X++)if(H=y[X],H.id===k)return y.splice(X,1),P._interactor._42(),{axis:0===i?"x":"y",position:H.p};return!1},Hk.prototype.adjustAlignmentGuide=function(x,C){var S=this,e=S.removeAlignmentGuide(x);return e?(S.addAlignmentGuide(e.axis,C,x),!0):!1};var Jo=pp.Guide.Rect=function(l){var B=this;B._interactor=l};Jo.prototype={},Jo.prototype.constructor=Jo,Jo.prototype.gatherRects=function(){var $,h,v,d,N=this,S=N._interactor.gv,U=[],b=[],B={x:U,y:b},W={},i=S.getDataModel(),C=i.a("width"),F=i.a("height");C&&F&&($=0,h=0,v=C,d=F,U.push({node:i,type:0,p:$},{node:i,type:1,p:$+v/2},{node:i,type:2,p:$+v}),b.push({node:i,type:0,p:h},{node:i,type:1,p:h+d/2},{node:i,type:2,p:h+d}),W[i._id||0]={x:$,y:h,width:v,height:d}),i.each(function(J){if(Lg(J)&&!S.isSelected(J)&&S.isVisible(J)){var N=!1;if(S.sm().getSelection().each(function(k){N||(J.isHostOn(k)?N=!0:J.isDescendantOf(k)&&(N=!0))}),!N){var Y=J.getRect();$=Y.x,h=Y.y,v=Y.width,d=Y.height,U.push({node:J,type:0,p:$},{node:J,type:1,p:$+v/2},{node:J,type:2,p:$+v}),b.push({node:J,type:0,p:h},{node:J,type:1,p:h+d/2},{node:J,type:2,p:h+d}),W[J._id]=Y}}}),U.sort(function(v,W){return v.p-W.p}),b.sort(function(T,_){return T.p-_.p}),N._grid=B,N._87I=W},Jo.prototype.gatherLines=function(Q,K,R){var w,p,M,c,$,L,o,r,O,l,E,s,I=this,H=[I.findClosest({x:Q.x,y:Q.y},K),I.findClosest({x:Q.x+Q.w/2,y:Q.y+Q.h/2},K),I.findClosest({x:Q.x+Q.w,y:Q.y+Q.h},K)],S={},D=I._87I;R=R||255;var u,b;for(I._guideLine=[],w=0;2>w;w++)for(S={},0===w?(c="y",r=Q.x,O=r+Q.w):(c="x",r=Q.y,O=r+Q.h),p=0;3>p;p++)$=H[p],$&&isFinite($[c])&&(u=1<<3*w+p,R&u&&(L=$[c+"Line"],o=L.node,b=o._id||0,S[b]||(S[b]=!0,s=D[b],"y"===c?(l=s.x,E=s.x+s.width):(l=s.y,E=s.y+s.height),M=L.p,I._guideLine.push({type:c,a:r,b:O,c:l,d:E,p:M}))))},Jo.prototype._binarySearchClosest=function(M,V){if(!V.length)return{dis:1/0};for(var J,w=0,e=V.length-1;e-w>1;)J=Math.floor((w+e)/2),V[J].p<M?w=J:e=J;var G=V[w].p-M,u=V[e].p-M;return Math.abs(G)<=Math.abs(u)?{line:V[w],dis:G}:{line:V[e],dis:u}},Jo.prototype.findClosest=function(l,F,P){var v=this,s=v._interactor,b=s.gv,T=v._grid;P&&(l=pp.toWorldPosition(b,l));var g,E=v._binarySearchClosest(l.x,T.x),U=v._binarySearchClosest(l.y,T.y),Z=E.dis,u=U.dis,A=b._zoom,j=s.getStyle("smartGuideSensitivity")/A,p={};return Math.abs(Z)<j&&"y"!==F&&(p.x=P?Z*A:Z,p.xLine=E.line,g=!0),Math.abs(u)<j&&"x"!==F&&(p.y=P?u*A:u,p.yLine=U.line,g=!0),g?p:void 0},Jo.prototype._42=function(){var f=this,t=f._guideLine;if(t&&!o.Default.isCtrlDown()){var F,Y,s,n,X,P,W,g,U,O,c,A,I,x,N,l,V,z=f._interactor,e=z.gv,k=z._context,G=e.tx(),r=e.ty(),b=e._zoom,L=z.getStyle("guideLineTextSpacing");for(F=0,Y=t.length;Y>F;F++)s=t[F],g=s.type,U=s.p,O=s.a,c=s.b,A=s.c,I=s.d,x=Math.min(O,A),N=Math.max(c,I),"x"===g?(n=U*b+G,X=x*b+r,P=n,W=N*b+r):(n=x*b+G,X=U*b+r,P=N*b+G,W=X),pp.Icons.DrawIcon(z,k,pp.Icons.MoveLineGuide,[n,X,P,W]),I>=O&&c>=A||(x=O>I?I:c,N=O>I?O:A,V=N-x,"x"===g?(s.center2center||(n-=L,P=n),X=x*b+r,W=N*b+r,l=pp.Icons.MoveLineGuideDistanceV):"y"===g&&(s.center2center||(X-=L,W=X),n=x*b+G,P=N*b+G,l=pp.Icons.MoveLineGuideDistanceH),pp.Icons.DrawIcon(z,k,l,{x0:n,y0:X,x1:P,y1:W,dis:V}))}},Jo.prototype.clear=function(){this._guideLine=null},pp.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:32,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:"#707070",shapeCtrlPointHighlightBorder:"black",shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var On=pp.Icons={},Qr=1e4,jl=null,ok=8;o.Default.setImage("Icons.RectPoint",{width:ok,height:ok,comps:[{type:"shape",points:[0,0,0,ok,ok,ok,ok,0],segments:[1,2,2,2,5],shadow:!0,borderWidth:1,shadowColor:{func:function(){return jl.getStyle("rectPointShadowColor")}},background:{func:function(){return jl.getStyle("rectPointBackground")}},borderColor:{func:function(){return jl.getStyle("rectPointBorderColor")}}}]});var Ei="#e000e0";On.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var c=On.GroupSubEntityRect.data;if(!c)return[];var Z=c.min,o=c.max;return[Z.x,Z.y,Z.x,o.y,o.x,o.y,o.x,Z.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return On.GroupSubEntityRect.data.isKeyOb?Ei:"#666666"}}}]},On.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[On.Line.data.P1.x,On.Line.data.P1.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[On.Line.data.P2.x,On.Line.data.P2.y],ok,ok]}}}]},On.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return On.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},On.Rect={comps:[{type:"shape",points:{func:function(){var j=On.Rect.data;if(!j)return[];var O=j.LT,d=j.LB,E=j.RB,V=j.RT;return[O.x,O.y,d.x,d.y,E.x,E.y,V.x,V.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#666666"},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return On.Rect.data.rotation}},rect:{func:function(){return[[On.Rect.data.LT.x,On.Rect.data.LT.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return On.Rect.data.rotation}},rect:{func:function(){return[[On.Rect.data.LB.x,On.Rect.data.LB.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return On.Rect.data.rotation}},rect:{func:function(){return[[On.Rect.data.RB.x,On.Rect.data.RB.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return On.Rect.data.rotation}},rect:{func:function(){return[[On.Rect.data.RT.x,On.Rect.data.RT.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return On.Rect.data.rotation}},visible:{func:function(){return On.Rect.data.L?!0:!1}},rect:{func:function(){return[[On.Rect.data.L.x,On.Rect.data.L.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return On.Rect.data.rotation}},visible:{func:function(){return On.Rect.data.R?!0:!1}},rect:{func:function(){return[[On.Rect.data.R.x,On.Rect.data.R.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return On.Rect.data.rotation}},visible:{func:function(){return On.Rect.data.T?!0:!1}},rect:{func:function(){return[[On.Rect.data.T.x,On.Rect.data.T.y],ok,ok]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return On.Rect.data.rotation}},visible:{func:function(){return On.Rect.data.B?!0:!1}},rect:{func:function(){return[[On.Rect.data.B.x,On.Rect.data.B.y],ok,ok]}}}]};var No=18;o.Default.setImage("Icons.Anchor",{width:No,height:No,comps:[{type:"arc",rect:[4,4,No-8,No-8],arcFrom:0,arcClose:!1,background:"#ffffff",borderWidth:0,borderColor:"#000000"},{type:"shape",points:[2,No/2,No-2,No/2,No/2,2,No/2,No-2],segments:[1,2,1,2],background:null,borderWidth:1,borderColor:"#111111"},{type:"arc",rect:[5.5,5.5,No-11,No-11],arcFrom:0,arcClose:!1,background:null,borderWidth:1,borderColor:"#111111"}]}),On.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[On.Anchor.data.POS.x,On.Anchor.data.POS.y],No,No]}}}]},On.TipShiftX=12,On.TipShiftY=12;var Xb=[8,28];On.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[On.TipHelper.data.helperPos.x,On.TipHelper.data.helperPos.y,Xb[0]*On.TipHelper.data.size,Xb[1]]}},background:{func:function(){return jl.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return On.TipHelper.data.text}},rect:{func:function(){return[On.TipHelper.data.helperPos.x,On.TipHelper.data.helperPos.y,Xb[0]*On.TipHelper.data.size,Xb[1]]}},color:{func:function(){return jl.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var We=7;On.ShapePoint={comps:[{type:"circle",rect:{func:function(){var x=On.ShapePoint.data;return[x,We,We]}},background:"#ffffff",borderWidth:1,borderColor:"#333333"}]},On.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return On.ShapeBgCurve.data.P}},segments:{func:function(){return On.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:"#333333"}]};var Vf=8;On.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var q=On.ShapeHighlighPoint.data;return[[q.x,q.y],Vf,Vf]}},background:{func:function(){return jl.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var re=10;On.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var N=On.ShapeHighlighRealPoint.data;return[[N.x,N.y],re,re]}},background:"#ffffff",borderWidth:2,borderColor:"#333333"}]};var Em=8;On.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var s=On.ShapeHighlighCtrlPoint.data,h=s.x,r=s.y,_=Em/2;return[h-_,r-_,h-_,r+_,h+_,r+_,h+_,r-_]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return jl.getStyle("shapeCtrlPointBorderColor")}}}]};var Di=3;On.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return On.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Di,borderColor:{func:function(){return jl.getStyle("curveHighlightColor")}}}]},On.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return On.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"red"}]},On.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return On.MoveLineGuide.data}},background:null,borderWidth:1,borderColor:"red"}]};var Ki=5;On.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var s=On.MoveLineGuideDistanceH.data,n=s.x0,S=s.y0,D=s.x1,G=s.y1;return[n,S,D,G,n,S-Ki,n,S+Ki,D,G-Ki,D,G+Ki]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(On.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var l=On.MoveLineGuideDistanceH.data;return[[(l.x0+l.x1)/2,l.y0-10],20,20]}},color:"red",font:"12px Arial",align:"center"}]},On.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var $=On.MoveLineGuideDistanceV.data,U=$.x0,Q=$.y0,s=$.x1,o=$.y1;return[U,Q,s,o,U-Ki,Q,U+Ki,Q,s-Ki,o,s+Ki,o]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(On.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var l=On.MoveLineGuideDistanceV.data;return[[l.x0-10,(l.y0+l.y1)/2],20,20]}},color:"red",font:"12px Arial",align:"center"}]},o.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),On.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var i=On.EdgeElevationGuide.data,W=i.x,t=i.y,c=jl.getStyle("curveElevationIntersectSize"),m=jl.getStyle("curveElevationGuideShift");return W+=m[0],t+=m[1],[W-c,t-c,2*c,2*c]}}}]},o.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),o.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),On.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return On.ConnectGuide.data.rotation}},rect:{func:function(){var d=On.ConnectGuide.data.connect;d.x,d.y;var B=jl.getStyle("connectGuideIntersectSize");return[[d.x,d.y],2*B,2*B]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var W=On.ConnectGuide.data.cursorPos||On.ConnectGuide.data.connect,Z=jl.getStyle("connectGuideIntersectSize");return[[W.x,W.y],2*Z-2,2*Z-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var $=On.ConnectGuide.data.connect,E=On.ConnectGuide.data.cursorPos||$;return[$.x,$.y,$.x+.5*(E.x-$.x),$.y,E.x+.5*($.x-E.x),E.y,E.x,E.y]}}}]},o.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),o.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),On.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var t=On.ConnectGuideGarbage.data.hover;return t?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var n=On.ConnectGuideGarbage.data,M=jl.getStyle("connectGuideGarbageIntersectsize");return n.hover&&(M+=5),[[n.x,n.y],2*M,2*M]}}}]};var zl=6;On.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return On.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Z=On.ShapeActivingCtrl.data;return[Z.point.x,Z.point.y,Z.c1.x,Z.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return On.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var g=On.ShapeActivingCtrl.data;return[g.point.x,g.point.y,g.c2.x,g.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return On.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var I=On.ShapeActivingCtrl.data.c1,U=I.x,u=I.y,W=zl/2;return"c1"===On.ShapeActivingCtrl.data.hl&&(W+=.5),[U-W,u-W,U-W,u+W,U+W,u+W,U+W,u-W]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===On.ShapeActivingCtrl.data.hl?jl.getStyle("shapeCtrlPointHighlightBorder"):jl.getStyle("shapeCtrlPointBorderColor")}}},{type:"shape",visible:{func:function(){return On.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var U=On.ShapeActivingCtrl.data.c2,d=U.x,r=U.y,K=zl/2;return"c2"===On.ShapeActivingCtrl.data.hl&&(K+=.5),[d-K,r-K,d-K,r+K,d+K,r+K,d+K,r-K]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return jl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===On.ShapeActivingCtrl.data.hl?jl.getStyle("shapeCtrlPointHighlightBorder"):jl.getStyle("shapeCtrlPointBorderColor")}}}]},pp.Icons.DrawIcon=function(Q,s,k,Y){k.width=k.height=Qr,k.data=Y,jl=Q,o.Default.drawImage(s,k,0,0,Qr,Qr)},pp.Icons.MapPoints=function(S,m){for(var j=0,W=S.length;W>j;j++)S[j]/=m},pp.roundTo=function(X,B,j){var I=Math.abs(X%B);return j>I||j>B-I?B*Math.round(X/B):X},pp.toFixed=function(_){return Math.round(100*_)/100},pp.getDataMatrix=function(m){if(m instanceof o.Shape){var n=new pp.Math.Matrix2,s=m.getPosition();return n.translate(-s.x,-s.y).scale(m.getScale().x,m.getScale().y).rotate(m.getRotation()).translate(s.x,s.y),n}return m.getMatrix?m.getMatrix():new pp.Math.Matrix2},Math.sign===Y&&(Math.sign=function(m){return 0>m?-1:m>0?1:+m});var Vb=pp.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};Vb.prototype={},Vb.prototype.constructor=Vb,Vb.prototype.set=function(w,F,S,r,n,c){return this.a=w,this.b=F,this.c=S,this.d=r,this.tx=n,this.ty=c,this},Vb.prototype.apply=function(Y,N){N=N||new em;var M=Y.x,J=Y.y;return N.x=this.a*M+this.c*J+this.tx,N.y=this.b*M+this.d*J+this.ty,N},Vb.prototype.applyInverse=function(l,P){P=P||new em;var J=1/(this.a*this.d+this.c*-this.b),Y=l.x,t=l.y;return P.x=this.d*J*Y+-this.c*J*t+(this.ty*this.c-this.tx*this.d)*J,P.y=this.a*J*t+-this.b*J*Y+(-this.ty*this.a+this.tx*this.b)*J,P},Vb.prototype.translate=function(J,R){return this.tx+=J,this.ty+=R,this},Vb.prototype.scale=function(g,q){return this.a*=g,this.d*=q,this.c*=g,this.b*=q,this.tx*=g,this.ty*=q,this},Vb.prototype.rotate=function(G){var h=Math.cos(G),O=Math.sin(G),Q=this.a,d=this.c,m=this.tx;return this.a=Q*h-this.b*O,this.b=Q*O+this.b*h,this.c=d*h-this.d*O,this.d=d*O+this.d*h,this.tx=m*h-this.ty*O,this.ty=m*O+this.ty*h,this},Vb.prototype.append=function(T){var Q=this.a,L=this.b,I=this.c,i=this.d;return this.a=T.a*Q+T.b*I,this.b=T.a*L+T.b*i,this.c=T.c*Q+T.d*I,this.d=T.c*L+T.d*i,this.tx=T.tx*Q+T.ty*I+this.tx,this.ty=T.tx*L+T.ty*i+this.ty,this},Vb.prototype.setTransform=function(o,I,q,k,c,t,n,l,$){var A,L,B,r,h,J,C,f,M,X;return h=Math.sin(n),J=Math.cos(n),C=Math.cos($),f=Math.sin($),M=-Math.sin(l),X=Math.cos(l),A=J*c,L=h*c,B=-h*t,r=J*t,this.a=C*A+f*B,this.b=C*L+f*r,this.c=M*A+X*B,this.d=M*L+X*r,this.tx=o+(q*A+k*B),this.ty=I+(q*L+k*r),this},Vb.prototype.prepend=function(U){var p=this.tx;if(1!==U.a||0!==U.b||0!==U.c||1!==U.d){var L=this.a,I=this.c;this.a=L*U.a+this.b*U.c,this.b=L*U.b+this.b*U.d,this.c=I*U.a+this.d*U.c,this.d=I*U.b+this.d*U.d}return this.tx=p*U.a+this.ty*U.c+U.tx,this.ty=p*U.b+this.ty*U.d+U.ty,this},Vb.prototype.invert=function(){var $=this.a,V=this.b,s=this.c,O=this.d,I=this.tx,n=$*O-V*s;return this.a=O/n,this.b=-V/n,this.c=-s/n,this.d=$/n,this.tx=(s*this.ty-O*I)/n,this.ty=-($*this.ty-V*I)/n,this},Vb.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Vb.prototype.clone=function(){var S=new Vb;return S.a=this.a,S.b=this.b,S.c=this.c,S.d=this.d,S.tx=this.tx,S.ty=this.ty,S},Vb.prototype.copy=function(B){return B.a=this.a,B.b=this.b,B.c=this.c,B.d=this.d,B.tx=this.tx,B.ty=this.ty,B},Vb.IDENTITY=new Vb,Vb.TEMP_MATRIX=new Vb;var em=pp.Math.Vector2=function(U,x,o){"object"==typeof U&&(U.x!=Y?(x=U.y,U=U.x,o=U.e):(o=U[2],x=U[1],U=U[0])),this.set(U||0,x||0,o)};em.prototype={},em.prototype.constructor=em,u.defineProperties(em.prototype,{width:{get:function(){return this.x},set:function(S){this.x=S}},height:{get:function(){return this.y},set:function(I){this.y=I}}}),em.prototype.clone=function(){return new em(this.x,this.y,this.e)},em.prototype.copy=function(s){return this.set(s.x,s.y,s.e),this},em.prototype.equals=function(q){return q.x===this.x&&q.y===this.y},em.prototype.set=function(Q,h,g){return this.x=Q||0,this.y=h||(0!==h?this.x:0),g!=Y&&(this.e=g),this},em.prototype.setScalar=function(X){return this.x=X,this.y=X,this},em.prototype.setX=function(P){return this.x=P||0,this},em.prototype.setY=function(I){return this.y=I||0,this},em.prototype.add=function(J){return this.x+=J.x,this.y+=J.y,this},em.prototype.addVectors=function(p,u){return this.x=p.x+u.x,this.y=p.y+u.y,this},em.prototype.addScalar=function(I){return this.x+=I,this.y+=I,this},em.prototype.addScaledVector=function(J,l){return this.x+=J.x*l,this.y+=J.y*l,this},em.prototype.sub=function(O){return this.x-=O.x,this.y-=O.y,this},em.prototype.subScalar=function(r){return this.x-=r,this.y-=r,this},em.prototype.subVectors=function(A,u){return this.x=A.x-u.x,this.y=A.y-u.y,this},em.prototype.multiply=function(y){return this.x*=y.x,this.y*=y.y,this},em.prototype.multiplyScalar=function(g){return this.x*=g,this.y*=g,this},em.prototype.divide=function(J){return this.x/=J.x,this.y/=J.y,this},em.prototype.divideScalar=function(_){return this.multiplyScalar(1/_)},em.prototype.min=function(O){return this.x=Math.min(this.x,O.x),this.y=Math.min(this.y,O.y),this},em.prototype.max=function(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this},em.prototype.clamp=function(U,n){return this.x=Math.max(U.x,Math.min(n.x,this.x)),this.y=Math.max(U.y,Math.min(n.y,this.y)),this},em.prototype.clampScalar=function(){var b,s;return function(c,A){return b===Y&&(b=new em,s=new em),b.set(c,c),s.set(A,A),this.clamp(b,s)}}(),em.prototype.clampLength=function(E,u){var g=this.length();return this.multiplyScalar(Math.max(E,Math.min(u,g))/g)},em.prototype.dot=function(M){return this.x*M.x+this.y*M.y},em.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},em.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},em.prototype.normalize=function(){return this.divideScalar(this.length())},em.prototype.angle=function(){var f=Math.atan2(this.y,this.x);return 0>f&&(f+=2*Math.PI),f},em.prototype.distanceTo=function(B){return Math.sqrt(this.distanceToSquared(B))},em.prototype.distanceToSquared=function(e){var Y=this.x-e.x,f=this.y-e.y;return Y*Y+f*f},em.prototype.isNearEnough=function(k){return this.distanceToSquared(k)<1e-8},em.prototype.setLength=function($){return this.multiplyScalar($/this.length())},em.prototype.lerp=function(T,i){return this.x+=(T.x-this.x)*i,this.y+=(T.y-this.y)*i,this},em.prototype.lerpVectors=function(J,L,X){return this.subVectors(L,J).multiplyScalar(X).add(J)},em.prototype.rotateAround=function(B,K){var w=Math.cos(K),t=Math.sin(K),n=this.x-B.x,F=this.y-B.y;return this.x=n*w-F*t+B.x,this.y=n*t+F*w+B.y,this};var mk=pp.Math.Curve=function(){this._curves=[]};mk.prototype={},mk.prototype.constructor=mk,mk.prototype.createFromHtShape=function(g,j,e){j instanceof o.List&&(j=j.toArray());var r,f,_,M,T,y,I,J=this,Z=null,p=null,a=0,D=pp.Math.Vector2,A=pp.Math.CubicBezier,q=function(Z){return new D(g[Z],g[Z+1],e?e[Z/2]:Y)};for(f=0,_=j.length;_>f;f++){switch(M=j[f],T=null,M){case 1:p=q(a),Z=p,a+=2;break;case 2:r=q(a),a+=2,T=new A(p,p.clone(),r.clone(),r),p=r;break;case 3:y=q(a),r=q(a+2),a+=4,T=new A(p,y.clone().sub(p).multiplyScalar(2/3).add(p),y.clone().sub(r).multiplyScalar(2/3).add(r),r),p=r;break;case 4:y=q(a),I=q(a+2),r=q(a+4),a+=6,T=new A(p,y,I,r),p=r;break;case 5:if(!Z)break;T=new A(p,p.clone(),Z.clone(),Z),p=null,Z=null}T&&(T._index=J._curves.length,J._curves.push(T))}},mk.prototype.checkPoint=function(T,d){var Z,Q,x,O,A,$=this,R=$._curves;for(Z=0,Q=R.length;Q>Z;Z++)if(O=R[Z],A=O.intersectRect(T,d,d),A.length)return x=0,A.forEach(function(W){x+=W.t}),x/=A.length,T=O.getPointAt(x),T.t=x,{bezier:O,intersection:T}},mk.prototype.insertKnot=function(c,y){var f=c.insertKnot(y),k=this,o=k._curves;o.splice(c._index,1,f[0],f[1])},mk.prototype._isCloseEnough=function(L,N){return Math.abs(L.x-N.x)<1e-6&&Math.abs(L.y-N.y)<1e-6},mk.prototype._isSamePoint=function(I,w){return I===w},mk.prototype.moveRealPoint=function(R,O){var F=this,E=F._curves,b=O.clone().sub(R);E.forEach(function(I){var t=I._p1;I._p2,I._p3;var u=I._p4;F._isSamePoint(t,R)&&(I._p2.add(b),I._p1=O),F._isSamePoint(u,R)&&(I._p3.add(b),I._p4=O)})},mk.prototype.moveCtrlDueToRealPointMovement=function(L,r){var q=this,u=q._curves,i=function(h){h.add(r),h.e&&r.e&&(h.e+=r.e)};u.forEach(function(U){var A=U._p1;U._p2,U._p3;var B=U._p4;q._isSamePoint(A,L)&&i(U._p2),q._isSamePoint(B,L)&&i(U._p3)})},mk.prototype.moveCtrlPoint=function(I,c,M){var O=I[M];if(O){O.e!==Y&&(c.e=O.e);var d=this,T=d._curves;c.clone().sub(O),T.forEach(function(S){var X;"c2"===M?X="_p2":"c1"===M&&(X="_p3"),d._isSamePoint(S[X],O)&&(S[X]=c)}),I[M]=c}},mk.prototype.deleteRealPoint=function(v,$){var D,m,_,K,o,S,X,A=this,s=A._curves,e={},w=[],j=pp.Math.CubicBezier;for(m=0,_=s.length;_>m;m++)D=s[m],K=D._p1,o=D._p2,S=D._p3,X=D._p4,(e[m]||!A._isSamePoint(K,v))&&(A._isSamePoint(X,v)?_>m+1&&A._isSamePoint(s[m+1]._p1,v)&&($||w.push(new j(K,o,s[m+1]._p3,s[m+1]._p4))):w.push(D));A._curves=w},mk.prototype.findPairs=function(y,E){var u,C,T,c,t,S,B,x,K=this,v=K._curves,L={},P=[];for(C=0,T=v.length;T>C;C++)u=v[C],c=u._p1,t=u._p2,S=u._p3,B=u._p4,!L[C]&&K._isSamePoint(c,y)&&(E?P.push({point:c,r2:B}):P.push({point:c,c2:t})),K._isSamePoint(B,y)&&(x=E?{point:B,r1:c}:{point:B,c1:S},T>C+1&&K._isSamePoint(v[C+1]._p1,y)&&(E?x.r2=v[C+1]._p4:x.c2=v[C+1]._p2,L[C+1]=!0),P.push(x));return P},mk.prototype.toHtShape=function(){var p=this,L=p._curves,l=[],s=[],Z={x:1/0,y:1/0};return L.forEach(function(W){var U=W._p1,n=W._p2,u=W._p3,T=W._p4;return p._isCloseEnough(U,Z)||(l.push(1),s.push(U.clone())),Z=T,p._isCloseEnough(U,n)&&p._isCloseEnough(u,T)?(l.push(2),s.push(T.clone()),void 0):(l.push(4),s.push(n.clone(),u.clone(),T.clone()),void 0)}),{segments:l,points:s}};var bs=pp.Math.CubicBezier=function(y,v,z,m){var c=this;c._id=pp.Math.CubicBezier._globalId++,c._p1=y,c._p2=v,c._p3=z,c._p4=m};bs._globalId=1,bs.prototype={},bs.prototype.constructor=bs,bs.prototype.toString=function(){return this._id},bs.prototype.intersectRect=function(A,l,P){var U=l/2,$=P/2,v=A.x,t=A.y,s=pp.Math.Vector2,x=new s(-U+v,-$+t),p=new s(U+v,$+t),Q=new s(p.x,x.y),V=new s(x.x,p.y),R=this,S=R.intersectLine(x,Q),k=R.intersectLine(Q,p),u=R.intersectLine(p,V),C=R.intersectLine(V,x),m=S.concat(k).concat(u).concat(C);return m},bs.prototype.intersectLine=function(R,I){var J,_,p,z,i,d,f,L,j,a,q,K,Q,U=this,c=R.clone().min(I),E=R.clone().max(I);z=U._p1,i=U._p2,d=U._p3,f=U._p4,J=z.clone().multiplyScalar(-1),_=i.clone().multiplyScalar(3),p=d.clone().multiplyScalar(-3),q=J.add(_).add(p).add(f),J=z.clone().multiplyScalar(3),_=i.clone().multiplyScalar(-6),p=d.clone().multiplyScalar(3),a=J.add(_).add(p),J=z.clone().multiplyScalar(-3),_=i.clone().multiplyScalar(3),j=J.add(_),L=z.clone(),Q=new pp.Math.Vector2(R.y-I.y,I.x-R.x),K=R.x*I.y-I.x*R.y;for(var W=U.getRoots(Q.dot(q),Q.dot(a),Q.dot(j),Q.dot(L)+K),k=new Array,Y=0,Z=W.length;Z>Y;Y++){var H=W[Y];if(!(0>H||H>1)){var u=z.clone().lerp(i,H),P=i.clone().lerp(d,H),V=d.clone().lerp(f,H),O=u.lerp(P,H),N=P.lerp(V,H),h=O.lerp(N,H);h.t=H,R.x==I.x?c.y<=h.y&&h.y<=E.y&&k.push(h):R.y==I.y?c.x<=h.x&&h.x<=E.x&&k.push(h):h.x>=c.x&&h.y>=c.y&&h.x<=E.x&&h.y<=E.y&&k.push(h)}}return k},bs.prototype.solveTForPoint=function(D){var y,A,J,t,g=this;y=g._p1.x-D.x,A=g._p2.x-D.x,J=g._p3.x-D.x,t=g._p4.x-D.x;for(var i=g.getRoots(t-3*J+3*A-y,3*J-6*A+3*y,3*A-3*y,y),O=Y,L=1/0,l=0,F=i.length;F>l;l++){var I=i[l];if(!(0>I||I>1)){var p=g._p1.clone().lerp(g._p2,I),W=g._p2.clone().lerp(g._p3,I),H=g._p3.clone().lerp(g._p4,I),b=p.lerp(W,I),k=W.lerp(H,I),c=b.lerp(k,I);
c.t=I;var U=Math.abs(c.y-D.y);L>U&&(L=U,O=c)}}return O},bs.prototype.getPointAt=function($){var m=this,f=m._p1,M=m._p2,B=m._p3,q=m._p4,u=f.clone().lerp(M,$),T=M.clone().lerp(B,$),s=B.clone().lerp(q,$),G=u.lerp(T,$),X=T.lerp(s,$);return G.lerp(X,$)},bs.prototype.getRoots=function(I,o,s,q){var L,Y,x,K,g,c=new Array;if(Math.abs(I)<1e-6){var L=o,Y=s/L,x=q/L,K=Y*Y-4*x;if(K>0){var g=Math.sqrt(K);c.push(.5*(-Y+g)),c.push(.5*(-Y-g))}else 0==K&&c.push(.5*-Y)}o/=I,s/=I,q/=I,L=(3*s-o*o)/3,Y=(2*o*o*o-9*s*o+27*q)/27;var v=o/3,t=Y*Y/4+L*L*L/27,N=Y/2;if(Math.abs(t)<=1e-6&&(t=0),t>0){var $,m,g=Math.sqrt(t);$=-N+g,m=$>=0?Math.pow($,1/3):-Math.pow(-$,1/3),$=-N-g,$>=0?m+=Math.pow($,1/3):m-=Math.pow(-$,1/3),c.push(m-v)}else if(0>t){var R=Math.sqrt(-L/3),k=Math.atan2(Math.sqrt(-t),-N)/3,M=Math.cos(k),n=Math.sin(k),A=Math.sqrt(3);c.push(2*R*M-v),c.push(-R*(M+A*n)-v),c.push(-R*(M-A*n)-v)}else{var $;$=N>=0?-Math.pow(N,1/3):Math.pow(-N,1/3),c.push(2*$-v),c.push(-$-v)}return c},bs.prototype._70I=function(){var V=this;return V._p1.distanceToSquared(V._p2)<1e-10&&V._p3.distanceToSquared(V._p4)<1e-10},bs.prototype.insertKnot=function(w){var P=this,H=P._p1,g=P._p2,c=P._p3,o=P._p4,G=H.clone().lerp(g,w),O=g.clone().lerp(c,w),f=c.clone().lerp(o,w),b=G.clone().lerp(O,w),I=O.clone().lerp(f,w),Z=b.clone().lerp(I,w);return P._70I()?(H.clone().lerp(o,w),[new pp.Math.CubicBezier(H,H.clone(),Z.clone(),Z),new pp.Math.CubicBezier(Z,Z.clone(),o.clone(),o)]):[new pp.Math.CubicBezier(H,G,b,Z),new pp.Math.CubicBezier(Z,I,f,o)]};var Vi=o.Default.getInternal().ui().EdgeUI,Th={_47O:function(e){var j=this,r=Th.getBackups()._47O;pp.inEdit(j.gv)||r.call(j,e)}};pp.Inject.registAsModule(Th,Vi);var br=o.Default.getInternal().ui().NodeUI,es={_47O:function(y){var X=this,H=es.getBackups()._47O;pp.inEdit(X.gv)||H.call(X,y)},getSelectWidth:function(){var L=this,A=L.gv,v=L._data;if(A.isEditable(v)&&pp.inEdit(A))return 0;var C=es.getBackup("getSelectWidth");return C.call(L)}};pp.Inject.registAsModule(es,br);var Rg=o.graph.GraphView,cc={_editPointSize:function(){var C=o.Default.isTouchable,n=pp.getStyle("pointSize");return n[C?0:1]}(),isPointEditable:function(w){var T=this;if(pp.inEdit(T))return T._pointEditableFunc?T._pointEditableFunc(w):!0;var r=cc.getBackup("isPointEditable");r.call(T,w)},isEditable:function(U){var M,A=this,L=cc.getBackup("isEditable");if(M=U instanceof pp.Group?!0:L.call(A,U),!pp.inEdit(A))return M;if(!(U instanceof o.Edge))return M;if(!U.s("2d.editable"))return!1;var e=A.getEditableFunc();return e?e(U):!0},_42:function(g,M){var r=this,o=cc.getBackups()._42;if(o.call(r,g,M),pp.inEdit(r)){var P=r.getEditInteractor();P.drawImpl()}}};pp.Inject.registAsModule(cc,Rg);var Kc=o.Default.getInternal().ui().ShapeUI,nj={_47O:function(h){var l=this,m=nj.getBackups()._47O;pp.inEdit(l.gv)||m.call(l,h)}};pp.Inject.registAsModule(nj,Kc);var Gh=o.graph.DefaultInteractor,Om={handle_mousewheel:function($){var c=this,H=Om.getBackup("handle_mousewheel");pp.inEdit(c.gv)||H.call(c,$)}};pp.Inject.registAsModule(Om,Gh);var Ep=o.graph.MoveInteractor,Wo={_calcShift:function(s,c){var I=this,D=Wo.getBackup("_calcShift"),f=I.gv;if(!pp.inEdit(f))return D.call(I,s,c);var X=f.getEditInteractor(),g=X.getSubModule("Move").calcShift(s,c,I);return g||D.call(I,s,c)},clear:function(v){var G=this,Y=Wo.getBackup("clear");Y.call(G,v);var m=G.gv;if(pp.inEdit(m)){var o=m.getEditInteractor();o.getSubModule("Move").clear(v)}}};pp.Inject.registAsModule(Wo,Ep);var Jo=pp.Rect=function(b){this.catalog="Rect",this._interactor=b};Jo.prototype={},Jo.prototype.constructor=Jo,Jo.prototype.gatherInfo=function(d,X){var x=this;if(1===X.length){var _=X[0];return _ instanceof o.Shape&&_._70I()?x.gatherLine(d,_):Dq(_,d)?!1:x.gatherSingleTarget(d,_)}return X.length>1?x.gatherMultiTargets(d,X):!1},Jo.prototype.gatherSingleTarget=function(V,H){if(H.getCorners){var s,A=this,X=A.info;A.target=H,s=A.screenInfo={};var n=H.getCorners();X.LT=new pp.Math.Vector2(n[0]),X.LB=new pp.Math.Vector2(n[1]),X.RB=new pp.Math.Vector2(n[2]),X.RT=new pp.Math.Vector2(n[3]),X.T=X.LT.clone().add(X.RT).divideScalar(2),X.B=X.LB.clone().add(X.RB).divideScalar(2),X.L=X.LT.clone().add(X.LB).divideScalar(2),X.R=X.RT.clone().add(X.RB).divideScalar(2);for(var C in X)s[C]=pp.toScreenPosition(V,X[C]);var $=A._interactor,Y=$.getStyle("checkSize"),T=function(I,w,U){var E=w.clone().sub(I).setLength(-Y),y=U.clone().sub(I).setLength(-Y),p=E.add(y).add(I);return p};return s.rotLT=T(s.LT,s.RT,s.LB),s.rotLB=T(s.LB,s.LT,s.RB),s.rotRB=T(s.RB,s.LB,s.RT),s.rotRT=T(s.RT,s.LT,s.RB),s.rotT=s.rotLT.clone().add(s.rotRT).divideScalar(2),s.rotB=s.rotLB.clone().add(s.rotRB).divideScalar(2),s.rotL=s.rotLT.clone().add(s.rotLB).divideScalar(2),s.rotR=s.rotRT.clone().add(s.rotRB).divideScalar(2),s.rotation=H.getRotation(),A.gatherConnectInfo(),!0}},Jo.prototype.gatherConnectInfo=function(){var M=this,S=M.target,d=M._interactor,N=M.screenInfo,Y=d.gv;if(S instanceof o.Node&&d.getStyle("connectGuideVisible")){var G=S.s("connectGuideShift")||d.getStyle("connectGuideShift"),q=S.getAnchor(),u=S.getSize(),K=S.toGlobal({x:u.width*(G[0]-q.x),y:u.height*(G[1]-q.y)});K=pp.toScreenPosition(Y,K),N.P1?K.add(N.P2.clone().sub(N.P1).setLength(G[2])):(K.add(N.RT.clone().sub(N.LT).setLength(G[2])),K.add(N.LB.clone().sub(N.LT).setLength(G[3]))),N.connect=K}},Jo.prototype.gatherMultiTargets=function(b,c){var O=pp.Group.findOrCreateGroup(c);if(!O)return!1;var h=this;return h.editing&&"rotate"!==h.editing.mode||O.calcInfo(),h.gatherSingleTarget(b,O)},Jo.prototype.gatherLine=function(l,E){this.target=E;var o=this.screenInfo={},q=E.getPoints(),n=pp.getDataMatrix(E);return o.P1=pp.toScreenPosition(l,n.apply(q.get(0))),o.P2=pp.toScreenPosition(l,n.apply(q.get(1))),this.gatherConnectInfo(),!0},Jo.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Jo.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Jo.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Jo.prototype.check=function(s,S,O){if(o.Default.isLeftButton(S)){var k=this;if(k.editing=null,k.tipInfo=null,k.screenInfo){var y=k.target,D=s.isEditable(y),E=k.screenInfo;if(D&&E.connect){var u=k._checkConnect(O);if(u)return u}if(E.P1)return k._checkLine(O);var A,N,K,h=null,z=k._interactor,M=z.getStyle("checkSize");if(D&&s.isRectEditable(y))for(N=0;N<pp.Rect.ResizeKeys.length;N++)if(K=pp.Rect.ResizeKeys[N],pp.checkHit(O,E[K],M)){h=K,A="resize";break}if(!h&&D&&s.isRotationEditable(y)){var U=z.getStyle("rotateCheckSize");for(N=0;N<pp.Rect.RotateKeys.length;N++)if(K=pp.Rect.RotateKeys[N],pp.checkHit(O,E[K],U)){h=K,A="rotate";break}}if(!h)return z.setCursor("default"),void 0;if("rotate"===A){var X,l=s.lp(S);if(y instanceof pp.Group){var b=z.getStyle("groupRotateModeKey");"string"==typeof b&&(b=[b]);for(var G=!1,C=0,m=b.length;m>C;C++)if(S[b[C]]){G=!0;break}var W=z.getStyle("groupRotateModeDefault");X=G?"batch"===W?"block":"batch":W}var _="batch"===X?y.getAnchor2():y.getPosition(),t=Math.atan2(l.y-_.y,l.x-_.x);z._setRotateCursor(t),k.editing={mode:A,key:h,pos:_,flipY:y.getScale().y<0,rotation:y.getRotation(),hitRot:t},X&&(k.editing.groupRotateMode=X)}else{var B=pp.Rect.ResizeKeys.indexOf(h),Y=pp.Rect.ResizeDirection[B],i=Math.cos(y.getRotation()),Z=Math.sin(y.getRotation()),I=Y.x*Math.sign(y.getScale().x),g=Y.y*Math.sign(y.getScale().y),r=Math.atan2(-Z*I-i*g,i*I-Z*g),a=(Math.round(r/(Math.PI/4))+8)%8,d=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][a];this._interactor.setCursor(d);var H=y.getWidth(),V=y.getHeight(),P=y.getAnchor();k.editing={mode:A,key:h,rect:{x:-H*P.x,y:-V*P.y,width:H,height:V},anchor:P,matrix:y.getMatrix()}}return h}}},Jo.prototype._checkLine=function(m){var T=this;T.screenInfo;var D,O=T._interactor.getStyle("checkSize");if(pp.checkHit(m,T.screenInfo.P1,O))D="P1";else{if(!pp.checkHit(m,T.screenInfo.P2,O))return this._interactor.setCursor("default"),void 0;D="P2"}return T.editing={mode:"line",key:D},D},Jo.prototype._checkConnect=function(S){var e=this,B=e.screenInfo,n=e._interactor,f=n.getStyle("connectGuideIntersectSize");if(pp.checkHit(S,B.connect,f)){var J="connect",Y=b.getConnectAction();return e.editing={mode:J},Y&&Y.delete&&Y.delete.visible.call(null,e.target)&&(e.editing.hasDeleteAction=!0),n.setCursor("default"),J}},Jo.prototype._fireEditEvent=function(T,i){var c=this._interactor,S=this.editing;if(S){var j=S.mode;j="rotate"===j?"Rotation":"connect"===j?"Connection":j[0].toUpperCase()+j.slice(1),c.fi({kind:T+"Edit"+j,event:i})}},Jo.prototype.startEdit=function(Y,N){Y.startDragging(N);var w=this;w._interactor.fi({kind:"prepareEdit",event:N});var j=w.editing,U=w.target;if(j){if(w._fireEditEvent("begin",N),"rotate"===j.mode)return j.groupRotateMode&&U.beginRotate(j),void 0;if("connect"!==j.mode)("line"===j.mode||U&&0===U.getRotation())&&(w._inSmartGuide=!0,w._interactor.rectGuide.gatherRects());else if(j.hasDeleteAction){var F=Y.gv,g=w._interactor.getStyle("connectGuideGarbageShift");j.garbageInfo={x:F.getWidth()*g[0]+g[2],y:F.getHeight()*g[1]+g[3],size:w._interactor.getStyle("connectGuideGarbageIntersectsize")},Y._42()}}},Jo.prototype._46O=function(a){var Z,v=this,H=v.editing;if(H){if("connect"===H.mode&&!H.canceled&&!H.deleted)try{H.garbageInfo&&H.garbageInfo.hover?b.doDeleteConnectionAction(v.target):b.doConnectAction(v.target,H.target)}catch(a){}Z=v.editing.groupRotateMode,v._fireEditEvent("end",a),v.editing=null}v.tipInfo=null,v._inSmartGuide&&(v._interactor.rectGuide.clear(),v._inSmartGuide=!1),Z&&v.target&&v.target.endRotate()},Jo.prototype.handleNormalStateDelete=function(){var O=this,q=O.editing;if(q&&"connect"===q.mode&&!q.canceled&&!q.deleted){if(q.garbageInfo){try{b.doDeleteConnectionAction(O.target)}catch(R){}q.garbageInfo=null}return q.cursorPos=null,q.targetCorners=null,q.deleted=!0,O._interactor._42(),!0}},Jo.prototype.handleNormalStateKeyDown=function(I){var n=this,P=n.editing;return!P||"connect"!==P.mode||P.canceled||P.deleted?void 0:o.Default.isEsc(I)?(P.cursorPos=null,P.targetCorners=null,P.canceled=!0,n._interactor._42(),!0):void 0},Jo.prototype.handleEdit=function(Q,a){var e=this,Z=e.editing;if(Z){var i,K,d,r,k,J=e.target,N=Z.key,y=Z.mode,C=Q.lp(a),D=e._interactor;if("connect"===y){if(Z.canceled)return;if(Z.deleted)return;Z.cursorPos=D._getLogicalPoint(a);var U=Z.garbageInfo;return U&&pp.checkHit(Z.cursorPos,U,U.size)?(U.hover=!0,Z.target=null,Z.targetCorners=null):(U&&(U.hover=!1),Z.target=Q.getDataAt(C,function(R){return Q.isSelectable(R)?Lg(R)?!0:!1:!1})||null,Z.targetCorners=pp.getTargetCornersOnScreen(Q,Z.target)),D._42(),void 0}if("rotate"===y){var S,Y,M=Z.pos,W=Math.atan2(C.y-M.y,C.x-M.x);if(Z.groupRotateMode?Y=W-Z.hitRot:(S=W-Z.hitRot,Y=Z.rotation+S),Y%=2*Math.PI,0>Y&&(Y+=2*Math.PI),!o.Default.isCtrlDown(a)){var g,O;gg(a)?(g=D.getStyle("shiftRotateRound"),O=g/2):(g=D.getStyle("rotateRound"),O=D.getStyle("rotateSensitivity")),Y=pp.roundTo(Y,g,O)}Z.groupRotateMode?(S=Y-(Z.lastRotation||0),0!==S&&(J.addRotation(S,Z.groupRotateMode),Z.lastRotation=Y)):J.setRotation(Y),D._setRotateCursor(W),Y>Math.PI&&(Y-=2*Math.PI);var q=180*(Y/Math.PI);q=q.toFixed(2),i=""+q+""}else if("resize"===y){var w=Z.rect;d=w.x,r=w.y;var E,L=w.width,R=w.height,x=Z.anchor,h=Z.matrix,p=gg(a),X=e._unionPointMode1,$=e._unionPointMode2;if(e._inSmartGuide&&!o.Default.isCtrlDown(a)&&!p){var I;"L"===N||"R"===N?I="x":("T"===N||"B"===N)&&(I="y"),e._adsorbedToClosest(C,I),k=!0}E=h.tfi(C);var c;"LT"===N?(w=X(E,{x:d+L,y:r+R},L,R,p),c=9):"T"===N?(w=$({x:d,y:E.y},{x:d+L,y:r+R},L,R,p,"v"),c=1):"RT"===N?(w=X(E,{x:d,y:r+R},L,R,p),c=33):"L"===N?(w=$({x:E.x,y:r},{x:d+L,y:r+R},L,R,p,"h"),c=8):"R"===N?(w=$({x:d,y:r},{x:E.x,y:r+R},L,R,p,"h"),c=32):"LB"===N?(w=X(E,{x:d+L,y:r},L,R,p),c=12):"B"===N?(w=$({x:d,y:r},{x:d+L,y:E.y},L,R,p,"v"),c=4):"RB"===N&&(w=X(E,{x:d,y:r},L,R,p),c=36);var B=h.tf(w.x+w.width*x.x,w.y+w.height*x.y);J.setPosition(B),J.setSize(w.width,w.height),k&&(K=J.getRect(),D.rectGuide.gatherLines({node:J,x:K.x,y:K.y,w:K.width,h:K.height},I,c)),i=""+Math.round(w.width)+" * "+Math.round(w.height)}else if("line"===y){if(gg(a)){var l=J.getPoints(),f="P1"===N?l.get(1):l.get(0),j={x:C.x-f.x,y:C.y-f.y},F=D.getStyle("shiftLineRotateRound"),n=e._shiftDirList;if(!n||e._shiftRotateRound!==F){e._shiftRotateRound=F,e._shiftDirList=n=[];for(var m=0;m<Math.PI;m+=F)n.push({x:A(m),y:G(m)})}for(var V,s=0,z=0,v=n.length;v>z;z++){var u=n[z],H=u.x*j.x+u.y*j.y;Math.abs(H)>Math.abs(s)&&(s=H,V=u)}C={x:f.x+V.x*s,y:f.y+V.y*s},D.rectGuide.clear()}else e._inSmartGuide&&!o.Default.isCtrlDown(a)&&(e._adsorbedToClosest(C),k=!0);var T=pp.getDataMatrix(J).applyInverse(C);J.setPoint("P1"===N?0:1,T,!0);var b=J.getPoints(),t=b.get(0),P=b.get(1);d=t.x-P.x,r=t.y-P.y,i=" "+Math.round(Math.sqrt(d*d+r*r))+" ",k&&(K=J.getRect(),D.rectGuide.gatherLines({node:J,x:K.x,y:K.y,w:K.width,h:K.height}))}if(i){var _=o.Default.getLogicalPoint(a,D._canvas);_.x+=pp.Icons.TipShiftX,_.y+=pp.Icons.TipShiftY,e.tipInfo={helperPos:_,text:i,size:i.length}}e._fireEditEvent("between",a)}},Jo.prototype._unionPointMode1=function(E,V,C,_,G){if(G&&C&&_){var r=E.x-V.x,Y=E.y-V.y;Math.abs(r*_)<Math.abs(Y*C)?(Y=Math.sign(Y)*Math.abs(r*_/C),E.y=V.y+Y):(r=Math.sign(r)*Math.abs(Y*C/_),E.x=V.x+r)}return o.Default.unionPoint(E,V)},Jo.prototype._unionPointMode2=function(x,a,H,P,h,s){var u=o.Default.unionPoint(x,a);if(h&&H&&P){var B;"v"===s?(B=u.x+u.width/2,u.width=H*u.height/P,u.x=B-u.width/2):(B=u.y+u.height/2,u.height=P*u.width/H,u.y=B-u.height/2)}return u},Jo.prototype._adsorbedToClosest=function(V,W){var y=this,Q=y._interactor,S=Q.rectGuide.findClosest(V,W),X=Q.gridGuide.findClosest(V,W),e=1/0,f=1/0;S&&(isFinite(S.x)&&(e=S.x),isFinite(S.y)&&(f=S.y)),X&&(isFinite(X.x)&&Math.abs(X.x)<Math.abs(e)&&(e=X.x),isFinite(X.y)&&Math.abs(X.y)<Math.abs(f)&&(f=X.y)),isFinite(e)&&(V.x+=e),isFinite(f)&&(V.y+=f)},Jo.prototype._42=function(P,o,y){var W=this;W.info={},W.screenInfo=null;var n=W._interactor;if(!n.editDetail&&W.gatherInfo(o,y)){var G=W.editing,v=G?G.groupRotateMode:null,O=W.screenInfo;"block"!==v&&(O.P1?pp.Icons.DrawIcon(n,P,pp.Icons.Line,O):pp.Icons.DrawIcon(n,P,pp.Icons.Rect,O),O.connect&&(pp.Icons.DrawIcon(n,P,pp.Icons.ConnectGuide,{rotation:O.rotation,connect:O.connect,cursorPos:G?G.cursorPos:null}),G&&(G.targetCorners&&pp.Icons.DrawIcon(n,P,pp.Icons.NodeHoverGuide,G.targetCorners),G.garbageInfo&&pp.Icons.DrawIcon(n,P,pp.Icons.ConnectGuideGarbage,G.garbageInfo))),W.tipInfo&&pp.Icons.DrawIcon(n,P,pp.Icons.TipHelper,W.tipInfo)),W.target instanceof pp.Group&&W.target._42(n,P,o)}};var To=pp.Anchor=function(B){this.catalog="Anchor",this._interactor=B};To.prototype={},To.prototype.constructor=To,To.prototype.gatherInfo=function(y,$){var H=this;if(1===$.length){var g=$[0];if(!g.getAnchor)return;if(g instanceof o.Shape&&g._70I())return;if(Dq(g,y))return;return H.gatherSingleTarget(y,$[0])}return $.length>1?H.gatherMultiTargets(y,$):!1},To.prototype.gatherSingleTarget=function(U,X){var e=this;return e.info.POS=X.getPosition(),e.screenInfo.POS=pp.toScreenPosition(U,e.info.POS),e.target=X,!0},To.prototype.gatherMultiTargets=function(k,s){var Q=this,t=pp.Group.findOrCreateGroup(s);return t?(Q.screenInfo.POS=pp.toScreenPosition(k,t.getAnchor2()),Q.target=t,!0):!1},To.prototype.isVisible=function(){var o=this,X=o._interactor;if(X.getStyle("anchorVisible")===!1)return!1;var j=o.target;if(j){if(this.editing)return!0;var U=j.getAnchor(),w=X.getStyle("anchorOutsideVisibleThreshold");if(U.x<-w||U.x>1+w||U.y<-w||U.y>1+w)return!0;var u=j.getSize(),T=j.getScale(),y=Math.min(Math.abs(u.width*T.x),Math.abs(u.height*T.y));if(y*X.gv._zoom<X.getStyle("anchorHideThreshold"))return!1}return!0},To.prototype.check=function(X,i,Y){if(o.Default.isLeftButton(i)){var b=this,R=b._interactor;if(b.isVisible()&&R.getStyle("anchorMovable")!==!1){b.editing=null,b.tipInfo=null;var _=b.target;if(_&&X.isAnchorEditable(_)&&X.isEditable(_)){var F;if(b.screenInfo&&(F=b.screenInfo.POS)&&pp.checkHit(Y,new pp.Math.Vector2(F),R.getStyle("checkSize"))){if(_ instanceof pp.Group)return b.editing={},!0;var r=_.getWidth(),l=_.getHeight(),f=_.getAnchor();return b.editing={rect:{x:-r*f.x,y:-l*f.y,width:r,height:l},anchor:f,matrix:_.getMatrix()},!0}}}}},To.prototype.startEdit=function(d,o){d.startDragging(o),d.fi({kind:"beginEditAnchor",event:o})},To.prototype._46O=function(O){var Z=this;Z.editing&&(Z.editing=null,Z._interactor.fi({kind:"endEditAnchor",event:O})),Z.tipInfo=null},To.prototype.handleEdit=function(m,N){var l=this,x=l.target;if(x){var z=l.editing;if(z){var f=m.lp(N),J=l._interactor;if(x instanceof pp.Group)return x.setAnchor2(f),J._42(),void 0;var Q=z.matrix,K=Q.tfi(f),H=z.rect,E=(K.x-H.x)/H.width,u=(K.y-H.y)/H.height;if(!o.Default.isCtrlDown(N)){var r=J.getStyle("anchorRound"),I=J.getStyle("anchorSensitivity");E=pp.roundTo(E,r,I),u=pp.roundTo(u,r,I)}x.setAnchor(E,u,!0);var C=o.Default.getLogicalPoint(N,J._canvas);C.x+=pp.Icons.TipShiftX,C.y+=pp.Icons.TipShiftY;var W=""+E.toFixed(2)+", "+u.toFixed(2);l.tipInfo={helperPos:C,text:W,size:W.length},J.fi({kind:"betweenEditAnchor",event:N})}}},To.prototype._42=function(A,B,m){var U=this;U.info={},U.screenInfo={};var f=U._interactor;f.editDetail||U.gatherInfo(B,m)&&U.isVisible()&&(pp.Icons.DrawIcon(f,A,pp.Icons.Anchor,U.screenInfo),U.tipInfo&&pp.Icons.DrawIcon(f,A,pp.Icons.TipHelper,U.tipInfo))};var mk=pp.Curve=function(O){this.catalog="Curve",this._interactor=O};mk.prototype={},mk.prototype.constructor=mk,u.defineProperties(mk.prototype,{activing:{get:function(){return this._activing},set:function(U){var V=this;if(U)V._activing=new pp.CurveActiving(this,U);else{var Z=V._activing;Z&&Z.dispose(),V._activing=null}}}}),mk.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},mk.prototype.setUp=function(){var m=this,Q=m._interactor;Q&&Q.gv.mp(m._onGraphviewPropertyChanged,m)},mk.prototype._onGraphviewPropertyChanged=function(n){("zoom"===n.property||"translateX"===n.property||"translateY"===n.property)&&this._handleDataChanged()},mk.prototype.tearDown=function(){var b=this,z=b._interactor;z&&z.gv.ump(b._onGraphviewPropertyChanged,b)},mk.prototype.canEnterEditDetailMode=function(){var B=this,j=B._interactor,A=j._getValidSelection();if(1===A.length){var Y=A[0],D=Y instanceof o.Edge;if(Y instanceof o.Shape||D){if(D){var k=Y.s("edge.type");if(k&&"points"!==k)return}var M=j.gv;if(M.isPointEditable(Y)&&M.isEditable(Y))return B.target=Y,!0}}},mk.prototype.preHandleScroll=function(){var p=this.editing;return p&&p.inEdit?!0:void 0},mk.prototype.getCurrentSelectintStatus=function(){var z=this;if(z.activing&&!z.activing.selections){if(z.activing.status!=Y)return z.activing.status;var c=function(b){var P=z.activing.status;z.activing.status=b,z._interactor.fp("shapePointStatus",P,b)},C=pp.Curve.PointType,s=z.activing.point,J=z.activing.pairs;if(!J||1!==J.length)return c(C.Mirrored);var T=J[0],m=T.c1&&T.c1.isNearEnough(s),M=T.c2&&T.c2.isNearEnough(s);if(!T.c1||!T.c2)return m||M?c(C.Straight):c(C.Disconnected);if(m&&M)return c(C.Straight);if(m||M)return c(C.Asymmetric);var R=T.c1.clone().sub(s),Q=T.c2.clone().sub(s);return Math.abs(R.x*Q.y-R.y*Q.x)>1e-5||R.x*Q.x>0?c(C.Disconnected):Math.abs(R.length()-Q.length())>1e-5?c(C.Asymmetric):c(C.Mirrored)}},mk.prototype.handle_keydown=function(J){var d=this;if(d._interactor.editDetail){var A=pp.Curve.PointType;"1"===J.key?d.setCurrentSelectionStatus(A.Straight):"2"===J.key?d.setCurrentSelectionStatus(A.Mirrored):"3"===J.key?d.setCurrentSelectionStatus(A.Disconnected):"4"===J.key&&d.setCurrentSelectionStatus(A.Asymmetric)}},mk.prototype.setCurrentSelectionStatus=function(g){var V=this,d=V.activing;if(d){var F=V.getCurrentSelectintStatus();if(null!==F&&F!==g){d.status=g;var a=V.activing.point,c=V.activing.pairs;if(c&&1===c.length){var L=c[0],X=V.screenInfo.curve,t=pp.Curve.PointType,v=function(){V._writeToHt(),V._interactor.fp("shapePointStatus",F,g)};if(g===t.Straight)return X.moveCtrlPoint(L,a,"c1"),X.moveCtrlPoint(L,a,"c2"),v(),void 0;if(F===t.Straight){var l=X.findPairs(a,!0),J=l[0],Y=J.r1||a,S=J.r2||a,j=S.clone().sub(Y).multiplyScalar(.25);return X.moveCtrlPoint(L,a.clone().sub(j),"c1"),X.moveCtrlPoint(L,a.clone().add(j),"c2"),v(),void 0}var w=L.c1,e=L.c2;if(w&&e){if(g===t.Mirrored)return X.moveCtrlPoint(L,a.clone().multiplyScalar(2).sub(e),"c1"),v(),void 0;if(g===t.Asymmetric&&F===t.Disconnected){var Q=w.clone().sub(a).length(),j=a.clone().sub(e).setLength(Q).add(a);return X.moveCtrlPoint(L,j,"c1"),v(),void 0}}d._firePointChange(),V._interactor.fp("shapePointStatus",F,g)}}}},mk.prototype._handleDataChanged=function(U){var v=this;if(v.screenInfo&&v.target){var V=v._interactor;v.gatherSingleTarget(V.gv,v.target,!0),v.check(V.gv,null,U?V._getLogicalPoint(U):new pp.Math.Vector2(V._lastClientPoint)),V._42()}},mk.prototype.gatherSingleTarget=function(M,H,s){var q,y,E=this;E.screenInfo&&E.screenInfo.curve&&(y=E.screenInfo.curve._curves);var N=E.editing;q=N?E.screenInfo:E.screenInfo={};var g,W,F=H instanceof o.Edge;F?(g=H.s("edge.segments"),W=H.s("edge.points")||new o.List):(g=H._58O,W=H._59O),q.S=g;var J,K=q.P=[],C=pp.getDataMatrix(H);if(H instanceof o.Polyline&&(J=H.getElevation()||0,q.E=[]),W.each(function($){q.E&&q.E.push($.e||J),$=C.apply($);var m=pp.toScreenPosition(M,$);K.push(m.x,m.y)}),F){var A=pp.toScreenPosition(M,H._lastSourcePoint),b=pp.toScreenPosition(M,H._lastTargetPoint);K.splice(0,0,A.x,A.y),K.push(b.x,b.y)}if(!q.S||!q.S.size()){q.S=new o.List,q.S.add(1);for(var u=0;u<K.length/2-1;u++)q.S.add(2)}if((!N||s)&&E.convertToCubicBezier(y),E.activing&&(s||!E.editing||"realPoint"===E.editing.type)){var r=q.curve.findPairs(E.activing.point);E.activing.pairs=r}F&&"points"!==H.s("edge.type")&&E._writeToHt()},mk.prototype._convertToNewPoint=function(K,z,$){var d,T,x;for(d=0,T=z.length;T>d;d++){if(x=z[d],x._p1.isNearEnough(K))return x._p1;if(x._p4.isNearEnough(K))return x._p4}if($)for(d=0,T=Math.min($.length,T);T>d;d++){if(x=$[d],x._p1===K)return z[d]._p1;if(x._p4===K)return z[d]._p4}},mk.prototype.convertToCubicBezier=function(I){var M,V,J=this,G=new pp.Math.Curve,$=J.screenInfo;if(G.createFromHtShape($.P,$.S,$.E),$.curve=G,J.activing){var x=G._curves;if(M=J.activing.point,V=J._convertToNewPoint(M,x,I),V&&(J.activing.point=V),J.activing.selections){var d=-1,T=J.activing.selections;T.forEach(function($){d++,V=J._convertToNewPoint($,x,I),V&&(T[d]=V)})}}},mk.prototype.check=function(c,X,K){if(!X||o.Default.isLeftButton(X)){var A=this;if(A._interactor.setCursor("default"),A.editing=null,A.highlight=null,A.tipInfo=null,A.screenInfo){if(gh())return A._interactor._42(),!0;if(A._checkEditCtrlPoint(K))return A._interactor._42(),!0;if(A._checkEditRealPoint(K))return A._interactor._42(),!0;if(A._checkEditElevation(K))return A._interactor._42(),!0;var L=A.screenInfo.curve,j=L.checkPoint(K,A._interactor.getStyle("curveIntersectSize"));if(j){var f=A.highlight={};f.type="insertKnot",f.bezier=j.bezier,f.point=j.intersection}return A._interactor._42(),!0}}},mk.prototype._checkEditRealPoint=function(B){var x,t,D,i,k,a,V=this,M=V.screenInfo.curve._curves,b=V._interactor.getStyle("curvePointIntersectSize"),O=1/0;for(b*=b,D=0,i=M.length;i>D;D++)x=M[D],k=x._p1,a=B.distanceToSquared(k),O>a&&(O=a,t=k),k=x._p4,a=B.distanceToSquared(k),O>a&&(O=a,t=k);if(O>b)return!1;var c=V.highlight={};return c.type="changeRealPoint",c.point=t,V.editing={type:"realPoint",point:t,shiftGuide:{point:t.clone(),dir:"x",limit:0}},V._interactor.setCursor("crosshair"),!0},mk.prototype._checkEditElevation=function(m){var d=this;if(!d._interactor.getStyle("curveElevationVisible"))return!1;var M=d.activing;if(!M)return!1;var b=M.getCurrentEditingPoint();if(!b)return!1;var U=d._interactor,X=U.getStyle("curveElevationGuideShift"),c=U.getStyle("curveElevationIntersectSize"),a=m.distanceToSquared({x:b.x+X[0],y:b.y+X[1]});if(!(a>c*c)){var s=d.highlight={};s.type="elevation";var N=new pp.Math.Vector2(m.x,m.y,b.e);return d.editing={type:"elevation",startPoint:N},d._interactor.setCursor("crosshair"),!0}},mk.prototype._checkEditCtrlPoint=function(D){var X=this;if(X.activing&&!X.activing.selections){var k=X.getCurrentSelectintStatus();if(k!==pp.Curve.PointType.Straight){var c=X.activing.pairs;if(c){var h=X._interactor.getStyle("curvePointIntersectSize");h*=h;var q,R,C,$,g,S,y,i,m,T=1/0;for(y=0,m=c.length;m>y;y++)for($=c[y],i=0;2>i;i++)g=0===i?"c1":"c2",$[g]&&(S=D.distanceToSquared($[g]),T>S&&(T=S,q=$,R=y,C=g));if(T>h)return!1;X.activing.hlpair=q,X.activing.hltype=C;var l=X.highlight={};return l.type="changeCtrlPoint",l.point=q[C],X.editing={type:"ctrlPoint",pair:q,pairId:R,ctrlType:C,direction:q[C].clone().sub(X.activing.point).normalize()},X._interactor.setCursor("crosshair"),!0}}}},mk.prototype.startEdit=function(w,I){w.startDragging(I);var B=this;B.highlight&&"insertKnot"===B.highlight.type&&(B.insertKnot(),B.gatherSingleTarget(B._interactor.gv,B.target),B.activing=null,B._checkEditRealPoint(B._interactor._getLogicalPoint(I)));var x=B._activing;if(x){var N=B.editing?B.editing.type:null;"ctrlPoint"===N?x.editingCtrl={pairId:B.editing.pairId,type:x.hltype}:"realPoint"===N&&(x.editingCtrl=!1)}var r=B.highlight,f=o.Default.isCtrlDown(I);if(!r||gh()){var $=B._interactor.gv;if(!$.setFocus(I)||$._scrolling)return;return $.isPannable()&&zj(I)&&!f&&(B._pan={tx:$.tx(),ty:$.ty()},w.fi({kind:"beginPan",event:I})),void 0}if("changeRealPoint"===r.type){var n,X=B.activing?B.activing.point:null,t=B.activing?B.activing.selections:null;if(f&&B.activing)X===r.point?(t?(B.activing={point:t[0]},t.length>1&&(t.splice(0,1),B.activing.selections=t)):B.activing=null,B.editing=null):t&&(n=t.indexOf(r.point))>=0?(t.length>1?t.splice(n,1):delete B.activing.selections,B.editing=null):t?(t.push(X),B.activing={point:r.point,selections:t}):B.activing={point:r.point,selections:[X]};else if(t)X===r.point||((n=t.indexOf(r.point))>=0?(t.splice(n,1,X),B.activing={point:r.point,selections:t}):B.activing={point:r.point});else{var l;X===r.point&&(l=B.activing.status),B.activing={point:r.point},l&&(B.activing.status=l)}w.fi({kind:"beginEditPoint",event:I})}},mk.prototype.insertKnot=function(){var s=this,L=s.highlight,Y=s.screenInfo.curve;Y.insertKnot(L.bezier,L.point.t),s._writeToHt()},mk.prototype._writeToHt=function(){var e,g,c,F,d=this,N=d.screenInfo.curve,u=N.toHtShape(),i=u.points,V=[],T=u.segments,_=d._interactor.gv,A=d.target,K=A instanceof o.Edge,R=pp.getDataMatrix(A).invert();F=A instanceof o.Polyline,F&&(c=A.getElevation());for(var n=0,P=i.length;P>n;n++)e=i[n],g=pp.toWorldPosition(_,e),g=R.apply(g),e.e!=Y&&e.e!==c&&(g.e=e.e),V.push(g);if(A._writing=!0,K){A.s("edge.type","points"),A.setStyle("edge.segments",T),A.setStyle("edge.points",V.slice(1,V.length-1)),A.setStyle("edge.source.offset.x",0),A.setStyle("edge.source.offset.y",0),A.setStyle("edge.target.offset.x",0),A.setStyle("edge.target.offset.y",0);var W=d._nextChangeEdgeHost;delete d._nextChangeEdgeHost,W&&("source"===W.type?A.setSource(W.host):A.setTarget(W.host)),d._writeEdgeHostAnchor("source",V[0]),d._writeEdgeHostAnchor("target",V[V.length-1])}else V.length?(A.setSegments(T),A.setPoints(V,!0)):A.removeFromDataModel();delete A._writing},mk.prototype._writeEdgeHostAnchor=function(Y,S){var M=this,K=M.target,_=M._calcHostAnchor(K,Y,S);K.s("edge."+Y+".anchor.x",_.x),K.s("edge."+Y+".anchor.y",_.y)},mk.prototype._calcHostAnchor=function(U,E,Q,Y){Y||(Y="source"===E?U.getSource():U.getTarget());var I=Y.getRotation(),T=Y.getAnchor(),c=this._interactor.gv;if(Dq(Y,c)&&(I=0),I){var t=Y.getMatrix(),D=t.tfi(Q),x=Y.getSize();return{x:D.x/x.width+T.x,y:D.y/x.height+T.y}}var d=Lq(c,Y),m={x:(Q.x-d.x)/d.width,y:(Q.y-d.y)/d.height};return m},mk.prototype._handlePanning=function(o){var y=this,A=y._pan;if(A){A.started=!0;var N=y._interactor,F=N.gv,h=N._lastClientPoint,U=Dl(o);F.setTranslate(A.tx+U.x-h.x,A.ty+U.y-h.y),y.gatherSingleTarget(N.gv,y.target),N._42(),N.fi({kind:"betweenPan",event:o})}},mk.prototype.handleEdit=function(g,p){var u=this,J=u.editing;if(u._pan)return u._handlePanning(p),void 0;if(J){J.inEdit=!0;var I,U,P,C=u._interactor._getLogicalPoint(p),f=o.Default.isCtrlDown(p),Q=o.Default.isShiftDown(p),Z=J.type,n=u.activing;if(u._guideInfo=null,"ctrlPoint"===Z&&Q){var e=u.editing.direction.clone();I=n.point;var T=e.dot(C.clone().sub(I));C=e.setLength(T).add(I)}else if("ctrlPoint"===Z||"realPoint"===Z){var e;if("realPoint"===Z&&Q){var A=u.editing.shiftGuide;U=A.point;var M=Math.abs(C.x-U.x),H=Math.abs(C.y-U.y);M>H&&M>A.limit&&"y"===A.dir&&(A.dir="x"),H>M&&H>A.limit&&"x"===A.dir&&(A.dir="y"),e=A.dir,"x"===e?(C.y=U.y,A.limit=Math.max(A.limit,M)):"y"===e&&(C.x=U.x,A.limit=Math.max(A.limit,H))}var h=u._isEditEdgeSourceTarget();if(h){var s=u._editEdgeSourceTarget(h,C,f);s&&(P=s.tipText)}else if(!f){var F=u._guidingToEdit(C,e),c="realPoint"===Z?u._interactor.gridGuide.findClosest(C,e,!0):null,v=1/0,b=1/0;c&&(c.x&&(v=c.x),c.y&&(b=c.y));var j=!1;F&&(F.xList&&(Math.abs(F.x)<=Math.abs(v)?(j=!0,v=F.x):delete F.xList),F.yList&&(Math.abs(F.y)<=Math.abs(b)?(j=!0,b=F.y):delete F.yList),j&&(u._guideInfo=F)),isFinite(v)&&(C.x+=v),isFinite(b)&&(C.y+=b),j&&(F.v=C)}}var W=u.screenInfo.curve;if("realPoint"===J.type){I=J.point,I.e!==Y&&(C.e=I.e),W.moveRealPoint(I,C),J.point=C,u.highlight.point=C;var D=n.status,O=n.selections;if(u.activing={point:C,status:D},O){var m=C.clone().sub(I),z=0;O.forEach(function(q){var l=q.clone().add(m);W.moveRealPoint(q,l),O[z++]=l}),u.activing.selections=O}}else if("ctrlPoint"===J.type){var k=n.pairs,i=k[J.pairId];W.moveCtrlPoint(i,C,J.ctrlType);var R=n.status,S=pp.Curve.PointType;if((R===S.Mirrored||R===S.Asymmetric)&&i.c1&&i.c2){var I=new pp.Math.Vector2(n.point),a="c1"===J.ctrlType?"c2":"c1";if(R===pp.Curve.PointType.Mirrored)W.moveCtrlPoint(i,I.clone().multiplyScalar(2).sub(C),a);else if(R===S.Asymmetric){var T=i[a].clone().sub(I).length(),x=I.clone().sub(i[J.ctrlType]).setLength(T).add(I);isNaN(x.x)||W.moveCtrlPoint(i,x,a)}}n._firePointChange()}else if("elevation"===J.type){U=J.startPoint;var G=U.e+(U.y-C.y)/g._zoom;u._setCurrentPointImpl("e",G),n._firePointChange(),P="E: "+pp.toFixed(G)}var q=o.Default.getLogicalPoint(p,u._interactor._canvas);if(q.x+=pp.Icons.TipShiftX,q.y+=pp.Icons.TipShiftY,!P){var l=pp.toWorldPosition(g,C);P=""+pp.toFixed(l.x)+", "+pp.toFixed(l.y)}u.tipInfo={helperPos:q,text:P,size:P.length},u._writeToHt(),u._interactor.fi({kind:"betweenEditPoint",event:p})}},mk.prototype._setCurrentPointImpl=function(K,n){var x=this,h=x._activing;if(!h)return!1;var e=x.target;if(!e)return!1;var d=h.getCurrentEditingPoint();if(!d)return!1;var Z=h.editingCtrl;if(!Z)var J=d.clone();if("e"===K)d.e=n;else{var c;if("x"===K||"y"===K){var q=h._lastFirePoint;c="x"===K?{x:n,y:q?q.y:0}:{x:q?q.x:0,y:n}}else"object"==typeof K?(c=K,K.e!==Y&&(d.e=K.e)):(c={x:arguments[0],y:arguments[1]},arguments[2]!==Y&&(d.e=arguments[2]));var g=pp.getDataMatrix(e);c=pp.toScreenPosition(x._interactor.gv,g.apply(c)),d.x=c.x,d.y=c.y}if(!Z){var R=J.multiplyScalar(-1).add(d);d.e&&J.e&&(R.e=d.e-J.e),x.screenInfo.curve.moveCtrlDueToRealPointMovement(d,R)}return!0},mk.prototype.setCurrentPoint=function(Z,x){return this._setCurrentPointImpl(Z,x)?(this._writeToHt(),!0):!1},mk.prototype._isEditEdgeSourceTarget=function(){var E=this,a=E.target;if(!(a instanceof o.Edge))return!1;var g=E.editing.point,D=E.screenInfo.curve._curves;return g===D[0]._p1?"source":g===D[D.length-1]._p4?"target":!1},mk.prototype._editEdgeSourceTarget=function(g,h,G){var r,o=this,X=o.target;if(r="source"===g?X.getSource():X.getTarget()){var b=o._interactor.gv,J=pp.toWorldPosition(b,h),x=o._calcHostAnchor(X,g,J,r);if(!G){var e=o._interactor.getStyle("anchorRound"),s=o._interactor.getStyle("anchorSensitivity");x.x=pp.roundTo(x.x,e,s),x.y=pp.roundTo(x.y,e,s)}if(o._interactor.getStyle("edgeHostDetectPerFrame")||x.x<0||x.x>1||x.y<0||x.y>1){var q=b.getDataAt(J,function(n){return b.isSelectable(n)?Lg(n)?!0:!1:!1});if(q){var Q=o._calcHostAnchor(X,g,J,q);r=q,o._nextChangeEdgeHost={type:g,host:q},x=Q,G||(x.x=pp.roundTo(x.x,e,s),x.y=pp.roundTo(x.y,e,s))}}if(!G){var D=zf(b,r,0,0,0,x.x,x.y),f=pp.toScreenPosition(b,D);h.x=f.x,h.y=f.y}return o._edgeHostGuideInfo=pp.getTargetCornersOnScreen(b,r),{host:r,anchor:x,tipText:""+x.x.toFixed(2)+", "+x.y.toFixed(2)}
}},mk.prototype._guidingToEdit=function(O,G){var s,V,L=this;if(s=L.screenInfo.curve){V=s._curves;var t,p,M,W,C,U,z,o,h=1/0,E=1/0,B=[];for(L.editing&&"realPoint"===L.editing.type&&(o=L.editing.point),C=0,U=2*V.length;U>C;C++)z=V[Math.floor(C/2)][C%2?"_p4":"_p1"],B.indexOf(z)>=0||(B.push(z),o&&o===z||(M=z.x-O.x,W=z.y-O.y,Math.abs(M)<Math.abs(h)?(h=M,t=[z]):M===h&&t.push(z),Math.abs(W)<Math.abs(E)?(E=W,p=[z]):W===E&&p.push(z)));var g=L._interactor.getStyle("smartGuideSensitivity");if((Math.abs(h)>g||"y"===G)&&(t=null),(Math.abs(E)>g||"x"===G)&&(p=null),t||p){var v=!1,D={};if(t&&(v=!0,D.xList=t,D.x=h),p&&(v=!0,D.yList=p,D.y=E),v)return D}}},mk.prototype._46O=function(T){var p=this;p.editing&&(p.editing=null,p._interactor.fi({kind:"endEditPoint",event:T})),p._guideInfo=null,p._edgeHostGuideInfo=null,p._pan&&(p._pan=null,p._interactor.fi({kind:"endPan",event:T})),p.tipInfo=null},mk.prototype._canDeletePoint=function($,A){var J=this.target;if(!(J instanceof o.Edge))return!0;var G=$._curves[0],F=$._curves[$._curves.length-1];return G._p1===A||F._p4===A?!1:!0},mk.prototype.handleDelete=function(){var q=this;if(q.activing&&q.screenInfo){var j=o.Default.isShiftDown(),v=q.screenInfo.curve;q._canDeletePoint(v,q.activing.point)&&v.deleteRealPoint(q.activing.point,j),q.activing.selections&&q.activing.selections.forEach(function(H){q._canDeletePoint(v,H)&&v.deleteRealPoint(H,j)}),q.activing=null,delete q.editing,delete q.tipInfo,delete q._pan,q._writeToHt(),q._interactor.fp("deleteShapePoint",!1,!0)}},mk.prototype.handleDoubleClick=function(s){var m=this,A=m._interactor._getLogicalPoint(s);if(m.screenInfo&&m._checkEditRealPoint(A)){var R=m.getCurrentSelectintStatus(),q=pp.Curve.PointType;return R=R===q.Mirrored?q.Straight:q.Mirrored,m.setCurrentSelectionStatus(R),m._interactor._42(),!0}},mk.prototype._drawHighlight=function(M){var x=this,m=x.highlight;if(m){var e=m.bezier,R=x._interactor;e&&pp.Icons.DrawIcon(R,M,pp.Icons.ShapeHighlightCurve,[e._p1.x,e._p1.y,e._p2.x,e._p2.y,e._p3.x,e._p3.y,e._p4.x,e._p4.y]);var d=m.point;d&&"insertKnot"===m.type&&pp.Icons.DrawIcon(R,M,pp.Icons.ShapeHighlighPoint,d)}},mk.prototype._drawGuide=function(Q){var o=this,W=o._guideInfo;if(W){var N,u,f,c,q=W.v;for(N=0;2>N;N++)if(c=0===N?W.xList:W.yList)for(u=0,f=c.length;f>u;u++)pp.Icons.DrawIcon(o._interactor,Q,pp.Icons.ShapeGuideLine,[q.x,q.y,c[u].x,c[u].y])}},mk.prototype._drawCurrentPoint=function(j){var R=this;if(R.activing){var z=R.activing,T=R.getCurrentSelectintStatus(),s=R._interactor;if(T!==pp.Curve.PointType.Straight){var H=z.pairs;z.hlpair,z.hltype;var A=z.selections,C=z.editingCtrl;if(H&&!A){var q,D,y;for(D=0,y=H.length;y>D;D++)q=H[D],C&&D===C.pairId&&q[C.type]?pp.Icons.DrawIcon(s,j,pp.Icons.ShapeActivingCtrl,{point:q.point,c1:q.c1,c2:q.c2,hl:C.type}):pp.Icons.DrawIcon(s,j,pp.Icons.ShapeActivingCtrl,q)}}pp.Icons.DrawIcon(s,j,pp.Icons.ShapeHighlighRealPoint,R.activing.point),A&&A.forEach(function(E){pp.Icons.DrawIcon(s,j,pp.Icons.ShapeHighlighRealPoint,E)})}},mk.prototype.clear=function(){var j=this;j.editing=null,j._guideInfo=null,j.activing=null,j.highlight=null},mk.prototype._42=function(q){var U=this;U.info={},U.editing||(U.screenInfo=null);var M=U._interactor;if(!M.editDetail)return U.clear(),void 0;if(!U.target||!U._interactor.gv.isSelected(U.target)||!U._interactor.gv.isVisible(U.target))return M.editDetail=!1,U.clear(),void 0;if(U.gatherSingleTarget(M.gv,U.target),pp.Icons.DrawIcon(M,q,pp.Icons.ShapeBgCurve,U.screenInfo),U._drawHighlight(q),U._drawCurrentPoint(q),U._getRealPoint().forEach(function(X){pp.Icons.DrawIcon(M,q,pp.Icons.ShapePoint,X)}),U._drawGuide(q),U.tipInfo&&pp.Icons.DrawIcon(M,q,pp.Icons.TipHelper,U.tipInfo),U._edgeHostGuideInfo&&pp.Icons.DrawIcon(M,q,pp.Icons.NodeHoverGuide,U._edgeHostGuideInfo),U._interactor.getStyle("curveElevationVisible")&&U.target instanceof o.Polyline&&U.activing){var i=U.activing.getCurrentEditingPoint();i&&pp.Icons.DrawIcon(M,q,pp.Icons.EdgeElevationGuide,i)}},mk.prototype._getRealPoint=function(){var B=this.screenInfo,V=B.P,q=B.S,f=-1,T=[];return q.each(function(Z){var s=1;if(3===Z)s=2;else if(4===Z)s=3;else if(5===Z)return;f+=s,T.push({x:V[2*f],y:V[2*f+1]})}),T};var Fk=pp.MoveHelper=function(g){var Q=this;Q.catalog="Move",Q._interactor=g};Fk.prototype={},Fk.prototype.constructor=Fk,Fk.prototype.calcShift=function(q,w,t){var K,B,n=this,M=n._interactor.gv,S=M.lp(w);if("beginMove"===q&&n._gatherGridInfo(t._lastLogicalPoint||S),K=n._target){var W=K.downPosition;if(W){var R=n._interactor.getStyle("moveSensitivity")/M._zoom;if(W.distanceTo(S)<R)return{x:0,y:0};delete K.downPosition}var h;B=o.Default.isShiftDown(w),B&&(S=n._dealShiftDown(S),h=K.shiftGuide.dir);var Y,e=K.rawPos={x:K.pos.x+S.x-K.lp.x,y:K.pos.y+S.y-K.lp.y};if(o.Default.isCtrlDown(w)){if(Y=n._calcShiftByAddon(),n._target.node instanceof pp.Group){var O=n._target.node;O._position.x+=Y.x,O._position.y+=Y.y}return Y}for(var H,x=K.x+e.x,X=K.y+e.y,i={x:x,y:X},f={x:x+K.w/2,y:X+K.h/2},T={x:x+K.w,y:X+K.h},v=n._interactor.rectGuide,a=n._interactor.gridGuide,E=[v.findClosest(i,h),v.findClosest(f,h),v.findClosest(T,h),a.findClosest(i,h),a.findClosest(f,h),a.findClosest(T,h)],D=1/0,A=1/0,Z=0,U=E.length;U>Z;Z++)H=E[Z],H&&(x=H.x,X=H.y,isFinite(x)&&Math.abs(x)<Math.abs(D)&&(D=x),isFinite(X)&&Math.abs(X)<Math.abs(A)&&(A=X));if(isFinite(D)||(D=0),isFinite(A)||(A=0),Y=n._calcShiftByAddon(D,A),n._target.node instanceof pp.Group){var O=n._target.node;O._position.x+=Y.x,O._position.y+=Y.y}var b=K.node;if(!Dq(b,M)){var g=e.x+D,N=e.y+A;n._interactor.rectGuide.gatherLines({node:b,x:K.x+g,y:K.y+N,w:K.w,h:K.h},h)}return Y}},Fk.prototype._calcShiftByAddon=function(i,G){var R=this._target,e=R.rawPos,l=R.node.getPosition();return i=i||0,G=G||0,{x:e.x-l.x+i,y:e.y-l.y+G}},Fk.prototype._dealShiftDown=function(g){var Y=this,r=Y._target.shiftGuide,w=Y._target.lp,z=Math.abs(g.x-w.x),v=Math.abs(g.y-w.y);z>v&&z>r.limit&&"y"===r.dir&&(r.dir="x"),v>z&&v>r.limit&&"x"===r.dir&&(r.dir="y");var D=r.dir;return"x"===D?(g.y=w.y,r.limit=Math.max(r.limit,z)):"y"===D&&(g.x=w.x,r.limit=Math.max(r.limit,v)),g},Fk.prototype._gatherGridInfo=function(V){var Q,O=this,A=O._interactor,T=A._getValidSelection();if(1===T.length){if(Q=T[0],!Q.getRect)return O._target=null,void 0}else if(Q=pp.Group.findOrCreateGroup(T),!Q)return O._target=null,void 0;var N=Q.getPosition(),o=Q.getRect();O._target={node:Q,x:o.x-N.x,y:o.y-N.y,w:o.width,h:o.height,lp:{x:V.x,y:V.y},pos:{x:N.x,y:N.y},shiftGuide:{dir:"x",limit:0},downPosition:new pp.Math.Vector2(V)},A.rectGuide.gatherRects()},Fk.prototype.clear=function(){var P=this;P._interactor.rectGuide.clear(),P._interactor._42()};var Uh="directional",Xd="point",Oh="spot",Ar="light.color",ib=function(I,p){Mq(p)&&np.test(p)?Eb(I,p):hk(p)&&p.modelType?kf(I,p):Vk[I]=p},Am=function(w){if(hk(w))return w;var s=Vk[w];return w&&s===Y&&np.test(w)&&(zr&&zr[w]||Eb(w,w)),s};mm(b,{graph3dViewAttributes:m,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:j/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Ec,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:j/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:ib,getShape3dModel:Am,createMatrix:function(F,R){sc(F)||(F=[F]);for(var y=F.length-1;y>=0;y--){var T=F[y];R=am(T.mat,T.s3,T.r3,T.rotationMode,T.t3,R)}return R},transformVec:function(C,u){return zh(C,u)},createBoxModel:function(){return{vs:qp,ns:Od,uv:ad,is:tj}},createRoundRectModel:function(X,t){return Fm.roundRect(X,t)},createStarModel:function(w,P){return Fm.star(w,P)},createRectModel:function(S,Y){return Fm.rect(S,Y)},createTriangleModel:function(d,Y){return Fm.triangle(d,Y)},createRightTriangleModel:function(Q,I){return Fm.rightTriangle(Q,I)},createParallelogramModel:function(M,V){return Fm.parallelogram(M,V)},createTrapezoidModel:function(a,X){return Fm.trapezoid(a,X)},createSmoothSphereModel:function(x,o,A,I,q,S,b){return qo(new Er(x,o,A,I,q,S,b))},createSphereModel:function(H,g,c,F,I,a){return H?fd(H,g,c,F,I,a):b.createSmoothSphereModel()},createSmoothConeModel:function(O,z,q,u,y){return gp(O,z,q,u,y)},createConeModel:function(A,E,l,x,Y,c){return A?si(A,E,l,x,Y,c):gp(c)},createSmoothCylinderModel:function(t,$,N,F,e,H,z,a){return qo(new Yj(t,$,N,F,e,H,z,a))},createCylinderModel:function(x,C,_,U,Y,O,o){return x?mr(x,C,_,U,Y,O,o):el(O,o)},createSmoothTorusModel:function(u,k,U,$,h,F){return qo(new $r(u,k,U,$,h,F))},createTorusModel:function(l,u,o,a,M,j,F){return l?Me(l,u,o,a,M,j,F):Kn(j,F)},createExtrusionModel:function(H,Z,J,g,X,y,o,q){return Re(H,Z,J,g,X,y,o,q)},createSmoothRingModel:function(C,o,U,N,R,O){for(var A=[],H=0;H<C.length-1;H+=2)A.push({x:C[H],y:C[H+1]});for(C=Bp(A,o,U)[0],A=[],H=0;H<C.length;H++){var D=C[H];A.push(new sd(D.x,0,D.y))}return qo(new Hf(A,O,N,R))},createTextGeometry:function(b,e){return qo(new Nm(b,e))},loadFontFace:function(L,N){b.xhrLoad(L,function(W){if(!W)return N();var G;try{G=JSON.parse(W)}catch(R){G=JSON.parse(W.substring(65,W.length-2))}ie.loadFace(G),N&&N(G.familyName.toLowerCase())},N?null:{sync:!0})},getRotationFromMatrix4:function(Z,t){var Q=q,J=Z[0],a=Z[4],m=Z[8],d=Z[1],u=Z[5],H=Z[9],L=Z[2],n=Z[6],j=Z[10];t=t||"xyz",t=t[2]+t[1]+t[0],t=t.toUpperCase();var A={};if("XYZ"===t)A._y=Math.asin(Q(m,-1,1)),Math.abs(m)<.99999?(A._x=Math.atan2(-H,j),A._z=Math.atan2(-a,J)):(A._x=Math.atan2(n,u),A._z=0);else if("YXZ"===t)A._x=Math.asin(-Q(H,-1,1)),Math.abs(H)<.99999?(A._y=Math.atan2(m,j),A._z=Math.atan2(d,u)):(A._y=Math.atan2(-L,J),A._z=0);else if("ZXY"===t)A._x=Math.asin(Q(n,-1,1)),Math.abs(n)<.99999?(A._y=Math.atan2(-L,j),A._z=Math.atan2(-a,u)):(A._y=0,A._z=Math.atan2(d,J));else if("ZYX"===t)A._y=Math.asin(-Q(L,-1,1)),Math.abs(L)<.99999?(A._x=Math.atan2(n,j),A._z=Math.atan2(d,J)):(A._x=0,A._z=Math.atan2(-a,u));else if("YZX"===t)A._z=Math.asin(Q(d,-1,1)),Math.abs(d)<.99999?(A._x=Math.atan2(-H,u),A._y=Math.atan2(-L,J)):(A._x=0,A._y=Math.atan2(m,j));else{if("XZY"!==t)return null;A._z=Math.asin(-Q(a,-1,1)),Math.abs(a)<.99999?(A._x=Math.atan2(n,u),A._y=Math.atan2(m,J)):(A._x=Math.atan2(-H,j),A._y=0)}return[A._x,A._y,A._z]},createRingModel:function(H,P,j,F,n,E,r,v,l,R){for(var e=[],h=0;h<H.length-1;h+=2)e.push({x:H[h],y:H[h+1]});E=E||b.shapeSide,r=r||0,v=v||E;var g,X,x,C,k,p,Z,D,S,f,h,Y,y,V,T,i,d,s,_=[],K=[],U=l?[]:m,o=l?[]:m,I=R?[]:m,B=R?[]:m,z=F?[]:m,q=F?[]:m,N=n?[]:m,t=n?[]:m,H=Bp(e,P,j),u=Tl(H),Q=0,L=2*Math.PI/E;return H.forEach(function(w){if(x=w.length,x>1){if(C=w[0],F)for(p=C.x,D=C.y,h=r;v>h;h++)Y=h+1,y=h*L,V=Y*L,T=G(y),i=A(y),d=G(V),s=A(V),z.push(T*p,D,-i*p,d*p,D,-s*p,0,D,0),q.push(.5-.5*T,.5-.5*i,.5-.5*d,.5-.5*s,.5,.5);for(f=0;x>f;f++){for(k=w[f],p=C.x,Z=k.x,D=C.y,S=k.y,g=Q/u,Q+=fr(C,k),X=Q/u,h=r;v>h;h++)Y=h+1,y=h*L,V=Y*L,T=G(y),i=A(y),d=G(V),s=A(V),_.push(T*Z,S,-i*Z,d*Z,S,-s*Z,T*p,D,-i*p,d*Z,S,-s*Z,d*p,D,-s*p,T*p,D,-i*p),K.push(h/E,X,Y/E,X,h/E,g,Y/E,X,Y/E,g,h/E,g),l&&h===r&&(U.push(0,D,0,0,S,0,T*Z,S,-i*Z,T*Z,S,-i*Z,T*p,D,-i*p,0,D,0),o.push(0,.5-D,0,.5-S,2*Z,.5-S,2*Z,.5-S,2*p,.5-D,0,.5-D)),R&&Y===v&&(I.push(0,D,0,d*Z,S,-s*Z,0,S,0,d*Z,S,-s*Z,0,D,0,d*p,D,-s*p),B.push(1,.5-D,1-2*Z,.5-S,1,.5-S,1-2*Z,.5-S,1,.5-D,1-2*p,.5-D));C=k}if(n)for(p=C.x,D=C.y,h=r;v>h;h++)Y=h+1,y=h*L,V=Y*L,T=G(y),i=A(y),d=G(V),s=A(V),N.push(d*p,D,-s*p,T*p,D,-i*p,0,D,0),t.push(.5-.5*d,.5+.5*s,.5-.5*T,.5+.5*i,.5,.5)}}),{vs:_,uv:K,bottom_vs:N,bottom_uv:t,top_vs:z,top_uv:q,from_vs:U,from_uv:o,to_vs:I,to_uv:B}}},!0),mm(_,{"3d.move.mode":Y,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":Y,"edge.gradient.color":Y,"edge.source.t3":Y,"edge.target.t3":Y,"light.type":Xd,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":j/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Hj,"wf.short":!1,"wf.mat":Y,"wf.geometry":!1,batch:Y,"transparent.mask":!1,brightness:Y,"select.brightness":.7,"repeat.uv.length":Y,alphaTest:.4,"label.face":fq,"label.t3":Y,"label.r3":Y,"label.texture.scale":2,"label.rotationMode":Pg,"label.light":!1,"label.blend":Y,"label.reverse.flip":!1,"label.reverse.color":_j,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":fq,"label2.t3":Y,"label2.r3":Y,"label2.texture.scale":2,"label2.rotationMode":Pg,"label2.light":!1,"label2.blend":Y,"label2.reverse.flip":!1,"label2.reverse.color":_j,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":fq,"note.t3":Y,"note.r3":Y,"note.texture.scale":2,"note.rotationMode":Pg,"note.light":!1,"note.blend":Y,"note.reverse.flip":!1,"note.reverse.color":_j,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":fq,"note2.t3":Y,"note2.r3":Y,"note2.texture.scale":2,"note2.rotationMode":Pg,"note2.light":!1,"note2.blend":Y,"note2.reverse.flip":!1,"note2.reverse.color":_j,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:Y,"shape3d.color":vn,"shape3d.top.color":Y,"shape3d.bottom.color":Y,"shape3d.from.color":Y,"shape3d.to.color":Y,"shape3d.image":Y,"shape3d.top.image":Y,"shape3d.bottom.image":Y,"shape3d.from.image":Y,"shape3d.to.image":Y,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":Y,"shape3d.side.to":Y,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":Y,"shape3d.opacity":Y,"shape3d.reverse.flip":!1,"shape3d.reverse.color":_j,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":Y,"shape3d.uv.scale":Y,"shape3d.top.uv.offset":Y,"shape3d.top.uv.scale":Y,"shape3d.bottom.uv.offset":Y,"shape3d.bottom.uv.scale":Y,"shape3d.from.uv.offset":Y,"shape3d.from.uv.scale":Y,"shape3d.to.uv.offset":Y,"shape3d.to.uv.scale":Y,"shape3d.top.cap":Y,"shape3d.bottom.cap":Y,"shape3d.start.angle":0,"shape3d.sweep.angle":k,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":Y,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":vn,"all.image":Y,"all.blend":Y,"all.opacity":Y,"all.reverse.flip":!1,"all.reverse.color":_j,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":Y,"all.uv.offset":Y,"all.uv.scale":Y,"all.discard.selectable":!0,mat:Y,"left.mat":Y,"right.mat":Y,"top.mat":Y,"bottom.mat":Y,"front.mat":Y,"back.mat":Y},!0);var nn,ye=!1,Ir=[0,0,0,0],Ff={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:ip,2:jf,3:wh,4:ef,5:fq,6:Pk}},ic=function(X,j,E,a){if(j.getFaceVisible(X,E)){sp(j,ak(X,j.getFaceMat(X,E)||j.getMat(X)));var s=j._26I;j.getFaceReverseCull(X,E)?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),cf(s,j._prg.uFixPickReverseColor,Ff[E]),fs(s),Ln(s,a,6),zq(s),Ph(j)}},An=function(g){return g instanceof rl},ij=function(W){return[W.x,W.e||0,W.y]},qb=function(E,e,I){for(var e=oq(e),w=e[0],f=e[1],B=e[2];I--;)E.push(w,f,B)},ub=function(T,K,E){for(var K=oq(K),V=K[0],w=K[1],Q=K[2],f=K[3];E--;)T.push(V,w,Q,f)},$k=function(D,P,O){if(P)for(var k,H,A,b=P[0],t=P[1],p=P[2],R=P[4],s=P[5],Y=P[6],W=P[8],G=P[9],r=P[10],X=P[12],w=P[13],F=P[14],$=O.length,d=0,d=0;$>d;d+=3)k=O[d],H=O[d+1],A=O[d+2],D.push(b*k+R*H+W*A+X,t*k+s*H+G*A+w,p*k+Y*H+r*A+F);else gb(D,O)},Ge=function(y,K){var A=K.s("light.intensity"),j=oq(K.s(Ar)),q=j[0],b=j[1],i=j[2];1!==A&&(q*=A,b*=A,i*=A),y.push(q,b,i,K.s("light.disabled")?1:0)},Tk=function(p,e,j){cf(e,j.uHeadlightRange,p._headlightRange);var i=p._headlightIntensity,U=oq(p._headlightColor);1!==i&&(U=[U[0]*i,U[1]*i,U[2]*i]),cf(e,j.uHeadlightColor,[U[0],U[1],U[2],p._headlightDisabled?1:0]);var r=p._59O,u=p._spots,l=p._dirs;if(r.length){var b=[],q=[],D=[];r.forEach(function(Y){Ge(b,Y),gb(q,p._transformPointToViewSpace(Y.p3())),D.push(Y.s("light.range"))}),e.uniform4fv(j.uPointColor,b),e.uniform1fv(j.uPointRange,D),e.uniform3fv(j.uPointPosition,q)}if(u.length){var k=[],P=[],a=[],O=[],f=[],S=[];u.forEach(function(v){Ge(k,v),gb(P,p._transformPointToViewSpace(v.p3())),gb(f,p._transformDirectionToViewSpace(v.p3(),v.s("light.center"))),a.push(v.s("light.range")),O.push(G(v.s("light.angle")/2)),S.push(v.s("light.exponent"))}),e.uniform4fv(j.uSpotColor,k),e.uniform1fv(j.uSpotRange,a),e.uniform1fv(j.uSpotAngle,O),e.uniform1fv(j.uSpotExponent,S),e.uniform3fv(j.uSpotPosition,P),e.uniform3fv(j.uSpotDirection,f)}if(l.length){var L=[],h=[];l.forEach(function(N){Ge(L,N),gb(h,p._transformDirectionToViewSpace(N.p3()))}),e.uniform4fv(j.uDirColor,L),e.uniform3fv(j.uDirDirection,h)}},jc=function(E){return E>0&&0===(E-1&E)},Be=function(z){return z=v(0,R(j,z)),z=v(kc,R(j-kc,z))},Xm=function(){return.05+I()/2},Um=function(q,B,t,Y){var b,j=q.getEye();return q.isOrtho()?(b=xl(q.getCenter(),j),b[0]+=Y[0],b[1]+=Y[1],b[2]+=Y[2]):b=j,rp(B,t,Y,b)},rp=function(J,f,N,Q){var T=Xo(J,f),i=xl(Q,N,!0),y=Xo(i,f);if(w(y)<kc)return m;var u=(T-Xo(N,f))/y;return[N[0]+i[0]*u,N[1]+i[1]*u,N[2]+i[2]*u]},uj=function(Q,W){return{x:2*Q.x-W.x,y:2*Q.y-W.y}},Fd=function(S,V,y,q){var B,o;if(!S)return B=r(V.y-y.y,y.x-V.x),{x:V.x+q*A(B),y:V.y+q*G(B)};if(!y)return B=r(S.y-V.y,V.x-S.x),{x:V.x+q*A(B),y:V.y+q*G(B)};var N=xl([S.x,S.y,0],[V.x,V.y,0],!0),e=xl([y.x,y.y,0],[V.x,V.y,0],!0),k=-(N[0]+e[0])/2,C=-(N[1]+e[1])/2,d=X(k*k+C*C);if(kc>d)return B=r(S.y-V.y,V.x-S.x),{x:V.x+q*A(B),y:V.y+q*G(B)};var P=S.x-V.x,g=S.y-V.y,f=y.x-V.x,u=y.y-V.y,t=X(P*P+g*g),_=X(f*f+u*u);B=p(Xo(N,e))/2,o=N[1]*e[0]-N[0]*e[1]>0?-1:1,k/=d,C/=d;var l=q/A(B),m=v(t,_)/G(B);d=Math.min(l,m);var b={x:V.x+o*d*k,y:V.y+o*d*C};return y.b&&l>_/G(B)&&(b.adjust=!0),b},Fe=function(Q){var d=Q[1],N=Q[2],f=Q[3],O=Q[6],j=Q[7],h=Q[11];Q[1]=Q[4],Q[2]=Q[8],Q[3]=Q[12],Q[4]=d,Q[6]=Q[9],Q[7]=Q[13],Q[8]=N,Q[9]=O,Q[11]=Q[14],Q[12]=f,Q[13]=j,Q[14]=h},Eq=function(b){var l=b[0],B=b[1],h=b[2],s=b[3],P=b[4],j=b[5],e=b[6],T=b[7],t=b[8],z=b[9],R=b[10],X=b[11],O=b[12],$=b[13],U=b[14],N=b[15],D=l*j-B*P,H=l*e-h*P,d=l*T-s*P,x=B*e-h*j,W=B*T-s*j,o=h*T-s*e,n=t*$-z*O,g=t*U-R*O,V=t*N-X*O,I=z*U-R*$,F=z*N-X*$,K=R*N-X*U,y=D*K-H*F+d*I+x*V-W*g+o*n;return y?(y=1/y,b[0]=(j*K-e*F+T*I)*y,b[1]=(h*F-B*K-s*I)*y,b[2]=($*o-U*W+N*x)*y,b[3]=(R*W-z*o-X*x)*y,b[4]=(e*V-P*K-T*g)*y,b[5]=(l*K-h*V+s*g)*y,b[6]=(U*d-O*o-N*H)*y,b[7]=(t*o-R*d+X*H)*y,b[8]=(P*F-j*V+T*n)*y,b[9]=(B*V-l*F-s*n)*y,b[10]=(O*W-$*d+N*D)*y,b[11]=(z*d-t*W-X*D)*y,b[12]=(j*g-P*I-e*n)*y,b[13]=(l*I-B*g+h*n)*y,b[14]=($*H-O*x-U*D)*y,b[15]=(t*x-z*H+R*D)*y,void 0):m},bl=function(n,T){if(T){var a=T[0],o=T[1],R=T[2];n[12]=n[0]*a+n[4]*o+n[8]*R+n[12],n[13]=n[1]*a+n[5]*o+n[9]*R+n[13],n[14]=n[2]*a+n[6]*o+n[10]*R+n[14],n[15]=n[3]*a+n[7]*o+n[11]*R+n[15]}},ns=function(R,u){if(u){var j=u[0],P=u[1],h=u[2];R[0]=R[0]*j,R[1]=R[1]*j,R[2]=R[2]*j,R[3]=R[3]*j,R[4]=R[4]*P,R[5]=R[5]*P,R[6]=R[6]*P,R[7]=R[7]*P,R[8]=R[8]*h,R[9]=R[9]*h,R[10]=R[10]*h,R[11]=R[11]*h}},Mo=function(w,X,C){var F=X[0],x=X[1],A=X[2],l=X[3],n=X[4],d=X[5],R=X[6],U=X[7],m=X[8],f=X[9],z=X[10],B=X[11],q=X[12],H=X[13],s=X[14],b=X[15],v=C[0],j=C[1],y=C[2],W=C[3];return w[0]=v*F+j*n+y*m+W*q,w[1]=v*x+j*d+y*f+W*H,w[2]=v*A+j*R+y*z+W*s,w[3]=v*l+j*U+y*B+W*b,v=C[4],j=C[5],y=C[6],W=C[7],w[4]=v*F+j*n+y*m+W*q,w[5]=v*x+j*d+y*f+W*H,w[6]=v*A+j*R+y*z+W*s,w[7]=v*l+j*U+y*B+W*b,v=C[8],j=C[9],y=C[10],W=C[11],w[8]=v*F+j*n+y*m+W*q,w[9]=v*x+j*d+y*f+W*H,w[10]=v*A+j*R+y*z+W*s,w[11]=v*l+j*U+y*B+W*b,v=C[12],j=C[13],y=C[14],W=C[15],w[12]=v*F+j*n+y*m+W*q,w[13]=v*x+j*d+y*f+W*H,w[14]=v*A+j*R+y*z+W*s,w[15]=v*l+j*U+y*B+W*b,w},ol=function(f,u,y,r){var c,C,L,G,D,S,Y,O,K,U,N=u[0],I=u[1],H=u[2],s=r[0],A=r[1],j=r[2],$=y[0],g=y[1],P=y[2];return w(N-$)<kc&&w(I-g)<kc&&w(H-P)<kc?uh(f):(Y=N-$,O=I-g,K=H-P,U=1/X(Y*Y+O*O+K*K),Y*=U,O*=U,K*=U,c=A*K-j*O,C=j*Y-s*K,L=s*O-A*Y,U=X(c*c+C*C+L*L),U?(U=1/U,c*=U,C*=U,L*=U):(c=0,C=0,L=0),G=O*L-K*C,D=K*c-Y*L,S=Y*C-O*c,U=X(G*G+D*D+S*S),U?(U=1/U,G*=U,D*=U,S*=U):(G=0,D=0,S=0),f[0]=c,f[1]=G,f[2]=Y,f[3]=0,f[4]=C,f[5]=D,f[6]=O,f[7]=0,f[8]=L,f[9]=S,f[10]=K,f[11]=0,f[12]=-(c*N+C*I+L*H),f[13]=-(G*N+D*I+S*H),f[14]=-(Y*N+O*I+K*H),f[15]=1,f)},Zc=function(q,H,a,h,Q){var Z=1/T(H/2),b=1/(h-Q);return q[0]=Z/a,q[1]=0,q[2]=0,q[3]=0,q[4]=0,q[5]=Z,q[6]=0,q[7]=0,q[8]=0,q[9]=0,q[10]=(Q+h)*b,q[11]=-1,q[12]=0,q[13]=0,q[14]=2*Q*h*b,q[15]=0,q},gi=function(g,t,Z,x,N,V,v){var z=1/(t-Z),u=1/(x-N),l=1/(V-v);return g[0]=-2*z,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*u,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*l,g[11]=0,g[12]=(t+Z)*z,g[13]=(N+x)*u,g[14]=(v+V)*l,g[15]=1,g},vl=function(Y,Z){var S=Z[0],c=Z[1],N=Z[2],G=Z[3],R=S*S+c*c+N*N+G*G,v=R?1/R:0;return Y[0]=-S*v,Y[1]=-c*v,Y[2]=-N*v,Y[3]=G*v,Y},qs=function(D,m){var _=m[0]+m[5]+m[10],K=0;return _>0?(K=2*Math.sqrt(_+1),D[3]=.25*K,D[0]=(m[6]-m[9])/K,D[1]=(m[8]-m[2])/K,D[2]=(m[1]-m[4])/K):m[0]>m[5]&m[0]>m[10]?(K=2*Math.sqrt(1+m[0]-m[5]-m[10]),D[3]=(m[6]-m[9])/K,D[0]=.25*K,D[1]=(m[1]+m[4])/K,D[2]=(m[8]+m[2])/K):m[5]>m[10]?(K=2*Math.sqrt(1+m[5]-m[0]-m[10]),D[3]=(m[8]-m[2])/K,D[0]=(m[1]+m[4])/K,D[1]=.25*K,D[2]=(m[6]+m[9])/K):(K=2*Math.sqrt(1+m[10]-m[0]-m[5]),D[3]=(m[1]-m[4])/K,D[0]=(m[8]+m[2])/K,D[1]=(m[6]+m[9])/K,D[2]=.25*K),D},Ij=function(l,X,H){var x=X[0],g=X[1],N=X[2],a=X[3],j=x+x,e=g+g,m=N+N,M=x*j,U=x*e,A=x*m,u=g*e,q=g*m,t=N*m,z=a*j,R=a*e,Q=a*m;return l[0]=1-(u+t),l[1]=U+Q,l[2]=A-R,l[3]=0,l[4]=U-Q,l[5]=1-(M+t),l[6]=q+z,l[7]=0,l[8]=A+R,l[9]=q-z,l[10]=1-(M+u),l[11]=0,l[12]=H[0],l[13]=H[1],l[14]=H[2],l[15]=1,l},wp=b.getRotationFromMatrix4,Rp=function(){var H=[0,0,0],l=[0,0,0],T=[0,0,0],B=function(T,k,N){T[0]=k[1]*N[2]-k[2]*N[1],T[1]=k[2]*N[0]-k[0]*N[2],T[2]=k[0]*N[1]-k[1]*N[0]},q=function(Q){return Q[0]*Q[0]+Q[1]*Q[1]+Q[2]*Q[2]},E=function(v){var p=Math.sqrt(q(v));v[0]/=p,v[1]/=p,v[2]/=p},L=function($,z,Q){$[0]=z[0]-Q[0],$[1]=z[1]-Q[1],$[2]=z[2]-Q[2]};return function(b,w,N){var y=vc();return L(T,b,w),0===q(T)&&(T[2]=1),E(T),B(H,N,T),0===q(H)&&(1===Math.abs(N[2])?T[0]+=1e-4:T[2]+=1e-4,E(T),B(H,N,T)),E(H),B(l,T,H),y[0]=H[0],y[4]=l[0],y[8]=T[0],y[1]=H[1],y[5]=l[1],y[9]=T[1],y[2]=H[2],y[6]=l[2],y[10]=T[2],y}}(),as=function(x,B){return ol(B?B:vc(),x._eye,x._center,x._up)},pi=function(i){var R=i.getAspect(),C=i._near,E=i._far,l=vc();if(i._ortho){var L=i._orthoWidth/2,t=L/R;gi(l,-L,L,-t,t,C,E)}else Zc(l,i._fovy,R,C,E);return l},oi=function(B,t){if(!B)return m;var b=0,I=1,N=2,D=[],Z=0,w=B.length,l=w/3;if(t){for(;w>Z;Z++)D[Z]=0;for(Z=0;Z<t.length;Z+=3){var q=[],i=[],Q=[];q[b]=B[3*t[Z+1]+b]-B[3*t[Z]+b],q[I]=B[3*t[Z+1]+I]-B[3*t[Z]+I],q[N]=B[3*t[Z+1]+N]-B[3*t[Z]+N],i[b]=B[3*t[Z+2]+b]-B[3*t[Z+1]+b],i[I]=B[3*t[Z+2]+I]-B[3*t[Z+1]+I],i[N]=B[3*t[Z+2]+N]-B[3*t[Z+1]+N],Q[b]=q[I]*i[N]-q[N]*i[I],Q[I]=q[N]*i[b]-q[b]*i[N],Q[N]=q[b]*i[I]-q[I]*i[b];for(var R=0;3>R;R++)D[3*t[Z+R]+b]+=Q[b],D[3*t[Z+R]+I]+=Q[I],D[3*t[Z+R]+N]+=Q[N]}}else for(Z=0;l>Z;Z+=3){var q=[],i=[],Q=[];q[b]=B[3*(Z+1)+b]-B[3*Z+b],q[I]=B[3*(Z+1)+I]-B[3*Z+I],q[N]=B[3*(Z+1)+N]-B[3*Z+N],i[b]=B[3*(Z+2)+b]-B[3*(Z+1)+b],i[I]=B[3*(Z+2)+I]-B[3*(Z+1)+I],i[N]=B[3*(Z+2)+N]-B[3*(Z+1)+N],Q[b]=q[I]*i[N]-q[N]*i[I],Q[I]=q[N]*i[b]-q[b]*i[N],Q[N]=q[b]*i[I]-q[I]*i[b];for(var R=0;3>R;R++)D[3*(Z+R)+b]=Q[b],D[3*(Z+R)+I]=Q[I],D[3*(Z+R)+N]=Q[N]}for(Z=0;w>Z;Z+=3){var e=[];e[b]=D[Z+b],e[I]=D[Z+I],e[N]=D[Z+N];var r=X(e[b]*e[b]+e[I]*e[I]+e[N]*e[N]);0===r&&(r=kc),e[b]=e[b]/r,e[I]=e[I]/r,e[N]=e[N]/r,D[Z+b]=e[b],D[Z+I]=e[I],D[Z+N]=e[N]}return new ck(D)},Le=function(S,$,N,d){if(N||(N=S.createTexture()),$){var Y=S.TEXTURE_2D,s=S.REPEAT,X=S.CLAMP_TO_EDGE,O=S.TEXTURE_MIN_FILTER;d!==S.NEAREST&&(d=S.LINEAR),hd(S,N),S.texImage2D(Y,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,$),_b(S,S.TEXTURE_MAG_FILTER,d),jc($.width)&&jc($.height)&&!$.clampToEdge?(_b(S,S.TEXTURE_WRAP_S,s),_b(S,S.TEXTURE_WRAP_T,s),_b(S,O,S.LINEAR_MIPMAP_LINEAR),S.generateMipmap(Y)):(_b(S,S.TEXTURE_WRAP_S,X),_b(S,S.TEXTURE_WRAP_T,X),_b(S,O,d)),hd(S,m)}return N},$g=function(G,a){var x=new Uint8Array(3);return a=a||G.createTexture(),hd(G,a),_b(G,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texImage2D(G.TEXTURE_2D,0,G.RGB,1,1,0,G.RGB,G.UNSIGNED_BYTE,x),a},hq=function(R){R._26I&&R._prg&&(R._26I.deleteProgram(R._prg),R._prg=m)},cg=function(M,C,L,y){var K=M.createShader(L);return M.shaderSource(K,y),M.compileShader(K),M.attachShader(C,K),K},Ie=function(f){return f.createBuffer()},hd=function(F,V){F.bindTexture(F.TEXTURE_2D,V)},Yk=function(X,A){X.bindFramebuffer(X.FRAMEBUFFER,A)},_b=function(R,F,N){R.texParameteri(R.TEXTURE_2D,F,N)},Fg=function(f,j){if(j){var j=oq(j);f.clearColor(j[0],j[1],j[2],j[3])}},yd=function(Y,D){cf(Y,D.uFix,!0),Qi(Y,D.aNormal)},pc=function(h,n){cf(h,n.uFix,!1),Zk(h,n.aNormal)},xp=function(U,o,j,J,k,v,I,M){U._picking||(j?(cf(U,o.uBlend,!0),cf(U,o.uBlendColor,j)):cf(U,o.uBlend,!1),cf(U,o.uLight,J==m?!0:J),Wj(k)&&1!==k&&cf(U,o.uPartOpacity,k),cf(U,o.uReverseFlip,v==m?!1:v),cf(U,o.uFixPickReverseColor,I||_j)),M?U.enable(U.CULL_FACE):U.disable(U.CULL_FACE)},Qo=function(Q,v){Q._picking||cf(Q,v.uPartOpacity,1)},fs=function(x,b,Q,I,L,l,m,g,k){if(!Q)return x.activeTexture(x.TEXTURE0),hd(x,x._emptyTexture),x.activeTexture(x.TEXTURE1),hd(x,x._emptyBlendTexture),void 0;cf(x,b.uTexture,!0),cf(x,b.uDiscardSelectable,tg(I)?I:!0),Zk(x,b.aUv),go(x,L,l,b.aUv,2),k?(cf(x,b.uBlendTexture,!0),x.activeTexture(x.TEXTURE1),hd(x,k),x.uniform1i(b.uBlendSampler,1)):(cf(x,b.uBlendTexture,!1),x.activeTexture(x.TEXTURE1),hd(x,x._emptyBlendTexture)),x.activeTexture(x.TEXTURE0),hd(x,Q),x.uniform1i(b.uSampler,0);var r=[0,0,1,1];m&&(r[0]=m[0],r[1]=m[1]),g&&(r[2]=g[0],r[3]=g[1]),cf(x,b.uOffsetScale,r)},zq=function(g,F,T){g.activeTexture(g.TEXTURE0),hd(g,m),g.activeTexture(g.TEXTURE1),hd(g,m),T&&(Qi(g,F.aUv),cf(g,F.uTexture,!1),cf(g,F.uBlendTexture,!1))},dh=function(B,R,$,n,H,b){!$||g||e||B.lineWidth($),n&&!B._picking&&cf(B,R.uFixPickReverseColor,n),H&&go(B,H,b,R.aPosition)},ce=function(M,p,f,s){nn&&(s=M[nn]),M.drawArrays(s==m?M.TRIANGLES:s,p,f);var V=M._renderInfo;V&&(V.calls++,V.vertices+=f,(s==m||s===M.TRIANGLES)&&(V.faces+=f/3),s===M.LINES&&(V.lines+=f/2))},Ln=function(c,o,g,s){nn&&(s=c[nn]),c.drawElements(s==m?c.TRIANGLES:s,g,c.UNSIGNED_SHORT,o==m?0:2*o);var x=c._renderInfo;x&&(x.calls++,x.vertices+=g,(s==m||s===c.TRIANGLES)&&(x.faces+=g/3),s===c.LINES&&(x.lines+=g/2))},Yo=function(O,A,B,l,d){var $=O.ARRAY_BUFFER;O.bindBuffer($,A),B&&O.bufferData($,B,O.STATIC_DRAW),l!=m&&O.vertexAttribPointer(l,d?d:3,O.FLOAT,!1,0,0)},go=function(_,l,M,Y,f){return M?(lm(_,_.ARRAY_BUFFER,l,M),Y!=m&&_.vertexAttribPointer(Y,f?f:3,_.FLOAT,!1,0,0),void 0):Yo(_,l,M,Y,f)},Vc=function(J,i,d){var b=J.ELEMENT_ARRAY_BUFFER;J.bindBuffer(b,i),d&&J.bufferData(b,d,J.STATIC_DRAW)},to=function(Q,Z,i){lm(Q,Q.ELEMENT_ARRAY_BUFFER,Z,i)},lm=function(M,p,J,r){var J,E=r.glBuf,Q=M._id;E&&(J=E[Q])&&J._buf?M.bindBuffer(p,J._buf):(J={_buf:Ie(M)},M._bufPool.push(J),M.bindBuffer(p,J._buf),M.bufferData(p,r,M.STATIC_DRAW),E||(E=r.glBuf={}),E[Q]=J),J._fid=M._renderInfo.frame},cf=function(V,y,$){if($!=m&&y!=m){$=oq($);var s=$.length;3===s?V.uniform3fv(y,$):4===s?V.uniform4fv(y,$):16===s?V.uniformMatrix4fv(y,!1,$):tg($)?V.uniform1i(y,$?1:0):2===s?V.uniform2fv(y,$):V.uniform1f(y,$)}},Zk=function(j,V){V!=m&&V>=0&&j.enableVertexAttribArray(V)},Qi=function(K,$){$!=m&&$>=0&&K.disableVertexAttribArray($)},Ph=function(R,K){var t=R.getGL(),w=R._prg;R._7O=R._8O.pop(),K&&(cf(t,w.uMVMatrix,R._7O),R._6O=K,cf(t,w.uNMatrix,K))},Ve=function(W,L){return L||(L=vc()),Zo(L,W),Eq(L),Fe(L),L},sp=function(y,O){var w=y.getGL(),K=y._prg,n=y._7O;O&&(y._8O.push(le(n)),Mo(n,n,O)),cf(w,K.uMVMatrix,n),cf(w,K.uNMatrix,Ve(n,y._6O))},cs=function(D,u,z,k,C,X){if(z){if(k){var p=z.value++,d=2147483648|p,$=[(255&d>>16)/255,(255&d>>8)/255,(255&d)/255,(255&d>>24)/255];z[p]={data:C,part:X}}else $=Ir;return cf(D,u.uFixPickReverseColor,$),$}},$n=function(){var X={center:function(R,z,u,X,h){var O=-z[1]/2,J={x:-z[0]/2,y:O,width:z[0],height:z[1]},i=wq(R,J,u);return[i.x+X,-i.y-h,Xm()]},front:function(H,I,x,L,P){var T=-I[1]/2,S={x:-I[0]/2,y:T,width:I[0],height:I[1]},k=wq(H,S,x);return[k.x+L,-k.y-P,I[2]/2+Xm()]},back:function(E,x,T,q,A){var _=-x[0]/2,e=-x[1]/2,Z={x:_,y:e,width:x[0],height:x[1]},P=wq(E,Z,T);return[-P.x-q,-P.y-A,-x[2]/2-Xm()]},left:function(Q,R,a,u,H){var I=-R[1]/2,_={x:-R[2]/2,y:I,width:R[2],height:R[1]},G=wq(Q,_,a);return[-R[0]/2-Xm(),-G.y-H,G.x+u]},right:function(V,z,S,J,L){var q=-z[2]/2,Y=-z[1]/2,E={x:q,y:Y,width:z[2],height:z[1]},H=wq(V,E,S);return[z[0]/2+Xm(),-H.y-L,-H.x-J]},top:function(E,k,U,g,q){var C={x:-k[0]/2,y:-k[2]/2,width:k[0],height:k[2]},x=wq(E,C,U);return[x.x+g,k[1]/2+Xm(),x.y+q]},bottom:function(R,i,h,_,n){var u=-i[2]/2,E={x:-i[0]/2,y:u,width:i[0],height:i[2]},M=wq(R,E,h);return[M.x+_,-i[1]/2-Xm(),-M.y-n]}};return function(j,d,B,O,t,V){return X[O](j,d,B,t||0,V||0)}}(),Wf=function(s,x,O,Y,l,g,C,T,P,a){if(l&&(x[0]+=l[0],x[1]+=l[1],x[2]+=l[2]),bl(s,O),T){var w=vc();if(ei(w,P,a),zh(x,w),bl(s,x),s.auto=T,s.pos=zh([0,0,0],s),g){var A=s.mat2=vc();ei(A,g,C)}}else ei(s,P,a),bl(s,x),Y===ip?Lo(s,-y):Y===jf?Lo(s,y):Y===wh?ue(s,-y):Y===ef?ue(s,y):Y===Pk&&Lo(s,j),ei(s,g,C);return s},Gf=function(j,s){var p=s.auto,g=s.mat2,E=j.gv;if(p){var R,b=vc(),y=[0,0,0,0];R="string"==typeof p?[p.indexOf("x")<0?E._eye[0]:E._center[0],p.indexOf("y")<0?E._eye[1]:E._center[1],p.indexOf("z")<0?E._eye[2]:E._center[2]]:E._eye,qs(y,ol(vc(),R,E._center,E._up)),Ij(b,vl(y,y),s.pos),g&&Mo(b,b,g),sp(E,b)}else sp(E,s)},Jl=function(b,u,g,h,q){var n=b.s,X=b.gv,J=X.getGL(),T=X._prg,O=X._buffer,W=X._1O;Le(J,ao,W),Gf(b,g),xp(J,T,n(u+".blend"),n(u+".light"),n(u+".opacity"),n(u+".reverse.flip"),n(u+".reverse.color"),n(u+".reverse.cull")),fs(J,T,W,q,O.uv,$d),go(J,O.vs,h,T.aPosition),go(J,O.ns,Kq,T.aNormal),to(J,O.is,So),Ln(J,0,So.length),zq(J,T,W),Qo(J,T),Ph(X)},In=function(T,x,E){var F=T.gv,W=T.data,V=T[x]={blend:F.getBodyColor(W)||F.getFaceBlend(W,x),light:F.getFaceLight(W,x),color:F.getFaceColor(W,x),opacity:F.getFaceOpacity(W,x),transparent:F.getFaceTransparent(W,x),reverseFlip:F.getFaceReverseFlip(W,x),reverseColor:F.getFaceReverseColor(W,x),reverseCull:F.getFaceReverseCull(W,x),texture:F.getFaceImage(W,x),blendTexture:F.getFaceBlendImage(W,x),discardSelectable:F.getFaceDiscardSelectable(W,x)};if("csg"!==x){V.uv=F.getFaceUv(W,x)||E&&E[x+"Uv"],V.uvScale=F.getFaceUvScale(W,x)||E&&E[x+"UvScale"],V.uvOffset=F.getFaceUvOffset(W,x)||E&&E[x+"UvOffset"];var G=F.getFaceMat(W,x);G&&(V.mat=ak(W,G))}return V},Gq=function(p,f,i,a,R){if(a){if(!R(a.transparent))return;var w=p.data,K=p.gv,U=K._buffer,v=K.getTexture(a.texture,w),M=K.getTexture(a.blendTexture,w);fs(f,i,v,a.discardSelectable,U.uv,a.tuv,a.uvOffset,a.uvScale,M),xp(f,i,a.blend,a.light,a.opacity,a.reverseFlip,a.reverseColor,a.reverseCull),cf(f,i.uDiffuse,a.color),go(f,U.vs,a.vs,i.aPosition),go(f,U.ns,a.ns,i.aNormal),ce(f,0,a.vs.length/3),Qo(f,i),zq(f,i,v)}},Ok=function(b,X,k,S,u,E){var p,D,T,l,V,P,U,c,t,Z,_,Y=[S-X,u-k],C=b?b.length:0;for(T=0;C>T;T++){for(l=2,p=b[T],V=p[0],P=p[1];l+1<p.length;){if(U=p[l],c=p[l+1],D=no(X,k,S,u,V,P,U,c,!0)){t=[U-V,c-P],Z=fr(t),t[0]/=Z,t[1]/=Z,Z=Xo(Y,t),Z=Z>0?E:-E,_=[t[0]*Z,t[1]*Z];break}V=U,P=c,l+=2}if(_)break}if(_)for(S=X+_[0],u=k+_[1],T=0;C>T;T++)for(l=2,p=b[T],V=p[0],P=p[1];l+1<p.length;){if(U=p[l],c=p[l+1],D=no(X,k,S,u,V,P,U,c,!0))return[0,0];V=U,P=c,l+=2}return _?_:[S-X,u-k]},bb=o.graph3d={},ji=function(I,R,e){Uo($+".graph3d."+I,R,e)},hl="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",cl="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
mm(b,{setBatchInfo:function(E,I){tk[E]=I},getBatchInfo:function(V){return tk[V]}},!0);var de=[1,1,1],Zb=[1,0,0,0,0,1,0,1,1,1,1,0],Hn=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],ve=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],ig=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Bo=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Jj=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Yg=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],gj=function(e,b){oh(e,b,"_batchModelMap","_batchIndexMap"),we(e,b,"_wireframeModelMap","_wireframeIndexMap"),we(e,b,"_polylineModelMap","_polylineIndexMap"),we(e,b,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),we(e,b,"_polylineModelMapSwap","_polylineIndexMapSwap")},oh=function(O,V,E,W){if(!V)return O[E]={},O[W]={},void 0;var z=V._id,y=O[W],c=y[z];if(c){var A=O[E],w=c.batch,Q=A[w],d=Q.ds,M=c.index;if(Q.invalidate=!0,delete y[z],d.splice(M,1),rk(d))return delete A[w],void 0;for(var j=c.begin,m=c.size,Y=3*j,o=3*m,L=4*j,b=4*m,F=Q.vs,p=Q.ps,a=Q.uv,g=Q.cs,s=Q.bs,u=Q.rs,n=Q.ns,H=Q.ls;M<d.length;M++)c=y[d[M]._id],c.index--,c.begin-=m;F.splice(Y,o),p.splice(L,b),a&&a.splice(2*j,2*m),g&&g.splice(L,b),s&&s.splice(Y,o),u&&u.splice(j,m),n&&n.splice(Y,o),H&&H.splice(j,m)}},we=oh,Kh=function(A,v,c,L){if(!L)return m;var q=v[L];if(!q){var u=tk[L]||$j,M=u.image?[]:m;q=v[L]={vs:[],ns:[],uv:M,cs:M?m:u.color?m:[],bs:u.blend?[]:m,ps:[],rs:u.brightness?[]:m,ds:[]}}return q.invalidate=!0,A[c._id]={index:q.ds.length,begin:q.vs.length/3,batch:L},q.ds.push(c),q},Ig=function(C,E){return E!=m&&1!==E?[C[0]*E,C[1]*E,C[2]*E,C[3]]:C},Jc=function(y,S,Q){var f=y.getBrightness(S),A=oq(Q.color||"white"),v=A[3]<1,W=Math.ceil(Q.width)||1,p=(v?"T":"O")+W,R=y._wireframeIndexMap,D=y._wireframeModelMap,o=D[p];o||(o=D[p]={vs:[],cs:[],ps:[],ds:[],T:v,W:W});var F,V=y.getData3dUI(S),q=Cl(V);if(Q.geometry){if(!q)return;if(F=ws(q),!F)return}else F=Q.short?hh:mn;o.invalidate=!0;var l=o.vs,T=o.cs,Y=o.ds,e=R[S._id]={index:Y.length,begin:l.length/3,batch:p};Y.push(S);var h=ak(S,Q.mat),I=V._calcAnchorMat(S);I&&Mo(h,h,I),$k(l,h,F);var J=e.size=l.length/3-e.begin;ub(T,Ig(A,f),J)},wi=function(n,k,z,Y,b,r,H,d,v){var t=n.getBrightness(k);t==m&&(t=1);var B=Ig(oq(Y),t),D=B[3]<1;r=Math.ceil(r)||1;var u=(D?"T":"O")+r;if(H){var q=H[0],S=(H[1]||q)+q;u+="-"+q+"-"+S,v&&(u+="-"+wj(v)+"-"+t,v=Ig(oq(v),t))}var M=n._polylineIndexMap,s=n._polylineModelMap,e=s[u];e||(e=s[u]={vs:[],cs:[],ps:[],ds:[],ls:H?[]:m,T:D,W:r},H&&(e.D=q,e.G=S,e.A=v)),e.invalidate=!0;var c,J=e.vs,T=e.cs,W=e.ds,C=e.ls,a=M[k._id]={index:W.length,begin:J.length/3,batch:u};W.push(k),gb(J,z);var w,L=a.size=J.length/3-a.begin,F=z.length,N=0,j=[];if(H||b)for(c=0;F>c;c+=6)w=fr([z[c],z[c+1],z[c+2]],[z[c+3],z[c+4],z[c+5]]),j.push(w),N+=w;if(N&&b){var V,O=Ig(oq(b),t),P=[O[0]-B[0],O[1]-B[1],O[2]-B[2],O[3]-B[3]],Z=0;for(c=0;F>c;c+=6)V=Z/N,ub(T,[B[0]+P[0]*V,B[1]+P[1]*V,B[2]+P[2]*V,B[3]+P[3]*V],1),Z+=j[c/6],V=Z/N,ub(T,[B[0]+P[0]*V,B[1]+P[1]*V,B[2]+P[2]*V,B[3]+P[3]*V],1)}else ub(T,B,L);if(H)for(Z=d||0,c=0;F>c;c+=6)C.push(Z),Z+=j[c/6],C.push(Z)},td=function(T,z,I){if(z)for(var F=4*z.begin,u=I[z.batch].ps,e=0;e<z.size;e++)u[F++]=T[0],u[F++]=T[1],u[F++]=T[2],u[F++]=T[3]},od=function(i,f){var J=f+["32"],s=i[f],B=i[J];s?B&&B.length===s.length?(B.set(s),B.glBuf=null):i[J]=new ck(s):delete i[J]},Cq=function(j,J,l,I,f,d,D,L,U){if(sc(l))l.forEach(function(l){Cq(j,J,l,I,f,d,D,L,U)});else if(Mq(l))Cq(j,J,Cl(I,l),I,f,d,D,L,U);else if(hk(l)){var m,V=Nd(l.mat,J,j),G=Nd(l.s3,J,j),s=Nd(l.t3,J,j),Y=Nd(l.r3,J,j);if((G||Y||s||V)&&(m=am(V,G,Y,Nd(l.rotationMode,J,j),s),d.push(m)),l.shape3d)Cq(j,J,l.shape3d,I,f,d,D,L,l);else{var P=I.s;U=U||$j;var M=d[0],W=d.length,O=P("shape3d.color",l.color,U.color);if(f||(f=P("shape3d.blend",l.blend,U.blend)),W>1){M=le(M);for(var N=1;W>N;N++)Mo(M,M,d[N])}l.vs&&P(ng,l.visible,U.visible)&&Si(M,D,L,l.vs,l.uv,l.is,f,O),l.top_vs&&P(pf,l.topVisible,U.topVisible)&&Si(M,D,L,l.top_vs,l.top_uv,l.top_is,f,P("shape3d.top.color",l.topColor,U.topColor)||O),l.bottom_vs&&P(jb,l.bottomVisible,U.bottomVisible)&&Si(M,D,L,l.bottom_vs,l.bottom_uv,l.bottom_is,f,P("shape3d.bottom.color",l.bottomColor,U.bottomColor)||O),l.from_vs&&P(gr,l.fromVisible,U.fromVisible)&&Si(M,D,L,l.from_vs,l.from_uv,l.from_is,f,P("shape3d.from.color",l.fromColor,U.fromColor)||O),l.to_vs&&P(dk,l.toVisible,U.toVisible)&&Si(M,D,L,l.to_vs,l.to_uv,l.to_is,f,P("shape3d.to.color",l.toColor,U.toColor)||O)}m&&d.pop()}},Si=function(j,i,T,e,l,F,z,h){var q,G=i.cs,d=i.uv,R=i.bs;if(F){q=F.length;for(var $=0;q>$;$++){var v=F[$];$k(T,j,[e[3*v],e[3*v+1],e[3*v+2]]),d&&gb(d,[l[2*v],l[2*v+1]])}}else q=e.length/3,$k(T,j,e),d&&gb(d,l);G&&ub(G,h,q),R&&(z?qb(R,z,q):gb(R,de,q))},Nn=function(n,i,w,$){var E=[];$?Cq(n.gv,n.data,$,n,n.getBodyColor(),[i],w,E):(Ug(n,ip,i,w,E),Ug(n,jf,i,w,E),Ug(n,fq,i,w,E),Ug(n,Pk,i,w,E),Ug(n,wh,i,w,E),Ug(n,ef,i,w,E),Ug(n,"csg",i,w,E)),E.length&&(gb(w.vs,E),gb(w.ns,oi(E)))},Ug=function(S,J,t,F,U){var P=S[J];if(P){var q=P.tuv;if(q){var E,k,A,e,x=P.uvScale,N=P.uvOffset;if(x)for(E=q.length,k=x[0],A=x[1],e=0;E>e;e+=2)q[e]*=k,q[e+1]*=A;if(N)for(E=q.length,k=N[0],A=N[1],e=0;E>e;e+=2)q[e]+=k,q[e+1]+=A}Si(t,F,U,P.vs,q,m,P.blend,P.color)}},vm=function(X,R,$,Z,z,D,a,M){var w,P=$.cs,H=$.uv,d=$.bs;if(X.getFaceVisible(R,D)){var A=X.getFaceMat(R,D);if(A&&(z=ak(R,A)),$k(a,z,M),P&&ub(P,X.getFaceColor(R,D),6),H){var K=X.getFaceUv(R,D)||Z[D+"Uv"],y=X.getFaceUvScale(R,D)||Z[D+"UvScale"],W=X.getFaceUvOffset(R,D)||Z[D+"UvOffset"];K=K?[K[6],K[7],K[0],K[1],K[2],K[3],K[2],K[3],K[4],K[5],K[6],K[7]]:Zb;var I=K[0],x=K[1],S=K[2],m=K[3],p=K[4],j=K[5],r=K[6],B=K[7],L=K[8],k=K[9],v=K[10],Y=K[11];if(y){var T=y[0],G=y[1];I*=T,x*=G,S*=T,m*=G,p*=T,j*=G,r*=T,B*=G,L*=T,k*=G,v*=T,Y*=G}if(W){var c=W[0],E=W[1];I+=c,x+=E,S+=c,m+=E,p+=c,j+=E,r+=c,B+=E,L+=c,k+=E,v+=c,Y+=E}H.push(I,x,S,m,p,j,r,B,L,k,v,Y)}d&&(w=X.getBodyColor(R)||X.getFaceBlend(R,D),w?qb(d,w,6):gb(d,de,6))}},Km=function(k,W,o,p){var G=k.getGL(),I=k._prg,q=k._buffer;if(!Dk(W)){sp(k),yd(G,I);for(var C in W){var Y=W[C];if(!(p&&!Y.T||!p&&Y.T)){Y.invalidate?(Y.invalidate=!1,od(Y,"vs"),od(Y,"cs"),od(Y,"ls"),od(Y,"ps")):o&&od(Y,"ps");var d=Y.vs32,Z=o?Y.ps32:Y.cs32;dh(G,I,Y.W,m,q.vs,d);var u=Y.D,e=!k._dashDisabled&&u;cf(G,I.uAlphaTest,_.alphaTest),e&&(cf(G,I.uDash,!0),cf(G,I.uDashDistance,u),cf(G,I.uDashGapDistance,Y.G),Zk(G,I.aLineDistance),go(G,q.lineDistance,Y.ls32,I.aLineDistance,1),cf(G,I.uDiffuse,Y.A||Fr));var M=!k._batchColorDisabled;M&&(cf(G,I.uBatchColor,!0),Zk(G,I.aBatchColor),go(G,q.batchColor,Z,I.aBatchColor,4)),fs(G),ce(G,0,d.length/3,G.LINES),zq(G),M&&(cf(G,I.uBatchColor,!1),Qi(G,I.aBatchColor)),e&&(cf(G,I.uDash,!1),Qi(G,I.aLineDistance))}}pc(G,I)}},Bf=function(E,W,U){var x,H,S,n,z,w,j,I,M,l,$,T=E.getGL(),C=E._prg,y=E._buffer,X=E._batchModelMap;if(!Dk(X)){sp(E);for(x in X)if(H=tk[x]||$j,!(U&&!H.transparent||!U&&H.transparent)&&(S=X[x],W||!H.transparentMask)){var r=U&&H.autoSort!==!1&&(E._33Q||S.invalidate);if(S.invalidate?(S.invalidate=!1,od(S,"vs"),od(S,"ns"),od(S,"cs"),od(S,"rs"),od(S,"ps"),od(S,"bs"),od(S,"uv")):W&&od(S,"ps"),z=S.vs32,w=W?S.ps32:S.cs32,M=S.uv32,j=S.bs32,I=S.rs32,$=z.length/3,r&&(S.is=Ej(z,E.getEye())),$){n=H.light,l=E.getTexture(H.image),xp(T,C,m,H.light,H.opacity,H.reverseFlip,H.reverseColor,H.reverseCull),w?E._batchColorDisabled||(cf(T,C.uBatchColor,!0),Zk(T,C.aBatchColor),go(T,y.batchColor,w,C.aBatchColor,4)):cf(T,C.uDiffuse,H.color);var A=H.alphaTest;cf(T,C.uAlphaTest,A===Y?_.alphaTest:A);var L=j&&!E._batchBlendDisabled;L&&(cf(T,C.uBatchBlend,!0),Zk(T,C.aBatchBlend),go(T,y.batchBlend,j,C.aBatchBlend));var c=I&&!E._batchBrightnessDisabled;c&&(cf(T,C.uBatchBrightness,!0),Zk(T,C.aBatchBrightness),go(T,y.batchBrightness,I,C.aBatchBrightness,1)),M?fs(T,C,l,H.discardSelectable,y.uv,M,H.uvOffset,H.uvScale):fs(T),go(T,y.vs,z,C.aPosition),go(T,y.ns,S.ns32,C.aNormal),S.is?(Vc(T,y.is,S.is),Ln(T,0,$)):ce(T,0,$),M?zq(T,C,l):zq(T),w&&!E._batchColorDisabled&&(cf(T,C.uBatchColor,!1),Qi(T,C.aBatchColor)),L&&(cf(T,C.uBatchBlend,!1),Qi(T,C.aBatchBlend)),c&&(cf(T,C.uBatchBrightness,!1),Qi(T,C.aBatchBrightness)),Qo(T,C)}}}},Ej=function(q,T){for(var j=q.length/3,Q=new Array(j),S=j/3,N=new Array(S),$=0;S>$;$++)N[$]=$;N.sort(function(o,E){var w=9*o,Y=[(q[w]+q[w+3]+2*q[w+6])/4,(q[w+1]+q[w+4]+2*q[w+7])/4,(q[w+2]+q[w+5]+2*q[w+8])/4];w=9*E;var Q=[(q[w]+q[w+3]+2*q[w+6])/4,(q[w+1]+q[w+4]+2*q[w+7])/4,(q[w+2]+q[w+5]+2*q[w+8])/4],b=fr(T,Y)-fr(T,Q);return b>0?-1:0>b?1:0});for(var $=0;S>$;$++){var y=3*$,w=3*N[$];Q[y]=w,Q[y+1]=w+1,Q[y+2]=w+2}return new yj(Q)},oe={obj:function(v,w){var S={mat:v.mat,s3:v.s3,r3:v.r3,rotationMode:v.rotationMode,t3:v.t3,cube:v.cube==m?!0:v.cube,center:v.center==m?!0:v.center,ignoreMtls:v.ignoreMtls,ignoreTransparent:v.ignoreTransparent,ignoreColor:v.ignoreColor,ignoreImage:v.ignoreImage,ignoreNormal:v.ignoreNormal,prefix:v.prefix,flipY:v.flipY,flipFace:v.flipFace,reverseFlipMtls:v.reverseFlipMtls,finishFunc:function(u,d){if(u){var d=[];for(var z in u){var k=u[z];d.rawS3=k.rawS3,d.push(k),v.eachModel&&v.eachModel(z,k)}d.json=v,w(d)}else w()}};b.loadObj(v.obj,v.mtl,S)}};b.getModelTypeHandlers=function(){return oe},b.setModelTypeHandler=function(w,D){oe[w]=D},b.getModelTypeHandler=function(D){return oe[D]},b.handleModelLoaded=function(){},b.handleUnfoundModel=function(){};var zr=m,kb=m,sh=function(Y){zr&&!Y._loadingModelView_&&(kb||(kb={}),kb[Y._loadingModelView_=vd()]=Y)},Eb=function(J,$){zr||(zr={});var S=zr[J];if(S){if(S.url===$)return;S.request.onload=ys,S.request.onerror=ys}var D=new XMLHttpRequest;if(zr[J]={request:D,url:$},D.overrideMimeType&&D.overrideMimeType("text/plain"),$=b.beforeLoadURL($),$.data){var s=b.parse($.data);kf(J,s,$)}else D.open("GET",encodeURI($),!0),D.onload=function(x){if(200===this.status||0===this.status){var z=b.parse(x.target.response||x.target.responseText);kf(J,z,$)}else zs(J,b.handleUnfoundModel(J,$)||m)},D.onerror=function(){zs(J,b.handleUnfoundModel(J,$)||m)},D.send(null)},kf=function(S,Y,P){var T=Y.modelType;if(!T)return zs(S,Y),b.handleModelLoaded(S,Y),void 0;var G=b.getModelTypeHandler(T);if(G){var l=function(J){J?(zs(S,J),b.handleModelLoaded(S,J)):zs(S,b.handleUnfoundModel(S,P)||m)};G(Y,l)}else zs(S,b.handleUnfoundModel(S,P)||m)},zs=function(Q,C){if(Vk[Q]=C,delete zr[Q],Dk(zr)&&(zr=m,kb)){for(var E in kb){var K=kb[E];K._2O&&(K._2O={}),K.invalidateAll&&K.invalidateAll(Y,"modelLoaded",Q),K.redraw&&K.redraw(),K.iv(),delete K._loadingModelView_}kb=m}if(C&&kb)for(var E in kb){var K=kb[E];K.invalidateAll&&K.invalidateAll(Y,"modelLoading",Q),K.redraw&&K.redraw(),K.iv()}},$d=new ck([0,0,0,1,1,1,1,0]),Kq=new ck([0,0,1,0,0,1,0,0,1,0,0,1]),So=new yj([0,1,2,2,3,0]),qp=new ck([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),tj=new yj([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ad=new ck([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Od=oi(qp,tj),mn=(new ck([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new yj([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),hh=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],fd=function(p,u,B,O,y,T){T=T||16,p=p||16,u=u||0,B=B||p;var z,x,S,C,M,U,$,h,V=.5,Q=[],m=[],t=k/p,s=j/T;for(z=0;T>z;z++)for(M=z+1,C=z*s,h=M*s,x=u;B>x;x++)U=x+1,S=x*t,$=U*t,Q.push(V*A(C)*G(S),V*G(C),-V*A(C)*A(S),V*A(h)*G($),V*G(h),-V*A(h)*A($),V*A(C)*G($),V*G(C),-V*A(C)*A($),V*A(C)*G(S),V*G(C),-V*A(C)*A(S),V*A(h)*G(S),V*G(h),-V*A(h)*A(S),V*A(h)*G($),V*G(h),-V*A(h)*A($)),m.push(x/p,z/T,U/p,M/T,U/p,z/T,x/p,z/T,x/p,M/T,U/p,M/T);if(O){var L=[],W=[];for(S=u*t,z=0;T>z;z++)M=z+1,C=z*s,h=M*s,L.push(0,0,0,V*A(h)*G(S),V*G(h),-V*A(h)*A(S),V*A(C)*G(S),V*G(C),-V*A(C)*A(S)),W.push(0,.5,u/p,M/T,u/p,z/T)}if(y){var N=[],l=[];for(S=B*t,z=0;T>z;z++)M=z+1,C=z*s,h=M*s,N.push(0,0,0,V*A(C)*G(S),V*G(C),-V*A(C)*A(S),V*A(h)*G(S),V*G(h),-V*A(h)*A(S)),l.push(1,.5,B/p,z/T,B/p,M/T)}return{vs:Q,uv:m,from_vs:L,from_uv:W,to_vs:N,to_uv:l}},Kn=function(x,d,C){x=x||.17,d=d||12,C=C||18,0>x?x=0:x>.25&&(x=.25);var u,X,b,H,p,D,R,Q=.5,v=[],l=[],Z=[],V=k/C,B=k/d,U=Q-x;for(X=0;d>=X;X++)for(H=-j+X*B,D=G(H),p=A(H),u=0;C>=u;u++)b=u*V,R=U+x*D,v.push(G(b)*R,p*x,-A(b)*R),l.push(u/C,1-X/d);for(X=0;d>X;X++){var O=X*(C+1),o=(X+1)*(C+1);for(u=0;C>u;u++)Z.push(O+u,o+u+1,o+u,O+u,O+u+1,o+u+1)}return{vs:v,uv:l,is:Z}},Me=function(Q,l,a,P,L,s,x){x=x||12,Q=Q||18,l=l||0,a=a||Q,s=s||.17,0>s?s=0:s>.25&&(s=.25);var N,C,m,Z,O,y,z,B,g,T,S=.5,F=[],n=[],w=k/Q,c=k/x,I=S-s;for(m=0;x>m;m++)for(Z=m+1,z=-j+m*c,B=-j+Z*c,N=l;a>N;N++)C=N+1,O=N*w,y=C*w,g=I+s*G(z),T=I+s*G(B),F.push(G(O)*g,A(z)*s,-A(O)*g,G(y)*g,A(z)*s,-A(y)*g,G(y)*T,A(B)*s,-A(y)*T,G(O)*g,A(z)*s,-A(O)*g,G(y)*T,A(B)*s,-A(y)*T,G(O)*T,A(B)*s,-A(O)*T),n.push(N/Q,1-m/x,C/Q,1-m/x,C/Q,1-Z/x,N/Q,1-m/x,C/Q,1-Z/x,N/Q,1-Z/x);if(P){var $=[],b=[];for(m=0;x>m;m++)Z=m+1,z=-j+m*c,B=-j+Z*c,O=l*w,g=I+s*G(z),T=I+s*G(B),$.push(G(O)*g,A(z)*s,-A(O)*g,G(O)*T,A(B)*s,-A(O)*T,G(O)*I,0,-A(O)*I),b.push(.5+.5*G(z),.5-.5*A(z),.5+.5*G(B),.5-.5*A(B),.5,.5)}if(L){var J=[],E=[];for(m=0;x>m;m++)Z=m+1,z=-j+m*c,B=-j+Z*c,O=a*w,g=I+s*G(z),T=I+s*G(B),J.push(G(O)*g,A(z)*s,-A(O)*g,G(O)*I,0,-A(O)*I,G(O)*T,A(B)*s,-A(O)*T),E.push(.5-.5*G(z),.5-.5*A(z),.5,.5,.5-.5*G(B),.5-.5*A(B))}return{vs:F,uv:n,from_vs:$,from_uv:b,to_vs:J,to_uv:E}},el=function(I,Q){for(var g,W,i,F=.5,t=16,q=[],Z=[],p=[],X=k/t,m=0;t>=m;m++)g=m*X,W=G(g)*F,i=A(g)*F,q.push(W,-F,i,W,F,i),Z.push(1-m/t,1,1-m/t,0);for(m=0;t>m;m++)p.push(2*m,2*m+1,2*m+3,2*m,2*m+3,2*m+2);if(Q){var J=[],r=[],f=[];for(J.push(0,-F,0),r.push(.5,.5),m=0;t>=m;m++)g=m*X,W=G(g),i=A(g),J.push(W*F,-F,-i*F),r.push(.5+.5*W,.5+.5*i);for(m=0;t>m;m++)f.push(0,m+2,m+1)}if(I){var H=[],T=[],v=[];for(H.push(0,F,0),T.push(.5,.5),m=0;t>=m;m++)g=m*X,W=G(g),i=A(g),H.push(W*F,F,-i*F),T.push(.5+.5*W,.5-.5*i);for(m=0;t>m;m++)v.push(0,m+1,m+2)}return{vs:q,uv:Z,is:p,bottom_vs:J,bottom_uv:r,bottom_is:f,top_vs:H,top_uv:T,top_is:v}},mr=function(P,T,q,b,r,i,Q){P=P||12,T=T||0,q=q||P;for(var Y,V,p,B,_,x,o,s,F=.5,C=[],e=[],j=k/P,f=T;q>f;f++)Y=f+1,V=f*j,p=Y*j,B=G(V)*F,_=A(V)*F,x=G(p)*F,o=A(p)*F,C.push(B,-F,-_,x,-F,-o,B,F,-_,x,-F,-o,x,F,-o,B,F,-_),e.push(f/P,1,Y/P,1,f/P,0,Y/P,1,Y/P,0,f/P,0);if(Q){var J=[],K=[];for(f=T;q>f;f++)V=j*f,p=j*(f+1),B=G(V),_=A(V),x=G(p),o=A(p),J.push(B*F,-F,-_*F,0,-F,0,x*F,-F,-o*F),K.push(.5+.5*B,.5+.5*_,.5,.5,.5+.5*x,.5+.5*o)}if(i){var U=[],Z=[];for(f=T;q>f;f++)V=j*f,p=j*(f+1),B=G(V),_=A(V),x=G(p),o=A(p),U.push(B*F,F,-_*F,x*F,F,-o*F,0,F,0),Z.push(.5+.5*B,.5-.5*_,.5+.5*x,.5-.5*o,.5,.5)}if(b){var N=[],W=[];V=j*T,B=G(V)*F,_=A(V)*F,s=T/P,N.push(0,F,0,0,-F,0,B,-F,-_,B,-F,-_,B,F,-_,0,F,0),W.push(0,0,0,1,s,1,s,1,s,0,0,0)}if(r){var S=[],n=[];V=j*q,B=G(V)*F,_=A(V)*F,s=q/P,S.push(0,-F,0,0,F,0,B,F,-_,B,F,-_,B,-F,-_,0,-F,0),n.push(1,1,1,0,s,0,s,0,s,1,1,1)}return{vs:C,uv:e,bottom_vs:J,bottom_uv:K,top_vs:U,top_uv:Z,from_vs:N,from_uv:W,to_vs:S,to_uv:n}},gp=function(O,b,J,v,n){b=b||18,J=J||0,v=v==m?k:v,n=n==m?.5:n;for(var U,z,g,S,$,V,T=[0,.5,.75,.875,.9375],D=[],i=[],l=[],x=v/b,r=0;r<T.length;r++){var N=0===r%2?0:.5;for(U=0;b>=U;U++)z=(U+N)*x+J,g=1-T[r],D.push(G(z)*n*g,-n+2*T[r]*n,-A(z)*n*g),i.push((U+N)/b,g)}for(r=0;r<T.length-1;r++){var H=r*(b+1),F=(r+1)*(b+1);for(U=0;b>U;U++)l.push(H+U,F+U+1,F+U,H+U,H+U+1,F+U+1)}for(V=D.length/3-(b+1),U=0;b>U;U++)D.push(0,n,0),i.push((U+.5)/b,0);for(U=0;b>U;U++)l.push(V+U,V+U+1,V+(b+1)+U);if(O){var I=[],f=[],R=[];for(I.push(0,-n,0),f.push(.5,.5),U=0;b>=U;U++)z=U*x+J,S=G(z),$=A(z),I.push(S*n,-n,-$*n),f.push(.5+.5*S,.5+.5*$);for(U=0;b>U;U++)R.push(0,U+2,U+1)}return{vs:D,uv:i,is:l,bottom_vs:I,bottom_uv:f,bottom_is:R}},si=function(r,$,B,J,I,Z){r=r||16,$=$||0,B=B||r;for(var y=.5,b=[],i=[],Q=k/r,x=$;B>x;x++){var R=x+1,a=Q*x,_=Q*R;b.push(G(a)*y,-y,-A(a)*y,G(_)*y,-y,-A(_)*y,0,y,0),i.push(x/r,1,R/r,1,(x+R)/2/r,0)}if(Z){var L=[],F=[];for(x=$;B>x;x++){a=Q*x,_=Q*(x+1);var H=G(a),u=A(a),P=G(_),S=A(_);L.push(H*y,-y,-u*y,0,-y,0,P*y,-y,-S*y),F.push(.5+.5*H,.5+.5*u,.5,.5,.5+.5*P,.5+.5*S)}}if(J){var n=[],o=[];a=Q*$,n.push(0,y,0,0,-y,0,G(a)*y,-y,-A(a)*y),o.push(0,0,0,1,$/r,1)}if(I){var V=[],D=[];a=Q*B,V.push(0,-y,0,0,y,0,G(a)*y,-y,-A(a)*y),D.push(1,1,1,0,B/r,1)}return{vs:b,uv:i,bottom_vs:L,bottom_uv:F,from_vs:n,from_uv:o,to_vs:V,to_uv:D}},Re=function(j,J,g,U,O,q,I,G){for(var Y=[],x=0;x<j.length-1;x+=2)Y.push({x:j[x],y:j[x+1]});return ud(Y,J,g,U,O,q,I,G,!1)},Fm={roundRect:function(l,o){return Re([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],l,o,3)},star:function(L,h){return Re([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],L,h)},rect:function(L,y){return Re([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],L,y)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(S,h){return Re([0,-.5,.5,.5,-.5,.5],[1,2,2,5],S,h)},rightTriangle:function(X,Y){return Re([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],X,Y)},parallelogram:function(o,i){return Re([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],o,i)},trapezoid:function(j,H){return Re([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],j,H)}},fi={sphere:1,cylinder:1,cone:1,torus:1},mj={torus:1,sphere:1},cd=mm(Cf(Fm),{cylinder:1}),ih=mm(Cf(Fm),{cylinder:1,cone:1}),Wl=function(_,w,e){var q,E=Nd(_.mat,e,w),O=Nd(_.s3,e,w),I=Nd(_.t3,e,w),U=Nd(_.r3,e,w);return(O||U||I||E)&&(q=le(w._6O),sp(w,am(E,O,U,Nd(_.rotationMode,e,w),I))),q},bm=function(Y,m,w,i,p,z,f){if(sc(w))w.forEach(function(X){bm(Y,m,X,i,p,z,f)});else if(Mq(w))bm(Y,m,Cl(i,w),i,p,z,f);else if(hk(w))if(w.shape3d){var E=Wl(w,Y,m);bm(Y,m,w.shape3d,i,p,z,w),E&&Ph(Y,E)}else im(Y,m,w,i.s,p,z,f)},im=function(n,Z,c,h,s,E,X){if(X=X||$j,!E||E(h("shape3d.transparent",c.transparent,X.transparent))){var S=Wl(c,n,Z);Je(c);var N=n._26I,y=n._prg,M=n._buffer,P=h("shape3d.color",c.color,X.color);s||(s=h("shape3d.blend",c.blend,X.blend));var o,f=c.opacity==m?X.opacity:c.opacity,C=h("shape3d.opacity");o=C!=m&&f!=m?f*C:f!=m?f:C,xp(N,y,s,h("shape3d.light",c.light,X.light),o,h("shape3d.reverse.flip",c.reverseFlip,X.reverseFlip),h("shape3d.reverse.color",c.reverseColor,X.reverseColor),h("shape3d.reverse.cull",c.reverseCull,X.reverseCull)),c.vs&&h(ng,c.visible,X.visible)&&um(N,y,M,P,n.getTexture(h("shape3d.image",c.image,X.image),Z),h("shape3d.discard.selectable",c.discardSelectable,X.discardSelectable),c.vs,c.uv,c.ns,c.is,h("shape3d.uv.offset",c.uvOffset,X.uvOffset),h("shape3d.uv.scale",c.uvScale,X.uvScale)),c.top_vs&&h(pf,c.topVisible,X.topVisible)&&um(N,y,M,h("shape3d.top.color",c.topColor,X.topColor)||P,n.getTexture(h("shape3d.top.image",c.topImage,X.topImage),Z),h("shape3d.top.discard.selectable",c.topDiscardSelectable,X.topDiscardSelectable),c.top_vs,c.top_uv,c.top_ns,c.top_is,h("shape3d.top.uv.offset",c.topUvOffset,X.topUvOffset),h("shape3d.top.uv.scale",c.topUvScale,X.topUvScale)),c.bottom_vs&&h(jb,c.bottomVisible,X.bottomVisible)&&um(N,y,M,h("shape3d.bottom.color",c.bottomColor,X.bottomColor)||P,n.getTexture(h("shape3d.bottom.image",c.bottomImage,X.bottomImage),Z),h("shape3d.bottom.discard.selectable",c.bottomDiscardSelectable,X.bottomDiscardSelectable),c.bottom_vs,c.bottom_uv,c.bottom_ns,c.bottom_is,h("shape3d.bottom.uv.offset",c.bottomUvOffset,X.bottomUvOffset),h("shape3d.bottom.uv.scale",c.bottomUvScale,X.bottomUvScale)),c.from_vs&&h(gr,c.fromVisible,X.fromVisible)&&um(N,y,M,h("shape3d.from.color",c.fromColor,X.fromColor)||P,n.getTexture(h("shape3d.from.image",c.fromImage,X.fromImage),Z),h("shape3d.from.discard.selectable",c.fromDiscardSelectable,X.fromDiscardSelectable),c.from_vs,c.from_uv,c.from_ns,c.from_is,h("shape3d.from.uv.offset",c.fromUvOffset,X.fromUvOffset),h("shape3d.from.uv.scale",c.fromUvScale,X.fromUvScale)),c.to_vs&&h(dk,c.toVisible,X.toVisible)&&um(N,y,M,h("shape3d.to.color",c.toColor,X.toColor)||P,n.getTexture(h("shape3d.to.image",c.toImage,X.toImage),Z),h("shape3d.to.discard.selectable",c.toDiscardSelectable,X.toDiscardSelectable),c.to_vs,c.to_uv,c.to_ns,c.to_is,h("shape3d.to.uv.offset",c.toUvOffset,X.toUvOffset),h("shape3d.to.uv.scale",c.toUvScale,X.toUvScale)),Qo(N,y),S&&Ph(n,S)}},um=function(Z,n,i,F,r,N,E,V,d,S,L,H){E&&(cf(Z,n.uDiffuse,F),V?fs(Z,n,r,N,i.uv,V,L,H):fs(Z),go(Z,i.vs,E,n.aPosition),go(Z,i.ns,d,n.aNormal),S?(to(Z,i.is,S),Ln(Z,0,S.length)):ce(Z,0,E.length/3),V?zq(Z,n,r):zq(Z))},Cl=function(u,v){var c=u.s;if(v||(v=c(Do)),!v)return m;var N=Am(v);if(N)return N;if("text"===v){var B={amount:c("shape3d.text.amount"),size:c("shape3d.text.size"),font:c("shape3d.text.font"),style:c("shape3d.text.style"),weight:c("shape3d.text.weight"),fill:c("shape3d.text.fill"),curveSegments:c("shape3d.text.curveSegments"),spacing:c("shape3d.text.spacing")},E=u.gv.getShape3dText(u.data),U=E;for(var o in B)U+="_"+(B[o]===Y?"U":B[o]);return u._cachedTextKey===U?u._cachedTextGeometry:(u._cachedTextKey=U,u._cachedTextGeometry=b.createTextGeometry(E,B))}var o=v;if(fi[v]){var $=c("shape3d.side"),f=c("shape3d.side.from"),K=c("shape3d.side.to"),d=c(gr),h=c(dk);3>$?($=0,f=0,K=0,d=!1,h=!1):((f==m||0>f)&&(f=0),(K==m||K>$)&&(K=$),0===f&&K===$&&(d=!1,h=!1)),o+="-"+$+"-"+f+"-"+K+"-"+d+"-"+h}if(cd[v]){var C=c(pf);o+="-"+C}if(ih[v]){var y=c(jb);o+="-"+y}if("torus"===v){var D=c("shape3d.torus.radius");0>D?D=0:D>.25&&(D=.25),o+="-"+D}if(mj[v]){var H=c(Wi);o+="-"+H}return N=ur[o],N||("box"===v?N=b.createBoxModel():Fm[v]?N=Fm[v](C,y):"sphere"===v?N=b.createSphereModel($,f,K,d,h,H):v===Ke?N=b.createCylinderModel($,f,K,d,h,C,y):"cone"===v?N=b.createConeModel($,f,K,d,h,y):"torus"===v&&(N=b.createTorusModel($,f,K,d,h,D,H)),ur[o]=N),N},Je=function(){var H=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],q=["is","top_is","bottom_is","from_is","to_is"];return d=Nl(hl.substr(hl.indexOf("^#")+2)),El(b[md(bg+H[15]+"n"+H[16])]())&&vs()?function(g){g&&!g._complete_&&(g._complete_=!0,g.vs&&rk(g.ns)&&(g.ns=oi(g.vs,g.is)),g.top_vs&&rk(g.top_ns)&&(g.top_ns=oi(g.top_vs,g.top_is)),g.bottom_vs&&rk(g.bottom_ns)&&(g.bottom_ns=oi(g.bottom_vs,g.bottom_is)),g.from_vs&&rk(g.from_ns)&&(g.from_ns=oi(g.from_vs,g.from_is)),g.to_vs&&rk(g.to_ns)&&(g.to_ns=oi(g.to_vs,g.to_is)),H.forEach(function($){var u=g[$];sc(u)&&(g[$]=new ck(u))}),q.forEach(function(V){var S=g[V];sc(S)&&(g[V]=new yj(S))}))}:void 0}(),Gm=function(C,x){var r=C[x];sc(r)&&(C[x]=new ck(r))};mm(qd,{_25Q:function(D){D._16O=function(p,c,g,q,v,u,y,U,N){var b=this.info;if(b){var I,X,E,F,B,x,w=vc();if(Sb[c]?(I=b.p3,X=b.c1,E=b.c2):_k[c]?(X=b.s1||b.c1,E=b.s2||b.c2):(X=b.t1||b.c1,E=b.t2||b.c2),I)x=$n(c,bh,g,q,U,N);else{var T=xl(E,X),Q=fr(X,E);F=[0,-r(T[2],T[0]),V(T[1]/Q)],B="zyx",I=[(X[0]+E[0])/2,(X[1]+E[1])/2,(X[2]+E[2])/2],x=$n(c,[Q,0,0],g,q,U,N)}return Wf(w,x,I,q,v,u,y,p,F,B)}return bj},D._80o=function(C,B,x){var n=this,i=n.shapeModel;if(i){var L=n.gv;sp(L),bm(L,n.data,i,n,n.getBodyColor(),x)}},D.createLineModel=function(T,l,v,u,n){for(var Z=this,I=Z.s,U=Zr(T,l,I(Wi)),k=[],J=0;J<U.length;J++){var e=U[J],h=e.length;if(h>1){var E=e[0];k.push(E.x,E.y,E.z);for(var x=1;h-1>x;x++)E=e[x],k.push(E.x,E.y,E.z),k.push(E.x,E.y,E.z);E=e[h-1],k.push(E.x,E.y,E.z)}}var D,_,W,A=I(u+".color"),z=I(n),Q=0;return z&&(_=I(n+".color"),D=I(n+".pattern"),Q=I(n+".offset"),W=A),wi(Z.gv,Z.data,k,_||A,W?m:I(u+".gradient.color"),v,D||I(u+".pattern"),Q,W),U},D.createTubeModel=function(q,W,e,U){for(var $=this,o=$.s,v=o("shape3d.side")||vq,f=o("shape3d.start.angle"),b=o("shape3d.sweep.angle"),D=o(pf)?o("shape3d.top.cap"):m,E=o(jb)?o("shape3d.bottom.cap"):m,c="flat"===D,s="flat"===E,l=c&&(U?U.uv:o("shape3d.top.image")),Q=s&&(U?U.uv:o("shape3d.bottom.image")),B=U?U.uv:o("shape3d.image"),V={vs:[],uv:B?[]:m,top_vs:c?[]:m,top_uv:l?[]:m,bottom_vs:s?[]:m,bottom_uv:Q?[]:m},K=Zr(q,W,o(Wi),e),h=0,d=K.length;d>h;h++)Zg(V,K[h],o(ag),e,v,f,b,D,E);if(U){var r=[];Cq($.gv,$.data,V,$,$.getBodyColor(),[],U,r),r.length&&(gb(U.vs,r),gb(U.ns,oi(r)))}else $.shapeModel=V;return K},D.getCache=function(){var Q=this.info;if(Q){var O=Q.list;if(O){var s=Q.cache;return s||(s=Q.cache=up(O)),s}}return m}}});var sm=function(P,S){for(var E,w=0,_=P.length,g=0,H=_-1;H>=g;)if(w=f(g+(H-g)/2),E=P[w].length-S,0>E)g=w+1;else{if(!(E>0)){H=w;break}H=w-1}w=H;var B=P[w],m=B.point;return w===_-1||B.length===S||(m=(new sd).subVectors(P[w+1].point,m).normalize().multiplyScalar(S-B.length).add(m)),{point:m,tangent:B.tangent}},up=function(p){for(var Y,L,B=[],r=0,t=0;t<p.length;t++){for(var d=p[t],D=0;D<d.length;D++){Y=d[D],L&&(r+=L.distanceTo(Y));var g=new sd,I=d[D+1];I?g.subVectors(I,Y):L?g.subVectors(Y,L):g.x=1,g.normalize(),B.push({point:Y,length:r,tangent:g}),L=Y}L=null}return B},Zr=function(C,u,g,D){g=g||pe;for(var w=[],p=0,d=C.size();d>p;p++){var q=C.get(p);w.push(new sd(q.x,q.e||0,q.y))}u&&(tp(u)&&(u=u._as),u.length||(u=null));for(var l,K,v,e,i,O=[],N=0,P=0,H=u?u.length:d;H>P;P++)if(i=u?u[P]:0===P?1:2,1===i)O.push(v=[]),v.push(w[N++]);else if(2===i||5===i)if(e=2===i?w[N++]:v[0],D){var Q=u?u[P+1]:H>P+1?2:m;if(2===Q||5===Q){var S=v[v.length-1],X=2===Q?w[N]:v[0],I=(new sd).subVectors(S,e),B=(new sd).subVectors(X,e),V=I.length(),U=B.length();if(V&&U)if(D>V/2&&D>U/2)v.push(e);else for(I.multiplyScalar(R(D,V/2)/V).add(e),B.multiplyScalar(R(D,U/2)/U).add(e),l=new kq(I,e,B).getPoints(g),K=0;g>=K;K++)v.push(l[K])}else v.push(e)}else v.push(e);else if(3===i)for(l=new kq(v[v.length-1],w[N++],w[N++]).getPoints(g),K=1;g>=K;K++)v.push(l[K]);else if(4===i)for(l=new Dd(v[v.length-1],w[N++],w[N++],w[N++]).getPoints(g),K=1;g>=K;K++)v.push(l[K]);return O},Ne=function(e){for(var s,Q,G=new sd,j=[],K=[],B=[],V=0,l=e.length;l>V;V++)s=e[V],Q=e[V+1],Q?G.subVectors(Q,s):G.subVectors(s,e[V-1]),j.push(G.normalize().clone());var z,S,i,t,F=new sd,W=new sd,c=new Ql,v=1e-4,C=Number.MAX_VALUE,Z=j[0],r=K[0]=new sd,o=B[0]=new sd;for(S=w(Z.x),i=w(Z.y),t=w(Z.z),C>=S&&(C=S,F.set(1,0,0)),C>=i&&(C=i,F.set(0,1,0)),C>=t&&F.set(0,0,1),W.crossVectors(Z,F).normalize(),r.crossVectors(Z,W),o.crossVectors(Z,r),V=1;l>V;V++)K[V]=K[V-1].clone(),B[V]=B[V-1].clone(),W.crossVectors(j[V-1],j[V]),W.length()>v&&(W.normalize(),z=p(Yr(j[V-1].dot(j[V]),-1,1)),K[V].applyMatrix4(c.makeRotationAxis(W,z))),B[V].crossVectors(j[V],K[V]);return{B:B,T:j,N:K}},Zg=function(){var g=function(I){for(var G=1;G<arguments.length;G++){var D=arguments[G];I.push(D.x,D.y,D.z)}},c=function(s){for(var e=1;e<arguments.length;e++){var $=arguments[e].uv;s.push($[0],$[1])}},L=function(H,g,M,R,U){var L=-R*G(U),r=R*A(U);return new sd(H.x+L*M.x+r*g.x,H.y+L*M.y+r*g.y,H.z+L*M.z+r*g.z)},I=function(R,s,l,n,j,$,b,D){b=b||k;for(var a=[],Q=b/j,p=0;j>=p;p++){var h=L(R,s,l,n,p*Q+$);a.push(h),D!=m&&(h.uv=[D,p/j])}return a},H=function(o,q,I,n,z,h,S,y,E){E=E||k;var C=q?o.top_vs:o.bottom_vs;if(C)for(var U=q?o.top_uv:o.bottom_uv,_=E/S,R=0;S>R;R++){var O,P;q?(O=R*_+y,P=(R+1)*_+y):(P=R*_+y,O=(R+1)*_+y),g(C,L(I,n,z,h,O),L(I,n,z,h,P),I),U&&U.push(.5-.5*G(O),.5-.5*A(O),.5-.5*G(P),.5-.5*A(P),.5,.5)}};return function(e,B,t,k,E,V,s,v,F){var O=B.length;if(O>1){var h,i,d,b,N,Z,G,l=Ne(B),T=l.T,j=l.N,D=l.B;"flat"===v&&H(e,!0,B[0],D[0],j[0],k,E,V,s),"flat"===F&&H(e,!1,B[O-1],D[O-1],j[O-1],k,E,V,s);var P,R,U=[],w=J(E/2),L="round"===v,a="round"===F,y=B[0],M=T[0],p=D[0],S=j[0],A=B[O-1],W=T[O-1],r=D[O-1],q=j[O-1];if(L){for(d=1;w>=d;d++)j.splice(0,0,S),D.splice(0,0,p),T.splice(0,0,M),R=-d/w*k,B.splice(0,0,M.clone().multiplyScalar(R).add(y)),U[w-d]=X(k*k-R*R);O+=w}if(a){for(d=1;w>=d;d++)j.push(q),D.push(r),T.push(W),R=d/w*k,B.push(W.clone().multiplyScalar(R).add(A)),U[B.length-1]=X(k*k-R*R);O+=w}if(e.uv){var K=0,x=0,n=[];for(t&&(K=t),N=B[0],n[0]=0,d=1;O>d;d++)b=B[d],n[d]=N.distanceTo(b),N=b,t||(K+=n[d]);for(P=[],d=0;O>d;d++)x+=n[d],P[d]=K?x/K:0}for(d=0;O>d;d++){if(b=B[d],Z=D[d],G=j[d],h=I(b,Z,G,U[d]===Y?k:U[d],E,V,s,P?P[d]:m),i)for(var _=0;E>_;_++){var o=i[_],u=i[_+1]||i[0],z=h[_],$=h[_+1]||h[0];g(e.vs,u,o,z,z,$,u),e.uv&&c(e.uv,u,o,z,z,$,u)}i=h}}}}();mm(b,{getLineLength:function(C){return C[C.length-1].length},getLineOffset:function(r,k){return sm(r,k)},getLineCacheInfo:function(Y,J,A,P){return up(Zr(Y,J,A,P))}});var rl=o.Light=function(){Ck(rl,this),this.s(Ar,_[Ar]),this.s(Do,"sphere"),this.s3(20,20,20)};_q("Light",af,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(t,Y,u){rl.superClass.onStyleChanged.apply(this,arguments),t===Ar&&this.s("shape3d.color",u)}});var Qg=bb.Graph3dView=function(t,$){var A=this;A._attributes=$||b.graph3dViewAttributes,A._25I={},A._view=xf(1,A);var e=A._canvas=dj(A._view);e.addEventListener("webglcontextlost",function(G){G.preventDefault(),hq(A),A._26I&&A._doBufferGC(A._26I,!0),A._26I=m,A._1o.texture=m,A._35O=!0},!1),e.addEventListener("webglcontextrestored",function(){A._35O=!1,A.iv()},!1),A._batchIndexMap={},A._batchModelMap={},A._wireframeIndexMap={},A._wireframeModelMap={},A._wireframeIndexMapSwap={},A._wireframeModelMapSwap={},A._polylineIndexMap={},A._polylineIndexMap={},A._polylineIndexMapSwap={},A._polylineIndexMapSwap={},A._8O=[],A._7O=vc(),A._6O=vc(),A._1o=new zb(A),A._30O=new Oc(A),A._31O=new nd(A),A._32O=new Fi(A),A._33Q=!0,A._eye=Cf(b.graph3dViewEye),A._center=Cf(b.graph3dViewCenter),A._up=Cf(b.graph3dViewUp),A._lightChanged=!1,A._59O=[],A._spots=[],A._dirs=[],A._frameId=0,A.dm(t?t:new Bd),A.setInteractors([new Al(A)])},uq={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},rj=0;ji("Graph3dView",u,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",nl,yh,"firstPersonMode",fn,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",wl,Im,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_editHelperDisabled:b.graph3dViewEditHelperDisabled,_devicePixelRatio:Y,_boundaries:Y,_moveStep:b.graph3dViewMoveStep,_rotateStep:b.graph3dViewRotateStep,_pannable:b.graph3dViewPannable,_rotatable:b.graph3dViewRotatable,_walkable:b.graph3dViewWalkable,_resettable:b.graph3dViewResettable,_zoomable:b.graph3dViewZoomable,_firstPersonMode:b.graph3dViewFirstPersonMode,_mouseRoamable:b.graph3dViewMouseRoamable,_gridVisible:b.graph3dViewGridVisible,_gridSize:b.graph3dViewGridSize,_gridGap:b.graph3dViewGridGap,_gridColor:b.graph3dViewGridColor,_originAxisVisible:b.graph3dViewOriginAxisVisible,_centerAxisVisible:b.graph3dViewCenterAxisVisible,_axisXColor:b.graph3dViewAxisXColor,_axisYColor:b.graph3dViewAxisYColor,_axisZColor:b.graph3dViewAxisZColor,_ortho:b.graph3dViewOrtho,_orthoWidth:b.graph3dViewOrthoWidth,_fovy:b.graph3dViewFovy,_near:b.graph3dViewNear,_far:b.graph3dViewFar,_headlightColor:b.graph3dViewHeadlightColor,_headlightIntensity:b.graph3dViewHeadlightIntensity,_headlightRange:b.graph3dViewHeadlightRange,_headlightDisabled:b.graph3dViewHeadlightDisabled,_rectSelectable:b.graph3dViewRectSelectable,_rectSelectBackground:b.graph3dViewRectSelectBackground,_editSizeColor:b.graph3dViewEditSizeColor,_autoMakeVisible:ks,_fogDisabled:b.graph3dViewFogDisabled,_fogColor:b.graph3dViewFogColor,_fogNear:b.graph3dViewFogNear,_fogFar:b.graph3dViewFogFar,_dashDisabled:b.graph3dViewDashDisabled,_batchColorDisabled:b.graph3dViewBatchColorDisabled,_batchBlendDisabled:b.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:b.graph3dViewBatchBrightnessDisabled,setEye:function(K,J,z){1===arguments.length&&(J=K[1],z=K[2],K=K[0]);
var b=this._eye;b[0]=K,b[1]=J,b[2]=z,this.fp(wl,m,b)},setCenter:function(S,O,D){1===arguments.length&&(O=S[1],D=S[2],S=S[0]);var j=this._center;j[0]=S,j[1]=O,j[2]=D,this.fp(Im,m,j)},setUp:function(C,x,K){1===arguments.length&&(x=C[1],K=C[2],C=C[0]);var F=this._up;F[0]=C,F[1]=x,F[2]=K,this.fp("up",m,F)},isTransparentMask:function(o){return o.s("transparent.mask")},getAspect:function(){var A=this,V=A._aspect;return V?V:A.getWidth()/A.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(L){var v=this,I=v._dataModel,F=v._selectionModel;I!==L&&(I&&(I.ump(v.handleDataModelPropertyChange,v),I.umm(v.handleDataModelChange,v),I.umd(v.handleDataPropertyChange,v),F||I.sm().ums(v.handleSelectionChange,v)),v._dataModel=L,L.mp(v.handleDataModelPropertyChange,v),L.mm(v.handleDataModelChange,v),L.md(v.handleDataPropertyChange,v),F?F._21I(L):L.sm().ms(v.handleSelectionChange,v),v.invalidateAll(!0),v.invalidateLight(),v.fp(lq,I,L),v._canvas.style.background=L.getBackground()||"")},handleDataModelPropertyChange:function(W){if("background"===W.property){var Q=this._canvas.style.background,P=W.newValue||"";this._canvas.style.background=P,this.fp("canvasBackground",Q,P)}},handleDataPropertyChange:function(L){var K=L.data;this.invalidateData(K),An(K)&&"s:light.type"===L.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(A){var o=this,f=A.property;o.iv(),o._18Q=m,"eye"===f?o._33Q=!0:"devicePixelRatio"===f?o._42(m,o._devicePixelRatio||Cr):uq[f]&&hq(o)},_5O:function(A){var p=A._22Q();return p?new p(this,A):m},getData3dUI:function(V){var G=this._25I[V._id];return G===Y&&(G=this._5O(V),this._25I[V._id]=G),G},invalidateAll:function(v){var p=this;if(v){for(var N in p._25I){var b=p._25I[N];b&&b.dispose()}p._25I={},p.iv(),gj(p)}else p.dm().each(function(W){p.invalidateData(W)})},invalidateSelection:function(){var b=this;b.sm().each(function(_){b.invalidateData(_)})},invalidateData:function(H){var X=this,w=X.getData3dUI(H);w&&(w.iv(),X.iv()),gj(X,H)},getShape3dText:function(b){return b.getStyle("shape3d.text")||this.getLabel(b)},invalidateBatch:function(h){var Q=this,m=Q._batchModelMap,K=m[h],d=[],u={};if(K){K.ds.forEach(function(N){var M=Q.getData3dUI(N);M&&M.iv(),delete Q._batchIndexMap[N._id],d.push(N._id)}),delete m[h];for(var f,k,D,w,J,I,V,t,G,B=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],P=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],U=0;U<B.length;U++){var j=Q[B[U]],L=Q[P[U]];for(u={},t=0;t<d.length;t++){var x=L[d[t]];if(x){delete L[d[t]],G=x.batch,f=j[G];var l=x.begin,p=x.size,o=3*l,$=3*p,E=4*l,v=4*p;for(k=f.ds,D=f.vs,w=f.cs,J=f.ps,I=f.ls,V=x.index,f.invalidate=!0,k[V]=Y,V=o;o+$>V;V++)D[V]=Y;for(V=E;E+v>V;V++)w[V]=Y;for(V=E;E+v>V;V++)J[V]=Y;if(I)for(V=o;o+$>V;V++)I[V]=Y;u[G]=!0}}for(G in u){f=j[G],k=f.ds,D=f.vs,w=f.cs,J=f.ps,I=f.ls;var H=[];for(V=0;V<k.length;V++)k[V]!==Y&&H.push(k[V]);if(0===H.length)delete j[G];else{for(f.ds=H,H=[],V=0;V<D.length;V++)D[V]!==Y&&H.push(D[V]);for(f.vs=H,H=[],V=0;V<w.length;V++)w[V]!==Y&&H.push(w[V]);for(f.cs=H,H=[],V=0;V<J.length;V++)J[V]!==Y&&H.push(J[V]);if(f.ps=H,I){for(H=[],V=0;V<I.length;V++)I[V]!==Y&&H.push(I[V]);f.ls=H}}}}Q.iv()}},handleDataModelChange:function(e){var s=this,r=e.kind,E=e.data;if("add"===r)s.invalidateData(E),qr(E)&&E.getEdgeGroup()&&E.getEdgeGroup().eachSiblingEdge(s.invalidateData,s),An(E)&&s.invalidateLight();else if(r===Ze){var F=E._id,A=s._25I[F];A&&(A.dispose(),delete s._25I[F],s.iv()),E===s._currentSubGraph&&s.setCurrentSubGraph(m),gj(s,E),An(E)&&s.invalidateLight()}else r===nf&&(s.invalidateAll(!0),s.setCurrentSubGraph(m),gj(s),s.invalidateLight())},toCanvas:function(c){var _=this,L=_.getGL();if(_.validate(),c){var I=L.getParameter(L.COLOR_CLEAR_VALUE);Fg(L,c)}_._42(m,1);var X=_.getWidth(),K=_.getHeight(),p=new Uint8Array(4*X*K),e=dj(),s=e.getContext("2d");L.readPixels(0,0,X,K,L.RGBA,L.UNSIGNED_BYTE,p),Xe(e,X,K,1);for(var O=s.getImageData(0,0,X,K),o=O.data,F=0;F<o.length;F+=4){var x=F/4,U=f(x/X),E=x-U*X;x=4*((K-1-U)*X+E),o[x]=p[F],o[x+1]=p[F+1],o[x+2]=p[F+2],o[x+3]=p[F+3]}return s.putImageData(O,0,0),c&&Fg(L,I),_._42(m,_._devicePixelRatio||Cr),e},toDataURL:function(o,t){var d=this,G=d.getGL();if(d.validate(),o){var H=G.getParameter(G.COLOR_CLEAR_VALUE);Fg(G,o)}d._42(m,1);var q=d._canvas.toDataURL(t||"image/png",1);return o&&Fg(G,H),d._42(m,d._devicePixelRatio||Cr),q},getGL:function(){var s=this,q=s._26I,j=s._prg;if(!q)try{s._2O={},q=s._26I=s._canvas.getContext("webgl",s._attributes)||s._canvas.getContext("experimental-webgl",s._attributes),q._emptyTexture=$g(q),q._emptyBlendTexture=$g(q),q._bufPool=[],q._id=++rj,s._buffer={vs:Ie(q),ns:Ie(q),is:Ie(q),uv:Ie(q),batchColor:Ie(q),batchBlend:Ie(q),batchBrightness:Ie(q),lineDistance:Ie(q)},s._1O=Le(q);var Y=s._cube={vs:Ie(q),ns:Ie(q),is:Ie(q),uv:Ie(q)};Yo(q,Y.vs,qp),Yo(q,Y.ns,Od),Yo(q,Y.uv,ad),Vc(q,Y.is,tj)}catch(Q){}if(q&&!j){if(j=s._prg=q.createProgram(),!j)return m;var o=s._dirs.length,f=s._spots.length,P=s._59O.length,D=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];o&&D.push("uDirColor","uDirDirection"),f&&D.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),P&&D.push("uPointColor","uPointRange","uPointPosition"),Fg(q,[0,0,0,0]),q.clearDepth(1),q.enable(q.DEPTH_TEST),q.depthFunc(q.LEQUAL),q.enable(q.BLEND),q.blendFuncSeparate(q.SRC_ALPHA,q.ONE_MINUS_SRC_ALPHA,q.ONE,q.ONE_MINUS_SRC_ALPHA),ye||(hl=Nl(hl.substring(0,hl.indexOf("^#"))),cl=Nl(cl),ye=!0);var w=["#define MAX_DIR "+o,"#define MAX_SPOT "+f,"#define MAX_POINT "+P,s._fogDisabled?"":"#define FOG",s._dashDisabled?"":"#define DASH",s._batchColorDisabled?"":"#define BATCHCOLOR",s._batchBlendDisabled?"":"#define BATCHBLEND",s._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),J=cg(q,j,q.VERTEX_SHADER,hl.replace("PREFIX",w)),I=cg(q,j,q.FRAGMENT_SHADER,cl.replace("PREFIX",w));g?D.push("aPosition"):(j.aPosition=0,q.bindAttribLocation(j,0,"aPosition")),q.linkProgram(j),D.forEach(function($){j[$]=/^u/.test($)?q.getUniformLocation(j,$):q.getAttribLocation(j,$)}),q.useProgram(j),q.deleteShader(J),q.deleteShader(I)}return q},getBrightness:function(C){var p=C.s("brightness"),o=this.isSelected(C)?C.s("select.brightness"):m;return p==m?o:o==m?p:p*o},getWireframe:function(M){var X=M.s("wf.visible"),I=M.s("wf.width");return X===!0||I>0&&"selected"===X&&this.isSelected(M)?{color:M.s("wf.color"),width:I,"short":M.s("wf.short"),mat:M.s("wf.mat")}:void 0},_transformPointToViewSpace:function(K){var m=[K[0],K[1],K[2]];return zh(m,this._viewMatrix),m},_transformDirectionToViewSpace:function(v,_){var y=[v[0],v[1],v[2]];zh(y,this._viewMatrix);var L=_?[_[0],_[1],_[2]]:[0,0,0];zh(L,this._viewMatrix);var T=L[0]-y[0],B=L[1]-y[1],R=L[2]-y[2],Q=Math.sqrt(T*T+B*B+R*R);return Q?[T/Q,B/Q,R/Q]:[T,B,R]},getWireframeGeometry:function(P){return P.s("wf.geometry")?{color:P.s("wf.color"),width:P.s("wf.width"),mat:P.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(w){return w.s("body.color")},getMat:function(y){return y.getMat?y.getMat():y.s("mat")},getFaceMat:function(M,H){return M.getFaceMat?M.getFaceMat(H):M.s(H+".mat")},getFaceBlend:function(k,o){return k.s(o+".blend")||k.s("all.blend")},getFaceColor:function(F,s){return F.s(s+".color")||F.s("all.color")},getFaceImage:function(E,L){return E.s(L+".image")||E.s("all.image")},getFaceBlendImage:function(p,F){return p.s(F+".blend.image")||p.s("all.blend.image")},getFaceDiscardSelectable:function(f,B){var V=f.s(B+".discard.selectable");return V==m?f.s("all.discard.selectable"):V},getFaceUv:function(C,M){return C.s(M+".uv")||C.s("all.uv")},getFaceUvOffset:function(D,n){return D.s(n+".uv.offset")||D.s("all.uv.offset")},getFaceUvScale:function(c,h){return c.s(h+".uv.scale")||c.s("all.uv.scale")},getFaceLight:function(p,P){var M=p.s(P+".light");return M==m?p.s("all.light"):M},getFaceVisible:function(P,I){var a=P.s(I+".visible");return a==m?P.s("all.visible"):a},getFaceOpacity:function(o,W){var N=o.s(W+".opacity");return N==m?o.s("all.opacity"):N},getFaceTransparent:function(T,h){var I=T.s(h+".transparent");return I==m?T.s("all.transparent"):I},getFaceReverseColor:function(o,h){return o.s(h+".reverse.color")||o.s("all.reverse.color")},getFaceReverseFlip:function(t,u){var H=t.s(u+".reverse.flip");return H==m?t.s("all.reverse.flip"):H},getFaceReverseCull:function(j,t){var A=j.s(t+".reverse.cull");return A==m?j.s("all.reverse.cull"):A},getTextureMap:function(){return this._2O},deleteTexture:function(q){var h=this,j=h._2O[q];j&&(delete h._2O[q],h.getGL().deleteTexture(j))},invalidateShape3dCachedImage:function(D){var e=D._shape3dCachedImage;e&&(this.getGL().deleteTexture(e),delete D._shape3dCachedImage)},getTexture:function(k,q){if(!k)return m;var e=this,W=e.getGL(),z=e._2O[k];if(!z){var U=Se(k);if(U)if(U.tagName){if(U.dynamic)return Le(W,U,e._1O);z=e._2O[k]=Le(W,U)}else{var J=q&&q.s("shape3d.image.cache");if(J&&q._shape3dCachedImage&&(z=q._shape3dCachedImage),!z){var t=q&&q.s("shape3d.fixSizeOnScreen"),_=t&&t[0]>0?t[0]:Jb(U,q),O=t&&t[1]>0?t[1]:vr(U,q);if(_>=1&&O>=1){_*=devicePixelRatio,O*=devicePixelRatio;var g=Cc(_,O);Dm(g,U,0,0,_,O,q,e),g.restore(),J&&Uq(U,q)?(z=q._shape3dCachedImage=Le(W,ao,null,W.NEAREST),ao=null):z=Le(W,ao,e._1O,W.NEAREST)}}}}return z},redraw:function(){this.iv()},validateImpl:function(){var t=this;if(t._lightChanged){t._lightChanged=!1;var k=[],s=[],n=[];t.dm().each(function(l){if(An(l)){var _=l.s("light.type");_===Xd?k.push(l):_===Oh?s.push(l):_===Uh&&n.push(l)}}),(k.length!==t._59O.length||s.length!==t._spots.length||n.length!==t._dirs.length)&&hq(t),t._59O=k,t._spots=s,t._dirs=n}t._42(),t._1o.iv()},getRenderInfo:function(){var y=this.getGL();return y?y._renderInfo:void 0},showDebugTip:function(){var A=this,r=A._debugDiv;if(!r){r=A._debugDiv=D.createElement("div"),r.style.position="absolute",r.style.overflow="hidden",r.style.backgroundColor="white",r.style.color="black";var e=A.getView();A._79O?e.insertBefore(r,A._79O):e.appendChild(r),A._debugTipTimerId=setInterval(function(){var x=A.getRenderInfo();if(x){var l=A.getGL()._bufPool,C=l.length-(l._ivCount||0),G="Draw Calls: "+x.calls+"<br/>"+"Vertices: "+x.vertices+"<br/>"+"Faces: "+x.faces+"<br/>"+"Lines: "+x.lines+"<br/>"+"Buffer Count: "+C;r.innerHTML=G}},10)}},hideDebugTip:function(){var p=this,W=p._debugDiv;W&&(delete p._debugDiv,cancelAnimationFrame(p._debugTipTimerId),delete p._debugTipTimerId,p.getView().removeChild(W))},_42:function(z,C){var $=this;if(!$._35O&&(!sj||bn(sj))){var s,i;z&&(z instanceof af?i=z:s=z);var y=$._canvas,Z=$.getWidth(),V=$.getHeight(),x=$.getGL(),A=$._prg;if(x){if(C?z||Xe(y,Z,V,C):(C=$._devicePixelRatio||Cr,z||Z===y.clientWidth&&V===y.clientHeight||Xe(y,Z,V,C)),x.viewport(0,0,Z*C,V*C),x._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++$._frameId},$._81O=m,x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),cf(x,A.uBrightness,1),cf(x,A.uOpacity,1),cf(x,A.uPartOpacity,1),x._picking=!!z,cf(x,A.uPick,!!z),cf(x,A.uTexture,!1),cf(x,A.uBlendTexture,!1),cf(x,A.uAlphaTest,_.alphaTest),cf(x,A.uTransparent,!1),cf(x,A.uFix,!1),cf(x,A.uBatchColor,!1),cf(x,A.uBatchBlend,!1),cf(x,A.uBatchBrightness,!1),cf(x,A.uPMatrix,$._projectMatrix=pi($)),cf(x,A.uViewMatrix,as($,$._7O)),$._viewMatrix=le($._7O),z||(Tk($,x,A),$._fogDisabled||(cf(x,A.uFogColor,$._fogColor),cf(x,A.uFogNear,$._fogNear),cf(x,A.uFogFar,$._fogFar))),Zk(x,A.aPosition),Zk(x,A.aNormal),Qi(x,A.aUv),Qi(x,A.aBatchColor),Qi(x,A.aBatchBlend),Qi(x,A.aBatchBrightness),Qi(x,A.aLineDistance),i){var t=x.getParameter(x.COLOR_CLEAR_VALUE);x.clearColor(0,0,0,0),x.disable(x.BLEND),Qi(x,A.aNormal),Yo(x,$._cube.vs,m,A.aPosition),Vc(x,$._cube.is),ic(i,$,ip,0),ic(i,$,fq,6),ic(i,$,jf,12),ic(i,$,Pk,18),ic(i,$,wh,24),ic(i,$,ef,30),Zk(x,A.aNormal),Fg(x,t)}else if(s){s.value=2;var t=x.getParameter(x.COLOR_CLEAR_VALUE);x.clearColor(0,0,0,0),x.disable(x.BLEND),$._95I(x,A,s),Bf($,s),Km($,$._polylineModelMap,s),Km($,$._wireframeModelMap,s),cf(x,A.uTransparent,!0),$._95I(x,A,s,!0),Bf($,s,!0),Km($,$._polylineModelMap,s,!0),Km($,$._wireframeModelMap,s,!0),cf(x,A.uTransparent,!1),x.clear(x.DEPTH_BUFFER_BIT),$._swapLineMap(),$._95I(x,A,s,!1,!0),Km($,$._polylineModelMap,s),Km($,$._wireframeModelMap,s),$._swapLineMap(),x.disable(x.DEPTH_TEST),$._30O._42(x,A,s),x.enable(x.DEPTH_TEST),Fg(x,t)}else x.disable(x.BLEND),$.drawSky(x,A),$._31O._42(x,A),$._95I(x,A),Bf($),Km($,$._polylineModelMap),Km($,$._wireframeModelMap),x.enable(x.BLEND),cf(x,A.uTransparent,!0),x.depthMask(!1),$._95I(x,A,m,!0),Bf($,m,!0),Km($,$._polylineModelMap,m,!0),Km($,$._wireframeModelMap,m,!0),x.depthMask(!0),cf(x,A.uTransparent,!1),x.clear(x.DEPTH_BUFFER_BIT),$._swapLineMap(),$._95I(x,A,m,!1,!0),Km($,$._polylineModelMap),Km($,$._wireframeModelMap),$._swapLineMap(),x.disable(x.DEPTH_TEST),x.disable(x.BLEND),$._32O._42(x,A),$._30O._42(x,A),x.enable(x.DEPTH_TEST);Yo(x,m),Vc(x,m),$._33Q=!1,$._doBufferGC(x)}}},setBufferGCInterval:function(s){this._bufferGCInterval=s},_doBufferGC:function(a,s){var n=a._bufPool,u=n.length;if(u){var j,A,G=a._renderInfo.frame,F=this._bufferGCInterval||10,m=0;for(j=0;u>j;j++)A=n[j],A?(s||G-A._fid>F)&&(m++,a.deleteBuffer(A._buf),A._buf=null,n[j]=null):m++;if(m>u/2&&m>128){var y=[];for(j=0;u>j;j++)n[j]&&y.push(n[j]);a._bufPool=y}else n._ivCount=m}},_swapLineMap:function(){var e=this;F=e._polylineModelMap,e._polylineModelMap=e._polylineModelMapSwap,e._polylineModelMapSwap=F,F=e._wireframeModelMap,e._wireframeModelMap=e._wireframeModelMapSwap,e._wireframeModelMapSwap=F,F=e._polylineIndexMap,e._polylineIndexMap=e._polylineIndexMapSwap,e._polylineIndexMapSwap=F,F=e._wireframeIndexMap,e._wireframeIndexMap=e._wireframeIndexMapSwap,e._wireframeIndexMapSwap=F},_updateSkyBoxPosition:function(k){if(this._skyBox&&k&&"eye"===k.property){var I=k.newValue;this._skyBox.p3(I[0],I[1],I[2]),this.invalidateData(this._skyBox)}},setSkyBox:function($){this._skyBox=$,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),$&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(z,N,F){var Z=this,j=Z._skyBox;if(j){var C=Z._headlightIntensity,y=oq(Z._headlightColor),N=Z._prg;1!==C&&(y=[y[0]*C,y[1]*C,y[2]*C]),cf(z,N.uHeadlightColor,[y[0],y[1],y[2],1]);var n=Z.getData3dUI(j);n&&n._42(z,N,F,function(){return!0}),z.clear(z.DEPTH_BUFFER_BIT),cf(z,N.uHeadlightColor,[y[0],y[1],y[2],Z._headlightDisabled?1:0])}},_95I:function(X,J,H,b,F){function Z(j){if(!!j.s("shape3d.alwaysOnTop")==!!F&&v.isVisible(j)&&(!B||O)){if(!H&&v.isTransparentMask(j))return;var G=v.getData3dUI(j);G&&G._42(X,J,H,N)}}var v=this,N=function(o){return b?o:!o};v.sky&&X.clear(X.DEPTH_BUFFER_BIT),v.dm().each(Z)},getLogicalPoint:function(u){return Pq(u,this._canvas)},getHitFaceInfo:function(q){q.target&&(q=this.lp(q));var V=this.getDataInfoAt(q);if(V){var Z=this._1o.face(V.data,Bl(q.x,q.y));if(Z)return{data:V.data,face:Z}}return m},unproject:function(s,X){var J=this,U=J.getWidth(),M=J.getHeight(),K=s.target?J.lp(s):s,w=K.x-U/2,$=K.y-M/2,R=2*(w/U),c=2*(-1*$/M);X=X||0;var E=vc(),H=pi(J),C=as(J);Mo(E,H,C),Eq(E);var o=Rd([R,c,X,1],E);return[o[0]/o[3],o[1]/o[3],o[2]/o[3]]},getDataAt:function(o){var R=this.getDataInfoAt(o);return R?R.data:m},getDataInfoAt:function(w,d){return w.target&&(w=this.lp(w)),this._1o.get(Bl(w.x,w.y,d),!0)},getDatasInRect:function(q){return this._1o.get(q)},setEditable:function(g){var d=this,K=d._editable;d._editable=g,this.fp(Io,K,g)},isEditable:function(k){var L=this;return L._editable?Lg(k)?k.s("3d.editable")?L._editableFunc?L._editableFunc(k):!0:!1:!1:!1},isSelectable:function(D){return D.s("3d.selectable")&&this.sm().isSelectable(D)},isMovable:function(j){var v=this;return qr(j)&&j.getStyle(Yc)!==_l?!1:j.s("3d.movable")?v._movableFunc?v._movableFunc(j):!0:!1},isSizeEditable:function(R){return Lg(R)?this._sizeEditableFunc?this._sizeEditableFunc(R):!0:!1},isRotationEditable:function(d){return Lg(d)&&d.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(d):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(q){this.setZoom(As,q)},zoomOut:function(Y){this.setZoom(1/As,Y)},setZoom:function(k,X){if(1!==k){var H=this;if(H._ortho)return H.setOrthoZoom(k,X),void 0;H._14o&&H._14o.stop(!0);var Z=1/k,o=H._eye,i=H._center,T=i[0]+(o[0]-i[0])*Z-o[0],s=i[1]+(o[1]-i[1])*Z-o[1],t=i[2]+(o[2]-i[2])*Z-o[2];if(!(fr(o,i)<H._moveStep&&1>Z)){if(X=dm(X)){var I=Cf(o);return X.action=function(Q){H.fi({kind:H._zooming?"betweenZoom":"beginZoom"}),H._zooming=1,o[0]=I[0]+T*Q,o[1]=I[1]+s*Q,o[2]=I[2]+t*Q,H.fp(wl,m,o)},X._37o=function(){delete H._14o,delete H._zooming,H.fi({kind:"endZoom"}),H.onZoomEnded()},H._14o=yn(X)}o[0]+=T,o[1]+=s,o[2]+=t,H.fp(wl,m,o)}}},setOrthoZoom:function(C,h){if(1!==C){var I=this;I._14o&&I._14o.stop(!0);var $=I._orthoWidth,V=$/C-$;if(!($<I._moveStep&&C>1))return(h=dm(h))?(h.action=function(f){I.fi({kind:I._zooming?"betweenZoom":"beginZoom"}),I._zooming=1,I.setOrthoWidth($+V*f)},h._37o=function(){delete I._14o,delete I._zooming,I.fi({kind:"endZoom"}),I.onZoomEnded()},I._14o=yn(h)):(I.setOrthoWidth($/C),void 0)}},getPositionInfo:function(G){var b=this,y=b._eye,e=b._center,d=b.getAspect(),a=G?Xo(xl(e,y,!0),xl(G,y)):fr(y,e);if(b._ortho){var H=b._orthoWidth;return{length:a,height:H/d,width:H}}var z=2*T(b._fovy/2)*a;return{length:a,height:z,width:z*d}},getCenterInfo:function(){var b=this;return b._81O||(b._81O=b.getPositionInfo()),Cf(b._81O)},rotate:function(d,R,e,o){var L=this;if(d||R){o==m&&(o=L._firstPersonMode),L._88O&&L._88O.stop(!0);var h=L._center,E=L._eye,K=L.getCenterInfo().length,I=o?h:E,B=o?E:h,N=xl(I,B),b=r(N[0],N[2]),T=r(X(N[0]*N[0]+N[2]*N[2]),N[1]),k=o?Im:wl;return o&&(R=-R),(e=dm(e))?(e.action=function(S){L.fi({kind:L._rotating?"betweenRotate":"beginRotate"}),L._rotating=1;var E=b+d*S,q=T+R*S;q=Be(q),N[0]=K*A(q)*A(E),N[1]=K*G(q),N[2]=K*A(q)*G(E),I[0]=B[0]+N[0],I[1]=B[1]+N[1],I[2]=B[2]+N[2],L.fp(k,m,I)},e._37o=function(){delete L._88O,delete L._rotating,L.fi({kind:"endRotate"}),L.onRotateEnded()},L._88O=yn(e)):(b+=d,T+=R,T=Be(T),N[0]=K*A(T)*A(b),N[1]=K*G(T),N[2]=K*A(T)*G(b),I[0]=B[0]+N[0],I[1]=B[1]+N[1],I[2]=B[2]+N[2],L.fp(k,m,I),void 0)}},pan:function(U,j,P,C){if(U||j){var d=this;C==m&&(C=d._firstPersonMode),d._89O&&d._89O.stop(!0);var t=as(d),i=[t[0]*U,t[4]*U,t[8]*U],q=[t[1]*j,t[5]*j,t[9]*j],Z=i[0]+q[0],f=i[1]+q[1],J=i[2]+q[2],N=d._center,l=d._eye;if(C){var T=Ok(d.getBoundaries(),l[0],l[2],l[0]+Z,l[2]+J,X(Z*Z+J*J));Z=T[0],J=T[1]}if(P=dm(P)){var s=Cf(l),K=Cf(N);return P.action=function(w){d.fi({kind:d._panning?"betweenPan":"beginPan"}),d._panning=1,N[0]=K[0]+Z*w,N[1]=K[1]+f*w,N[2]=K[2]+J*w,l[0]=s[0]+Z*w,l[1]=s[1]+f*w,l[2]=s[2]+J*w,d.fp(wl,m,l),d.fp(Im,m,N)},P._37o=function(){delete d._89O,delete d._panning,d.fi({kind:"endPan"}),d.onPanEnded()},d._89O=yn(P)}N[0]+=Z,N[1]+=f,N[2]+=J,l[0]+=Z,l[1]+=f,l[2]+=J,d.fp(wl,m,l),d.fp(Im,m,N)}},walk:function(b,S,l){if(b){var _=this;l==m&&(l=_._firstPersonMode),_._90O&&_._90O.stop(!0);var x=_._center,q=_._eye,i=xl(x,q,!0);if(l){var Y=Ok(_.getBoundaries(),q[0],q[2],q[0]+i[0]*b,q[2]+i[2]*b,w(b));if(b=fr(Y),!b)return;i=[Y[0]/b,0,Y[1]/b]}if(S=dm(S)){var U=Cf(q),h=Cf(x);return S.action=function(G){_.fi({kind:_._walking?"betweenWalk":"beginWalk"}),_._walking=1;var r=b*G;q[0]=U[0]+i[0]*r,q[1]=U[1]+i[1]*r,q[2]=U[2]+i[2]*r,x[0]=h[0]+i[0]*r,x[1]=h[1]+i[1]*r,x[2]=h[2]+i[2]*r,_.fp(wl,m,q),_.fp(Im,m,x)},S._37o=function(){delete _._90O,delete _._walking,_.fi({kind:"endWalk"}),_.onWalkEnded()},_._90O=yn(S)}q[0]+=i[0]*b,q[1]+=i[1]*b,q[2]+=i[2]*b,x[0]+=i[0]*b,x[1]+=i[1]*b,x[2]+=i[2]*b,_.fp(wl,m,q),_.fp(Im,m,x)}},handleScroll:function(u,_){u.preventDefault();var h=this,Y=h._moveStep;h.isFirstPersonMode()?h.isPannable()&&h.pan(0,_>0?Y:-Y):h.isZoomable()&&h.setZoom(0>_?1/Wk:Wk)},handlePinch:function(h,T){this.isZoomable()&&this.setZoom(T>h?1/Hi:Hi)},reset:function(){this.setCenter(b.graph3dViewCenter),this.setEye(b.graph3dViewEye),this.setUp(b.graph3dViewUp)},moveSelection:function(E,C,O){var F=this;F.dm().beginTransaction(),xk(this.sm().toSelection(this.isMovable,this),E,C,O),F.dm().endTransaction()},getMoveMode:function(t,J){var A=J.s("3d.move.mode");if(A)return A;var O="88",Q="89",I="90";return gg(t)||wd[O]&&wd[Q]&&wd[I]?"xyz":wd[O]&&wd[Q]?"xy":wd[O]&&wd[I]?"xz":wd[Q]&&wd[I]?"yz":wd[O]?"x":wd[Q]?"y":wd[I]?"z":"xz"},handleTick:function(){var u=this,R=!1,z=u._moveStep,V=z,n=!1,W=!0,x=u._rotateStep*(W?-1:1);if(u.isWalkable()||(V=0),u.isPannable()||(z=0),u.isRotatable()||(x=0),u._32Q){var c=(Pj()-u._32Q)/50;V*=c,z*=c,x*=c}u._31Q&&(Vr(u._31Q),delete u._31Q,delete u._32Q),If()&&(R=!0,u.pan(-z,0,n,W)),nc()&&(R=!0,u.pan(z,0,n,W)),Dc()&&(R=!0,gg()?u.pan(0,z,n,W):u.walk(V,n,W)),Ml()&&(R=!0,gg()?u.pan(0,-z,n,W):u.walk(-V,n,W)),pq()&&(R=!0,u.rotate(-x,0,n,W)),Sf()&&(R=!0,u.rotate(x,0,n,W)),Zj()&&(R=!0,u.rotate(0,-x/2,n,W)),Pp()&&(R=!0,u.rotate(0,x/2,n,W)),R&&(u._32Q=Pj(),u._31Q=bf(u.handleTick,u))},handleKeyDown:function(P){var N=this;!fo(P)&&km[P.keyCode]?N.handleTick():ff(P)?N.selectAll():Cp(P)?N.handleDelete(P):gh(P)&&this.isResettable()&&N.reset()},checkDoubleClickOnNote:function(L,s,o){var _=this;if(o===ne){if(s.s("note.toggleable"))return s.s(df,!s.s(df)),_.fi({kind:"toggleNote",event:L,data:s,part:o}),!0}else if(o===Hh&&s.s("note2.toggleable"))return s.s(Ik,!s.s(Ik)),_.fi({kind:"toggleNote2",event:L,data:s,part:o}),!0;return!1},checkDoubleClickOnRotation:function(r,Z,K){return K===Bs?(Z.setRotationX(0),!0):K===dd?(Z.setRotationY(0),!0):K===Eg?(Z.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(N){var T=this,Y=T.getWidth()/2,B=T.getHeight()/2,F=T._18Q;return F&&F._wh===Y/B||(F=pi(T),T._18Q=Mo(F,F,as(T)),T._18Q._wh!==Y/B),N=Rd([N[0],N[1],N[2],1],F),{x:Y+Y*N[0]/N[3],y:B-B*N[1]/N[3]}},getHitPosition:function(M,z,g){var R=this,i=R.getWidth(),n=R.getHeight(),k=M.target?R.lp(M):M,f=k.x-i/2,B=k.y-n/2,I=R.getCenterInfo(),N=as(R);z=z?z:[0,0,0],g=g?g:[0,1,0],f=f/i*I.width,B=-1*B/n*I.height;var l=[N[0]*f,N[4]*f,N[8]*f],j=[N[1]*B,N[5]*B,N[9]*B],r=[l[0]+j[0],l[1]+j[1],l[2]+j[2]],K=R.getCenter(),O=Um(R,z,g,[r[0]+K[0],r[1]+K[1],r[2]+K[2]]);return O?O:[0,0,0]},getLineLength:function(X){this.validate();var U=this.getData3dUI(X);if(U&&U.getCache){var W=U.getCache();if(W)return W[W.length-1].length}return 0},getLineOffset:function(A,i){var x=this.getData3dUI(A);if(x&&x.getCache){var s=x.getCache();if(s)return sm(s,i)}return m},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}});var Hm=bb.Interactor=function(k){this.gv=k};ji("Interactor",u,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Al=bb.DefaultInteractor=function(I){Ck(Al,this,[I])};ji("DefaultInteractor",Hm,{handle_contextmenu:function(m){db(m)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta/40)},handle_DOMMouseScroll:function(l){2===l.axis&&this.gv.handleScroll(l,-l.detail)},handle_keydown:function(i){this.gv.handleKeyDown(i)},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(N){db(N);var y=this,Q=y.gv,l=zj(N),E=Q.getDataInfoAt(N),Y=E?E.data:m,i=E?E.part:m,G=Q.sm(),H=jg(N),g=rn(N);Q.setFocus(N)&&(y._62O=m,y._57I=m,Y?fo(N)?G.co(Y)?G.rs(Y):G.as(Y):G.co(Y)||G.ss(Y):l&&(fo(N)?Q.isRectSelectable()&&(y._62O=ze):y._57I=Dl(N)),y._31Q&&(Vr(y._31Q),delete y._31Q,delete y._32Q),y._62O||(Q.isFirstPersonMode()&&(gg(N)||g>2?y._62O="pan":Q.isMouseRoamable()||L?(y._62O="roaming",y.foward=H&&zj(N),y._32Q=Pj(),y._31Q=bf(y.tick,y)):l||(y._62O="roaming")),y._62O||(l&&H&&ui[i]?(y._62O=i,y.p3=Y.p3()):l&&H&&Lg(Y)&&Q.isSelected(Y)&&Q.isMovable(Y)?(y._62O="move",y.p3=Y.p3(),y.movedata=Y):L&&(g>2?y._62O="pan":2===g&&(y.dist=lf(N),y._62O="pinch")))),y.point=Q.lp(N),Qc(y,N),qc(N)?Q.handleDoubleClick(N,Y,i):Q.handleClick(N,Y,i))},tick:function(){var C=this,z=C.gv,U=z._moveStep;C.point&&z.isWalkable()&&(C._32Q&&(U*=(Pj()-C._32Q)/50),z.walk(C.foward?U:-U),C._32Q=Pj(),C._31Q=bf(C.tick,C))},handle_mouseup:function(q){this.handle_touchend(q)},handle_touchend:function(k){var y=this._57I;y&&(fr(y,Dl(k))<=1&&this.gv.sm().cs(),this._57I=m)},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(O){var t,K,l=this,x=l.gv,j=l._62O,n=l.point,Q=x.dm(),C=x.lp(O),I=C.x-n.x,G=C.y-n.y,M=-k*I/x.getWidth(),h=-k*G/x.getHeight();if("roaming"===j)l.rotate(O,M/2,h/2);else if(j===Bs||j===dd||j===Eg)x._86O||Q.beginTransaction(),x.fi({kind:x._86O?"betweenEditRotation":"beginEditRotation",event:O}),x._86O=1,x.sm().each(function(H){if(Lg(H)&&x.isRotationEditable(H)){var v=w(M)>w(h)?M:h;j===Bs?H.setRotationX(H.getRotationX()+v):j===dd?H.setRotationY(H.getRotationY()+v):j===Eg&&H.setRotationZ(H.getRotationZ()+v)}});else if("move"===j||ui[j]){j===jp||j===Bh||j===ph?(x._87O||Q.beginTransaction(),x.fi({kind:x._87O?"betweenEditSize":"beginEditSize",event:O}),x._87O=1):(x._moving||Q.beginTransaction(),x.fi({kind:x._moving?"betweenMove":"beginMove",event:O}),x._moving=1);var Z,r=l.p3,H=x.getPositionInfo(r),q=as(x);Z=j===rh?"x":j===Vd?"y":j===gk?"z":j===jp?"sx":j===Bh?"sy":j===ph?"sz":x.getMoveMode(O,l.movedata),I=I/x.getWidth()*H.width,G=-1*G/x.getHeight()*H.height;var o,W,N=[q[0]*I,q[4]*I,q[8]*I],D=[q[1]*G,q[5]*G,q[9]*G],J=N[0]+D[0],X=N[1]+D[1],$=N[2]+D[2],u=[r[0]+J,r[1]+X,r[2]+$],Y=xl(x.getEye(),u,!0);if("xyz"===Z?(o=u,x.moveSelection(J,X,$)):"xz"===Z?(o=Um(x,r,[0,1,0],u),o&&x.moveSelection(o[0]-r[0],0,o[2]-r[2])):"xy"===Z?(o=Um(x,r,[0,0,1],u),o&&x.moveSelection(o[0]-r[0],o[1]-r[1],0)):"yz"===Z?(o=Um(x,r,[1,0,0],u),o&&x.moveSelection(0,o[1]-r[1],o[2]-r[2])):"x"===Z||"sx"===Z?(Y[0]=0,o=Um(x,r,Y,u),o&&(W=o[0]-r[0],"x"===Z?x.moveSelection(W,0,0):x.sm().each(function(r){Lg(r)&&x.isSizeEditable(r)&&(t=v(kc,r.getWidth()+W),K=t/r.getWidth(),r.setWidth(t),gg(O)&&(r.setHeight(r.getHeight()*K),r.setTall(r.getTall()*K)))}))):"y"===Z||"sy"===Z?(Y[1]=0,o=Um(x,r,Y,u),o&&(W=o[1]-r[1],"y"===Z?x.moveSelection(0,W,0):x.sm().each(function(B){Lg(B)&&x.isSizeEditable(B)&&(t=v(kc,B.getTall()+W),K=t/B.getTall(),B.setTall(t),gg(O)&&(B.setHeight(B.getHeight()*K),B.setWidth(B.getWidth()*K)))}))):("z"===Z||"sz"===Z)&&(Y[2]=0,o=Um(x,r,Y,u),o&&(W=o[2]-r[2],"z"===Z?x.moveSelection(0,0,W):x.sm().each(function(f){Lg(f)&&x.isSizeEditable(f)&&(t=v(kc,f.getHeight()+W),K=t/f.getHeight(),f.setHeight(t),gg(O)&&(f.setTall(f.getTall()*K),f.setWidth(f.getWidth()*K)))}))),!o)return;l.p3=o}else if(j===ze){var a=l.div;a||(a=l.div=gd(),ts(l.getView(),a),a.op=n,a.style.background=x.getRectSelectBackground()),x.fi({kind:x._rectSelecting?"betweenRectSelect":"beginRectSelect",event:O}),x._rectSelecting=1,a.rect=Td(a.op,C),Or(a,a.rect)}else if("pinch"===j&&2===rn(O)){x.fi({kind:x._pinching?"betweenPinch":"beginPinch",event:O}),x._pinching=1;var W=lf(O);x.handlePinch(W,l.dist),l.dist=W}else"pan"===j||gg(O)?l.pan(O,I,G):x.isFirstPersonMode()||(zj(O)?l.rotate(O,M,h):(l.pan(O,I,0),x.isWalkable()&&(x.fi({kind:x._walking?"betweenWalk":"beginWalk",event:O}),x._walking=1,x.walk(G/x.getHeight()*x.getCenterInfo().height))));l.point=C},pan:function(e,R,B){var a=this.gv;if(a.isPannable()){var A=a.getCenterInfo(),$=R/a.getWidth()*A.width,h=-1*B/a.getHeight()*A.height;a.fi({kind:a._panning?"betweenPan":"beginPan",event:e}),a._panning=1,a.pan(-$,-h)}},rotate:function(v,o,U){var V=this.gv;V.isRotatable()&&(V.fi({kind:V._rotating?"betweenRotate":"beginRotate",event:v}),V._rotating=1,V.rotate(o,U))},handleWindowMouseUp:function(l){this.handleWindowTouchEnd(l)},handleWindowTouchEnd:function(v){var x=this,A=x.gv,E=A.dm(),H=x.div;if(H){var K=A.getDatasInRect(H.rect);if(!K.isEmpty()){var j=A.sm(),N=j.toSelection();K.each(function(M){j.co(M)?N.remove(M):N.add(M)}),j.ss(N)}bd(H)}A._moving&&(delete A._moving,A.fi({kind:"endMove",event:v}),A.onMoveEnded(),E.endTransaction()),A._panning&&(delete A._panning,A.fi({kind:"endPan",event:v}),A.onPanEnded()),A._rotating&&(delete A._rotating,A.fi({kind:"endRotate",event:v}),A.onRotateEnded()),A._86O&&(delete A._86O,A.fi({kind:"endEditRotation",event:v}),E.endTransaction()),A._87O&&(delete A._87O,A.fi({kind:"endEditSize",event:v}),E.endTransaction()),A._pinching&&(delete A._pinching,A.fi({kind:"endPinch",event:v}),A.onPinchEnded()),A._rectSelecting&&(delete A._rectSelecting,A.fi({kind:"endRectSelect",event:v}),A.onRectSelectEnded()),A._walking&&(delete A._walking,A.fi({kind:"endWalk",event:v}),A.onWalkEnded()),x.dist=x.point=x._62O=x.p3=x.movedata=x.div=x._57I=x._32Q=x._31Q=x.foward=m}});var zb=function(B){this.gv=B};Uo(zb,u,{_iv:!0,iv:function(){this._iv=!0},face:function(o,h){var J=this,Y=J.gv.getGL();if(!Y||!Lg(o))return m;var M=h.x,$=h.width,P=h.height,x=J.height-h.y-P,e=f($/2),H=new Uint8Array(4*$*P),K=0;for(J.iv(),J.validate(o),Yk(Y,J.frame),Y.readPixels(M,x,$,P,Y.RGBA,Y.UNSIGNED_BYTE,H),Yk(Y,m),J.iv();e>=K;K++)for(var T=e-K,t=e+K,O=T;t>=O;O++)for(var l=T;t>=l;l++)if(O===T||O===t||l===T||l===t){var C=Ff.m[H[4*(O*$+l)]];if(C)return C}},get:function(_,D){this.validate();var T=this,N=T.gv.getGL();if(!N)return m;var C,r,Z=_.x,E=_.width,O=_.height,K=T.height-_.y-O,y=f(E/2),c=new Uint8Array(4*E*O),z=0,v=c.length,A=D?m:new Nf,I=D?m:{};if(Yk(N,T.frame),N.readPixels(Z,K,E,O,N.RGBA,N.UNSIGNED_BYTE,c),Yk(N,m),D){for(;y>=z;z++)for(var G=y-z,l=y+z,J=G;l>=J;J++)for(var L=G;l>=L;L++)if((J===G||J===l||L===G||L===l)&&(C=T.info(c,4*(J*E+L))))return C}else for(;v>z;z+=4)C=T.info(c,z),C&&(r=C.data,I[r._id]||(A.add(r),I[r._id]=r));return A},info:function(W,k){return this.colorMap[(W[k]<<16)+(W[k+1]<<8)+W[k+2]+((127&W[k+3])<<24)]},validate:function(A){var L=this,z=L.gv,p=z.getGL();if(p){var I=z.getWidth(),K=z.getHeight(),B=p.RGBA,E=p.TEXTURE_2D,P=p.RENDERBUFFER,U=p.FRAMEBUFFER;L.texture||(L.texture=Le(p),L.render=p.createRenderbuffer(),L.frame=p.createFramebuffer()),(L.width!==I||L.height!==K)&&(hd(p,L.texture),p.texImage2D(E,0,B,I,K,0,B,p.UNSIGNED_BYTE,m),_b(p,p.TEXTURE_MIN_FILTER,p.LINEAR),p.bindRenderbuffer(P,L.render),p.renderbufferStorage(P,p.DEPTH_COMPONENT16,I,K),Yk(p,L.frame),p.framebufferTexture2D(U,p.COLOR_ATTACHMENT0,E,L.texture,0),p.framebufferRenderbuffer(U,p.DEPTH_ATTACHMENT,P,L.render),hd(p,m),p.bindRenderbuffer(P,m),Yk(p,m),L.width=I,L.height=K),L._iv&&(L._iv=!1,Yk(p,L.frame),z._42(A||(L.colorMap={}),1),Yk(p,m))}}});var nd=function(Q){this.gv=Q};Uo(nd,u,{gap:0,size:0,_42:function(p,E){var w=this,f=w.gv,y=f._gridGap,c=f._gridSize;if(f._gridVisible){if(w.gap!==y||w.size!==c){for(var n=[],G=f._gridSize/2,L=y*G,I=0;2*G+1>I;I++){var U=6*I,l=6*(2*G+1)+U;n[U]=-L,n[U+1]=0,n[U+2]=-L+I*y,n[U+3]=L,n[U+4]=0,n[U+5]=-L+I*y,n[l]=-L+I*y,n[l+1]=0,n[l+2]=-L,n[l+3]=-L+I*y,n[l+4]=0,n[l+5]=L}w.vs=new ck(n),w.gap=y,w.size=c}sp(f),yd(p,E),fs(p),dh(p,E,1,f._gridColor,f._buffer.vs,w.vs),ce(p,0,w.vs.length/3,p.LINES),zq(p),pc(p,E)}else w.vs=w.gap=w.size=m}});var Fi=function(V){this.gv=V};Uo(Fi,u,{_42:function(d,E){var j=this.gv,p=j._buffer.vs,Z=j._axisXColor,r=j._axisYColor,W=j._axisZColor,B=j._originAxisVisible,U=j._centerAxisVisible;if(B||U){var t=g?d.TRIANGLES:d.TRIANGLE_FAN,q=d.LINES;if(sp(j),yd(d,E),fs(d),B){var I=j.getCenterInfo(),X=R(I.width,I.height)/5,V=.8*X,o=.05*X;dh(d,E,1.5,Z,p,new ck([0,0,0,X,0,0,V,o,0,V,0,o,V,-o,0,V,0,-o,V,o,0,0,0,0,0,X,0,o,V,0,0,V,o,-o,V,0,0,V,-o,o,V,0,0,0,0,0,0,X,o,0,V,0,o,V,-o,0,V,0,-o,V,o,0,V])),ce(d,0,2,q),ce(d,1,6,t),dh(d,E,m,r),ce(d,7,2,q),ce(d,8,6,t),dh(d,E,m,W),ce(d,14,2,q),ce(d,15,6,t)}if(U){var n=j._center,k=n[0],Q=n[1],e=n[2],I=j.getPositionInfo(n);X=R(I.width,I.height)/20,dh(d,E,1.5,Z,p,new ck([k,Q,e,k+X,Q,e,k,Q,e,k,Q+X,e,k,Q,e,k,Q,e+X])),ce(d,0,2,q),dh(d,E,m,r),ce(d,2,2,q),dh(d,E,m,W),ce(d,4,2,q)}zq(d),pc(d,E)
}}});var Oc=function($){this.gv=$},rh="edit_tx",Vd="edit_ty",gk="edit_tz",Bs="edit_rx",dd="edit_ry",Eg="edit_rz",jp="edit_sx",Bh="edit_sy",ph="edit_sz",ui={};ui[rh]=1,ui[Vd]=1,ui[gk]=1,ui[Bs]=1,ui[dd]=1,ui[Eg]=1,ui[jp]=1,ui[Bh]=1,ui[ph]=1,Uo(Oc,u,{_42:function(p,Q,l){var t=this,P=t.gv,U=P.sm().ld();if(P.isEditable(U)&&!P.isEditHelperDisabled()&&Lg(U)&&(!P.isFirstPersonMode()||!P.isMouseRoamable()&&!L)){sp(P);var y,s,X=P.isMovable(U),I=P.isRotationEditable(U),b=P.isSizeEditable(U),C=P._axisXColor,r=P._axisYColor,O=P._axisZColor,e=P._editSizeColor,m=P.getCenterInfo(),v=R(m.width,m.height)/10,d=v/(l?5:10),F=.7*v,o=.4*F,W=U.p3(),h=W[0],c=W[1],N=W[2];y=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],X&&t._17O(p,Q,U,l,rh,C,y,[h,c-d,N,h+F,c-d,N,h+F,c,N,h+F,c,N,h,c,N,h,c-d,N,h,c-d,N+d,h+F,c-d,N+d,h+F,c-d,N,h+F,c-d,N,h,c-d,N,h,c-d,N+d]),s=h+F,b&&t._17O(p,Q,U,l,jp,e,y,[s,c-d,N,s+o,c-d,N,s+o,c,N,s+o,c,N,s,c,N,s,c-d,N,s,c-d,N+d,s+o,c-d,N+d,s+o,c-d,N,s+o,c-d,N,s,c-d,N,s,c-d,N+d]),s+=o,I&&t._17O(p,Q,U,l,Bs,C,y,[s,c-d,N,s+o,c-d,N,s+o,c,N,s+o,c,N,s,c,N,s,c-d,N,s,c-d,N+d,s+o,c-d,N+d,s+o,c-d,N,s+o,c-d,N,s,c-d,N,s,c-d,N+d]),y=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],X&&t._17O(p,Q,U,l,Vd,r,y,[h,c,N,h,c+F,N,h-d,c+F,N,h-d,c+F,N,h-d,c,N,h,c,N,h,c,N,h,c,N-d,h,c+F,N-d,h,c+F,N-d,h,c+F,N,h,c,N]),s=c+F,b&&t._17O(p,Q,U,l,Bh,e,y,[h,s,N,h,s+o,N,h-d,s+o,N,h-d,s+o,N,h-d,s,N,h,s,N,h,s,N,h,s,N-d,h,s+o,N-d,h,s+o,N-d,h,s+o,N,h,s,N]),s+=o,I&&t._17O(p,Q,U,l,dd,r,y,[h,s,N,h,s+o,N,h-d,s+o,N,h-d,s+o,N,h-d,s,N,h,s,N,h,s,N,h,s,N-d,h,s+o,N-d,h,s+o,N-d,h,s+o,N,h,s,N]),y=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],X&&t._17O(p,Q,U,l,gk,O,y,[h,c,N,h,c,N+F,h,c-d,N+F,h,c-d,N+F,h,c-d,N,h,c,N,h,c-d,N,h-d,c-d,N,h-d,c-d,N+F,h-d,c-d,N+F,h,c-d,N+F,h,c-d,N]),s=N+F,b&&t._17O(p,Q,U,l,ph,e,y,[h,c,s,h,c,s+o,h,c-d,s+o,h,c-d,s+o,h,c-d,s,h,c,s,h,c-d,s,h-d,c-d,s,h-d,c-d,s+o,h-d,c-d,s+o,h,c-d,s+o,h,c-d,s]),s+=o,I&&t._17O(p,Q,U,l,Eg,O,y,[h,c,s,h,c,s+o,h,c-d,s+o,h,c-d,s+o,h,c-d,s,h,c,s,h,c-d,s,h-d,c-d,s,h-d,c-d,s+o,h-d,c-d,s+o,h,c-d,s+o,h,c-d,s])}},_17O:function(K,d,y,P,r,s,e,l){var W=this.gv._buffer;cs(K,d,P,!0,y,r),xp(K,d,m,!0,m,!0,m,!1),cf(K,d.uDiffuse,s),Yo(K,W.vs,new ck(l),d.aPosition),Yo(K,W.ns,new ck(e),d.aNormal),fs(K),ce(K,0,12),zq(K),Qo(K,d)}});var Xh=function(B,Z){this.gv=B,this.s=function(f,F,l){return F==m&&(F=l),F==m?Z.getStyle(f):Nd(F,Z,B)},this.data=Z};Uo(Xh,u,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(L,s,S,x){var t=this,G=t.data;if(!(G instanceof hj)){var V,p,R,v,$,U,N,B=t.gv,j=G._id,D=t.s("shape3d.alwaysOnTop")?null:t.s("batch"),b=B._batchIndexMap,n=B._batchModelMap,u=B.isSelectable(G),H=B.getBrightness(G),y=H!=m&&1!==H;if(t.needValidate(L)){if(R=Kh(b,n,G,D),t.validate(R,D?tk[D]||$j:m),R&&(v=b[j],$=v.size=R.vs.length/3-v.begin,N=R.rs))for(H=y?H:1,U=0;$>U;U++)N.push(H);if(Lg(G)){var _=B.getWireframeGeometry(G);if(_)Jc(B,G,_);else{var X=B.getWireframe(G);X&&Jc(B,G,X)}}t.labelInfo=t.label2Info=t.noteInfo=t.note2Info=t._38o=m,t._24O(yr,"getLabel"),t._24O(id,"getLabel2"),t._26O(ne,"getNote"),t._26O(Hh,"getNote2"),t._15O(),t._iv=!1}y&&cf(L,s.uBrightness,H),cf(L,s.uAlphaTest,t.s("alphaTest")),p=cs(L,s,S,u,G,Mn),p&&(td(p,b[j],n),td(p,B._polylineIndexMap[j],B._polylineModelMap),td(p,B._wireframeIndexMap[j],B._wireframeModelMap)),b[j]||t._80o(L,s,x),B.isLabelVisible(G)&&((V=t.labelInfo)&&(cs(L,s,S,u,G,yr),t._28O(V,yr,x)),(V=t.label2Info)&&(cs(L,s,S,u,G,id),t._28O(V,id,x))),B.isNoteVisible(G)&&((V=t.noteInfo)&&(cs(L,s,S,u,G,ne),t._29O(V,ne,x)),(V=t.note2Info)&&(cs(L,s,S,u,G,Hh),t._29O(V,Hh,x))),(V=t._38o)&&t._99O(L,s,V,S,u,x),y&&cf(L,s.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return bj},_80o:function(){},dispose:function(){},_calcAnchorMat:function(V){if(V.hasOwnProperty("_anchor")||V.hasOwnProperty("_anchorElevation")){var p=V.getAnchor3d(),m={x:p.x-.5,y:p.y-.5,z:p.z-.5},i=vc();return bl(i,[-m.x,-m.y,-m.z]),i}},getBodyColor:function(O){var i=this.data,D=this.gv.getBodyColor(i);return D?D:O?i.getStyle(O):m},_24O:function(G,T){var Z=this,h=Z.data,d=Z.gv,V=Z.s,a=d[T](h);if(a!=m){var k=V(G+".scale"),o=V(G+".max"),e=Z[G+"Info"]={label:a,textureScale:V(G+".texture.scale"),color:d[T+"Color"](h),font:V(G+".font"),align:V(G+".align"),background:d[T+"Background"](h)},W=e.rect=eg(e,a);o>0&&o<W.width&&(e.labelWidth=W.width,W.width=o),W.x=W.y=0,W.width*=k,W.height*=k,e.mat=Z._16O(V(G+".autorotate"),V(G+".position"),W,V(G+".face"),V(G+".t3"),V(G+".r3"),V(G+".rotationMode"));var x=W.width/2,H=W.height/2;e.vs=new ck([-x,H,0,-x,-H,0,x,-H,0,x,H,0]),W.width/=k,W.height/=k}},_26O:function(y,Y){var w=this,j=w.data,z=w.gv,I=w.s,J=z[Y](j);if(J!=m){var e=I(y+".scale"),D=this[y+"Info"]={note:J,textureScale:I(y+".texture.scale"),expanded:I(y+".expanded"),font:I(y+".font"),color:I(y+".color"),align:I(y+".align"),borderWidth:I(y+".border.width"),borderColor:I(y+".border.color"),background:z[Y+"Background"](j)};if(D.expanded){var p=I(y+".max"),T=eg(D,J);T.width+=6,T.height+=2,p>0&&p<T.width&&(D.labelWidth=T.width,T.width=p);var A={x:-T.width/2,y:-8-T.height,width:T.width,height:T.height+8}}else A={x:-6,y:-18,width:12,height:18};D.mat=w._16O(I(y+".autorotate"),I(y+".position"),m,I(y+".face"),I(y+".t3"),I(y+".r3"),I(y+".rotationMode")),D.rect=A,1!==e&&(A=Cf(A),A.x*=e,A.height*=e,A.y=-A.height,A.width*=e);var h=A.x,_=A.y,i=A.width,W=A.height;D.vs=new ck([h,-_,0,h,-_-W,0,h+i,-_-W,0,h+i,-_,0])}},_28O:function(y,K,g){if(g(this.s(K+".transparent"))){var M=y.rect,h=y.textureScale,N=M.width*h,w=M.height*h;if(N>=1&&w>=1){var n=Cc(N,w);1!==h&&(n.translate(n,M.x,M.y),n.scale(h,h),n.translate(n,-M.x,-M.y)),ul(n,y),n.restore(),Jl(this,K,y.mat,y.vs,!0)}}},_29O:function(B,O,H){if(H(this.s(O+".transparent"))){var o=B.rect,Q=B.textureScale,J=o.x,k=o.y,E=o.width*Q,V=o.height*Q;if(E>=1&&V>=1){o.x=o.y=0;var y=Cc(E,V);1!==Q&&y.scale(Q,Q),ed(y,B),y.restore(),o.x=J,o.y=k,Jl(this,O,B.mat,B.vs,!1)}}},_99O:function(B,I,M,E,Q,q){if(M){var N=this,$=N.gv,G=N.data,r=$._buffer,g=$._1O,v=M.icons;for(var d in v){var J=v[d],_=M.rects[d];if(_&&q(Nd(J.transparent,G,$))){cs(B,I,E,Q,G,d);var O=Nd(J.shape3d,G,$),Y=O?[O]:Nd(J.names,G,$),W=Y?Y.length:0,n=Nd(J.textureScale,G,$)||1,C=Nd(J.light,G,$);C==m&&(C=O?!0:!1),xp(B,I,Nd(J.blend,G,$),C,Nd(J.opacity,G,$),Nd(J.reverseFlip,G,$),Nd(J.reverseColor,G,$),Nd(J.reverseCull,G,$));for(var L=0;W>L;L++){var H=Y[L],k=_[L];if(Gf(N,k.mat),O)bm($,G,Cl(N,O),N);else{var S=Se(H);if(S){var j=k.width*n,P=k.height*n;if(j>=1&&P>=1){var X=Cc(j,P);Mc(X,S,Nd(J.stretch,G,$),0,0,j,P,G,$),X.restore(),Le(B,ao,g),fs(B,I,g,Nd(J.discardSelectable,G,$),r.uv,$d),Yo(B,r.vs,k.vs,I.aPosition),go(B,r.ns,Kq,I.aNormal),to(B,r.is,So),Ln(B,0,So.length),zq(B,I,g)}}}Ph($)}Qo(B,I)}}}}});var Jd=function(r,A){Ck(Jd,this,[r,A])};Uo(Jd,Xh,{_16O:function(C,G,y,R,m,n,s,E,c){var Q=this.data,_=Q.getFinalScale3d(),Y=$n(G,_,y,R,E,c);if(Q.hasOwnProperty("_anchor")||Q.hasOwnProperty("_anchorElevation")){var p=Q.getAnchor3d();Y[0]-=(p.x-.5)*_[0],Y[1]-=(p.y-.5)*_[1],Y[2]-=(p.z-.5)*_[2]}return Wf(vc(),Y,Q.p3(),R,m,n,s,C,Q.r3(),Q.getRotationMode())},clear:function(){var r=this;r.faceMat=r.mat=r.shapeModel=r.left=r.right=r.front=r.back=r.top=r.bottom=r.csg=m},needValidate:function(E){if(this._iv)return this._validateFrameId=E._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")){var C=E._renderInfo.frame;if(this._validateFrameId!==C)return this._validateFrameId=C,!0}return!1},validate:function(R,r){var G=this,A=G.gv,j=G.data,s=Cl(G);G._updateAutoRotation(),G._updateFixSize2d(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(we(A,j,"_wireframeModelMap","_wireframeIndexMap"),we(A,j,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var w=ak(j,A.getMat(j),s?G.s("shape3d.scaleable"):!0),J=G._calcAnchorMat(j);if(J&&Mo(w,w,J),G.clear(),R){var f=[];s?Cq(A,j,s,G,G.getBodyColor(),[w],R,f):(vm(A,j,R,r,w,ip,f,Hn),vm(A,j,R,r,w,jf,f,ve),vm(A,j,R,r,w,wh,f,ig),vm(A,j,R,r,w,ef,f,Bo),vm(A,j,R,r,w,fq,f,Jj),vm(A,j,R,r,w,Pk,f,Yg)),f.length&&(gb(R.vs,f),gb(R.ns,oi(f)))}else G.mat=w,(G.shapeModel=s)||(G._cubeUvs=null,G.vf(ip,0),G.vf(jf,16),G.vf(fq,8),G.vf(Pk,24),G.vf(wh,32),G.vf(ef,40))},_updateAutoRotation:function(){var T=this,_=T.s("shape3d.autorotate");if(_){var l,j=T.gv,L=T.data;l="string"==typeof _?[_.indexOf("x")<0?j._eye[0]:j._center[0],_.indexOf("y")<0?j._eye[1]:j._center[1],_.indexOf("z")<0?j._eye[2]:j._center[2]]:j._eye;var B=j._center,h=[l[0]-B[0],l[1]-B[1],l[2]-B[2]],v=L.p3(),m=Rp([v[0]+h[0],v[1]+h[1],v[2]+h[2]],v,j._up),r=L.r3(),c=wp(m,L.getRotationMode());Math.abs(r[0]-c[0])<1e-5&&Math.abs(r[1]-c[1])<1e-5&&Math.abs(r[2]-c[2])<1e-5||L.r3(c)}},_updateFixSize2d:function(){var k=this,h=k.data,W=k.s("shape3d.fixSizeOnScreen");if(!W)return h._dynamicScale3d&&delete h._dynamicScale3d,void 0;var n=k.gv;h.getFinalScale3d();var Q=ak(h,n.getMat(h)),z=zh([0,0,0],Q),T=n.toViewPosition(z);if(!isNaN(T.x)&&!isNaN(T.y)){var i=zh([1,0,0],Q),M=n.toViewPosition(i),q=zh([0,1,0],Q),D=n.toViewPosition(q),O=M.x-T.x,E=D.y-T.y,S=h._dynamicScale3d||[1,1,1],I=Se(h.s("shape3d.image")),U=W[0]>0?W[0]:I?Jb(I,k):20,d=W[1]>0?W[1]:I?vr(I,k):20,P=Math.abs(O/U),m=Math.abs(E/d);Math.abs(P-1)<.001&&Math.abs(m-1)<.001||(h._dynamicScale3d=[S[0]/P,S[1]/m,S[2]])}},vf:function(E,S){var q=this;if(q.gv.getFaceVisible(q.data,E)){var d=In(q,E);d.mat&&(q.faceMat=!0);var x=d.uv;if(x){var n=q._cubeUvs;n||(n=q._cubeUvs=new ck([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var l=0;8>l;l++)n[S+l]=x[l]}return d}},_80o:function(Y,O,d){var X=this,q=X.gv,x=X.data,I=q._cube,i=X.shapeModel;sp(q,X.mat),i?bm(q,x,i,X,X.getBodyColor(),d):(Yo(Y,I.vs,m,O.aPosition),Yo(Y,I.ns,m,O.aNormal),Vc(Y,I.is),X._18O(Y,O,X.left,0,d),X._18O(Y,O,X.front,6,d),X._18O(Y,O,X.right,12,d),X._18O(Y,O,X.back,18,d),X._18O(Y,O,X.top,24,d),X._18O(Y,O,X.bottom,30,d)),Ph(q),X.faceMat&&(X._18O(Y,O,X.left,0,d,!0),X._18O(Y,O,X.front,6,d,!0),X._18O(Y,O,X.right,12,d,!0),X._18O(Y,O,X.back,18,d,!0),X._18O(Y,O,X.top,24,d,!0),X._18O(Y,O,X.bottom,30,d,!0))},_18O:function(D,s,a,F,W,b){if(a){if(!W(a.transparent))return;if(b&&!a.mat||!b&&a.mat)return;b&&sp(this.gv,a.mat);var U=this,x=U.data,j=U.gv,Y=j.getTexture(a.texture,x),u=a.uv,l=a.uvScale,h=a.uvOffset,S=a.discardSelectable;Y?u?fs(D,s,Y,S,j._buffer.uv,U._cubeUvs,h,l):fs(D,s,Y,S,j._cube.uv,m,h,l):fs(D),xp(D,s,a.blend,a.light,a.opacity,a.reverseFlip,a.reverseColor,a.reverseCull),cf(D,s.uDiffuse,a.color),Ln(D,F,6),Qo(D,s),zq(D,s,Y),b&&Ph(j)}}});var pm=function(v,H){Ck(pm,this,[v,H])};Uo(pm,Xh,{_25Q:1,validate:function(M){var T=this,V=T.gv,J=T.data,Z=T.s,p=Z("edge.width"),e=J._40I,o=J._41I;if(T.shapeModel=T.info=m,e&&o){var K,s,r,O,i,y,U,E,v,f,z=J.isLooped(),g=Z(Yc),q=b.getEdgeType(g);if(q){var D=q(J,Gd(T,V,J,z,g),V,T._19Q);if(!D.points||D.points.isEmpty())return;y=T.info={},U=D.segments,i=D.points,E=i.size();for(var I=e.getElevation(),C=o.getElevation(),$=0;E>$;$++){var t=i.get($);t.e==m&&(t.e=I+(C-I)*$/(E-1))}v=ij(i.get(0)),f=ij(i.get(E-1));var h=E%2;0===h?(y.c1=ij(i.get(E/2-1)),y.c2=ij(i.get(E/2))):y.p3=ij(i.get((E-h)/2)),y.s1=v,y.s2=ij(i.get(1)),y.t1=ij(i.get(E-2)),y.t2=f}else{i=new Nf,y=T.info={};var W=Z("edge.offset"),S=Z("edge.center"),F=Z("edge.source.t3"),A=Z("edge.target.t3"),k=e.p3(),H=o.p3();if(F&&(k[0]+=F[0],k[1]+=F[1],k[2]+=F[2]),A&&(H[0]+=A[0],H[1]+=A[1],H[2]+=A[2]),g===_l){U=Z("edge.segments");var n=y.points=Z(Sc)||De;if(E=n.size()){v=ij(n.get(0)),f=ij(n.get(E-1)),!S&&W&&(r=xl(v,k,!0),W=R(W,fr(k,v)),k=[k[0]+r[0]*W,k[1]+r[1]*W,k[2]+r[2]*W],r=xl(H,f,!0),W=R(W,fr(f,H)),H=[H[0]-r[0]*W,H[1]-r[1]*W,H[2]-r[2]*W]);var h=E%2;0===h?(K=ij(n.get(E/2-1)),s=ij(n.get(E/2))):y.p3=ij(n.get((E-h)/2)),y.s1=k,y.s2=v,y.t1=f,y.t2=H}else!S&&W&&(r=xl(H,k,!0),O=fr(k,H),W=pk(W,O),k=[k[0]+r[0]*W,k[1]+r[1]*W,k[2]+r[2]*W],H=[H[0]-r[0]*W,H[1]-r[1]*W,H[2]-r[2]*W]),K=k,s=H;i.add({x:k[0],y:k[2],e:k[1]}),i.addAll(n),i.add({x:H[0],y:H[2],e:H[1]})}else{var N=Gd(T,V,J,z,g);if(T._19Q||(N=-N),z){var j=k[0],L=k[1],x=k[2],G=e.getTall()/2+N;K=[j-N,L+G,x],s=[j+N,L+G,x],i.add({x:j-N,y:x,e:L}),i.add({x:j-N,y:x,e:L+G}),i.add({x:j+N,y:x,e:L+G}),i.add({x:j+N,y:x,e:L})}else{r=xl(H,k,!0),O=fr(k,H);var u={x:k[0],y:k[2]},Y={x:H[0],y:H[2]},Q=Fd(m,u,Y,N),l=Q.x-u.x,c=Q.y-u.y;W=pk(W,O),r[0]*=W,r[1]*=W,r[2]*=W,K=[k[0]+r[0]+l,k[1]+r[1],k[2]+r[2]+c],s=[H[0]-r[0]+l,H[1]-r[1],H[2]-r[2]+c],S?(i.add({x:k[0],y:k[2],e:k[1]}),i.add({x:K[0],y:K[2],e:K[1]}),i.add({x:s[0],y:s[2],e:s[1]}),i.add({x:H[0],y:H[2],e:H[1]})):(i.add({x:K[0],y:K[2],e:K[1]}),i.add({x:s[0],y:s[2],e:s[1]}))}}y.c1=K,y.c2=s}y.list=Z(Do)===Ke?T.createTubeModel(i,U,p/2,M):T.createLineModel(i,U,p,"edge","edge.dash")}}});var Rk=function(c,Q){Ck(Rk,this,[c,Q])};Uo(Rk,Jd,{_80o:function(q,C,S){var J=this,U=J.gv,x=J.shapeModel;sp(U,J.mat),x?bm(U,J.data,x,J,J.getBodyColor(),S):(Gq(J,q,C,J.left,S),Gq(J,q,C,J.front,S),Gq(J,q,C,J.right,S),Gq(J,q,C,J.back,S),Gq(J,q,C,J.top,S),Gq(J,q,C,J.bottom,S)),Ph(U)},validate:function(e,X){var v,F,E=this,D=E.s,t=E.data,I=t.p3(),J=t._thickness/2,W=t.isClosePath(),K=t.getPoints(),A=t.getSegments(),p=D(Wi),Z=e&&e.uv;if(E.clear(),0>J)F=E.shapeModel=ud(K,A,D(pf),D(jb),p,D(ag),t.getTall(),t.getShapeElevation(),W),D(ng)?D("shape3d.image")||delete F.uv:(delete F.vs,delete F.ns,delete F.uv),D("shape3d.top.image")||delete F.top_uv,D("shape3d.bottom.image")||delete F.bottom_uv;else if(D(Do)===Ke)v=Bp(K,A,p,W),F=E.shapeModel={vs:[]},D("shape3d.image")&&(F.uv=[],F.sum=D(ag)||Tl(v)||1,F.len=0),D(pf)&&!W&&(F.top_vs=[],D("shape3d.top.image")&&(F.top_uv=[])),D(jb)&&!W&&(F.bottom_vs=[],D("shape3d.bottom.image")&&(F.bottom_uv=[])),E._12O(v,J);else{var i,y,j,s,r,w,u,l,P,V;if(v=Bp(K,A,p,W),r=E.vf(fq,Z,!1,X),J&&(w=E.vf(Pk,Z,!1,X),u=W?m:E.vf(ip,Z,!1,X),l=W?m:E.vf(jf,Z,!1,X),P=E.vf(wh,Z,!1,X),V=E.vf(ef,Z,!1,X)),J){for(var T=0,R=v.length;R>T;T++)v[T]=E._tryRemoveBezierPoints(v[T],J);E._12O(v,J)}else r&&v.forEach(function(b){if(s=b.length,s>0)for(i=b[0],j=1;s>j;j++)y=b[j],E.addV(r.vs,i,y),i=y});E._20Q(v),e||(r&&(r.ns=oi(r.vs),Gm(r,"vs"),Gm(r,Wq)),J&&(w&&(w.ns=oi(w.vs),Gm(w,"vs"),Gm(w,Wq)),u&&(u.ns=oi(u.vs),Gm(u,"vs"),Gm(u,Wq)),l&&(l.ns=oi(l.vs),Gm(l,"vs"),Gm(l,Wq)),P&&(P.ns=oi(P.vs),Gm(P,"vs"),Gm(P,Wq)),V&&(V.ns=oi(V.vs),Gm(V,"vs"),Gm(V,Wq))))}var g=E.mat=vc();bl(g,I),ei(g,t.r3(),t.getRotationMode());var B=t.getScale3d(),L=t._dynamicScale3d;L&&(B[0]*=L[0],B[1]*=L[1],B[2]*=L[2]),ns(g,B),bl(g,xo(I)),e&&(Nn(E,g,e,F),E.clear())},_20Q:function(E){var i,d,v,s,Y,I,K,o=this,S=o.front,g=o.back,q=o.top,N=o.bottom,L=S?S.tuv:m,U=g?g.tuv:m,R=q?q.tuv:m,X=N?N.tuv:m,x=0;(L||U||R||X)&&(i=o.s(ag)||Tl(E)||1,E.forEach(function(F){if(d=F.length,d>0)for(I=F[0],v=1;d>v;v++)K=F[v],s=x/i,x+=fr(I,K),Y=x/i,o._14O(S,s,Y),o._14O(g,1-Y,1-s),o._14O(q,s,Y),o._14O(N,s,Y),I=K}))},_14O:function(Y,R,I){if(Y){var K=Y.uv,g=Y.tuv;if(g){if(K)var U=K[0]+(K[6]-K[0])*R,f=K[1]+(K[7]-K[1])*R,q=K[2]+(K[4]-K[2])*R,s=K[3]+(K[5]-K[3])*R,H=K[2]+(K[4]-K[2])*I,x=K[3]+(K[5]-K[3])*I,S=K[0]+(K[6]-K[0])*I,P=K[1]+(K[7]-K[1])*I;else U=R,f=0,q=R,s=1,H=I,x=1,S=I,P=0;g.push(q,s,H,x,S,P,S,P,U,f,q,s)}}},_13O:function(Q){var C=Q.uv,f=Q.tuv;f&&(C?f.push(C[2],C[3],C[4],C[5],C[6],C[7],C[6],C[7],C[0],C[1],C[2],C[3]):f.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(o,C){var b=o.length;if(4>b)return o;var Q,D,O,W,r,A,J=!1,K=function(N){return o[N]},_=function(l){return o[b-1-l]};for(r=0;1>=r;r++)for(A=r?_:K,D=A(0),O=A(1),Q=2;b-1>Q;Q++)if(W=A(Q),!W.remove)if(W.b){var j=Fd(D,O,W,C);j.adjust?(W.remove=!0,J=!0):(D=O,O=W)}else D=O,O=W;if(!J)return o;var I=[];for(Q=0;b>Q;Q++)o[Q].remove||I.push(o[Q]);return I},_12O:function(K,R){var l,b,P,c,i,y=this;K.forEach(function(r){if(i=r.length,i>0)for(l={p:r[0],n:!0},c=1;i>c;c++)b=r[c],P=i-1>c?r[c+1]:m,y.addPoint(l,b,P,R,r)})},addPoint:function(B,z,w,e,j){var L,k,T,Q,r,Y,y,M,W,v=this,N=B.p,P=B.f,g=B.b,s=v.s("shape3d.side")||vq,K=v.s("shape3d.start.angle"),n=v.s("shape3d.sweep.angle"),C=v.shapeModel,b=v.data.isClosePath();if(B.n&&(B.n=!1,P=b&&j.length>2?Fd(j[j.length-2],N,z,e):Fd(m,N,z,e),g=uj(N,P),C?C.top_vs&&v._10O(g,P,s,K,n,C.top_vs,C.top_uv):(L=v.left)&&(v.addV(L.vs,g,P),v._13O(L))),k=w?Fd(N,z,w,e):b&&j.length>2?Fd(N,z,j[1],e):Fd(N,z,m,e),T=uj(z,k),C){var _,l,A=C.vs,u=C.uv,V=C.sum;for(u&&(_=C.len/V,C.len+=fr(N,z),l=C.len/V),Y=v._9O(g,P,s,K,n),y=v._9O(T,k,s,K,n),M=0;s>M;M++)W=M+1,gb(A,Y[W]),gb(A,y[M]),gb(A,Y[M]),gb(A,y[M]),gb(A,Y[W]),gb(A,y[W]),u&&(Q=M/s,r=W/s,u.push(_,r,l,Q,_,Q,l,Q,_,r,l,r));!w&&C.bottom_vs&&v._10O(T,k,s,K,n,C.bottom_vs,C.bottom_uv,!0)}else!w&&(L=v.right)&&(v.addV(L.vs,k,T),v._13O(L)),(L=v.front)&&v.addV(L.vs,P,k),(L=v.back)&&v.addV(L.vs,T,g),(L=v.top)&&v.addH(L.vs,P,k,T,g,!0),(L=v.bottom)&&v.addH(L.vs,g,T,k,P);B.p=z,B.f=k,B.b=T},_10O:function(B,n,d,K,D,T,J,Q){var o,U,F=this,q=F.data,L=F._9O(B,n,d,K,D),Y=(B.x+n.x)/2,r=(B.y+n.y)/2,X=q.getShapeElevation(),e=0;for(e=0;d>e;e++)Q?(gb(T,L[e]),gb(T,L[e+1])):(gb(T,L[e+1]),gb(T,L[e])),gb(T,[Y,X,r]),J&&(Q?(o=k*(e+1)/d+K,U=k*e/d+K):(o=k*e/d+K,U=k*(e+1)/d+K),J.push(.5-.5*G(U),.5-.5*A(U),.5-.5*G(o),.5-.5*A(o),.5,.5))},_9O:function(b,I,K,d,X){var q,V,x=this,C=x.data,f=[],h=(b.x+I.x)/2,j=(b.y+I.y)/2,w=C.getTall()/2,M=C.getShapeElevation(),u=0;for(X=X||k;K>=u;u++)q=X*u/K+d,V=G(q),f.push([h+(b.x-h)*V,M+w*A(q),j+(b.y-j)*V]);return f},addV:function(w,t,x){var o=t.x,i=t.y,v=x.x,X=x.y,T=this.data,l=T.getShapeElevation(),R=T.getTall()/2;w.push(o,l-R,i,v,l-R,X,v,l+R,X,v,l+R,X,o,l+R,i,o,l-R,i)},addH:function(T,g,w,$,c,a){var L=this.data,O=L.getTall()/2,U=L.getShapeElevation()+(a?O:-O);T.push(g.x,U,g.y,w.x,U,w.y,$.x,U,$.y,$.x,U,$.y,c.x,U,c.y,g.x,U,g.y)},vf:function(u,s,g,K){var x,G=this,O=G.gv.getFaceVisible(G.data,u);return(g||O)&&(x=In(G,u,K),x.vs=[],x.tuv=O&&(x.texture||s)?[]:m,x.visible=O),x}});var ni=function(p,v){Ck(ni,this,[p,v])};Uo(ni,Xh,{_25Q:1,validate:function(N){var t=this,U=t.data,o=t.s,u=U.getPoints(),B=u.size();if(t.shapeModel=t.info=m,B>1){var W=t.info={},Q=U.getSegments(),C=U.getThickness(),g=ij(u.get(0)),R=ij(u.get(B-1)),$=B%2;0===$?(W.c1=ij(u.get(B/2-1)),W.c2=ij(u.get(B/2))):W.p3=ij(u.get((B-$)/2)),W.s1=g,W.s2=ij(u.get(1)),W.t1=ij(u.get(B-2)),W.t2=R,W.list=o(Do)===Ke?t.createTubeModel(u,Q,C/2,N):t.createLineModel(u,Q,C,"shape.border","shape.dash")}var A=U.p3(),x=t.mat=vc();bl(x,A),ei(x,U.r3(),U.getRotationMode());var e=U.getScale3d(),l=U._dynamicScale3d;l&&(e[0]*=l[0],e[1]*=l[1],e[2]*=l[2]),ns(x,e),bl(x,xo(A))},_80o:function(n,p,q){var i=this,D=i.shapeModel;if(D){var H=i.gv;sp(H,i.mat),bm(H,i.data,D,i,i.getBodyColor(),q),Ph(H)}}}),mm(b,{accordionViewExpandIcon:Qk(xi),accordionViewCollapseIcon:Qk(xi,!0),accordionViewLabelColor:Ac,accordionViewLabelFont:_h,accordionViewTitleBackground:is,accordionViewSelectBackground:Hj,accordionViewSelectWidth:3,accordionViewSeparatorColor:Y,splitViewDividerSize:1,splitViewDividerBackground:is,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:kn,rect:[2,2,12,12],background:xi}]},propertyViewLabelColor:Ol,propertyViewLabelSelectColor:Ac,propertyViewLabelFont:_h,propertyViewExpandIcon:Qk(Sd),propertyViewCollapseIcon:Qk(Sd,!0),propertyViewBackground:mg,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Jm,propertyViewColumnLineColor:Jm,propertyViewSelectBackground:Hj,listViewLabelColor:Ol,listViewLabelSelectColor:Ac,listViewLabelFont:_h,listViewRowLineVisible:!1,listViewRowLineColor:Jm,listViewSelectBackground:Hj,treeViewLabelColor:Ol,treeViewLabelSelectColor:Ac,treeViewLabelFont:_h,treeViewExpandIcon:Qk(ej),treeViewCollapseIcon:Qk(ej,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Jm,treeViewSelectBackground:Hj,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Ol,tableViewLabelSelectColor:Ac,tableViewLabelFont:_h,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Jm,tableViewColumnLineColor:Jm,tableViewSelectBackground:Hj,treeTableViewLabelColor:Ol,treeTableViewLabelSelectColor:Ac,treeTableViewLabelFont:_h,treeTableViewExpandIcon:Qk(ej),treeTableViewCollapseIcon:Qk(ej,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Jm,treeTableViewColumnLineColor:Jm,treeTableViewSelectBackground:Hj,tableHeaderLabelColor:Ol,tableHeaderLabelFont:_h,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:$q,tableHeaderBackground:mg,tableHeaderMoveBackground:Zp,tableHeaderInsertColor:Hj,tableHeaderSortDescIcon:Hr(Sd,!0),tableHeaderSortAscIcon:Hr(Sd),tabViewTabGap:1,tabViewLabelColor:Ac,tabViewLabelFont:_h,tabViewTabBackground:is,tabViewSelectWidth:3,tabViewSelectBackground:Hj,tabViewMoveBackground:Zp,tabViewInsertColor:Hj,toolbarLabelColor:Ol,toolbarLabelSelectColor:Ac,toolbarLabelFont:_h,toolbarBackground:mg,toolbarSelectBackground:Hj,toolbarItemGap:8,toolbarSeparatorColor:Lk},!0);var Bb={translateX:1,sortColumn:1},Kj={sortable:1,sortOrder:1,sortFunc:1},hb={focusData:1},Hd={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ym={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},oj=function(V,P){P.add(V),V.hasChildren()&&V.eachChild(function(T){oj(T,P)})},ah=function(K,t,s,z,k,N,O,V,d,J,c){var x,P=s.getValueType(J),C=s.getAlign(J);if(s.getEnumValues(J)){var a=s.toEnumLabel(t,J),Q=Yp||0,$=0,B=N,R=b.getTextSize(z,a).width;return x=Se(s.toEnumIcon(t,J)),x&&($=N+Yp/2,"center"===C?$+=(V-(Q+R))/2:"right"===C&&($=$+V-(Q+R)),Yi(K,x,$,O+d/2,J,c),B=$+Yp/2),a!=m&&(x?ci(K,a,z,k,B,O,V-(B-N),d):ci(K,a,z,k,N,O,V,d,C)),void 0}return t=s.formatValue(t),t!=m?P===yk?(Wm(K,N,O,V,d,t),void 0):P===Np||!P&&tg(t)?(x=Se(t?xr:Jf),Yi(K,x,N+V/2,O+d/2,J,c),void 0):(ci(K,t,z,k,N,O,V,d,C),void 0):void 0},al=function(S,y){var X=y.view,b=$b(S),J=y.column||y.property;X.getDataModel().beginTransaction(),y.editor=S,S.info=y,X.setCurrentEditor(S),X.getView().insertBefore(b,X._79O),Or(S,y.editorRect),S.setFocus?S.setFocus():Ad(S),S.commitValue=function(){S._17Q&&(S=S._17Q),X.setValue(y.data,J,S.getValue?S.getValue():S.value),S.close&&S.close(),bd(b)},J.onEditorCreated&&J.onEditorCreated(y)},Lj=function($,w,E,z,k){var C=Xr($,E),g=w.value,M=w.view,x=k.getValueType(w.data);return C.onblur=C.onchange=function(){M.endEditing()},"input"===$?(g=k.formatValue(g),g!=m&&(C.value=g),C.onkeydown=function(Z){me(Z)&&M.endEditing()},(x===bg||x===Rc)&&C.addEventListener(Nq,b.numberListener,!1)):$===ze&&z.forEach(function(U){var c=D.createElement("option");c.innerHTML=k.toEnumLabel(U),c.value=U,k.isEnumEqual(g,U)&&(c.selected=!0),ts(C,c)}),al(C,w),C},ek=o.widget={},En=function(s,z,m){Uo($+".widget."+s,z,m)};mm(qd,{ms_value:function(D){D.getValue=function(c){var y=this.getItemById(c),h=y.element;return Mq(h)?h:h?h.getValue?h.getValue():h.value:y.selected},D.setValue=function(R,t){var U=this.getItemById(R),W=U.element;W&&!Mq(W)?W.setValue?W.setValue(t):W.value=t:tg(t)?(U.selected=t,this.iv()):(U.element=t,this.iv())},D.v=function(L,O){var r=this;if(2===arguments.length)r.setValue(L,O);else{if(!hk(L))return r.getValue(L);for(var B in L)r.setValue(B,L[B])}return r}},_46o:function(K){K._icon=m,K._accessType=m,K._valueType=m,K._editable=!1,K._batchEditable=!0,K._align=ip,K._nullable=!0,K._emptiable=!1,K.setParent=Kd,K.formatValue=function(y){var k=this,p=k._valueType;return k.getEnumValues()?k.toEnumLabel(y):p===Np?!!y:y!=m&&p===bg?W(y):y},K.setEnum=function(t,k,E,J,o,v,C){var w=this;t&&!sc(t)&&t.values&&(J=t.editable,E=t.icons,k=t.labels,o=t.strict,v=t.maxHeight,C=t.dropDownWidth,t=t.values),tp(t)&&(t=t._as),tp(k)&&(k=k._as),tp(E)&&(E=E._as),w._enumValues=t,w._enumLabels=k,w._enumIcons=E,w._enumEditable=J,w._enumStrict=o==m?!0:o,w._enumMaxHeight=v,w._enumDropDownWidth=C,t&&t.length&&Wj(t[0])&&(w._valueType=Rc),w.fp("enum",!1,!0)},K.getEnumDropDownWidth=function(){return this._enumDropDownWidth},K.getEnumMaxHeight=function(){return this._enumMaxHeight},K.isEnumEditable=function(){return this._enumEditable},K.getEnumValues=function(){return this._enumValues},K.getEnumLabels=function(){return this._enumLabels},K.getEnumIcons=function(){return this._enumIcons},K.isEnumStrict=function(){return this._enumStrict},K.isEnumEqual=function(R,A){return this._enumStrict?R===A:R==A},K.toEnumLabel=function(Z,u){var U=this,$=U.getEnumValues(u),O=U.getEnumLabels(u);if($&&O)for(var S=0;S<$.length;S++)if(U.isEnumEqual(Z,$[S]))return O[S];return Z},K.toEnumIcon=function(k,d){var q=this,f=q.getEnumValues(d),t=q.getEnumIcons(d);if(f&&t)for(var T=0;T<f.length;T++)if(q.isEnumEqual(k,f[T]))return t[T];return Y}},_45o:function(q){q._87o=function(x,i,m,U,O,r){if(x){var V=this,b=V._90I,J=gd(1);V._columnLineVisible&&(O-=1),V._rowLineVisible&&(r-=1),0>=O||0>=r||(V._90I||(b=V._90I={}),b[i]||(b[i]=new Nf),Or(J,V.tx()+m,V.ty()+U,O,r),ts(J,x),V._view.insertBefore(J,V._79O),x.onParentAdded&&x.onParentAdded(J),b[i].add(J))}},q._76o=function(){var M=this,k=M._90I;if(k){for(var d in k)k[d].each(function(O){bd(O)});delete M._90I}},q._77o=function(_){var V=this;if(V._90I){var t=V._90I[_];t&&(t.each(function(r){bd(r)}),delete V._90I[_])}}},_47o:function(v){v.getValue=function(x,o){return o.getValue?o.getValue(x,o,this):Og(x,o.getAccessType(),o.getName())},v.setValue=function(t,y,N){if(y.isEmptiable(t)||""!==N||(N=Y),y.isNullable(t)||N!=m){var Q=this,B=y.getName(t),W=y.getAccessType(t),$=y.getValueType(t);$===bg&&Mq(N)?N=C(N):$===Rc&&Mq(N)?N=parseFloat(N):$===Np&&Mq(N)&&(N="true"===N),Q._batchEditable&&y._batchEditable&&Q.isSelected(t)?Q.sm().each(function(t){y.setValue?y.setValue(t,y,N,Q):un(t,W,B,N)}):y.setValue?y.setValue(t,y,N,Q):un(t,W,B,N)}},v.setCurrentEditor=function(M){this.endEditing(),this._currentEditor=M,this.redraw()},v.isEditing=function($,H){var R=this,Q=R._currentEditor;if(!Q)return!1;if(H){var n=Q.info;return n?(n.column||n.property)===H&&n.data===$:!1}return!0},v.endEditing=function(){var d=this,A=d._currentEditor;A&&(delete d._currentEditor,A.commitValue&&A.commitValue(A.info),d.redraw(),d.getDataModel().endTransaction())},v.beginEditing=function(B){this.endEditing();var e=this,R=B.column||B.property;if(R.beginEditing)R.beginEditing(B);else{var T=B.data,O=B.value,W=e.getSelectBackground(T),D=R.getEnumValues(T),Z=R.getSlider(T),$=R.getColorPicker(T);if(Z){var I=Ii(ek.Slider,Z);return I.setValue(O),I.getView().onblur=function(){e.endEditing()},I.isInstant()&&(I.onValueChanged=function(){e.setValue(T,R,I.getValue())}),al(I,B),void 0}if($||R.getValueType(T)===yk){var p=Ii(ek.ColorPicker,$);return p.setValue(O),p.onClosed=function(){e.endEditing()},p.isInstant()&&(p.onValueChanged=function(W,x){e.setValue(T,R,x)}),al(p,B),p.open(),void 0}if(D){if(ek.ComboBox){var j=new ek.ComboBox;j.setValue(O),j.setValues(D),j.setLabels(R.getEnumLabels(T)),j.setIcons(R.getEnumIcons(T)),j.setEditable(R.isEnumEditable(T)),j.setStrict(R.isEnumStrict(T)),j.setMaxHeight(R.getEnumMaxHeight(T)),j.setDropDownWidth(R.getEnumDropDownWidth(T)),j.onClosed=function(){e.endEditing()},al(j,B),j.open()}else Lj(ze,B,W,D,R);return}var Q=R.getValueType(T);if(Q===Np||tg(O))return e.setValue(T,R,!O),void 0;if(R.getItemEditor(T)){var K=hp(R.getItemEditor(T)),P=new K(T,R,e,B),k=P.getView();return k._17Q=P,P.setValue(O),hr(k),al(k,B),P.editBeginning&&P.editBeginning(),void 0}Lj("input",B,W,m,R)}}},_44o:function(F){F.init=function(c){var d=this,o=d.th=new nq(c),Y=d._view=xf(1,d);d.tv=d._tableView=c,ts(Y,o.getView()),ts(Y,c.getView()),o.mp(function(H){H.property===Uc&&d.iv()}),d.iv()},F.getTableView=function(){return this.tv},F.getTableHeader=function(){return this.th},F.getDataModel=function(){return this.tv.dm()},F.getColumnModel=function(){return this.tv.getColumnModel()},F.setColumns=function(g){this.tv.setColumns(g)},F.addColumns=function(I){this.tv.addColumns(I)},F.endEditing=function(){this.tv.endEditing()},F.validateImpl=function(){var D=this,N=D.th,L=wc(N),P={x:0,y:0,width:D.getWidth(),height:L};Or(N,P),P.y=L,P.height=v(0,D.getHeight()-L),Or(D.tv,P)}},ms_vs:function(n){n._41o=function(){return this._29I.height<this._59I},n._43o=function(){var n=this;n._41o()&&(n._58I||(h(function(){n._94O()},Mk),n.iv()),n._58I=new Date)},n._94O=function(){var S=this;if(S._58I){var d=new Date;d.getTime()-S._58I.getTime()>=Mk?(delete S._58I,S.iv()):h(function(){S._94O()},Mk)}},n._93I=function(){var Z=this,h=Z._27I;if(Z._58I||!Z._autoHideScrollBar){h||ts(Z._79O,h=Z._27I=gd());var w=Z._29I,p=w.height,e=Z._59I,v=Z.getScrollBarSize(),Y=w.width-v-2,B=p*(-Z.ty()/e),W=p*(p/e),k=h.style;e>p?(Sn>W&&(B=B+W/2-Sn/2,0>B&&(B=0),B+Sn>p&&(B=p-Sn),W=Sn),k.visibility=Bc,k.background=Z.getScrollBarColor(),k.borderRadius=v/2+se,Or(h,Y,B,v,W)):k.visibility=wr}else h&&(h.style.visibility=wr)}},ms_hs:function(M){M._40o=function(){return this._29I.width<this._91I},M._42o=function(){var z=this;z._40o()&&(z._95O||(h(function(){z._94I()},Mk),z.iv()),z._95O=new Date)},M._94I=function(){var P=this;if(P._95O){var l=new Date;l.getTime()-P._95O.getTime()>=Mk?(delete P._95O,P.iv()):h(function(){P._94I()},Mk)}},M._92I=function(){var e=this,W=e._28I;if(e._95O||!e._autoHideScrollBar){W||ts(e._79O,W=e._28I=gd());var m=e._29I,t=m.width,o=e._91I,B=e.getScrollBarSize(),Q=m.height-B-2,y=t*(-e.tx()/o),b=t*(t/o),c=W.style;o>t?(Sn>b&&(y=y+b/2-Sn/2,0>y&&(y=0),y+Sn>t&&(y=t-Sn),b=Sn),c.visibility=Bc,c.background=e.getScrollBarColor(),c.borderRadius=B/2+se,Or(W,y,Q,b,B)):c.visibility=wr}else W&&(W.style.visibility=wr)}}}),lj(xr,Of(16,16,[{type:fj,rect:[1,1,14,14],background:Hj},{type:wb,rect:[1,1,14,14],width:1,color:qq},{type:Cb,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),lj(Jf,Of(16,16,{type:wb,rect:[1,1,14,14],width:1,color:qq})),lj($i,Of(16,16,[{type:ll,rect:[2,2,12,12],borderWidth:1,borderColor:qq,background:"#FFF"},{type:ll,rect:[4,4,8,8],background:Hj}])),lj(Dj,Of(16,16,{type:ll,rect:[2,2,12,12],borderWidth:1,borderColor:qq})),qd._15Q=function(T){T._29I=Mh,T._59I=0,T._91I=0,T._5o=function(t){var X=this;X._30I=new Nf,X._rows=new Nf,X._rowMap={},X._31I=0,X._14I=0,X._view=xf(1,X),X._canvas=dj(X._view),ts(X._view,X._79O=gd()),X.dm(t?t:new Bd)},T.getCheckIcon=function(A){var Y=this.sm(),u=Y.co(A);return Y.sg()?Se(u?$i:Dj):Se(u?xr:Jf)},T.checkData=function(O){var w=this.sm(),W=w.co(O);w.sg()&&W||(this._32o=1,W?w.rs(O):w.as(O),delete this._32o)},T.getDataAt=function(L){L.target&&(L=this.lp(L));var J=f(L.y/this._rowHeight),G=this._rows;return 0>J||J>=G.size()?m:G.get(J)},T.onDataDoubleClicked=function(){},T.onDataClicked=function(){},T.adjustTranslateX=function(){return 0},T.adjustTranslateY=function(y){var i=this.getHeight()-this._59I;return i>y&&(y=i),y>0?0:W(y)},T.onPropertyChanged=function(h){var H=this,q=h.property;Hd[q]?H.ivm():hb[q]||H.redraw(),q===Jq?H._42o():q===zd&&H._43o()},T.getLabel=function(c){return c.toLabel()},T.getLabelFont=function(){return this._labelFont},T.getLabelColor=function(X){var $=this;if($.isCheckMode()){if($._focusData===X)return $._labelSelectColor}else if($.isSelected(X))return $._labelSelectColor;return $._labelColor},T.getStartRowIndex=function(){return this._31I},T.getEndRowIndex=function(){return this._14I},T.getRowDatas=function(){return this._rows},T.getRowIndex=function(p){return this._rowMap[p._id]},T.getRowSize=function(){return this._rows.size()},T.getViewRect=function(){return Cf(this._29I)},T.isVisible=function(I){return this._visibleFunc?this._visibleFunc(I):!0},T.getCurrentSortFunc=function(){return this._sortFunc},T.setDataModel=function(z){var P=this,T=P._dataModel,B=P._selectionModel;T!==z&&(T&&(T.umm(P.handleDataModelChange,P),T.umd(P.handleDataPropertyChange,P),T.umh(P.handleHierarchyChange,P),B||T.sm().ums(P.handleSelectionChange,P)),P._dataModel=z,z.mm(P.handleDataModelChange,P),z.md(P.handleDataPropertyChange,P),z.mh(P.handleHierarchyChange,P),B?B._21I(z):z.sm().ms(P.handleSelectionChange,P),P.fp("dataModel",T,z))},T.validateModel=function(){var h=this;h._rows.clear(),h._rowMap={},h.buildChildren(h._dataModel._roots);var r=h._rows=h._rows.toList(h.isVisible,h),S=0,$=h.getCurrentSortFunc(),W=r.size();for($&&r.sort($);W>S;S++)h._rowMap[r.get(S)._id]=S},T.buildChildren=function(d){var j=this;d.each(function(A){j._rows.add(A),j.buildChildren(A._children)})},T.handleDataModelChange=function(){this.ivm()},T.handleDataPropertyChange=function(H){"parent"===H.property?this.ivm():this.invalidateData(H.data)
},T.handleHierarchyChange=function(){this.ivm()},T.handleSelectionChange=function(r){r.datas.each(this.invalidateData,this),this.onSelectionChanged(r)},T.onSelectionChanged=function(j){var l=this,W=l.sm();!l.isAutoMakeVisible()||1!==W.size()||"set"!==j.kind&&"append"!==j.kind||l._32o||l.makeVisible(W.ld())},T.handleBackgroundClick=function(N){zj(N)&&!this.isCheckMode()&&this.sm().cs()},T.makeVisible=function(b){b&&(this._23I=b,this.iv())},T.scrollToIndex=function($){var h=this,z=h._29I,g=z.height,I=h._rowHeight,U=I*$;$>=0&&$<h._rows.size()&&g>0&&(U+I>z.y+g?h.ty(-U+g-I):U<z.y&&h.ty(-U))},T.autoScroll=function(Q,b){var P=this,L=P._rowHeight,g=L,J=L/4,W=P._29I,q=P.lp(Q),z={x:P.tx(),y:P.ty()};return L>0&&W&&(q.x-W.x<g?P.translate(J,0):W.x+W.width-q.x<g&&P.translate(-J,0),q.y-W.y<g?P.translate(0,J):W.y+W.height-q.y<g&&P.translate(0,-J)),z.x=P.tx()-z.x,z.y=P.ty()-z.y,b&&(b.x+=z.x,b.y+=z.y),z},T.getTopRowOrderSelection=function(){var G=this.sm().getTopSelection(),n={},M=new Nf;return G.each(function(D){n[D._id]=D}),this._rows.each(function(k){n[k._id]&&M.add(k)}),M},T.getRowOrderSelection=function(){var S=new Nf;return this._rows.each(function(d){this.isSelected(d)&&S.add(d)},this),S},T.ivm=function(){this.invalidateModel()},T.invalidateModel=function(){var m=this;m._96I||(m._96I=1,m._32I=1,delete m._24I),m.iv()},T.redraw=function(){var c=this;c._32I||(c._32I=1,delete c._24I,c.iv())},T.invalidateData=function(P){var _=this;Z?_.redraw():_._32I||(_._24I||(_._24I={}),_._24I[P._id]=P,_.iv())},T.getFocusData=function(){return this._focusData},T.setFocusDataById=function(D){this.setFocusData(this.dm().getDataById(D))},T.setFocusData=function(k){var x=this,g=x._focusData;g!==k&&(x._focusData=k,x.fp("focusData",g,k),g&&x.invalidateData(g),k&&(x.invalidateData(k),x.isAutoMakeVisible()&&x.makeVisible(k)))},T.drawRowBackground=function(h,i,g,l,B,N,S){var v=this,w=v.isCheckMode();(i===v._focusData&&w||g&&!w)&&Wm(h,l,B,N,S,v.getSelectBackground(i))},T.drawData=function(Y,o,e){var B=this,f=B._rowHeight,m=f*e,H=B._29I,_=H.x,y=H.width;Y.save(),Y.beginPath(),Y.rect(_,m,y,f),Y.clip(),B._87o(B.drawRow(Y,o,B.isSelected(o),_,m,y,f),e,_,m,y,f),Y.restore(),B._rowLineVisible&&Wm(Y,_,m+f-1,y,1,B._rowLineColor)},T._12I=function(e){var v=this,S=v._31I,Z=v._29I,P=Z.x,j=Z.y,C=Z.width,L=Z.height;for(e.beginPath(),e.rect(P,j,C,L),e.clip(),e.clearRect(P,j,C,L),v._76o(),v._93db(e);S<v._14I;S++)v.drawData(e,v._rows.get(S),S);v._92db(e)},T._13I=function(w){for(var n,E=this,$=E._rowHeight,S=E._29I,c=S.x,W=S.width,P=E._31I,X=E._30I;P<E._14I;P++)n=E._rows.get(P),E._24I[n._id]&&X.add({data:n,index:P});X.isEmpty()||(w.beginPath(),X.each(function(p){w.rect(c,p.index*$,W,$)}),w.clip(),X.each(function(l){w.clearRect(c,l.index*$,W,$)}),X.each(function(g){E._77o(g.index)}),E._93db(w),X.each(function(k){E.drawData(w,k.data,k.index)}),E._92db(w),X.clear())},T.validateImpl=function(){var U=this,r=U._canvas,o=U.getWidth(),D=U.getHeight(),l=U._rowHeight,K=U._32I;(o!==r.clientWidth||D!==r.clientHeight)&&(Xe(r,o,D),K=1);var Z=B&&!O;U._96I&&!Z&&U.validateModel();var y=U._29I,M={x:-U.tx(),y:-U.ty(),width:o,height:D},d=U._rows.size(),V=xd(r),j=U._23I;K||Pe(M,y)||(K=1),U._29I=M,U._59I=d*l,U._31I=f(M.y/l),U._14I=J((M.y+M.height)/l),U._31I<0&&(U._31I=0),U._14I>d&&(U._14I=d),U._99I&&K&&U._99I(),ti(V,U.tx(),U.ty(),1),K?U._12I(V):U._24I&&U._13I(V),U._93I(),U._92I(),V.restore(),U._32I=U._24I=U._96I=m,j&&(U.scrollToIndex(U.getRowIndex(j)),delete U._23I),U.tx(U.tx()),U.ty(U.ty())}},qd._48o=function(d){d._rootVisible=!0,d._rootData=m,d._35o=function(){this._expandMap={},this._levelMap={}},d.validateModel=function(){var O=this,X=O._rootData;O._rows.clear(),O._levelMap={},O._rowMap={},O._currentLevel=0,X?O._rootVisible?O.isVisible(X)&&O.buildData(X):O.buildChildren(X):O.buildChildren(),delete O._currentLevel},d.buildData=function(g){var R=this,d=g._id,P=R._rows;R._rowMap[d]=P.size(),P.add(g),R._levelMap[d]=R._currentLevel,R.isExpanded(g)&&(R._currentLevel++,R.buildChildren(g),R._currentLevel--)},d.buildChildren=function(F){var H=this,u=F?F._children:H._dataModel._roots,L=H.getCurrentSortFunc();L&&H.isChildrenSortable(F)?u.toList(H.isVisible,H).sort(L).each(H.buildData,H):u.each(function(x){H.isVisible(x)&&H.buildData(x)})},d.getLevel=function(X){return this._levelMap[X._id]},d.getToggleIcon=function(j){var K=this,h=K._loader,Q=K._collapseIcon;return h&&!h.isLoaded(j)?Q:j.hasChildren()?K.isExpanded(j)?K._expandIcon:Q:m},d.isCheckMode=function(){return this._checkMode!=m},d.isChildrenSortable=function(){return!0},d.handleDataModelChange=function(o){var _=this;o.kind===Ze?delete _._expandMap[o.data._id]:o.kind===nf&&(_._expandMap={}),_.ivm()},d.toggle=function(n){var z=this;z.isExpanded(n)?z.collapse(n):z.expand(n)},d.isExpanded=function(D){return 1===this._expandMap[D._id]},d.expand=function(m){var q=this,U=q._loader;q.isExpanded(m)||(U&&!U.isLoaded(m)&&U.load(m),q._expandMap[m._id]=1,q.ivm(),q.onExpanded(m))},d.onExpanded=function(){},d.collapse=function(q){var P=this;P.isExpanded(q)&&(delete P._expandMap[q._id],P.ivm(),P.onCollapsed(q))},d.onCollapsed=function(){},d.expandAll=function(Z){if(Z)this.expand(Z),Z.eachChild(function(v){this.expandAll(v)},this);else{var F=this;F._dataModel.each(function(B){B.hasChildren()&&(F._expandMap[B._id]=1)}),F.ivm()}},d.collapseAll=function(){this._expandMap={},this.ivm()},d.makeVisible=function(J){if(J){var I=this;if(!I._rootData||J.isDescendantOf(I._rootData)){for(var R=J._parent;R;)I.expand(R),R=R._parent;I._23I=J,I.iv()}}},d.checkData=function(_){var N,q=this,V=q._checkMode,H=q.sm(),W=H.co(_);if(!H.sg()||!W){if(q._32o=1,V===kj)W?H.rs(_):H.as(_);else if(V===li)N=new Nf(_),N.addAll(_._children);else if("descendant"===V)N=new Nf,oj(_,N);else if("all"===V&&(N=new Nf,oj(_,N),!W))for(var F=_._parent;F;)N.add(F),F=F._parent;N&&(W?H.rs(N):H.as(N)),delete q._32o}},d._97I=function(a,W,Q,I,V,T,S){var n=this,p=n._indent,E=n._levelMap[W._id],X=n.getIconWidth(W),U=Se(n.getToggleIcon(W));U?(I+=p*E,Yi(a,U,I+p/2,V+S/2,W,n),I+=p):I+=p*(E+1),n._checkMode&&(Yi(a,n.getCheckIcon(W),I+p/2,V+S/2,W,n),I+=p),n.drawIcon(a,W,I,V,X,S),n.drawLabel(a,W,I+X,V,S)}},qd._14Q=function(X){X.getIcon=function(q){return q.getIcon()},X.getIconWidth=function(E){return this.getIcon(E)?this._indent:0},X.drawIcon=function(n,N,j,c,$,M){if($){var y=this,t=y.getBodyColor(N),P=Se(y.getIcon(N),t);P&&(M-=y.isRowLineVisible()?1:0,Mc(n,P,Aj,j,c,$,M,N,y,t),Af(n,y.getBorderColor(N),j,c,$,M))}},X.drawLabel=function(D,H,Y,l,$){var h=this;ci(D,h.getLabel(H),h.getLabelFont(H),h.getLabelColor(H),Y,l,0,$)}},qd._50o=function(h){h._98I=function(){var A=this,q=A._39o=new Bd;A._60I=new Nf,q.mm(A._17o,A),q.md(A._18o,A),q.mh(A._19o,A)},h.setColumns=function(C){this._39o.clear(),this.addColumns(C)},h.addColumns=function(y){var C=this._39o;y.forEach(function(H){if(!(H instanceof Ll)){var I=hp(H.className);H=Ii(I?I:Ll,H)}C.add(H)})},h.onColumnClicked=function(){},h.onCheckColumnClicked=function(){},h._3Q=function(T){for(var t,N=0,F=this._60I,q=F.size();q>N;N++)if(t=F.get(N),t.column===T)return t;return m},h.getColumnAt=function(E){var x=this._4Q(E);return x?x.column:m},h._4Q=function(U){for(var X=this,J=U.target?X.lp(U).x:U.x,Q=X._60I,c=0;c<Q.size();c++){var C=Q.get(c),K=C.startX;if(J>=K&&J<K+C.column.getWidth())return C}return m},h.getToolTip=function(S){var W=this,j=W.getDataAt(S),P=W.getColumnAt(S);return j&&P?P.getToolTip(j,W):m},h.adjustTranslateX=function(v){var f=this.getWidth()-this._91I;return f>v&&(v=f),v>0?0:W(v)},h._99I=function(){var Y=this,k=Y._29I,N=Y._60I;N.clear(),Y._91I=0,Y._39o._roots.each(function(v){if(v.isVisible()){var Q=Y._91I+v.getWidth();Y._91I<=k.x+k.width&&Q>=k.x&&N.add({column:v,startX:Y._91I}),Y._91I=Q}})},h.drawData=function(L,j,o){var C=this,_=C._rowHeight,t=_*o,d=C.isSelected(j),u=C._29I,S=u.x,A=u.width;C.drawRowBackground(L,j,d,S,t,A,_),C._60I.each(function(c){var k=c.column,X=c.startX,s=k.getWidth();s>0&&!C.isEditing(j,k)&&(L.save(),L.beginPath(),L.rect(X,t,s,_),L.clip(),C._87o(C.drawCell(L,j,d,k,X,t,s,_),o,X,t,s,_),C._columnLineVisible&&Wm(L,X+s-1,t,1,_,C._columnLineColor),L.restore())}),C._rowLineVisible&&Wm(L,S,t+_-1,A,1,C._rowLineColor)},h.drawCell=function(Y,T,H,X,r,n,l,L){var N=this;if(X.drawCell)return X.drawCell(Y,T,H,X,r,n,l,L,N);var u=N.getValue(T,X);ah(Y,u,X,N.getLabelFont(T,X,u),N.getLabelColor(T,X,u),r,n,l,L,T,N)},h.getColumnModel=function(){return this._39o},h._17o=function(){this.redraw()},h._18o=function(D){var y=this;D.data===y._sortColumn&&Kj[D.property]?y.ivm():(y._42o(),y.redraw())},h._19o=function(){this.redraw()},h.getCurrentSortFunc=function(){var H=this,x=H._sortColumn;if(x&&x.isSortable()){var D=x.getSortFunc(),Q=Bj===x.getSortOrder()?1:-1;return D||(D=_f),function(e,h){return D.call(H,H.getValue(e,x),H.getValue(h,x),e,h)*Q}}return H._sortFunc},h.isCellEditable=function(m,k){return!this.isCheckMode()&&this.isSelected(m)||this.isCheckMode()&&m===this._focusData?k.isEditable()&&this.isEditable():!1},h._37O=function(u,Q){if(zj(Q))for(var x=this,i=x.lp(Q),k=x._60I,I=x._rowHeight,S=x._29I,P=S.x,A=S.y,$=S.width,y=S.height,V=0;V<k.size();V++){var H=k.get(V),Y=H.startX,b=H.column,L=b.getWidth();if(b!==x._31o&&b!==x._4o&&x.isCellEditable(u,b,Q)&&i.x>=Y&&i.x<Y+L){var c={x:Y,y:x.getRowIndex(u)*I,width:L,height:I},f={x:c.x+x.tx(),y:c.y+x.ty(),width:c.width,height:c.height},E=0,C=0;return c.x<P?E=c.x-P:c.x+c.width>P+$&&(E=c.x+c.width-P-$),E&&(x.tx(x.tx()-E),f.x-=E),c.y<A?C=c.y-A:c.y+I>A+y&&(C=c.y+I-A-y),C&&(x.ty(x.ty()-C),f.y-=C),x.beginEditing({data:u,column:b,value:x.getValue(u,b),event:Q,rect:c,editorRect:f,view:x}),void 0}}}},ek.BaseItemEditor=function(f,u,G,Q){this._data=f,this._column=u,this._master=G,this._editInfo=Q},En("BaseItemEditor",u,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Vm=o.Tab=function(){Ck(Vm,this)};_q("Tab",fc,{ms_ac:["view","closable","disabled"],_icon:m,_closable:!1,_disabled:!1,setParent:Kd});var Ll=o.Column=function(){Ck(Ll,this)};_q("Column",fc,{_46o:1,ms_ac:["accessType","valueType",Bc,Io,ap,Rb,"align",yk,"sortOrder",lc,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Bj,_sortFunc:m,_sortable:!0,_clickable:!0,setWidth:function(f){16>f&&(f=16);var X=this._width;this._width=f,this.fp(Rb,X,f)},getToolTip:function(R,s){return this.formatValue(s.getValue(R,this))}});var Ae=o.Property=function(){Ck(Ae,this)};_q("Property",fc,{_46o:1,ms_ac:["accessType","valueType",Io,ap,"categoryName",yk,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:m,getToolTip:function(O,t,o){var q=this;return t?q.formatValue(o.getValue(O,q)):o.getPropertyName(q)}}),ek.AccordionView=function(){var Y=this;Y._20o={},Y._21o=new Nf,Y._10o=m,Y._9o=m,Y._11o=m,Y._view=xf(0,Y),Y.iv()},En("AccordionView",u,{ms_v:1,ms_fire:1,ms_ac:[il,Ji,"titleHeight",of,Bi,"titleBackground","selectWidth",Ur,"orientation","separatorColor"],_expandIcon:b.accordionViewExpandIcon,_collapseIcon:b.accordionViewCollapseIcon,_titleHeight:fg,_labelColor:b.accordionViewLabelColor,_labelFont:b.accordionViewLabelFont,_titleBackground:b.accordionViewTitleBackground,_selectBackground:b.accordionViewSelectBackground,_selectWidth:b.accordionViewSelectWidth,_orientation:"v",_separatorColor:b.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(G,q,z,n){var g=this,O=gd();if(g._20o[G])throw G+" already exists";O.onmousedown=db,O.style.cursor=jk,O.addEventListener(L?Rr:dn,function(F){db(F)},!1),O.addEventListener(L?Tm:yf,function(x){db(x),zj(x)&&(g._10o===G?g.collapse():g.expand(G))},!1),ts(g._view,O),g._20o[G]={content:q,div:O,canvas:dj(O),icon:n},g._21o.add(G),z&&g.expand(G),g.iv()},remove:function(n){var O=this,M=O._20o[n];M&&(bd(M.div),delete O._20o[n],O._21o.remove(n),O.iv())},clear:function(){var $=this;$._20o={},$._21o.clear(),$.iv()},isExpanded:function(s){return this._10o===s},expand:function(b){var m=this;m._20o[b]&&m._10o!==b&&(m._10o=b,m.onExpanded(b),m.iv())},onExpanded:function(){},collapse:function(){var E=this;E._10o&&(E.onCollapsed(E._10o),delete E._10o,E.iv())},onCollapsed:function(){},initCanvas:function(U,z,w){Xe(U,z,w);var C=xd(U);return ti(C,0,0,1),C.clearRect(0,0,z,w),C},drawTitle:function(l,r,_,p,I){var i=this,k=Se(I.icon),Y=i.isExpanded(r),b=i._titleHeight,T=i._titleBackground,E=i._selectWidth,y=i._separatorColor,f=Se(Y?i._expandIcon:i._collapseIcon),u=E+4;Wm(l,0,0,_,p,T),Y&&E&&Wm(l,0,0,E,p,i._selectBackground),(Y||i._21o.get(i._21o.size()-1)!==r)&&Wm(l,0,p-1,_,1,y?y:wm(T)),k&&(Yi(l,k,u+Jb(k)/2,b/2),u+=Jb(k)+2),ci(l,r,i.getLabelFont(r),i.getLabelColor(r),u,0,0,b),f&&Yi(l,f,_-Jb(f)/2-4,b/2)},validateImpl:function(){var r=this,O=r._view,P=0,c=0,V=r.getWidth(),l=r.getHeight(),J=r._titleHeight,p=r._21o.size()*J,b=r._11o,L=r._9o;delete r._11o,delete r._9o,r._21o.each(function(X){var Z,b,n=r._20o[X],i=n.content,k=r._10o===X;Po(r)?(Or(n.div,P,0,J,l),Z=r.initCanvas(n.canvas,J,l),Mi(Z,0,l),zg(Z,-y),r.drawTitle(Z,X,l,J,n),Z.restore(),k?(b=v(0,V-p),i&&(r._11o=i,r._9o=$b(i),Or(i,P+J,0,b,l)),P+=J+b):P+=J):(Or(n.div,0,c,V,J),Z=r.initCanvas(n.canvas,V,J),r.drawTitle(Z,X,V,J,n),Z.restore(),k?(b=v(0,l-p),i&&(r._11o=i,r._9o=$b(i),Or(i,0,c+J,V,b)),c+=J+b):c+=J)});var d=r._9o;b&&b!==r._11o&&b.endEditing&&b.endEditing(),d&&d!==L&&ts(O,d),L&&L!==d&&bd(L)}}),ek.SplitView=function(I,T,z,q){var D=this,f=D._dividerDiv=gd(),o=D._60O=dj(),K=D._61O=dj(),U=o.style,J=K.style;D._view=xf(1,D),ts(D._view,f),U.msTouchAction=Sq,U.pointerEvents=Sq,U.cursor=jk,J.msTouchAction=Sq,J.pointerEvents=Sq,J.cursor=jk,I&&D.setLeftView(I),T&&D.setRightView(T),z&&D.setOrientation(z),q!=m&&D.setPosition(q),D.setStatus(Gn),new Lr(D)},En("SplitView",u,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:b.splitViewDividerSize,_dividerBackground:b.splitViewDividerBackground,_dragOpacity:b.splitViewDragOpacity,_toggleIcon:b.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(c,Y){var n=this,u=n._position;isNaN(c)||(Y||(n._82O=0>c?-1:c>1?1:0),n._position=c,n.fp(Nh,u,c))},getLeftView:function(){return this._leftView},setLeftView:function(j){var R=this,z=R._leftView,d=R._view;if(R._leftView!==j){if(z&&z!==R._rightView){var v=$b(z);v.parentNode===d&&bd(v)}if(R._leftView=j,j){var n=$b(j);n.parentNode!==d&&d.insertBefore(n,R._dividerDiv)}R.fp("leftView",z,j)}},getRightView:function(){return this._rightView},setRightView:function(O){var j=this,h=j._rightView,W=j._view;if(j._rightView!==O){if(h&&h!==j._leftView){var D=$b(h);D.parentNode===W&&bd(D)}if(j._rightView=O,O){var X=$b(O);X.parentNode!==W&&W.insertBefore(X,j._dividerDiv)}j.fp("rightView",h,O)}},validateImpl:function(){var D=this,V=D._draggable,u=D._position,C=D.getWidth(),s=D.getHeight(),k=D._dividerSize,w=D._dividerBackground,P=L?18:8,z=D._dividerDiv,U=D._82O,J=D._60O,$=D._61O,f=D._toggleIcon,E=D._status,G=z.style,q=null,d=L?20:4,Q=f.comps[0];k>=P||0===k?D._coverDiv&&(bd(D._coverDiv),delete D._coverDiv):D._coverDiv||(D._coverDiv=gd(),g&&(D._coverDiv.style.background=kl),ts(z,D._coverDiv)),D._togglable?J.parentNode||(ts(z,J),ts(z,$)):(bd(J),bd($));var h=D._coverDiv,O=D._leftView,t=D._rightView;if(Po(D)){if(k>C&&(k=C),E===Gn)if(1===U)var p=R(u,C),Z=v(0,C-k-p);else-1===U?(Z=R(-u,C),p=v(0,C-k-Z)):(p=W((C-k)*u),Z=v(0,C-k-p));else"cl"===E?(p=0,Z=v(0,C-k)):"cr"===E&&(Z=0,p=v(0,C-k));O&&Or(O,0,0,p,s),t&&Or(t,p+k,0,Z,s),Or(z,p,0,k,s),D._22o=p,h&&(Or(h,k/2-P/2,0,P,s),h.style.cursor=V?bo:""),z.style.cursor=V?bo:"";var a=z.clientHeight/2,S=z.clientWidth;Xe(J,S,S),Or(J,0,a-S-d,S,S),q=xd(J),ti(q,0,0,1),Q.rotation=-y,Dm(q,f,0,0,S,S),q.restore(),Xe($,S,S),Or($,0,a+d,S,S),q=xd($),ti(q,0,0,1),Q.rotation=y,Dm(q,f,0,0,S,S),q.restore()}else{if(k>s&&(k=s),E===Gn)if(1===U)var r=R(u,s),c=v(0,s-k-r);else-1===U?(c=R(-u,s),r=v(0,s-k-c)):(r=W((s-k)*u),c=v(0,s-k-r));else"cl"===E?(r=0,c=v(0,s-k)):"cr"===E&&(c=0,r=v(0,s-k));O&&Or(O,0,0,C,r),t&&Or(t,0,r+k,C,c),Or(z,0,r,C,k),D._22o=r,h&&(Or(h,0,k/2-P/2,C,P),h.style.cursor=V?Vl:""),G.cursor=V?Vl:"";var m=z.clientWidth/2,S=z.clientHeight;Xe(J,S,S),Or(J,m-S-d,0,S,S),q=xd(J),ti(q,0,0,1),Q.rotation=0,Dm(q,f,0,0,S,S),q.restore(),Xe($,S,S),Or($,m+d,0,S,S),q=xd($),ti(q,0,0,1),Q.rotation=j,Dm(q,f,0,0,S,S),q.restore()}G.background=w}});var Lr=function(I){this.sv=I,this.addListeners()};Uo(Lr,u,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(r){var o=this,A=o.sv,w=A._dividerDiv,t=A._60O,c=A._61O,C=A._status,_=r.target;if(_===t)C===Gn?A.setStatus("cl"):"cr"===C&&A.setStatus(Gn);else if(_===c)C===Gn?A.setStatus("cr"):"cl"===C&&A.setStatus(Gn);else if(jg(r)&&(_===w||_===A._coverDiv)&&(db(r),A.isDraggable())){A.getLeftView(),A.getRightView();var z=o.maskDiv=gd();if(z.style.left=0,z.style.top=0,z.style.width=A.getWidth()+"px",z.style.height=A.getHeight()+"px",A.getView().appendChild(z),!A.isContinuousLayout()){var y=o.resizeDiv=gd();y.style.left=w.style.left,y.style.top=w.style.top,y.style.width=w.style.width,y.style.height=w.style.height,y.style.opacity=A.getDragOpacity(),y.style.background=A.getDividerBackground(),ts(o.getView(),y)}o._lastAbsPosition=A._22o,o._86o=Po(A)?Dl(r).x:Dl(r).y,Qc(o,r)}},handleWindowTouchMove:function(f){jg(f)&&this.update(f,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(J){var l=this;l.update(J,!0),l.sv.setStatus(Gn),l.maskDiv&&bd(l.maskDiv),l.resizeDiv&&bd(l.resizeDiv),l.maskDiv=l.resizeDiv=m},handle_mousedown:function(U){zj(U)&&this.handle_touchstart(U)},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowMouseUp:function(D){this.handleWindowTouchEnd(D)},update:function(K,j){var x=this,w=x.sv,S=Po(w)?w.getWidth():w.getHeight(),l=w._dividerSize,y=x._lastAbsPosition-x._86o;Po(w)?(y+=Dl(K).x,y>S-l&&(y=S-l),0>y&&(y=0),x.resizeDiv&&(x.resizeDiv.style.left=y+se)):(y+=Dl(K).y,y>S-l&&(y=S-l),0>y&&(y=0),x.resizeDiv&&(x.resizeDiv.style.top=y+se)),j&&S!==l&&(1===w._82O?w.setPosition(y,1):-1===w._82O?w.setPosition(y-S+l,1):w.setPosition(y/(S-l),1))}}),ek.TabView=function(){var y=this,j=y._view=xf(1,y),Q=y._91O=gd(1),l=y._tabModel=new Bd,q=l.sm(),B=y.invalidate;y._7o=new Nf,y._canvas=dj(Q),ts(j,Q),ts(j,y._92O=gd(1)),q.setSelectionMode(bi),q.ms(B,y),l.mm(B,y),l.md(B,y),l.mh(B,y),new jm(y),y.iv()},En("TabView",u,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",of,Bi,"tabBackground","selectWidth",Ur,"moveBackground","insertColor"],_tabPosition:wh,_tabHeight:fg,_tabGap:b.tabViewTabGap,_labelColor:b.tabViewLabelColor,_labelFont:b.tabViewLabelFont,_tabBackground:b.tabViewTabBackground,_selectWidth:b.tabViewSelectWidth,_selectBackground:b.tabViewSelectBackground,_moveBackground:b.tabViewMoveBackground,_insertColor:b.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(E,x,s){var b=new Vm,P=this._tabModel;return b.setName(E),b.setView(x),P.add(b),s&&P.sm().ss(b),b},getLabel:function(G){return G.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(V){this._23o=V,this.iv()},get:function(I){var k=this,D=k._tabModel;if(Wj(I))return D._roots.get(I);if(Mq(I)){var h;return D.each(function(V){I===k.getLabel(V)&&(h=V)}),h}return I instanceof Vm?I:m},select:function(N){this._tabModel.sm().ss(this.get(N))},remove:function(k){var y=this;if(k=y.get(k)){var w=y._tabModel,c=w._roots.indexOf(k);y._tabModel.remove(k),y._12Q(--c)}},getCurrentTab:function(){return this._8o},hideTabView:function(z,Q){Q.parentNode===this._92O&&(xs(Q)?(Q.style.display=Ag,Q._tab_=z):bd(Q),Sl())},showTabView:function(N,h){xs(h)&&(h.style.display="block",h._tab_=N),h.parentNode!==this._92O&&(ts(this._92O,h),Sl())},_24o:function(){var I,R=this,X=R._8o,V=R._9o,h=R._tabModel.sm().ld();h&&(I=$b(h.getView())),I!==V&&(V&&(X.getView()&&X.getView().endEditing&&X.getView().endEditing(),R.hideTabView(X,V)),I&&R.showTabView(h,I)),R._8o=h,R._9o=I,X!==h&&R.onTabChanged(X,h)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(m,d){this._12Q(--d)},_12Q:function(t){var B=this,v=B._tabModel,c=v.size();if(c&&!v.sm().ld()){t==m&&(t=0),t>=c&&(t=c-1),0>t&&(t=0);for(var T=t;T>=0;T--){var I=B.get(T);if(!I.isDisabled())return B.select(I),I}for(T=t+1;c>T;T++)if(I=B.get(T),!I.isDisabled())return B.select(I),I}},getTabWidth:function(e){var u=4,k=Se(e.getIcon());k&&(u+=Jb(k,e)+4);var l=this.getLabel(e);return l&&(u+=gc(this.getLabelFont(e),l).width+4),e.isClosable()&&(u+=10),u},drawTab:function(X,L,M,m,G,k,i){var H,U=this,Y=U._tabPosition,e=M+4,c=U._selectWidth,h=Se(L.getIcon()),Z=L.isDisabled(),K=U.getLabelColor(L),E=U.getLabelFont(L),$=U.getLabel(L),g=U._selectBackground,C=Y===ip+"-vertical",l=Y===jf+"-vertical";(C||l)&&(e=m+4),Z&&(X.globalAlpha=Mb),Wm(X,M,m,G,k,i),L===U._8o&&c&&(Y===wh?Wm(X,M,m+k-c,G,c,g):Y===ip?Wm(X,M+G-c,m,c,k,g):Y===jf?Wm(X,M,m,c,k,g):C?Wm(X,M+G-c,m,c,k,g):l?Wm(X,M,m,c,k,g):Wm(X,M,m,G,c,g));var I=G/2;if(C&&(Mi(X,I,m+k/2),zg(X,j),Mi(X,-I,-m-k/2)),h){var o=vr(h,L),n=Jb(h,L);if(C||l){var O=M+G/2,s=e+o/2;Mi(X,O,s),zg(X,y),Mi(X,-O,-s),Yi(X,h,M+G/2,e+o/2,L,U),Mi(X,O,s),zg(X,-y),Mi(X,-O,-s),e+=o+4}else Yi(X,h,e+n/2,m+k/2,L,U),e+=n+4}return C||l?(Mi(X,G/2,e+G/2),zg(X,y),Mi(X,-G/2,-e-G/2),ci(X,$,E,K,M,e,k,G),Mi(X,G/2,e+G/2),zg(X,-y),Mi(X,-G/2,-e-G/2)):ci(X,$,E,K,e,m,G,k),C&&(Mi(X,I,m+k/2),zg(X,-j),Mi(X,-I,-m-k/2)),L.isClosable()&&(H=l?{x:M+G-12,y:m+k-12,width:12,height:12}:{x:M+G-12,y:m+2,width:12,height:12},this.drawCloseIcon(L,X,K,H)),Z&&(X.globalAlpha=1),H},drawCloseIcon:function(v,e,G,a){var i=a.x,F=a.y;e.strokeStyle=G,e.lineWidth=1,e.beginPath(),e.moveTo(i+2,F+8),e.lineTo(i+8,F+2),e.moveTo(i+8,F+8),e.lineTo(i+2,F+2),e.stroke()},validateImpl:function(){var A=this;A._24o();var J,E=A._canvas,R=A._tabPosition,D=A._91O,K=A._92O,f=A._tabModel,s=A.getWidth(),N=A.getHeight(),w=A._tabHeight,u=A._7o,b=A._tabGap,M=R===wh,W=R===ip,p=R===jf,Z=R===ip+"-vertical",Q=R===jf+"-vertical",e=A._23o,n=0;if((W||p)&&f._roots.each(function(H){n=v(A.getTabWidth(H),n)}),M?(Or(D,0,0,s,w),J={x:0,y:w,width:s,height:v(0,N-w)}):W?(Or(D,0,0,n,N),J={x:n,y:0,width:v(0,s-n),height:N}):p?(Or(D,s-n,0,n,N),J={x:0,y:0,width:v(0,s-n),height:N}):Z?(Or(D,0,0,w,N),J={x:w,y:0,width:v(0,s-w),height:N}):Q?(Or(D,s-w,0,w,N),J={x:0,y:0,width:v(0,s-w),height:N}):(Or(D,0,N-w,s,w),J={x:0,y:0,width:s,height:v(0,N-w)}),Or(K,J),Z||Q){A._9o&&(J.x=0,Or(A._8o.getView(),J)),Xe(E,w,N);var i=xd(E),l=0;if(ti(i,0,A.ty(),1),i.clearRect(0,0,w,N),u.clear(),f._roots.each(function(o){var H,J=A.getTabWidth(o);e&&e.tab===o||(H=A.drawTab(i,o,0,l,w,J,A._tabBackground)),u.add({_75o:H,tab:o,startY:l,endY:l+J,height:J}),l+=J+b}),A._23Q=v(0,l-b),e){var m=e.position;A.drawTab(i,e.tab,0,e.startY,w,e.height,A._moveBackground),Wm(i,0,m,w,1,A._insertColor)}i.restore(),A.ty(A.ty())}else if(W||p){A._9o&&(J.x=0,Or(A._8o.getView(),J)),Xe(E,n,N);var i=xd(E),l=0;if(ti(i,0,A.ty(),1),i.clearRect(0,0,n,N),u.clear(),f._roots.each(function(k){var L;e&&e.tab===k||(L=A.drawTab(i,k,0,l,n,w,A._tabBackground)),u.add({_75o:L,tab:k,startY:l,endY:l+w,height:w}),l+=w+b}),A._23Q=v(0,l-b),e){var m=e.position;A.drawTab(i,e.tab,0,e.startY,n,e.height,A._moveBackground),Wm(i,0,m,n,1,A._insertColor)}i.restore(),A.ty(A.ty())}else{A._9o&&(J.y=0,Or(A._8o.getView(),J)),Xe(E,s,w);var i=xd(E),o=0;if(ti(i,A.tx(),0,1),i.clearRect(0,0,s,w),u.clear(),f._roots.each(function(Z){var R,r=A.getTabWidth(Z);e&&e.tab===Z||(R=A.drawTab(i,Z,o,0,r,w,A._tabBackground)),u.add({_75o:R,tab:Z,startX:o,endX:o+r,width:r}),o+=r+b}),A._64I=v(0,o-b),e){var m=e.position;A.drawTab(i,e.tab,e.startX,0,e.width,w,A._moveBackground),Xi(i,A._insertColor,m,0,w)}i.restore(),A.tx(A.tx())}for(var j=[],T=K.children,y=0;y<T.length;y++){var F=T[y],g=F._tab_;g&&!f.contains(g)&&j.push(F)}j.forEach(function(A){K.removeChild(A)})}});var jm=function(Y){this.tv=Y,this.addListeners()};Uo(jm,u,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(q){this.handleScroll(q,10*(q.wheelDelta/40))},handle_DOMMouseScroll:function(e){this.handleScroll(e,10*-e.detail)},handleScroll:function(V,W){db(V);var o=this.tv,N=o._tabPosition;!o._40o()||N!==wh&&N!==ef||o.tx(this.tv.tx()+W),!o._41o()||N!==ip&&N!==jf&&N!==ip+"-vertical"&&N!==jf+"-vertical"||o.ty(this.tv.ty()+W)},_8Q:function(o){var A,T,c=this.tv,G=c._tabPosition,N=c._7o;if(G===wh||G===ef){var Y=c.lp(o).x;for(A=0;A<N.size();A++)if(T=N.get(A),T.startX<=Y&&Y<=T.endX)return T}else if(G===ip||G===jf||G===ip+"-vertical"||G===jf+"-vertical"){var O=c.lp(o).y;for(A=0;A<N.size();A++)if(T=N.get(A),T.startY<=O&&O<=T.endY)return T}return m},isClickable:function(T){var V=this.tv,t=V._tabPosition,M=this._73o=this._8Q(T);return!V._40o()||t!==wh&&t!==ef?!V._41o()||t!==ip&&t!==jf&&t!==ip+"-vertical"&&t!==jf+"-vertical"?M&&(!M.tab.isDisabled()||V.isMovable()):!0:!0},handle_mousemove:function(Z){var V=this;tb?V._74o=V._8Q(Z):V.getView().style.cursor=V.isClickable(Z)?jk:""},handle_mousedown:function(N){this.handle_mousemove(N),this.handle_touchstart(N)},handle_touchstart:function(i){var h=this,X=h.tv,d=X._tabPosition;db(i),h.isClickable(i)&&(d===wh||d===ef?(h.x=Dl(i).x,h.lp=X.lp(i),h.tx=X.tx()):(h.y=Dl(i).y,h.lp=X.lp(i),h.ty=X.ty()),Qc(h,i))},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(l){var r,O=this,h=O.tv,N=h._tabPosition,s=O._73o;if(N===wh||N===ef){if(r=Dl(l).x-O.x,!O._25o&&!O.moving&&w(r)>2&&(h._40o()&&!fo(l)?O._25o=1:s&&h.isMovable()&&(O.moving=1)),O._25o)h.tx(O.tx+r);else if(O.moving){var d=O.lp.x+r,t=h._tabGap/2;h._7o.each(function(J){var B=J.endX,T=d-J.startX<B-d;d>=J.startX&&B>=d&&h._7Q({tab:s.tab,startX:s.startX+r,width:s.width,front:T,insertTab:J.tab,position:T?v(0,J.startX-t):R(h._64I,B+t)})})}}else if(r=Dl(l).y-O.y,!O._25o&&!O.moving&&w(r)>2&&(h._41o()&&!fo(l)?O._25o=1:s&&h.isMovable()&&(O.moving=1)),O._25o)h.ty(O.ty+r);else if(O.moving){var z=O.lp.y+r,t=h._tabGap/2;h._7o.each(function(f){var A=f.endY,b=z-f.startY<A-z;z>=f.startY&&A>=z&&h._7Q({tab:s.tab,startY:s.startY+r,height:s.height,front:b,insertTab:f.tab,position:b?v(0,f.startY-t):R(h._23Q,A+t)})})}},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(){var Q=this,k=Q.tv,G=k._tabPosition,g=k.getTabModel(),O=g._roots,A=Q._73o;if(Q.moving){var i=k._23o;if(i&&i.insertTab!==i.tab){var u=i.tab,n=O.remove(u),H=O.indexOf(i.insertTab);H>=0&&(i.front||H++,H<=O.size()&&(O.add(u,H),g._38I(u,n,H)))}k._7Q(m),delete Q.moving}else if(!Q._25o&&A){u=A.tab;var p=Q._74o;if(!p||p.tab===u)if(!u.isDisabled()&&qf(A._75o,Q.lp)){var w=function(){var M=O.indexOf(u);g.remove(u),k.onTabClosed(u,M)};k.onTabClosing(u,w)&&w()}else u.isDisabled()||k._8o===u||g.sm().ss(u)}Q._25o=Q._73o=Q._74o=G===wh||G===ef?Q.x=Q.lp=Q.tx=m:Q.y=Q.lp=Q.ty=m}}),ek.PropertyView=function(U){var I=this;I._view=xf(1,I),I._canvas=dj(I._view),ts(I._view,I._79O=gd()),I._rows=new Nf,I._28o=new Nf,I._26o={},I._26Q={};var E=I._propertyModel=new Bd,X=I.ivm;E.mm(X,I),E.md(X,I),E.mh(X,I),I.dm(U?U:new Bd),new Ee(I)},En("PropertyView",u,{ms_ac:[of,nr,Bi,Io,ap,"categorizable",ab,lc,fn,il,Ji,bc,hs,lp,"selectRowIndex",Ur,"background",Nk,Lp,qg,$l,cq],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Mh,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Yp,_background:b.propertyViewBackground,_expandIcon:b.propertyViewExpandIcon,_collapseIcon:b.propertyViewCollapseIcon,_scrollBarColor:Tg,_scrollBarSize:_n,_autoHideScrollBar:dq,_selectBackground:b.propertyViewSelectBackground,_rowHeight:Mg,_rowLineVisible:b.propertyViewRowLineVisible,_rowLineColor:b.propertyViewRowLineColor,_10I:.5,_columnLineVisible:b.propertyViewColumnLineVisible,_columnLineColor:b.propertyViewColumnLineColor,_labelColor:b.propertyViewLabelColor,_labelSelectColor:b.propertyViewLabelSelectColor,_labelFont:b.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(z){0>z&&(z=0),z>1&&(z=1);var $=this,B=$._10I;$._10I=z,$.fp("columnPosition",B,z)},getPropertyName:function(F){return F.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(g,D,B){return B===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(O,C){return C===this._selectRowIndex?this._labelSelectColor:O.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(F){var X=this.getHeight()-this._59I;return X>F&&(F=X),F>0?0:W(F)},isExpanded:function($){if(!$)return!0;var H=this._26o[$];return H?H.isExpanded:!(this._26Q[$]===!1)},toggle:function(X){var m=this;m.isExpanded(X)?m.collapse(X):m.expand(X)},expandAll:function(){this.validate();for(var D in this._26o)this.expand(D)},expand:function(T){if(T&&T!==Ag){var m=this,S=m._26o[T];S&&!S.isExpanded&&(S.isExpanded=!0,m.onExpanded(T),m.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var S in this._26o)this.collapse(S)},collapse:function(C){if(C&&C!==Ag){var _=this,h=_._26o[C];h&&h.isExpanded&&(h.isExpanded=!1,_.onCollapsed(C),_.ivm())}},onCollapsed:function(){},getCategoryName:function(i){if(!this.isCategorizable())return Ag;var K=i.getCategoryName();return K?K:Ag},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(Q){var i=this,o=i._dataModel;o!==Q&&(o&&(o.umd(i.handlePropertyChange,i),i._selectionModel||o.sm().ums(i.handleSelectionChange,i)),i._dataModel=Q,Q.md(i.handlePropertyChange,i),i._selectionModel?i._selectionModel._21I(Q):Q.sm().ms(i.handleSelectionChange,i),i.fp(lq,o,Q))},isVisible:function(j){return this._visibleFunc?this._visibleFunc(j):!0},onPropertyChanged:function(d){var o=this,R=d.property;Ym[R]?o.ivm():o.iv(),R===zd&&o._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:De},handlePropertyChange:function(j){this._27o===j.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var Y=this;Y._96I||(Y.setSelectRowIndex(-1),Y._96I=1,Y.iv())},redraw:function(){this.iv()},validateModel:function(){var p=this,r=p._rows,q=p._28o,w={},I=new Nf,H=p._27o;p.updateCurrentData(),H!==p._27o&&p.endEditing(),r.clear(),q.clear(),p.getRawProperties().each(function(z){if(p.isVisible(z)){I.add(z);var x=p.getCategoryName(z);w[x]||(q.add(x,x===Ag?0:Y),w[x]={isExpanded:p.isExpanded(x),properties:new Nf})}}),p._sortFunc&&I.sort(p._sortFunc);for(var f in p._26o)p._26Q[f]=p.isExpanded(f);p._26o=w,q.each(function(Y){Y!==Ag&&r.add(Y);var J=w[Y];J.isExpanded&&I.each(function(W){p.getCategoryName(W)===Y&&(J.properties.add(W),r.add({property:W,data:p._27o}))},p)})},validateImpl:function(){var K=this;K._76o(),K._96I&&(K.validateModel(),delete K._96I);var _=K._canvas,$=K.getWidth(),E=K.getHeight(),t=-K.ty(),F=K._rowHeight,N=K._indent,p=$-N,o=K._rows,n=o.size(),G=K._9I=N+p*K._10I,O=K._59I=n*F;Xe(_,$,E),K._29I={x:0,y:t,width:$,height:E},K._31I=f(t/F),K._14I=J((t+E)/F),K._31I<0&&(K._31I=0),K._14I>n&&(K._14I=n);var M,V=xd(_),u=K._background;ti(V,0,-t,1),V.beginPath(),V.rect(0,t,$,E),V.clip(),V.clearRect(0,t,$,E),K._93db(V),u&&Wm(V,0,0,N,O,u);for(var y=K._31I;y<K._14I;y++){var B=o.get(y),t=F*y;if(Mq(B))u&&Wm(V,N,t,p,F,u),M=Se(K.isExpanded(B)?K._expandIcon:K._collapseIcon),M&&Mc(V,M,Aj,0,t,N,F),V.save(),V.beginPath(),V.rect(N,t,p,F),V.clip(),K.drawCategoryName(V,B,y,N,t,p,F),V.restore();else{var v=B.property,W=B.data,M=Se(v.getIcon()),x=K._selectRowIndex===y?K.getSelectBackground():m;
if(M&&Mc(V,M,Aj,0,t,N,F),x&&Wm(V,N,t,p,F,x),V.save(),V.beginPath(),V.rect(N,t,G-N,F),V.clip(),K.drawPropertyName(V,v,y,N,t,G-N,F),V.restore(),!K.isEditing(W,v)){var R=G+1,g=$-G-1;V.save(),V.beginPath(),V.rect(R,t,g,F),V.clip(),K._87o(K.drawPropertyValue(V,v,K.getValue(W,v),y,R,t,g,F,W),y,R,t,g,F),V.restore()}}K._rowLineVisible&&Wm(V,N,t+F-1,p,1,K._rowLineColor)}K._columnLineVisible&&(Wm(V,G,0,1,O,K._columnLineColor),Wm(V,$-1,0,1,O)),K._92db(V),K._93I(),V.restore(),K.ty(K.ty())},drawCategoryName:function(R,t,z,O,s,Q,N){ci(R,t,this.getCategoryFont(t),this.getCategoryColor(t),O,s,Q,N)},drawPropertyName:function(h,B,G,N,A,W,r){return B.drawPropertyName?(B.drawPropertyName(h,B,G,N,A,W,r,this),void 0):(ci(h,this.getPropertyName(B),this.getPropertyFont(B,G),this.getPropertyColor(B,G),N,A,W,r),void 0)},drawPropertyValue:function(r,Y,P,e,S,l,m,$,b){return Y.drawPropertyValue?Y.drawPropertyValue(r,Y,P,e,S,l,m,$,b,this):(ah(r,P,Y,this.getLabelFont(Y,P,e),this.getLabelColor(Y,P,e),S,l,m,$,b,this),void 0)},isPropertyEditable:function(d){return d.isEditable()&&this.isEditable()},setProperties:function(P){this._propertyModel.clear(),this.addProperties(P)},addProperties:function(a){if(a){var H=this._propertyModel;a.forEach(function(w){if(!(w instanceof Ae)){var Q=hp(w.className);w=Ii(Q?Q:Ae,w)}H.add(w)})}},getRowIndexAt:function(C){var K=this,j=f(K.lp(C).y/K._rowHeight);return j>=0&&j<K._rows.size()?j:-1},getPropertyAt:function(o){var I=this,t=I.getRowIndexAt(o);return t>=0?I._rows.get(t).property:m},getToolTip:function(C){var r=this,x=r.getPropertyAt(C),i=r._27o;return x&&i?x.getToolTip(i,r._9I<r.lp(C).x,r):m}});var Ee=function(F){this.pv=F,this.addListeners()};Uo(Ee,u,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(Y){this.getView().style.cursor=Y},clear:function(){var d=this;d._62O=d.cp=d.ty=d.p=m,d.setCursor(kj)},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(b){var j=this,R=j.pv;db(b),R.setFocus(b)&&(zj(b)?(j.cp=Dl(b),j.ty=R.ty(),j.p=R.getColumnPosition(),j.handle_touchmove(b)):R.setSelectRowIndex(R.getRowIndexAt(b)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(k){var s=this;if(s.cp&&!s._62O){var I=s.pv,R=I.lp(k),V=R.x,b=R.y,o=I._indent,_=I.getRowIndexAt(k),v=I._9I;if(_>=0){var u=I._rowHeight,d=u*_,z=I._rows.get(_),Z=z.property;if(Mq(z))Se(I.isExpanded(z)?I._expandIcon:I._collapseIcon)&&V>=0&&o>=V&&b>=d&&d+u>=b?I.toggle(z):qc(k)&&I.toggle(z);else if(V>v&&I.isPropertyEditable(Z,k)){var U={x:v+1,y:d,width:I.getWidth()-v-1,height:u},c={x:U.x+I.tx(),y:U.y+I.ty(),width:U.width,height:U.height},Q=0,a=I._29I;U.y<a.y?Q=U.y-a.y:U.y+u>a.y+a.height&&(Q=U.y+u-a.y-a.height),Q&&(I.ty(I.ty()-Q),c.y-=Q),I.beginEditing({data:z.data,property:Z,value:I.getValue(z.data,Z),event:k,rect:U,editorRect:c,view:I})}}I.setSelectRowIndex(_)}s.clear()},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowTouchMove:function(J){var N=this,T=N.pv,z=N.ty,k=N.cp,U=Dl(J),I=N._62O;if("p"===I)T.setTranslateY(z+U.y-k.y);else if("c"===I){var X=T.getWidth()-T._indent;if(X>16){var $=N.p-(k.x-U.x)/X,f=16/X;f>$&&($=f),$>1-f&&($=1-f),T.setColumnPosition($)}}else"s"===I&&T.setTranslateY(z+(k.y-U.y)*T._59I/T._29I.height)},handle_mousemove:function(b){this.handle_touchmove(b)},handle_touchmove:function(x){if(!tb&&zj(x)){var X=this,O=X.pv,g=w(O.lp(x).x-O._9I)<=(L?8:3);X.cp?X._62O||(g?(X._62O="c",Qc(X)):w(Dl(x).y-X.cp.y)>=2&&(X._62O=X.isV(x)?"s":"p",Qc(X))):(g?X.setCursor(bo):X.setCursor(kj),X.isV(x)&&O._43o())}},isV:function(_){var D=this.pv,r=D._29I;return D._41o()&&r.x+r.width-D.lp(_).x<ps},handle_mousewheel:function(J){this.handleScroll(J,J.wheelDelta/40)},handle_DOMMouseScroll:function(J){2===J.axis&&this.handleScroll(J,-J.detail)},handleScroll:function(N,U){var K=this.pv;db(N),K.endEditing(),K.translate(0,U*K.getRowHeight())},handle_keydown:function(K){var U=this.pv,q=U._rows.size(),E=U._selectRowIndex+(Zj(K)?-1:1);(Zj(K)||Pp(K))&&(0>E&&(E=0),E>=q&&(E=q-1),U.setSelectRowIndex(E))}}),ek.ListView=function(F){this._5o(F),new Ao(this)},En("ListView",u,{ms_ac:[of,nr,Bi,Nk,ab,Lp,qg,lc,fn,bc,hs,lp,yh,Ur],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Yp,_rowHeight:Mg,_rowLineVisible:b.listViewRowLineVisible,_rowLineColor:b.listViewRowLineColor,_scrollBarColor:Tg,_scrollBarSize:_n,_autoMakeVisible:ks,_autoHideScrollBar:dq,_selectBackground:b.listViewSelectBackground,_labelColor:b.listViewLabelColor,_labelSelectColor:b.listViewLabelSelectColor,_labelFont:b.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(H){var z=this,Y=z._checkMode;z._checkMode=H,z.fp(Pd,Y,H)},drawRow:function(z,P,o,Q,n,k,N){var E=this,G=0,C=E._indent,x=E.getIconWidth(P);E.drawRowBackground(z,P,o,Q,n,k,N),E._checkMode&&(Yi(z,Se(E.getCheckIcon(P)),G+C/2,n+N/2,P,E),G+=C),E.drawIcon(z,P,G,n,x,N),E.drawLabel(z,P,G+x,n,N)}});var Ao=function(G){this.list=G,this._lastSelectDataTime=Pj(),this.addListeners()};Uo(Ao,u,{ms_listener:1,getView:function(){return this.list._view},clear:function(x){var $=this,a=$.list;x&&"d"===$._62O&&!$.dragCancel&&a.handleDragAndDrop(x,"end"),a.draggingData&&(a.draggingData=null,a.redraw()),$.dragCancel=$._62O=$._isV=$._isH=$.cp=$.tx=$.ty=m},handle_mousedown:function(P){this.handle_touchstart(P)},handle_touchstart:function(q){var Z=this,x=Z.list;if(db(q),x.setFocus(q)){var U=x.getDataAt(q);Z.cp=Dl(q),Z.tx=x.tx(),Z.ty=x.ty(),zj(q)?U&&x.handleDragAndDrop&&!Z.isV(q)&&!Z.isH(q)&&(x.draggingData=U,x.redraw(),x.handleDragAndDrop(q,"prepare")):(U&&Z._33o(q,U),Z.clear(q))}},handleWindowMouseUp:function(i){this.clear(i)},handleWindowTouchEnd:function(D){this.clear(D)},handle_mouseup:function(Q){this.handle_touchend(Q)},handle_touchend:function(m){var k=this,s=k.list;if(!k._isV&&!k._isH&&k.cp&&!k._62O){var t=s.getDataAt(m);t?(s.isCheckMode()?k._34o(m,t):k._33o(m,t),qc(m)?s.onDataDoubleClicked(t,m):s.onDataClicked(t,m)):s.handleBackgroundClick(m)}k.clear(m)},handleWindowMouseMove:function(F){this.handleWindowTouchMove(F)},handleWindowTouchMove:function(c){var g=this,w=g.list,b=g._62O,T=g.tx,B=g.ty,A=g.cp,N=Dl(c),z=w._29I;"p"===b?w.setTranslate(T+N.x-A.x,B+N.y-A.y):"v"===b?w.ty(B+(A.y-N.y)*w._59I/z.height):"h"===b?w.tx(T+(A.x-N.x)*w._91I/z.width):"d"===b&&(g.dragCancel||w.handleDragAndDrop(c,"between"))},handle_mousemove:function(Z){this.handle_touchmove(Z)},handle_touchmove:function(j){if(!tb&&zj(j)){var C=this,F=C.list;if(C._isV=C.isV(j),C._isH=C.isH(j),C.cp){if(!C._62O){if(fr(Dl(j),C.cp)<2)return;C._isV?C._62O="v":C._isH?C._62O="h":F.draggingData&&!this.dragCancel?(C._62O="d",F.handleDragAndDrop(j,"begin")):C._62O="p",C._62O&&"d"!==C._62O&&F.draggingData&&(F.draggingData=null,F.redraw()),Qc(C)}}else C._isV&&F._43o(),C._isH&&F._42o()}},isV:function(H){var x=this.list,I=x._29I;return x._41o()&&I.x+I.width-x.lp(H).x<ps},isH:function(I){var w=this.list,$=w._29I;return w._40o()&&$.y+$.height-w.lp(I).y<ps},handle_mousewheel:function(h){this.handleScroll(h,h.wheelDelta/40,h.wheelDelta!==h.wheelDeltaX)},handle_DOMMouseScroll:function(v){this.handleScroll(v,-v.detail,1)},handleScroll:function(Q,P,b){var z=this.list;db(Q),z.endEditing&&z.endEditing(),b&&z._41o()?z.translate(0,P*z.getRowHeight()):z._40o()&&z.translate(10*P,0)},handle_keydown:function(J){if(!b.isInput(J.target)){var d,D=this.list,O=D.sm(),I=D._rows,m=I.size();if(ff(J))D.selectAll();else if(Cp(J))D.handleDelete&&D.handleDelete(J);else if(mq(J))"d"!==this._62O||this.dragCancel||(D.handleDragAndDrop(J,"cancel"),this.dragCancel=!0);else if(gh(J))D.isCheckMode()&&(d=D.getFocusData(),d&&D.checkData(d));else if(Zj(J)||Pp(J)){var q=D.isCheckMode();if(d=q?D.getFocusData():O.ld()){var w=D.getRowIndex(d);w>=0&&(Zj(J)?0!==w&&(d=I.get(w-1),q?D.setFocusData(d):O.ss(d)):w!==m-1&&(d=I.get(w+1),q?D.setFocusData(d):O.ss(d)))}else m>0&&(d=I.get(0),q?D.setFocusData(d):O.ss(d))}}},_34o:function(D,U){var m=this.list,n=m.lp(D).x;return n>=0&&n<=m._indent?(m.checkData(U),void 0):(m.setFocusData(U),void 0)},_33o:function(u,T){var k=this.list,K=k.sm(),r=K.ld();if(fo(u))k.isSelected(T)?K.rs(T):K.as(T);else if(gg(u))if(r)for(var z=k.getRowIndex(r),j=k.getRowIndex(T);z!==j;)z+=j>z?1:-1,K.as(k._rows.get(z));else K.ss(T);else if(zj(u)){var P=Pj();if(K.contains(T)){var W=P-this._lastSelectDataTime;k.handleDataDoubleSelect&&W>500&&1500>W&&k.handleDataDoubleSelect(u,T)}K.ss(T),this._lastSelectDataTime=P}else K.contains(T)||K.ss(T)}}),ek.TreeView=function(d){var G=this;G._35o(),G._5o(d),new $e(G)},En("TreeView",u,{ms_ac:[of,nr,Bi,"rootVisible",Pd,"rootData",lc,fn,bc,hs,lp,ab,Nk,Lp,qg,il,Ji,yh,Ur,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:m,_indent:Yp,_rowHeight:Mg,_rowLineVisible:b.treeViewRowLineVisible,_rowLineColor:b.treeViewRowLineColor,_scrollBarColor:Tg,_scrollBarSize:_n,_autoHideScrollBar:dq,_expandIcon:b.treeViewExpandIcon,_collapseIcon:b.treeViewCollapseIcon,_autoMakeVisible:ks,_selectBackground:b.treeViewSelectBackground,_labelColor:b.treeViewLabelColor,_labelSelectColor:b.treeViewLabelSelectColor,_labelFont:b.treeViewLabelFont,_doubleClickToToggle:b.treeViewDoubleClickToToggle,drawRow:function(T,z,o,g,Q,X,y){var w=this;w.drawRowBackground(T,z,o,g,Q,X,y),w._97I(T,z,o,0,Q,X,y)},isOnToggleIcon:function(q){var f=this.getDataAt(q);if(f){var X=this.getIndent(),x=this.lp(q).x;if(Se(this.getToggleIcon(f))){var D=X*this.getLevel(f);if(x>=D&&D+X>=x)return!0}}return!1}});var $e=function(F){Ck($e,this,[F])};Uo($e,Ao,{toggle:function(P,M,r,I){var A=this.list,u=A.lp(P).x;if(Se(A.getToggleIcon(M))){var J=r*I;if(u>=J&&J+r>=u)return A.toggle(M),!0}return A.isDoubleClickToToggle()&&qc(P)?(A.toggle(M),!0):!1},_34o:function(L,t){var s=this.list,r=s.lp(L).x,d=s._levelMap[t._id],h=s._indent,i=h*(d+1);return r>=i&&i+h>=r?(s.checkData(t),void 0):(this.toggle(L,t,h,d)||s.setFocusData(t),void 0)},_33o:function(d,l){var i=this,n=i.list;i.toggle(d,l,n._indent,n.getLevel(l))||$e.superClass._33o.call(i,d,l)},handle_keydown:function(A){if(pq(A)||Sf(A)){var r=this.list,M=r._rows,e=r.isCheckMode(),Q=r.sm(),w=e?r.getFocusData():Q.ld();w?w.hasChildren()&&(pq(A)?r.collapse(w):r.expand(w)):M.size()>0&&(w=M.get(0),e?r.setFocusData(w):Q.ss(w))}else $e.superClass.handle_keydown.call(this,A)}});var Qh=ek.TableView=function(i){this._98I(),this._5o(i),new Lm(this)};En("TableView",u,{ms_ac:[of,nr,Bi,"sortMode",Io,ap,Nk,Lp,qg,$l,cq,"sortColumn",lc,fn,bc,hs,lp,yh,Ur],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Zh,_editable:!0,_batchEditable:!1,_rowHeight:Mg,_rowLineVisible:b.tableViewRowLineVisible,_rowLineColor:b.tableViewRowLineColor,_columnLineVisible:b.tableViewColumnLineVisible,_columnLineColor:b.tableViewColumnLineColor,_scrollBarColor:Tg,_scrollBarSize:_n,_autoHideScrollBar:dq,_autoMakeVisible:ks,_selectBackground:b.tableViewSelectBackground,_labelColor:b.tableViewLabelColor,_labelSelectColor:b.tableViewLabelSelectColor,_labelFont:b.tableViewLabelFont,getCheckColumn:function(){var B=this;if(!B._31o){var T=B._31o=new Ll;T.setEditable(!0),T.setWidth(40),T.getValue=B.getCheckColumValue,T.drawCell=B.drawCheckColumnCell}return B._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(Q){var I=this,a=I._39o,n=I.getCheckColumn();Q!==I.isCheckMode()&&(Q?a.add(n,0):a.remove(n),I.fp(Pd,!Q,Q))},getCheckColumValue:function(N,y,s){return s.isSelected(N)},drawCheckColumnCell:function(J,Z,S,I,z,p,Y,_,e){Yi(J,e.getCheckIcon(Z),z+Y/2,p+_/2,Z,e)}});var Lm=function(G){Ck(Lm,this,[G])};Uo(Lm,Ao,{_34o:function(L,q){var M=this.list,w=M._31o;if(M.isCellEditable(q,w,L)){var h=M._3Q(w),J=M.lp(L).x;if(h&&J>=h.startX&&J<h.startX+w.getWidth())return M.checkData(q),void 0}M._37O(q,L),M.setFocusData(q)},_33o:function(z,J){this.list._37O(J,z),Lm.superClass._33o.apply(this,arguments)}});var _d=ek.TreeTableView=function(W){var Q=this,f=Q._4o=new Ll;Q._35o(),Q._98I(),Q._5o(W),f.setDisplayName("Name"),f.setEditable(!0),f.setWidth(180),f.drawCell=pb,f.getValue=ec,Q._39o.add(f),new yg(Q)},pb=function(v,j,G,U,E,k,S,n,V){V._97I(v,j,G,E,k,S,n)},ec=function(f,M,E){return E.getLabel(f)};En("TreeTableView",u,{ms_ac:[of,nr,Bi,"sortMode",Io,ap,ab,Pd,"rootData","rootVisible",lc,fn,"sortColumn",il,Ji,bc,hs,lp,yh,qg,Nk,Lp,$l,cq,Ur,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Zh,_checkMode:m,_editable:!0,_batchEditable:!1,_indent:Yp,_rowHeight:Mg,_rowLineVisible:b.treeTableViewRowLineVisible,_rowLineColor:b.treeTableViewRowLineColor,_columnLineVisible:b.treeTableViewColumnLineVisible,_columnLineColor:b.treeTableViewColumnLineColor,_expandIcon:b.treeTableViewExpandIcon,_collapseIcon:b.treeTableViewCollapseIcon,_scrollBarColor:Tg,_scrollBarSize:_n,_autoHideScrollBar:dq,_autoMakeVisible:ks,_selectBackground:b.treeTableViewSelectBackground,_labelColor:b.treeTableViewLabelColor,_labelSelectColor:b.treeTableViewLabelSelectColor,_labelFont:b.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var yg=function(N){Ck(yg,this,[N])};Uo(yg,Ao,{_34o:function(U,y){var o=this.list,f=o._4o,c=o._3Q(f),J=o.lp(U).x;if(c){var h=o._indent,Y=c.startX+h*o.getLevel(y);if(Se(o.getToggleIcon(y))&&J>=Y&&Y+h>=J)return o.toggle(y),void 0;if(o.isCellEditable(y,f)&&(Y+=h,J>=Y&&Y+h>=J))return o.checkData(y),void 0}o._37O(y,U),o.setFocusData(y)},_33o:function(z,c){var h=this.list,L=h.lp(z).x;if(Se(h.getToggleIcon(c))){var F=h._3Q(h._4o);if(F){var A=h._indent,r=F.startX+A*h.getLevel(c);if(L>=r&&r+A>=L)return h.toggle(c),void 0}}h._37O(c,z),yg.superClass._33o.apply(this,arguments)}});var nq=ek.TableHeader=function(X){var P=this,n=P._view=xf(1,P),d=P._39o=X.getColumnModel(),C=P.iv;P.tv=P._tableView=X,P._60I=new Nf,P._canvas=dj(n),n.style.background=b.tableHeaderBackground||"",n.style.height=mb+se,d.mm(C,P),d.md(C,P),d.mh(C,P),X.mp(function(n){Bb[n.property]&&P.iv()},P),new vg(P),P.iv()};En("TableHeader",u,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",of,Bi,ab,"moveBackground","insertColor",$l,cq,"resizable","movable"],_checkIcon:Jf,_movable:!0,_resizable:!0,_labelColor:b.tableHeaderLabelColor,_labelFont:b.tableHeaderLabelFont,_columnLineColor:b.tableHeaderColumnLineColor,_columnLineVisible:b.tableHeaderColumnLineVisible,_sortDescIcon:b.tableHeaderSortDescIcon,_sortAscIcon:b.tableHeaderSortAscIcon,_moveBackground:b.tableHeaderMoveBackground,_insertColor:b.tableHeaderInsertColor,_indent:Yp,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(e){return e.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(_){return _.getColor()||this._labelColor},getLabelAlign:function(B){return B._align},onPropertyChanged:function(){this.iv()},_5Q:function(L){this._61I=L,this.iv()},getLogicalPoint:function(N){return Pq(N,this._canvas,this.tv.tx())},validateImpl:function(){var Q=this,P=Q._canvas,q=Q.getWidth(),u=Q.getHeight(),s=Q.tv,O=Q._60I,v=Q._61I,J=-s.tx(),c=0;(q!==P.clientWidth||u!==P.clientHeight)&&Xe(P,q,u),O.clear(),Q._39o._roots.each(function(U){if(U.isVisible()){var W=c+U.getWidth();J+q>=c&&W>=J&&O.add({column:U,startX:c}),c=W}});var d=xd(P);if(ti(d,-J,0,1),d.beginPath(),d.rect(J,0,q,u),d.clip(),d.clearRect(J,0,q,u),O.each(function(i){var E=i.column,G=i.startX,C=E.getWidth();C>0&&(d.save(),d.beginPath(),d.rect(G,0,C,u),d.clip(),v&&v.column===E||Q.drawColumn(d,E,G,0,C,u),Q._columnLineVisible&&Wm(d,G+C-1,0,1,u,Q._columnLineColor),d.restore())}),v){var y=v.column,c=v.startX,a=v.position,B=y.getWidth();d.save(),d.beginPath(),d.rect(c,0,B,u),d.clip(),d.fillStyle=Q._moveBackground,d.fill(),Q.drawColumn(d,y,c,0,B,u),d.restore(),Xi(d,Q._insertColor,a,0,u)}d.restore()},_6Q:function(T){var g=this.tv;return g._31o===T&&g.sm().getSelectionMode()===mc},drawColumn:function(h,x,O,w,A,_){var y=this,u=y.tv,k=Se(x.getIcon()),o=y.getLabelAlign(x);if(y._6Q(x)){var j=Se(y._checkIcon);Yi(h,j,O+A/2,w+_/2,x,y)}else{var l=y.getLabel(x),V=y.getLabelFont(x),C=y.getLabelColor(x),r=gc(V,l).width,q=k?y._indent:0;o===ip?(k&&Mc(h,k,Aj,O,w,q,_),ci(h,l,V,C,O+q,w,A,_,ip)):o===jf?(k&&Mc(h,k,Aj,O+A-r-q,w,q,_),ci(h,l,V,C,O,w,A,_,jf)):(k&&Mc(h,k,Aj,O+(A-r-q)/2,w,q,_),ci(h,l,V,C,O+(A-r+q)/2,w,0,_,ip))}if(x.isSortable()&&u.getSortColumn()===x&&(k=Se(x.getSortOrder()===Bj?y._sortAscIcon:y._sortDescIcon))){var U=Jb(k,x)/2+2;Yi(h,k,o===jf?O+U:O+A-U,w+_/2,x,u)}}});var vg=function(q){var d=this;d.th=q,d.tv=q._tableView,d.addListeners()};Uo(vg,u,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(P){this.getView().style.cursor=P},handle_mousemove:function(Y){if(!tb){var l=this;delete l._29o,l.setCursor(kj);for(var i=l.th,Z=i._60I,P=i.lp(Y).x,y=Z.size()-1;y>=0;y--){var v=Z.get(y),o=v.column,W=v.startX+o.getWidth();if(i.isResizable()&&w(W-P)<=(L?10:3))return l._29o=v,l.setCursor(bo),void 0;P>v.startX&&W>P&&(l._29o=v),(o.isClickable()||o.isSortable()||i.isMovable()||l.tv.getCheckColumn&&o===l.tv.getCheckColumn())&&P>v.startX&&W>P&&l.setCursor(jk)}}},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(B){var b=this;db(B),b.tv.endEditing(),b.handle_mousemove(B),b._29o&&(b.x=Dl(B).x,b.lx=b.th.lp(B).x,b.w=b._29o.column.getWidth(),Qc(b,B))},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowTouchMove:function(K){var y=this,R=y.th,Z=y.getView().style.cursor,$=y._29o,d=Dl(K).x-y.x;if(y.resizing||y.moving||(Z===bo?y.resizing=1:R.isMovable()&&Z===jk&&w(d)>2&&(y.moving=1)),y.resizing)$.column.setWidth(y.w+d);else if(y.moving){var i=y.lx+d;R._60I.each(function(z){var l=z.startX,t=l+z.column.getWidth();if(i>=l&&t>=i){var Z={column:$.column,startX:$.startX+d,front:t-i>i-l,insertColumn:z.column};Z.position=Z.front?l:t,R._5Q(Z)}})}},_16Q:function(A,Y){var J=this,q=J.tv,$=J.th,d=$._checkIcon;if($._6Q(A)){var S=Se(d),V=J.lx,P=A.getWidth(),o=Jb(S,A);if(V>=Y+P/2-o&&Y+P/2+o>=V){$.setCheckIcon(d===xr?Jf:xr);var p=q.sm(),E=q._rows;return d===xr?p.rs(E):p.ss(E),q.onCheckColumnClicked(A),!0}}return!1},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},handleWindowTouchEnd:function(c){var j=this,z=j.tv,b=j.th,r=j._29o;if(j.moving){var g=b._61I;if(g&&g.insertColumn!==g.column){var E=g.column,W=z.getColumnModel()._roots,O=W.remove(E),N=W.indexOf(g.insertColumn);N>=0&&(g.front||N++,N<=W.size()&&(W.add(E,N),z.getColumnModel()._38I(E,O,N)))}b._5Q(m),delete j.moving}else if(!j.resizing&&r){E=r.column;var v=b.lp(c).x,t=r.startX,y=!0;if(b.onColumnClicked){var C=b.onColumnClicked(E,c,t);C===!1&&(y=!1)}if(y&&v>=t&&v<=t+E.getWidth()&&!j._16Q(E,t)){if(E.isSortable()){var s=z.getSortMode(),D=E.getSortOrder();s===Zh?z.getSortColumn()===E?(D===Vj&&z.setSortColumn(m),E.setSortOrder(D===Bj?Vj:Bj)):z.setSortColumn(E):"bistate"===s&&(z.getSortColumn()===E?E.setSortOrder(D===Bj?Vj:Bj):z.setSortColumn(E))}z.onColumnClicked(E,c,t)}}j._29o=j.resizing=j.x=j.lx=j.w=m}}),ek.TablePane=function(x){this.init(new Qh(x))},En("TablePane",u,{ms_v:1,_44o:1}),ek.TreeTablePane=function(T){this.init(new _d(T))},En("TreeTablePane",u,{ms_v:1,_44o:1}),ek.Toolbar=function(P){var d=this,B=d._view=xf(1,d),M=B.style;M.background=b.toolbarBackground||"",M.height=fg+se,d._canvas=dj(B),d._30o=new Nf,d._90I=new Nf,d.setItems(P||[]),B.handleGroupSelectedChanged=function(b){if(b.isSelected()){var V=b.getGroupId();null!=V&&d._items.forEach(function(U){var O=U.element;O&&O!==b&&O.setSelected&&O.getGroupId&&O.getGroupId()===V&&O.setSelected(!1)})}},new jn(d)},En("Toolbar",u,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Qb,of,Bi,nr,Ur,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:b.toolbarLabelColor,_labelSelectColor:b.toolbarLabelSelectColor,_labelFont:b.toolbarLabelFont,_selectBackground:b.toolbarSelectBackground,_itemGap:b.toolbarItemGap,_separatorColor:b.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(p){var w=this.getItemInfoAt(p);return w?w.item.toolTip:m},getLabelColor:function(j){return j&&j.selected&&j.type!==xr&&j.type!==yb?this._labelSelectColor:this._labelColor},onPropertyChanged:function(J){this.iv(),J.property===Qb&&this._items.forEach(function(F){rq(F)})},redraw:function(){this.iv()},addItem:function(v,L){var Q=this._items;L==m?Q.push(v):Q.splice(L,0,v),this.fp(Qb,m,Q)},removeItem:function(q){if(q)for(var U=this._items,B=0;B<U.length;B++)q===U[B]&&(U.splice(B,1),this.fp(Qb,m,U))},removeItemById:function(p){if(p!=m)for(var X=this._items,I=0;I<X.length;I++)if(p===X[I].id){var N=X.splice(I,1)[0];return this.fp(Qb,m,X),N}},getItemById:function(_){if(_!=m)for(var X=this._items,x=0;x<X.length;x++){var o=X[x];if(_===o.id)return o}},setItemVisible:function(t,E){var D=this.getItemById(t);D&&(D.visible=E)},getItemInfos:function(){return this._30o},getItemInfoAt:function(b){var f=this,c=0,D=f._30o,o=f.lp(b),V=o.x,k=o.y;if(k>=0&&k<=f.getHeight())for(;c<D.size();c++){var d=D.get(c);if(d.startX<=V&&V<=d.endX)return d}return m},drawItem:function(J,G,i,e,p){if(G.visible===!1)return 0;if(fp(G.visible)&&!G.visible())return 0;var m=this,l=G.disabled;l&&(J.globalAlpha=Mb);var t=m.drawItemImpl(J,G,i,e,p),E=m._itemGap;return l&&(J.globalAlpha=1),this._currentItem!==G||"separator"===G||G.separator===!0||G.unfocusable||Af(J,m._separatorColor,i-E/2,0,t+E,e),t},drawItemImpl:function(v,z,t,B,X){var s=this,n=s._view,P=s._itemGap,l=B/2,W=z.type,y=z.element,E=z.label;Mq(y)&&(E=y,y=m);var I,H=s.getLabelFont(z),K=s.getLabelColor(z),N=z.selected,Q=Se(z.icon),h=Jb(Q,z),S=0,a=h+(E?gc(H,E).width:0);if("separator"===z||z.separator===!0)return Xi(v,s._separatorColor,t,B/4,l),1;if(y){Q&&Yi(v,Q,t+h/2,l,z,s),ci(v,E,H,K,t+h,0,0,B);var A=$b(y);X||s._90I.add(A),A.parentNode!==n&&ts(n,A),y.iv&&y.iv(),y.validate&&y.validate();var Y=A.getBoundingClientRect(),$=Y.width,F=A.style;return hr(A),F.left=s.tx()+t+a+se,F.top=(B-Y.height)/2+se,a+$}return W===yb?I=Se(N?$i:Dj):W===xr&&(I=Se(N?xr:Jf)),I?(S=Jb(I,z),Yi(v,I,t+S/2,l,z,s),t+=S,a+=S):N&&Wm(v,t-P/2,0,a+P,B,s.getSelectBackground(z)),Q&&Yi(v,Q,t+h/2,l,z,s),ci(v,E,H,K,t+h,0,0,B),a},validateImpl:function(){var j=this,V=j._canvas,s=j.getWidth(),K=j.getHeight(),r=j._30o,u=j._items;Xe(V,s,K);var t=xd(V),L=j._itemGap,e=L/2;ti(t,j.tx(),0,1),t.clearRect(0,0,s,K);var a=j._90I;j._90I=new Nf,r.clear(),u.forEach(function(d){var G=j.drawItem(t,d,e,K);r.add({item:d,startX:e,endX:e+G,width:G}),G&&(e+=G+L)}),a.each(function($){j._90I.contains($)||bd($)});var Q=j._64I;j._64I=v(0,e),t.restore(),j._stickToRight?(j._65O=0,t=xd(V),e=s-j._64I+L,ti(t,0,0,1),t.clearRect(0,0,s,K),r.clear(),u.forEach(function(I){var Z=j.drawItem(t,I,e,K,!0);r.add({item:I,startX:e,endX:e+Z,width:Z}),Z&&(e+=Z+L)}),t.restore()):j.tx(j.tx()),Q!==j._64I&&j.onSumWidthChanged(Q,j._64I)},onSumWidthChanged:function(){},handleClick:function(R,C){var N=this,z=R.type,L=R.action,O=R.groupId,S=R.selected;R.disabled||(O!=m?S||(R.selected=!0,this._items.forEach(function(i){i.groupId===O&&R!==i&&(i.selected=!1)}),L&&R.action(R,N,C)):z===xr||"toggle"===z?(R.selected=!S,L&&R.action(R,N,C)):L&&R.action(R,N,C)),Sl(),N.iv()}});var jn=function(P){this.tb=P,this.addListeners()};Uo(jn,u,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(Y){this.handleScroll(Y,10*(Y.wheelDelta/40))},handle_DOMMouseScroll:function(q){this.handleScroll(q,10*-q.detail)},handleScroll:function(_,Q){db(_);var f=this.tb;f.isScrollable()&&!f._stickToRight&&(f.tx(f.tx()+Q),Eo())},handle_mousemove:function(z){var L=this;tb||L.setItem(z)},handle_mouseout:function(d){var H=this;d.target===H.getView()?H.tb.setCurrentItem(m):H.handle_mousemove(d)},handle_mousedown:function(Q){this.handle_mousemove(Q),this.handle_touchstart(Q)},handle_touchstart:function(Z){var d=this,U=d.tb,Q=Z.target;zj(Z)&&(Q===d.getView()||Q===U._canvas)&&(db(Z),U.setFocus(Z)&&(this.setItem(Z,!0),(U.isScrollable()||d.info&&!d.info.item.disabled)&&(d.x=Dl(Z).x,d.tx=U.tx(),Qc(d,Z))))},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(B){var A=this,X=A.tb;if(!X._stickToRight){var K=Dl(B).x-A.x;!A._25o&&w(K)>2&&X.isScrollable()&&(A._25o=1),A._25o&&X.tx(A.tx+K)}},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(P){var F=this,E=F.tb,z=F.info,U=F.tb.getItemInfoAt(P);if(!F._25o&&z){var Q=z.item;U&&U.item===Q&&E.handleClick(Q,P)}F._25o=F.x=F.tx=m,F.setItem()},setItem:function(t,J){var D=this,y=D.tb,C=D.info=t?y.getItemInfoAt(t):m,b=C?C.item:m;y.setCurrentItem(b),J&&b&&fp(b.onDown)&&b.onDown(t)}}),ek.BorderPane=function(){this._view=xf(1,this),this.iv()},En("BorderPane",u,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(M,f){this._12o("leftView",M),f!=m&&this.setLeftWidth(f)},getRightView:function(){return this._rightView},setRightView:function(M,d){this._12o("rightView",M),d!=m&&this.setRightWidth(d)},getTopView:function(){return this._topView},setTopView:function(Q,q){this._12o("topView",Q),q!=m&&this.setTopHeight(q)},getBottomView:function(){return this._bottomView},setBottomView:function(v,k){this._12o("bottomView",v),k!=m&&this.setBottomHeight(k)},getCenterView:function(){return this._centerView},setCenterView:function(U){this._12o("centerView",U)},_12o:function(C,F){var f=this,R="_"+C,x=f._view,d=f[R];d!==F&&(d&&(d.getView?bd(d.getView()):bd(d)),f[R]=F,F&&(F.getView?ts(x,F.getView(),1):ts(x,F,1)),f.fp(C,d,F))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var G=this,E=G._topView,J=G._bottomView,$=G._leftView,e=G._rightView,M=G._centerView,D=G.getWidth(),w=G.getHeight(),p=0,O=0,f=D,I=w,i=0,T=0,q=0,n=0;E&&(i=G._topHeight==m?wc(E):G._topHeight,O=i),J&&(T=G._bottomHeight==m?wc(J):G._bottomHeight,I=w-T),$&&(q=G._leftWidth==m?Kb($):G._leftWidth,p=q),e&&(n=G._rightWidth==m?Kb(e):G._rightWidth,f=D-n);var r=v(0,f-p),A=v(0,I-O);E&&Or(E,0,0,D,i),J&&Or(J,0,I,D,T),$&&Or($,0,O,q,A),e&&Or(e,f,O,n,A),M&&Or(M,p,O,r,A)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);