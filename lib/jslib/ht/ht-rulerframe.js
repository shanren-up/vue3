!function(v,O){"use strict";var l="position",K="absolute",C="relative",h="px",Y="left",$="right",o="top",H="bottom",I="display",i="none",w="block",A=ht.Default,U=A.getInternal(),s=Math.floor,t=Math.ceil,R=Math.PI,T=null,V=v.parseInt,d=function(z){return z.getContext("2d")},G=function(){return document},r=function(Z){return G().createElement(Z)},S=function(){return r("div")},e=function(){return r("canvas")},g=function(c,h,U){c.style.setProperty(h,U,T)},E=function(i,x,g){A.def(ht.widget[i],x,g)},D=function(s,y){s.appendChild(y)},j=function(k,c){k.removeChild(c)},z=function(O,J,$,e){O.addEventListener(J,$,!!e)},x=function(V,E,k,n){V.removeEventListener(E,k,!!n)};ht.widget.RulerFrame=function(Y){var J=this,U=J._view=S(),f=J.$1k=e(),B=J.$2k=e(),q=J.$3k=e(),E=J.$4k=e();J._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},J._topRulerConfig={visible:!0},J._rightRulerConfig={visible:!1},J._bottomRulerConfig={visible:!1},J._leftRulerConfig={visible:!0},D(U,f),D(U,q),D(U,B),D(U,E),g(U,l,C),g(U,"box-sizing","border-box"),g(U,"-moz-box-sizing","border-box"),g(f,l,K),g(B,l,K),g(q,l,K),g(E,l,K),J.$14k=function(){J.$13k=1,J.iv()},J.$15k=function(i){if(J._topRulerConfig.guideVisible||J._rightRulerConfig.guideVisible||J._bottomRulerConfig.guideVisible||J._leftRulerConfig.guideVisible||J._defaultRulerConfig.guideVisible||(J._topRulerConfig.guideTipVisible||J._rightRulerConfig.guideTipVisible||J._bottomRulerConfig.guideTipVisible||J._leftRulerConfig.guideTipVisible||J._defaultRulerConfig.guideTipVisible)&&J._component){var Q=U.getBoundingClientRect();J.$16k={x:i.clientX-Q.left,y:i.clientY-Q.top},J.$5k()}},J.setComponent(Y)},E("RulerFrame",O,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(F){var n=this,e=n._component,$=n.getView();if($){if(n._component=F,n.fp("component",e,F),e){var m=n.getComponentView(e);j($,m),x($,"mousemove",n.$15k),n.removeComponentPropertyChangeListener(e,n.$14k)}if(F){var f=n.getComponentView(F);D($,f),g(f,l,K),z($,"mousemove",n.$15k),n.addComponentPropertyChangeListener(F,n.$14k)}}},addComponentPropertyChangeListener:function(w,C){w&&w.mp&&w.mp(C)},removeComponentPropertyChangeListener:function(W,X){W&&W.ump&&W.ump(X)},getComponentHZoom:function(B){return B&&B.getZoom?B.getZoom():1},getComponentVZoom:function(n){return n&&n.getZoom?n.getZoom():1},getComponentViewRect:function(g){return g&&g.getViewRect?g.getViewRect():void 0},getComponentView:function(i){return i&&i.getView?i.getView():i},invalidateComponent:function(W){W&&W.iv&&W.iv()},validateComponent:function(C){C&&C.validate&&C.validate()},$7k:function(c,u,f,A,y,W,F,Z,q,k,S,t){if(u.visible){var K=this._defaultRulerConfig,H="borderStyle",V="borderColor",b="borderWidth",D="background",O=u[H]||K[H],E=u[V]||K[V],Y=u[b]||K[b],N=u.size!=T?u.size:K.size,G=u[D]||K[D],M=N+Y,h=this.$6k(Y,O,E,c,f,y,M,F,Z,q,k,S,t);g(c,y,"0px"),W?U.setCanvas(c,A-h,N):U.setCanvas(c,N,A-h),g(c,"background",G),g(c,I,w)}else g(c,I,i),g(this.getComponentView(this._component),y,"0px")},$6k:function(A,z,T,e,M,H,J,x,d,l,B,D,Z){var N=0;return g(e,M,A+"px "+z+" "+T),g(this.getComponentView(this._component),H,J+h),x?(g(e,d,l+h),N+=l):g(e,d,"0px"),B?(g(e,D,Z+h),N+=Z):g(e,D,"0px"),N},validateImpl:function(){var F=this,Q=F._component,k=F.$1k,b=F.$2k,L=F.$3k,a=F.$4k,X=F._view,w=F._defaultRulerConfig,N=F._topRulerConfig,_=F._rightRulerConfig,l=F._bottomRulerConfig,d=F._leftRulerConfig,U=w.size;if(X&&Q){var z=N.size!=T?N.size:U,f=_.size!=T?_.size:U,W=l.size!=T?l.size:U,n=d.size!=T?d.size:U;F.$7k(k,N,"border-bottom",X.offsetWidth,o,!0,d.visible,Y,n,_.visible,$,f),F.$7k(b,_,"border-left",X.offsetHeight,$,!1,N.visible,o,z,l.visible,H,W),F.$7k(L,l,"border-top",X.offsetWidth,H,!0,d.visible,Y,n,_.visible,$,f),F.$7k(a,d,"border-right",X.offsetHeight,Y,!1,N.visible,o,z,l.visible,H,W),F.$13k?delete F.$13k:F.invalidateComponent(Q),F.validateComponent(Q),F.$5k()}},$5k:function(){function Q(W,z,B,L,G,v){if(z.visible){var C=d(W),Q=z[I]||R,F=z[r]!=T?z[r]:s,i=z[q]||t,e=z[P]||U,$=z.size!=T?z.size:H,Em=z[K]||w,vh=z[Y]||o,bj=z[j]||g,lf=z[p]!=T?z[p]:_,vl=z[u]!=T?z[u]:E,ol=z[S]!=T?z[S]:a,Dd=z[A]!=T?z[A]:c,In=z[M]!=T?z[M]:V,rc=z[l]!=T?z[l]:Z,mc=z[X]||sj,ck=z[y]||vc;F&&(Q=N[v]=N.$8k(N[v]||Q,z[b]||x,z[h]||O,L?f:J,vh)),B.call(N,C,n,k,D,m,$,L?f:J,Q,i,e,G,Em,bj);var ib=N.$16k;(lf||vl)&&ib&&(L?N.$9k(C,ib.x,$,mc,ck,lf,vl,ol,Dd,In,rc):N.$10k(C,ib.y,$,mc,ck,lf,vl,ol,Dd,In,rc,G))}}var N=this,W=N.$1k,z=N.$2k,F=N.$3k,C=N.$4k,L=N._topRulerConfig,$=N._rightRulerConfig,B=N._bottomRulerConfig,G=N._leftRulerConfig,i=N._defaultRulerConfig,v=N._component,e=N.getComponentViewRect(v),f=N.getComponentHZoom(v),J=N.getComponentVZoom(v),n=e.x*f,D=n+e.width*f,k=e.y*J,m=k+e.height*J,H=N._defaultRulerConfig.size,I="defaultMajorTickSpacing",b="maxPhysicalMajorTickSpacing",h="minPhysicalMajorTickSpacing",r="tickSpacingAdaptable",q="majorTickTextFont",P="majorTickTextColor",K="majorTickColor",j="minorTickColor",p="guideVisible",u="guideTipVisible",S="guideTipBorderColor",A="guideTipTextColor",M="guideTipTextFont",l="guideTipBackground",X="guideColor",y="guideWidth",Y="minMajorTickSpacing",R=i[I],x=i[b],O=i[h],s=i[r],t=i[q],U=i[P],w=i[K],o=i[Y],g=i[j],_=i[p],E=i[u],a=i[S],c=i[A],V=i[M],Z=i[l],sj=i[X],vc=i[y];N._view&&v&&(Q(W,L,N.$11k,!0,!1,"_currentTopMajorTickSpacing"),Q(z,$,N.$12k,!1,!0,"_currentRightMajorTickSpacing"),Q(F,B,N.$11k,!0,!0,"_currentBottomMajorTickSpacing"),Q(C,G,N.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(r,o,k,S,i){return k>r*S?r=s(o/S/i)*i:r*S>o&&(r=t(k/S/i)*i),r},getHTipText:function(P){var p=this,N=p._component,X=0,g=p._view.getBoundingClientRect();return N.lp?X=V(N.lp({clientX:P.x+g.left,clientY:P.y}).x):X-=V(this.getComponentView(N).style.left)||0,X},$9k:function(v,s,Q,F,A,j,N,I,M,x,l){var c=this,Z=c._component;v.save(),U.translateAndScale(v,0,0,1);var i=s-(V(this.getComponentView(Z).style.left)||0),T=0;if(s=c.getHTipText(c.$16k),j&&(v.beginPath(),v.fillStyle=F,v.rect(i,T,A,Q),v.fill()),N){v.beginPath(),v.textAlign="center",v.textBaseline="middle",v.font=x;var X=v.measureText(s).width+6;v.fillStyle=l,v.rect(i-X/2,T,X,Q),v.fill(),v.strokeStyle=I,v.stroke(),v.beginPath(),v.fillStyle=M,v.fillText(s,i,T+Q/2)}v.restore()},getVTipText:function(D){var m=this,O=m._component,T=0,a=m._view.getBoundingClientRect();return O.lp?T=V(O.lp({clientX:D.x,clientY:D.y+a.top}).y):T-=V(this.getComponentView(O).style.top)||0,T},formatScaleText:function(e){return Math.round(e)},$10k:function(y,s,b,o,x,M,F,K,D,q,i,n){var A=this,G=A._component;y.save(),U.translateAndScale(y,0,0,1);var g=b/2,p=s-(V(this.getComponentView(G).style.top)||0);if(s=A.getVTipText(A.$16k),M&&(y.beginPath(),y.fillStyle=o,y.rect(g-b/2,p,b,x),y.fill()),F){y.translate(g,p),y.rotate((n?90:-90)*R/180),y.translate(-g,-p),y.beginPath(),y.textAlign="center",y.textBaseline="middle",y.font=q;var v=y.measureText(s).width+6;y.fillStyle=i,y.rect(g-v/2,p-b/2,v,b),y.fill(),y.strokeStyle=K,y.stroke(),y.fillStyle=D,y.fillText(s,g,p)}y.restore()},$11k:function(P,K,w,b,M,N,f,G,E,c,Y,C,h){P.save(),w=0;var Z=K,J=b,v=(Z+J)/2;K=0,b=J-Z,U.translateAndScale(P,0,0,1);var X=0,F=0,y=V(N/2),a=N-y,O=Y?0:y,W=G*f,Q=W/10;K-=W,b+=W,P.clearRect(K,0,b-K,N),P.beginPath(),P.fillStyle=h;var z=s(v/Q)*Q-Z;for(X=z;b>X;X+=Q)P.rect(X,w+O,1,a);for(X=z;X>K;X-=Q)P.rect(X,w+O,1,a);for(P.fill(),O=Y?0:1,P.beginPath(),P.fillStyle=C,z=s(v/W)*W-Z,X=z;b>X;X+=W)P.rect(X,w+O,1,N-1);for(X=z;X>K;X-=W)P.rect(X,w+O,1,N-1);P.fill();var j=V(/\d+px/.exec(E)[0]),o=(j||10)/2;P.textBaseline="middle",O=Y?N-o-2:o+2,P.beginPath(),P.fillStyle=c,P.font=E;var R=s(v/W)*W/f;for(X=z,F=R;b>X;X+=W,F+=G){var n=this.getHScaleText?this.getHScaleText(X):F;P.fillText(this.formatScaleText(n),X+2,w+O)}for(X=z,F=R;X>K;X-=W,F-=G){var n=this.getHScaleText?this.getHScaleText(X):F;P.fillText(this.formatScaleText(n),X+2,w+O)}P.restore()},$12k:function(e,T,q,n,N,r,L,Y,i,p,x,Q,f){function I(t,F,d,E,Z,x){Z=K.getVScaleText?K.getVScaleText(d):Z,Z=K.formatScaleText(Z),e.translate(t+F,d),e.rotate(-E),e.translate(-t-F,-d),e.fillText(Z,t+F+(x?2:1),d),e.translate(t+F,d),e.rotate(E),e.translate(-t-F,-d)}e.save(),T=0;var G=q,k=N,b=(G+k)/2;q=0,N=k-G,U.translateAndScale(e,0,0,1);var B=0,K=this,M=0,y=V(r/2),g=r-y,c=x?0:y,F=Y*L,E=F/10;q-=F,N+=F,e.clearRect(T,0,r,N-q),e.beginPath(),e.fillStyle=f;var Z=s(b/E)*E-G;for(B=Z;N>B;B+=E)e.rect(T+c,B,g,1);for(B=Z;B>q;B-=E)e.rect(T+c,B,g,1);for(e.fill(),c=x?0:1,e.beginPath(),e.fillStyle=Q,Z=s(b/F)*F-G,B=Z;N>B;B+=F)e.rect(T+c,B,r-1,1);for(B=Z;B>q;B-=F)e.rect(T+c,B,r-1,1);e.fill();var O=V(/\d+px/.exec(i)[0]),C=(O||10)/2,$=90*R/180;e.textBaseline="middle",c=x?r-C:C+2,$=x?-$:$,e.beginPath(),e.fillStyle=p,e.font=i;var X=s(b/F)*F/L;for(B=Z,M=X;N>B;B+=F,M+=Y)I(T,c,B,$,M,x);for(B=Z,M=X;B>q;B-=F,M-=Y)I(T,c,B,$,M,x);e.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var C=this,w=C._component,V=C._view;w&&C.removeComponentPropertyChangeListener(w,C.$14k),V&&(x(V,"mousemove",C.$15k),j(V.parentNode,V),C._view=null)}})}(this,Object);